!function(e){function t(A){if(r[A])return r[A].exports;var a=r[A]={exports:{},id:A,loaded:!1};return e[A].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";var A=r(3)["default"],a=r(11),i=A(a);r(1);var n=r(2),o=A(n);window.urlParse=i["default"],MAF.application.init({views:[{id:"view-GameView",viewClass:o["default"]},{id:"view-About",viewClass:MAF.views.AboutBox}],defaultViewId:"view-GameView",settingsViewId:"view-About"})},function(e,t){"use strict";document.createElement=document.createElement||function(e){switch(e){case"canvas":return new Canvas}throw new Error("document.createElement("+e+") not implemented. Check out createElementShim.js")}},function(e,t,r){"use strict";var A=r(3)["default"];Object.defineProperty(t,"__esModule",{value:!0});var a=r(4),i=r(5),n=A(i);MAF.Theme.Fonts.add("VCR","Fonts/vcr_osd_mono_1.001-webfont");var o=new MAF.Class({ClassName:"GameView",Extends:MAF.system.FullscreenView,createView:function(){var e=this,t=new MAF.element.Core({element:Canvas,styles:{width:this.width,height:this.height}}).appendTo(this),r=new MAF.element.Image({styles:{vAlign:"center",hAlign:"center",vOffset:50,hOffset:50}}).appendTo(this),A=new a.CanvasRenderer(this.width,this.height,{view:t.element}),i=new n["default"](A);i.setQRVisible=function(e){};var o=function l(){e.animating&&(requestAnimationFrame(l),i.render())};this.animating=!0,o();var s=new MAF.PrivateRoom(this.ClassName);this.room=s;(function(e){var t=e.payload;switch(e.type){case"onConnected":return void(s.joined||s.join());case"onDisconnected":return void i.players.clear();case"onCreated":var A=widget.getUrl("Client/client.html?hash="+t.hash);return console.log(A),void r.setSource(QRCode.get(A));case"onDestroyed":return void i.players.clear();case"onJoined":return void(t.user!==s.user&&i.players.joined(t.user));case"onHasLeft":return void(t.user!==s.user&&i.players.left(t.user));case"onData":i.players.onData(t);break;default:log(e.type,t)}}).subscribeTo(s,["onConnected","onDisconnected","onCreated","onDestroyed","onJoined","onHasLeft","onData","onError"]),s.connected&&s.join()},destroyView:function(){this.animating=!1,this.room&&(this.room.leave(),this.room.destroy(),delete this.room)}});t["default"]=o,e.exports=t["default"]},function(e,t){"use strict";t["default"]=function(e){return e&&e.__esModule?e:{"default":e}},t.__esModule=!0},function(module,exports){eval(decodeURIComponent("%2F**%0A%20*%20%40license%0A%20*%20pixi.js%20-%20v3.0.8%0A%20*%20Compiled%202015-10-14T14%3A21%3A20.183Z%0A%20*%0A%20*%20pixi.js%20is%20licensed%20under%20the%20MIT%20License.%0A%20*%20http%3A%2F%2Fwww.opensource.org%2Flicenses%2Fmit-license.php%0A%20*%0A%20*%0A%20*%20The%20MIT%20License%0A%20*%20%0A%20*%20Copyright%20(c)%202013-2015%20Mathew%20Groves%0A%20*%20%0A%20*%20Permission%20is%20hereby%20granted%2C%20free%20of%20charge%2C%20to%20any%20person%20obtaining%20a%20copy%0A%20*%20of%20this%20software%20and%20associated%20documentation%20files%20(the%20%22Software%22)%2C%20to%20deal%0A%20*%20in%20the%20Software%20without%20restriction%2C%20including%20without%20limitation%20the%20rights%0A%20*%20to%20use%2C%20copy%2C%20modify%2C%20merge%2C%20publish%2C%20distribute%2C%20sublicense%2C%20and%2For%20sell%0A%20*%20copies%20of%20the%20Software%2C%20and%20to%20permit%20persons%20to%20whom%20the%20Software%20is%0A%20*%20furnished%20to%20do%20so%2C%20subject%20to%20the%20following%20conditions%3A%0A%20*%20%0A%20*%20The%20above%20copyright%20notice%20and%20this%20permission%20notice%20shall%20be%20included%20in%0A%20*%20all%20copies%20or%20substantial%20portions%20of%20the%20Software.%0A%20*%20%0A%20*%20THE%20SOFTWARE%20IS%20PROVIDED%20%22AS%20IS%22%2C%20WITHOUT%20WARRANTY%20OF%20ANY%20KIND%2C%20EXPRESS%20OR%0A%20*%20IMPLIED%2C%20INCLUDING%20BUT%20NOT%20LIMITED%20TO%20THE%20WARRANTIES%20OF%20MERCHANTABILITY%2C%0A%20*%20FITNESS%20FOR%20A%20PARTICULAR%20PURPOSE%20AND%20NONINFRINGEMENT.%20IN%20NO%20EVENT%20SHALL%20THE%0A%20*%20AUTHORS%20OR%20COPYRIGHT%20HOLDERS%20BE%20LIABLE%20FOR%20ANY%20CLAIM%2C%20DAMAGES%20OR%20OTHER%0A%20*%20LIABILITY%2C%20WHETHER%20IN%20AN%20ACTION%20OF%20CONTRACT%2C%20TORT%20OR%20OTHERWISE%2C%20ARISING%20FROM%2C%0A%20*%20OUT%20OF%20OR%20IN%20CONNECTION%20WITH%20THE%20SOFTWARE%20OR%20THE%20USE%20OR%20OTHER%20DEALINGS%20IN%0A%20*%20THE%20SOFTWARE.%0A%20*%20%0A%20*%20%0A%20*%2F%0A(function(f)%7Bif(typeof%20exports%3D%3D%3D%22object%22%26%26typeof%20module!%3D%3D%22undefined%22)%7Bmodule.exports%3Df()%7Delse%20if(typeof%20define%3D%3D%3D%22function%22%26%26define.amd)%7Bdefine(%5B%5D%2Cf)%7Delse%7Bvar%20g%3Bif(typeof%20window!%3D%3D%22undefined%22)%7Bg%3Dwindow%7Delse%20if(typeof%20global!%3D%3D%22undefined%22)%7Bg%3Dglobal%7Delse%20if(typeof%20self!%3D%3D%22undefined%22)%7Bg%3Dself%7Delse%7Bg%3Dthis%7Dg.PIXI%20%3D%20f()%7D%7D)(function()%7Bvar%20define%2Cmodule%2Cexports%3Breturn%20(function%20e(t%2Cn%2Cr)%7Bfunction%20s(o%2Cu)%7Bif(!n%5Bo%5D)%7Bif(!t%5Bo%5D)%7Bvar%20a%3Dtypeof%20require%3D%3D%22function%22%26%26require%3Bif(!u%26%26a)return%20a(o%2C!0)%3Bif(i)return%20i(o%2C!0)%3Bvar%20f%3Dnew%20Error(%22Cannot%20find%20module%20'%22%2Bo%2B%22'%22)%3Bthrow%20f.code%3D%22MODULE_NOT_FOUND%22%2Cf%7Dvar%20l%3Dn%5Bo%5D%3D%7Bexports%3A%7B%7D%7D%3Bt%5Bo%5D%5B0%5D.call(l.exports%2Cfunction(e)%7Bvar%20n%3Dt%5Bo%5D%5B1%5D%5Be%5D%3Breturn%20s(n%3Fn%3Ae)%7D%2Cl%2Cl.exports%2Ce%2Ct%2Cn%2Cr)%7Dreturn%20n%5Bo%5D.exports%7Dvar%20i%3Dtypeof%20require%3D%3D%22function%22%26%26require%3Bfor(var%20o%3D0%3Bo%3Cr.length%3Bo%2B%2B)s(r%5Bo%5D)%3Breturn%20s%7D)(%7B1%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A(function%20(process%2Cglobal)%7B%0A%2F*!%0A%20*%20async%0A%20*%20https%3A%2F%2Fgithub.com%2Fcaolan%2Fasync%0A%20*%0A%20*%20Copyright%202010-2014%20Caolan%20McMahon%0A%20*%20Released%20under%20the%20MIT%20license%0A%20*%2F%0A(function%20()%20%7B%0A%0A%20%20%20%20var%20async%20%3D%20%7B%7D%3B%0A%20%20%20%20function%20noop()%20%7B%7D%0A%20%20%20%20function%20identity(v)%20%7B%0A%20%20%20%20%20%20%20%20return%20v%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20toBool(v)%20%7B%0A%20%20%20%20%20%20%20%20return%20!!v%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20notId(v)%20%7B%0A%20%20%20%20%20%20%20%20return%20!v%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20global%20on%20the%20server%2C%20window%20in%20the%20browser%0A%20%20%20%20var%20previous_async%3B%0A%0A%20%20%20%20%2F%2F%20Establish%20the%20root%20object%2C%20%60window%60%20(%60self%60)%20in%20the%20browser%2C%20%60global%60%0A%20%20%20%20%2F%2F%20on%20the%20server%2C%20or%20%60this%60%20in%20some%20virtual%20machines.%20We%20use%20%60self%60%0A%20%20%20%20%2F%2F%20instead%20of%20%60window%60%20for%20%60WebWorker%60%20support.%0A%20%20%20%20var%20root%20%3D%20typeof%20self%20%3D%3D%3D%20'object'%20%26%26%20self.self%20%3D%3D%3D%20self%20%26%26%20self%20%7C%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20typeof%20global%20%3D%3D%3D%20'object'%20%26%26%20global.global%20%3D%3D%3D%20global%20%26%26%20global%20%7C%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20this%3B%0A%0A%20%20%20%20if%20(root%20!%3D%20null)%20%7B%0A%20%20%20%20%20%20%20%20previous_async%20%3D%20root.async%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20async.noConflict%20%3D%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20root.async%20%3D%20previous_async%3B%0A%20%20%20%20%20%20%20%20return%20async%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20function%20only_once(fn)%20%7B%0A%20%20%20%20%20%20%20%20return%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(fn%20%3D%3D%3D%20null)%20throw%20new%20Error(%22Callback%20was%20already%20called.%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20fn.apply(this%2C%20arguments)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20fn%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20_once(fn)%20%7B%0A%20%20%20%20%20%20%20%20return%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(fn%20%3D%3D%3D%20null)%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20fn.apply(this%2C%20arguments)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20fn%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%20cross-browser%20compatiblity%20functions%20%2F%2F%2F%2F%0A%0A%20%20%20%20var%20_toString%20%3D%20Object.prototype.toString%3B%0A%0A%20%20%20%20var%20_isArray%20%3D%20Array.isArray%20%7C%7C%20function%20(obj)%20%7B%0A%20%20%20%20%20%20%20%20return%20_toString.call(obj)%20%3D%3D%3D%20'%5Bobject%20Array%5D'%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20%2F%2F%20Ported%20from%20underscore.js%20isObject%0A%20%20%20%20var%20_isObject%20%3D%20function(obj)%20%7B%0A%20%20%20%20%20%20%20%20var%20type%20%3D%20typeof%20obj%3B%0A%20%20%20%20%20%20%20%20return%20type%20%3D%3D%3D%20'function'%20%7C%7C%20type%20%3D%3D%3D%20'object'%20%26%26%20!!obj%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20function%20_isArrayLike(arr)%20%7B%0A%20%20%20%20%20%20%20%20return%20_isArray(arr)%20%7C%7C%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20has%20a%20positive%20integer%20length%20property%0A%20%20%20%20%20%20%20%20%20%20%20%20typeof%20arr.length%20%3D%3D%3D%20%22number%22%20%26%26%0A%20%20%20%20%20%20%20%20%20%20%20%20arr.length%20%3E%3D%200%20%26%26%0A%20%20%20%20%20%20%20%20%20%20%20%20arr.length%20%25%201%20%3D%3D%3D%200%0A%20%20%20%20%20%20%20%20)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20_each(coll%2C%20iterator)%20%7B%0A%20%20%20%20%20%20%20%20return%20_isArrayLike(coll)%20%3F%0A%20%20%20%20%20%20%20%20%20%20%20%20_arrayEach(coll%2C%20iterator)%20%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_forEachOf(coll%2C%20iterator)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20_arrayEach(arr%2C%20iterator)%20%7B%0A%20%20%20%20%20%20%20%20var%20index%20%3D%20-1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20length%20%3D%20arr.length%3B%0A%0A%20%20%20%20%20%20%20%20while%20(%2B%2Bindex%20%3C%20length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(arr%5Bindex%5D%2C%20index%2C%20arr)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20_map(arr%2C%20iterator)%20%7B%0A%20%20%20%20%20%20%20%20var%20index%20%3D%20-1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20length%20%3D%20arr.length%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20result%20%3D%20Array(length)%3B%0A%0A%20%20%20%20%20%20%20%20while%20(%2B%2Bindex%20%3C%20length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20result%5Bindex%5D%20%3D%20iterator(arr%5Bindex%5D%2C%20index%2C%20arr)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20result%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20_range(count)%20%7B%0A%20%20%20%20%20%20%20%20return%20_map(Array(count)%2C%20function%20(v%2C%20i)%20%7B%20return%20i%3B%20%7D)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20_reduce(arr%2C%20iterator%2C%20memo)%20%7B%0A%20%20%20%20%20%20%20%20_arrayEach(arr%2C%20function%20(x%2C%20i%2C%20a)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20memo%20%3D%20iterator(memo%2C%20x%2C%20i%2C%20a)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20return%20memo%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20_forEachOf(object%2C%20iterator)%20%7B%0A%20%20%20%20%20%20%20%20_arrayEach(_keys(object)%2C%20function%20(key)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(object%5Bkey%5D%2C%20key)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20_indexOf(arr%2C%20item)%20%7B%0A%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20arr.length%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(arr%5Bi%5D%20%3D%3D%3D%20item)%20return%20i%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20-1%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20_keys%20%3D%20Object.keys%20%7C%7C%20function%20(obj)%20%7B%0A%20%20%20%20%20%20%20%20var%20keys%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20for%20(var%20k%20in%20obj)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(obj.hasOwnProperty(k))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20keys.push(k)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20keys%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20function%20_keyIterator(coll)%20%7B%0A%20%20%20%20%20%20%20%20var%20i%20%3D%20-1%3B%0A%20%20%20%20%20%20%20%20var%20len%3B%0A%20%20%20%20%20%20%20%20var%20keys%3B%0A%20%20%20%20%20%20%20%20if%20(_isArrayLike(coll))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20len%20%3D%20coll.length%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20function%20next()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20i%2B%2B%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20i%20%3C%20len%20%3F%20i%20%3A%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20keys%20%3D%20_keys(coll)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20len%20%3D%20keys.length%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20function%20next()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20i%2B%2B%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20i%20%3C%20len%20%3F%20keys%5Bi%5D%20%3A%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Similar%20to%20ES6's%20rest%20param%20(http%3A%2F%2Fariya.ofilabs.com%2F2013%2F03%2Fes6-and-rest-parameter.html)%0A%20%20%20%20%2F%2F%20This%20accumulates%20the%20arguments%20passed%20into%20an%20array%2C%20after%20a%20given%20index.%0A%20%20%20%20%2F%2F%20From%20underscore.js%20(https%3A%2F%2Fgithub.com%2Fjashkenas%2Funderscore%2Fpull%2F2140).%0A%20%20%20%20function%20_restParam(func%2C%20startIndex)%20%7B%0A%20%20%20%20%20%20%20%20startIndex%20%3D%20startIndex%20%3D%3D%20null%20%3F%20func.length%20-%201%20%3A%20%2BstartIndex%3B%0A%20%20%20%20%20%20%20%20return%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20length%20%3D%20Math.max(arguments.length%20-%20startIndex%2C%200)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20rest%20%3D%20Array(length)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(var%20index%20%3D%200%3B%20index%20%3C%20length%3B%20index%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20rest%5Bindex%5D%20%3D%20arguments%5Bindex%20%2B%20startIndex%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20switch%20(startIndex)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%200%3A%20return%20func.call(this%2C%20rest)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%201%3A%20return%20func.call(this%2C%20arguments%5B0%5D%2C%20rest)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Currently%20unused%20but%20handle%20cases%20outside%20of%20the%20switch%20statement%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20var%20args%20%3D%20Array(startIndex%20%2B%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20for%20(index%20%3D%200%3B%20index%20%3C%20startIndex%3B%20index%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%20%20%20%20args%5Bindex%5D%20%3D%20arguments%5Bindex%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20args%5BstartIndex%5D%20%3D%20rest%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20return%20func.apply(this%2C%20args)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20_withoutIndex(iterator)%20%7B%0A%20%20%20%20%20%20%20%20return%20function%20(value%2C%20index%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20iterator(value%2C%20callback)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%20exported%20async%20module%20functions%20%2F%2F%2F%2F%0A%0A%20%20%20%20%2F%2F%2F%2F%20nextTick%20implementation%20with%20browser-compatible%20fallback%20%2F%2F%2F%2F%0A%0A%20%20%20%20%2F%2F%20capture%20the%20global%20reference%20to%20guard%20against%20fakeTimer%20mocks%0A%20%20%20%20var%20_setImmediate%20%3D%20typeof%20setImmediate%20%3D%3D%3D%20'function'%20%26%26%20setImmediate%3B%0A%0A%20%20%20%20var%20_delay%20%3D%20_setImmediate%20%3F%20function(fn)%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20not%20a%20direct%20alias%20for%20IE10%20compatibility%0A%20%20%20%20%20%20%20%20_setImmediate(fn)%3B%0A%20%20%20%20%7D%20%3A%20function(fn)%20%7B%0A%20%20%20%20%20%20%20%20setTimeout(fn%2C%200)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20if%20(typeof%20process%20%3D%3D%3D%20'object'%20%26%26%20typeof%20process.nextTick%20%3D%3D%3D%20'function')%20%7B%0A%20%20%20%20%20%20%20%20async.nextTick%20%3D%20process.nextTick%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20async.nextTick%20%3D%20_delay%3B%0A%20%20%20%20%7D%0A%20%20%20%20async.setImmediate%20%3D%20_setImmediate%20%3F%20_delay%20%3A%20async.nextTick%3B%0A%0A%0A%20%20%20%20async.forEach%20%3D%0A%20%20%20%20async.each%20%3D%20function%20(arr%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20return%20async.eachOf(arr%2C%20_withoutIndex(iterator)%2C%20callback)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.forEachSeries%20%3D%0A%20%20%20%20async.eachSeries%20%3D%20function%20(arr%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20return%20async.eachOfSeries(arr%2C%20_withoutIndex(iterator)%2C%20callback)%3B%0A%20%20%20%20%7D%3B%0A%0A%0A%20%20%20%20async.forEachLimit%20%3D%0A%20%20%20%20async.eachLimit%20%3D%20function%20(arr%2C%20limit%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20return%20_eachOfLimit(limit)(arr%2C%20_withoutIndex(iterator)%2C%20callback)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.forEachOf%20%3D%0A%20%20%20%20async.eachOf%20%3D%20function%20(object%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20callback%20%3D%20_once(callback%20%7C%7C%20noop)%3B%0A%20%20%20%20%20%20%20%20object%20%3D%20object%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20var%20size%20%3D%20_isArrayLike(object)%20%3F%20object.length%20%3A%20_keys(object).length%3B%0A%20%20%20%20%20%20%20%20var%20completed%20%3D%200%3B%0A%20%20%20%20%20%20%20%20if%20(!size)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20callback(null)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20_each(object%2C%20function%20(value%2C%20key)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(object%5Bkey%5D%2C%20key%2C%20only_once(done))%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20function%20done(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20completed%20%2B%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(completed%20%3E%3D%20size)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(null)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.forEachOfSeries%20%3D%0A%20%20%20%20async.eachOfSeries%20%3D%20function%20(obj%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20callback%20%3D%20_once(callback%20%7C%7C%20noop)%3B%0A%20%20%20%20%20%20%20%20obj%20%3D%20obj%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20var%20nextKey%20%3D%20_keyIterator(obj)%3B%0A%20%20%20%20%20%20%20%20var%20key%20%3D%20nextKey()%3B%0A%20%20%20%20%20%20%20%20function%20iterate()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20sync%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(key%20%3D%3D%3D%20null)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20callback(null)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(obj%5Bkey%5D%2C%20key%2C%20only_once(function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20key%20%3D%20nextKey()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(key%20%3D%3D%3D%20null)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20callback(null)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(sync)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20async.nextTick(iterate)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20iterate()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20sync%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20iterate()%3B%0A%20%20%20%20%7D%3B%0A%0A%0A%0A%20%20%20%20async.forEachOfLimit%20%3D%0A%20%20%20%20async.eachOfLimit%20%3D%20function%20(obj%2C%20limit%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20_eachOfLimit(limit)(obj%2C%20iterator%2C%20callback)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20function%20_eachOfLimit(limit)%20%7B%0A%0A%20%20%20%20%20%20%20%20return%20function%20(obj%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20callback%20%3D%20_once(callback%20%7C%7C%20noop)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20obj%20%3D%20obj%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20nextKey%20%3D%20_keyIterator(obj)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(limit%20%3C%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20callback(null)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20done%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20running%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20errored%20%3D%20false%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20(function%20replenish%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(done%20%26%26%20running%20%3C%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20callback(null)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20while%20(running%20%3C%20limit%20%26%26%20!errored)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20key%20%3D%20nextKey()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(key%20%3D%3D%3D%20null)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20done%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(running%20%3C%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(null)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20running%20%2B%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20iterator(obj%5Bkey%5D%2C%20key%2C%20only_once(function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20running%20-%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20errored%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20replenish()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)()%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%0A%0A%20%20%20%20function%20doParallel(fn)%20%7B%0A%20%20%20%20%20%20%20%20return%20function%20(obj%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20fn(async.eachOf%2C%20obj%2C%20iterator%2C%20callback)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20doParallelLimit(fn)%20%7B%0A%20%20%20%20%20%20%20%20return%20function%20(obj%2C%20limit%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20fn(_eachOfLimit(limit)%2C%20obj%2C%20iterator%2C%20callback)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20doSeries(fn)%20%7B%0A%20%20%20%20%20%20%20%20return%20function%20(obj%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20fn(async.eachOfSeries%2C%20obj%2C%20iterator%2C%20callback)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20_asyncMap(eachfn%2C%20arr%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20callback%20%3D%20_once(callback%20%7C%7C%20noop)%3B%0A%20%20%20%20%20%20%20%20var%20results%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20eachfn(arr%2C%20function%20(value%2C%20index%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(value%2C%20function%20(err%2C%20v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20results%5Bindex%5D%20%3D%20v%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20callback(err%2C%20results)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20async.map%20%3D%20doParallel(_asyncMap)%3B%0A%20%20%20%20async.mapSeries%20%3D%20doSeries(_asyncMap)%3B%0A%20%20%20%20async.mapLimit%20%3D%20doParallelLimit(_asyncMap)%3B%0A%0A%20%20%20%20%2F%2F%20reduce%20only%20has%20a%20series%20version%2C%20as%20doing%20reduce%20in%20parallel%20won't%0A%20%20%20%20%2F%2F%20work%20in%20many%20situations.%0A%20%20%20%20async.inject%20%3D%0A%20%20%20%20async.foldl%20%3D%0A%20%20%20%20async.reduce%20%3D%20function%20(arr%2C%20memo%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20async.eachOfSeries(arr%2C%20function%20(x%2C%20i%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(memo%2C%20x%2C%20function%20(err%2C%20v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20memo%20%3D%20v%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20callback(err%20%7C%7C%20null%2C%20memo)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.foldr%20%3D%0A%20%20%20%20async.reduceRight%20%3D%20function%20(arr%2C%20memo%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20var%20reversed%20%3D%20_map(arr%2C%20identity).reverse()%3B%0A%20%20%20%20%20%20%20%20async.reduce(reversed%2C%20memo%2C%20iterator%2C%20callback)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20function%20_filter(eachfn%2C%20arr%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20var%20results%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20eachfn(arr%2C%20function%20(x%2C%20index%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(x%2C%20function%20(v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20results.push(%7Bindex%3A%20index%2C%20value%3A%20x%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20callback(_map(results.sort(function%20(a%2C%20b)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20a.index%20-%20b.index%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%2C%20function%20(x)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20x.value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D))%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20async.select%20%3D%0A%20%20%20%20async.filter%20%3D%20doParallel(_filter)%3B%0A%0A%20%20%20%20async.selectLimit%20%3D%0A%20%20%20%20async.filterLimit%20%3D%20doParallelLimit(_filter)%3B%0A%0A%20%20%20%20async.selectSeries%20%3D%0A%20%20%20%20async.filterSeries%20%3D%20doSeries(_filter)%3B%0A%0A%20%20%20%20function%20_reject(eachfn%2C%20arr%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20_filter(eachfn%2C%20arr%2C%20function(value%2C%20cb)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(value%2C%20function(v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cb(!v)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20callback)%3B%0A%20%20%20%20%7D%0A%20%20%20%20async.reject%20%3D%20doParallel(_reject)%3B%0A%20%20%20%20async.rejectLimit%20%3D%20doParallelLimit(_reject)%3B%0A%20%20%20%20async.rejectSeries%20%3D%20doSeries(_reject)%3B%0A%0A%20%20%20%20function%20_createTester(eachfn%2C%20check%2C%20getResult)%20%7B%0A%20%20%20%20%20%20%20%20return%20function(arr%2C%20limit%2C%20iterator%2C%20cb)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20function%20done()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(cb)%20cb(getResult(false%2C%20void%200))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20function%20iteratee(x%2C%20_%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!cb)%20return%20callback()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20iterator(x%2C%20function%20(v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(cb%20%26%26%20check(v))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cb(getResult(true%2C%20x))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cb%20%3D%20iterator%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(arguments.length%20%3E%203)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20eachfn(arr%2C%20limit%2C%20iteratee%2C%20done)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cb%20%3D%20iterator%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20iterator%20%3D%20limit%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20eachfn(arr%2C%20iteratee%2C%20done)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20async.any%20%3D%0A%20%20%20%20async.some%20%3D%20_createTester(async.eachOf%2C%20toBool%2C%20identity)%3B%0A%0A%20%20%20%20async.someLimit%20%3D%20_createTester(async.eachOfLimit%2C%20toBool%2C%20identity)%3B%0A%0A%20%20%20%20async.all%20%3D%0A%20%20%20%20async.every%20%3D%20_createTester(async.eachOf%2C%20notId%2C%20notId)%3B%0A%0A%20%20%20%20async.everyLimit%20%3D%20_createTester(async.eachOfLimit%2C%20notId%2C%20notId)%3B%0A%0A%20%20%20%20function%20_findGetResult(v%2C%20x)%20%7B%0A%20%20%20%20%20%20%20%20return%20x%3B%0A%20%20%20%20%7D%0A%20%20%20%20async.detect%20%3D%20_createTester(async.eachOf%2C%20identity%2C%20_findGetResult)%3B%0A%20%20%20%20async.detectSeries%20%3D%20_createTester(async.eachOfSeries%2C%20identity%2C%20_findGetResult)%3B%0A%20%20%20%20async.detectLimit%20%3D%20_createTester(async.eachOfLimit%2C%20identity%2C%20_findGetResult)%3B%0A%0A%20%20%20%20async.sortBy%20%3D%20function%20(arr%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20async.map(arr%2C%20function%20(x%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(x%2C%20function%20(err%2C%20criteria)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(null%2C%20%7Bvalue%3A%20x%2C%20criteria%3A%20criteria%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20function%20(err%2C%20results)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(null%2C%20_map(results.sort(comparator)%2C%20function%20(x)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20x.value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20%20%20function%20comparator(left%2C%20right)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20a%20%3D%20left.criteria%2C%20b%20%3D%20right.criteria%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20a%20%3C%20b%20%3F%20-1%20%3A%20a%20%3E%20b%20%3F%201%20%3A%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.auto%20%3D%20function%20(tasks%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20callback%20%3D%20_once(callback%20%7C%7C%20noop)%3B%0A%20%20%20%20%20%20%20%20var%20keys%20%3D%20_keys(tasks)%3B%0A%20%20%20%20%20%20%20%20var%20remainingTasks%20%3D%20keys.length%3B%0A%20%20%20%20%20%20%20%20if%20(!remainingTasks)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20callback(null)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20var%20results%20%3D%20%7B%7D%3B%0A%0A%20%20%20%20%20%20%20%20var%20listeners%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20function%20addListener(fn)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20listeners.unshift(fn)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20function%20removeListener(fn)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20idx%20%3D%20_indexOf(listeners%2C%20fn)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(idx%20%3E%3D%200)%20listeners.splice(idx%2C%201)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20function%20taskComplete()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20remainingTasks--%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_arrayEach(listeners.slice(0)%2C%20function%20(fn)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fn()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20addListener(function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!remainingTasks)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(null%2C%20results)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20%20%20_arrayEach(keys%2C%20function%20(k)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20task%20%3D%20_isArray(tasks%5Bk%5D)%20%3F%20tasks%5Bk%5D%3A%20%5Btasks%5Bk%5D%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20taskCallback%20%3D%20_restParam(function(err%2C%20args)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(args.length%20%3C%3D%201)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20args%20%3D%20args%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20safeResults%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_forEachOf(results%2C%20function(val%2C%20rkey)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20safeResults%5Brkey%5D%20%3D%20val%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20safeResults%5Bk%5D%20%3D%20args%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err%2C%20safeResults)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20results%5Bk%5D%20%3D%20args%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20async.setImmediate(taskComplete)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20requires%20%3D%20task.slice(0%2C%20task.length%20-%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20prevent%20dead-locks%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20len%20%3D%20requires.length%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20dep%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20while%20(len--)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!(dep%20%3D%20tasks%5Brequires%5Blen%5D%5D))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error('Has%20inexistant%20dependency')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(_isArray(dep)%20%26%26%20_indexOf(dep%2C%20k)%20%3E%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error('Has%20cyclic%20dependencies')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20function%20ready()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20_reduce(requires%2C%20function%20(a%2C%20x)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20(a%20%26%26%20results.hasOwnProperty(x))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%20true)%20%26%26%20!results.hasOwnProperty(k)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(ready())%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20task%5Btask.length%20-%201%5D(taskCallback%2C%20results)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20addListener(listener)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20function%20listener()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(ready())%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20removeListener(listener)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20task%5Btask.length%20-%201%5D(taskCallback%2C%20results)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%3B%0A%0A%0A%0A%20%20%20%20async.retry%20%3D%20function(times%2C%20task%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20var%20DEFAULT_TIMES%20%3D%205%3B%0A%20%20%20%20%20%20%20%20var%20DEFAULT_INTERVAL%20%3D%200%3B%0A%0A%20%20%20%20%20%20%20%20var%20attempts%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20%20%20%20%20var%20opts%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20times%3A%20DEFAULT_TIMES%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20interval%3A%20DEFAULT_INTERVAL%0A%20%20%20%20%20%20%20%20%7D%3B%0A%0A%20%20%20%20%20%20%20%20function%20parseTimes(acc%2C%20t)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(typeof%20t%20%3D%3D%3D%20'number')%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20acc.times%20%3D%20parseInt(t%2C%2010)%20%7C%7C%20DEFAULT_TIMES%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if(typeof%20t%20%3D%3D%3D%20'object')%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20acc.times%20%3D%20parseInt(t.times%2C%2010)%20%7C%7C%20DEFAULT_TIMES%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20acc.interval%20%3D%20parseInt(t.interval%2C%2010)%20%7C%7C%20DEFAULT_INTERVAL%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error('Unsupported%20argument%20type%20for%20%5C'times%5C'%3A%20'%20%2B%20typeof%20t)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20var%20length%20%3D%20arguments.length%3B%0A%20%20%20%20%20%20%20%20if%20(length%20%3C%201%20%7C%7C%20length%20%3E%203)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error('Invalid%20arguments%20-%20must%20be%20either%20(task)%2C%20(task%2C%20callback)%2C%20(times%2C%20task)%20or%20(times%2C%20task%2C%20callback)')%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20(length%20%3C%3D%202%20%26%26%20typeof%20times%20%3D%3D%3D%20'function')%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20callback%20%3D%20task%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20task%20%3D%20times%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20(typeof%20times%20!%3D%3D%20'function')%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20parseTimes(opts%2C%20times)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20opts.callback%20%3D%20callback%3B%0A%20%20%20%20%20%20%20%20opts.task%20%3D%20task%3B%0A%0A%20%20%20%20%20%20%20%20function%20wrappedTask(wrappedCallback%2C%20wrappedResults)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20function%20retryAttempt(task%2C%20finalAttempt)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20function(seriesCallback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20task(function(err%2C%20result)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20seriesCallback(!err%20%7C%7C%20finalAttempt%2C%20%7Berr%3A%20err%2C%20result%3A%20result%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%20wrappedResults)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20function%20retryInterval(interval)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20function(seriesCallback)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20setTimeout(function()%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20seriesCallback(null)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%20interval)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20while%20(opts.times)%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20finalAttempt%20%3D%20!(opts.times-%3D1)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20attempts.push(retryAttempt(opts.task%2C%20finalAttempt))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(!finalAttempt%20%26%26%20opts.interval%20%3E%200)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20attempts.push(retryInterval(opts.interval))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20async.series(attempts%2C%20function(done%2C%20data)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%20%3D%20data%5Bdata.length%20-%201%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(wrappedCallback%20%7C%7C%20opts.callback)(data.err%2C%20data.result)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20If%20a%20callback%20is%20passed%2C%20run%20this%20as%20a%20controll%20flow%0A%20%20%20%20%20%20%20%20return%20opts.callback%20%3F%20wrappedTask()%20%3A%20wrappedTask%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.waterfall%20%3D%20function%20(tasks%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20callback%20%3D%20_once(callback%20%7C%7C%20noop)%3B%0A%20%20%20%20%20%20%20%20if%20(!_isArray(tasks))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20err%20%3D%20new%20Error('First%20argument%20to%20waterfall%20must%20be%20an%20array%20of%20functions')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20(!tasks.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20callback()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20function%20wrapIterator(iterator)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20_restParam(function%20(err%2C%20args)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback.apply(null%2C%20%5Berr%5D.concat(args))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20next%20%3D%20iterator.next()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(next)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20args.push(wrapIterator(next))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20args.push(callback)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ensureAsync(iterator).apply(null%2C%20args)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20wrapIterator(async.iterator(tasks))()%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20function%20_parallel(eachfn%2C%20tasks%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20callback%20%3D%20callback%20%7C%7C%20noop%3B%0A%20%20%20%20%20%20%20%20var%20results%20%3D%20_isArrayLike(tasks)%20%3F%20%5B%5D%20%3A%20%7B%7D%3B%0A%0A%20%20%20%20%20%20%20%20eachfn(tasks%2C%20function%20(task%2C%20key%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20task(_restParam(function%20(err%2C%20args)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(args.length%20%3C%3D%201)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20args%20%3D%20args%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20results%5Bkey%5D%20%3D%20args%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D))%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20callback(err%2C%20results)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20async.parallel%20%3D%20function%20(tasks%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20_parallel(async.eachOf%2C%20tasks%2C%20callback)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.parallelLimit%20%3D%20function(tasks%2C%20limit%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20_parallel(_eachOfLimit(limit)%2C%20tasks%2C%20callback)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.series%20%3D%20function(tasks%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20_parallel(async.eachOfSeries%2C%20tasks%2C%20callback)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.iterator%20%3D%20function%20(tasks)%20%7B%0A%20%20%20%20%20%20%20%20function%20makeCallback(index)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20function%20fn()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(tasks.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20tasks%5Bindex%5D.apply(null%2C%20arguments)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20fn.next()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20fn.next%20%3D%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20(index%20%3C%20tasks.length%20-%201)%20%3F%20makeCallback(index%20%2B%201)%3A%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20fn%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20makeCallback(0)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.apply%20%3D%20_restParam(function%20(fn%2C%20args)%20%7B%0A%20%20%20%20%20%20%20%20return%20_restParam(function%20(callArgs)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20fn.apply(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20null%2C%20args.concat(callArgs)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D)%3B%0A%0A%20%20%20%20function%20_concat(eachfn%2C%20arr%2C%20fn%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20var%20result%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20eachfn(arr%2C%20function%20(x%2C%20index%2C%20cb)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20fn(x%2C%20function%20(err%2C%20y)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20result%20%3D%20result.concat(y%20%7C%7C%20%5B%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cb(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20callback(err%2C%20result)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%20%20%20%20async.concat%20%3D%20doParallel(_concat)%3B%0A%20%20%20%20async.concatSeries%20%3D%20doSeries(_concat)%3B%0A%0A%20%20%20%20async.whilst%20%3D%20function%20(test%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20callback%20%3D%20callback%20%7C%7C%20noop%3B%0A%20%20%20%20%20%20%20%20if%20(test())%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20next%20%3D%20_restParam(function(err%2C%20args)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20(test.apply(this%2C%20args))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20iterator(next)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(null)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(next)%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20callback(null)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.doWhilst%20%3D%20function%20(iterator%2C%20test%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20var%20calls%20%3D%200%3B%0A%20%20%20%20%20%20%20%20return%20async.whilst(function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%2B%2Bcalls%20%3C%3D%201%20%7C%7C%20test.apply(this%2C%20arguments)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20iterator%2C%20callback)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.until%20%3D%20function%20(test%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20return%20async.whilst(function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20!test.apply(this%2C%20arguments)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20iterator%2C%20callback)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.doUntil%20%3D%20function%20(iterator%2C%20test%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20return%20async.doWhilst(iterator%2C%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20!test.apply(this%2C%20arguments)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20callback)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.during%20%3D%20function%20(test%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20callback%20%3D%20callback%20%7C%7C%20noop%3B%0A%0A%20%20%20%20%20%20%20%20var%20next%20%3D%20_restParam(function(err%2C%20args)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20args.push(check)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20test.apply(this%2C%20args)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20%20%20var%20check%20%3D%20function(err%2C%20truth)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20(truth)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20iterator(next)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(null)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%3B%0A%0A%20%20%20%20%20%20%20%20test(check)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.doDuring%20%3D%20function%20(iterator%2C%20test%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20var%20calls%20%3D%200%3B%0A%20%20%20%20%20%20%20%20async.during(function(next)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(calls%2B%2B%20%3C%201)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20next(null%2C%20true)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20test.apply(this%2C%20arguments)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%2C%20iterator%2C%20callback)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20function%20_queue(worker%2C%20concurrency%2C%20payload)%20%7B%0A%20%20%20%20%20%20%20%20if%20(concurrency%20%3D%3D%20null)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20concurrency%20%3D%201%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20if(concurrency%20%3D%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error('Concurrency%20must%20not%20be%20zero')%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20function%20_insert(q%2C%20data%2C%20pos%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(callback%20!%3D%20null%20%26%26%20typeof%20callback%20!%3D%3D%20%22function%22)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error(%22task%20callback%20must%20be%20a%20function%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20q.started%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!_isArray(data))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%20%3D%20%5Bdata%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if(data.length%20%3D%3D%3D%200%20%26%26%20q.idle())%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20call%20drain%20immediately%20if%20there%20are%20no%20tasks%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20async.setImmediate(function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.drain()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20_arrayEach(data%2C%20function(task)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20item%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%3A%20task%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback%3A%20callback%20%7C%7C%20noop%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(pos)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.tasks.unshift(item)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.tasks.push(item)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(q.tasks.length%20%3D%3D%3D%20q.concurrency)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.saturated()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20async.setImmediate(q.process)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20function%20_next(q%2C%20tasks)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20function()%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20workers%20-%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20arguments%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_arrayEach(tasks%2C%20function%20(task)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20task.callback.apply(task%2C%20args)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(q.tasks.length%20%2B%20workers%20%3D%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.drain()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.process()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20var%20workers%20%3D%200%3B%0A%20%20%20%20%20%20%20%20var%20q%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20tasks%3A%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20concurrency%3A%20concurrency%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20payload%3A%20payload%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20saturated%3A%20noop%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20empty%3A%20noop%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20drain%3A%20noop%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20started%3A%20false%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20paused%3A%20false%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20push%3A%20function%20(data%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_insert(q%2C%20data%2C%20false%2C%20callback)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20kill%3A%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.drain%20%3D%20noop%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.tasks%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20unshift%3A%20function%20(data%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_insert(q%2C%20data%2C%20true%2C%20callback)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20process%3A%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!q.paused%20%26%26%20workers%20%3C%20q.concurrency%20%26%26%20q.tasks.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20while(workers%20%3C%20q.concurrency%20%26%26%20q.tasks.length)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20tasks%20%3D%20q.payload%20%3F%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.tasks.splice(0%2C%20q.payload)%20%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.tasks.splice(0%2C%20q.tasks.length)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20data%20%3D%20_map(tasks%2C%20function%20(task)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20task.data%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(q.tasks.length%20%3D%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.empty()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20workers%20%2B%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20cb%20%3D%20only_once(_next(q%2C%20tasks))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20worker(data%2C%20cb)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20length%3A%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20q.tasks.length%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20running%3A%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20workers%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20idle%3A%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20q.tasks.length%20%2B%20workers%20%3D%3D%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20pause%3A%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.paused%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20resume%3A%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(q.paused%20%3D%3D%3D%20false)%20%7B%20return%3B%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.paused%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20resumeCount%20%3D%20Math.min(q.concurrency%2C%20q.tasks.length)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Need%20to%20call%20q.process%20once%20per%20concurrent%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20worker%20to%20preserve%20full%20concurrency%20after%20pause%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20(var%20w%20%3D%201%3B%20w%20%3C%3D%20resumeCount%3B%20w%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20async.setImmediate(q.process)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20return%20q%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20async.queue%20%3D%20function%20(worker%2C%20concurrency)%20%7B%0A%20%20%20%20%20%20%20%20var%20q%20%3D%20_queue(function%20(items%2C%20cb)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20worker(items%5B0%5D%2C%20cb)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20concurrency%2C%201)%3B%0A%0A%20%20%20%20%20%20%20%20return%20q%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.priorityQueue%20%3D%20function%20(worker%2C%20concurrency)%20%7B%0A%0A%20%20%20%20%20%20%20%20function%20_compareTasks(a%2C%20b)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20a.priority%20-%20b.priority%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20function%20_binarySearch(sequence%2C%20item%2C%20compare)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20beg%20%3D%20-1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20end%20%3D%20sequence.length%20-%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20while%20(beg%20%3C%20end)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20mid%20%3D%20beg%20%2B%20((end%20-%20beg%20%2B%201)%20%3E%3E%3E%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(compare(item%2C%20sequence%5Bmid%5D)%20%3E%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20beg%20%3D%20mid%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20end%20%3D%20mid%20-%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20beg%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20function%20_insert(q%2C%20data%2C%20priority%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(callback%20!%3D%20null%20%26%26%20typeof%20callback%20!%3D%3D%20%22function%22)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error(%22task%20callback%20must%20be%20a%20function%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20q.started%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!_isArray(data))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%20%3D%20%5Bdata%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if(data.length%20%3D%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20call%20drain%20immediately%20if%20there%20are%20no%20tasks%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20async.setImmediate(function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.drain()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20_arrayEach(data%2C%20function(task)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20item%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%3A%20task%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20priority%3A%20priority%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback%3A%20typeof%20callback%20%3D%3D%3D%20'function'%20%3F%20callback%20%3A%20noop%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.tasks.splice(_binarySearch(q.tasks%2C%20item%2C%20_compareTasks)%20%2B%201%2C%200%2C%20item)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(q.tasks.length%20%3D%3D%3D%20q.concurrency)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.saturated()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20async.setImmediate(q.process)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Start%20with%20a%20normal%20queue%0A%20%20%20%20%20%20%20%20var%20q%20%3D%20async.queue(worker%2C%20concurrency)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Override%20push%20to%20accept%20second%20parameter%20representing%20priority%0A%20%20%20%20%20%20%20%20q.push%20%3D%20function%20(data%2C%20priority%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_insert(q%2C%20data%2C%20priority%2C%20callback)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Remove%20unshift%20function%0A%20%20%20%20%20%20%20%20delete%20q.unshift%3B%0A%0A%20%20%20%20%20%20%20%20return%20q%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.cargo%20%3D%20function%20(worker%2C%20payload)%20%7B%0A%20%20%20%20%20%20%20%20return%20_queue(worker%2C%201%2C%20payload)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20function%20_console_fn(name)%20%7B%0A%20%20%20%20%20%20%20%20return%20_restParam(function%20(fn%2C%20args)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20fn.apply(null%2C%20args.concat(%5B_restParam(function%20(err%2C%20args)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(typeof%20console%20%3D%3D%3D%20'object')%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(console.error)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20if%20(console%5Bname%5D)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_arrayEach(args%2C%20function%20(x)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console%5Bname%5D(x)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%5D))%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%20%20%20%20async.log%20%3D%20_console_fn('log')%3B%0A%20%20%20%20async.dir%20%3D%20_console_fn('dir')%3B%0A%20%20%20%20%2F*async.info%20%3D%20_console_fn('info')%3B%0A%20%20%20%20async.warn%20%3D%20_console_fn('warn')%3B%0A%20%20%20%20async.error%20%3D%20_console_fn('error')%3B*%2F%0A%0A%20%20%20%20async.memoize%20%3D%20function%20(fn%2C%20hasher)%20%7B%0A%20%20%20%20%20%20%20%20var%20memo%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20var%20queues%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20hasher%20%3D%20hasher%20%7C%7C%20identity%3B%0A%20%20%20%20%20%20%20%20var%20memoized%20%3D%20_restParam(function%20memoized(args)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20callback%20%3D%20args.pop()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20key%20%3D%20hasher.apply(null%2C%20args)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(key%20in%20memo)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20async.nextTick(function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback.apply(null%2C%20memo%5Bkey%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20if%20(key%20in%20queues)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20queues%5Bkey%5D.push(callback)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20queues%5Bkey%5D%20%3D%20%5Bcallback%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fn.apply(null%2C%20args.concat(%5B_restParam(function%20(args)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20memo%5Bkey%5D%20%3D%20args%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20q%20%3D%20queues%5Bkey%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20delete%20queues%5Bkey%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%200%2C%20l%20%3D%20q.length%3B%20i%20%3C%20l%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q%5Bi%5D.apply(null%2C%20args)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%5D))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20memoized.memo%20%3D%20memo%3B%0A%20%20%20%20%20%20%20%20memoized.unmemoized%20%3D%20fn%3B%0A%20%20%20%20%20%20%20%20return%20memoized%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.unmemoize%20%3D%20function%20(fn)%20%7B%0A%20%20%20%20%20%20%20%20return%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20(fn.unmemoized%20%7C%7C%20fn).apply(null%2C%20arguments)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20function%20_times(mapper)%20%7B%0A%20%20%20%20%20%20%20%20return%20function%20(count%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20mapper(_range(count)%2C%20iterator%2C%20callback)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20async.times%20%3D%20_times(async.map)%3B%0A%20%20%20%20async.timesSeries%20%3D%20_times(async.mapSeries)%3B%0A%20%20%20%20async.timesLimit%20%3D%20function%20(count%2C%20limit%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20return%20async.mapLimit(_range(count)%2C%20limit%2C%20iterator%2C%20callback)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.seq%20%3D%20function%20(%2F*%20functions...%20*%2F)%20%7B%0A%20%20%20%20%20%20%20%20var%20fns%20%3D%20arguments%3B%0A%20%20%20%20%20%20%20%20return%20_restParam(function%20(args)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20that%20%3D%20this%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20callback%20%3D%20args%5Bargs.length%20-%201%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(typeof%20callback%20%3D%3D%20'function')%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20args.pop()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback%20%3D%20noop%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20async.reduce(fns%2C%20args%2C%20function%20(newargs%2C%20fn%2C%20cb)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fn.apply(that%2C%20newargs.concat(%5B_restParam(function%20(err%2C%20nextargs)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cb(err%2C%20nextargs)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%5D))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20function%20(err%2C%20results)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback.apply(that%2C%20%5Berr%5D.concat(results))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.compose%20%3D%20function%20(%2F*%20functions...%20*%2F)%20%7B%0A%20%20%20%20%20%20%20%20return%20async.seq.apply(null%2C%20Array.prototype.reverse.call(arguments))%3B%0A%20%20%20%20%7D%3B%0A%0A%0A%20%20%20%20function%20_applyEach(eachfn)%20%7B%0A%20%20%20%20%20%20%20%20return%20_restParam(function(fns%2C%20args)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20go%20%3D%20_restParam(function(args)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20that%20%3D%20this%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20callback%20%3D%20args.pop()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20eachfn(fns%2C%20function%20(fn%2C%20_%2C%20cb)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fn.apply(that%2C%20args.concat(%5Bcb%5D))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(args.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20go.apply(this%2C%20args)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20go%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20async.applyEach%20%3D%20_applyEach(async.eachOf)%3B%0A%20%20%20%20async.applyEachSeries%20%3D%20_applyEach(async.eachOfSeries)%3B%0A%0A%0A%20%20%20%20async.forever%20%3D%20function%20(fn%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20var%20done%20%3D%20only_once(callback%20%7C%7C%20noop)%3B%0A%20%20%20%20%20%20%20%20var%20task%20%3D%20ensureAsync(fn)%3B%0A%20%20%20%20%20%20%20%20function%20next(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20done(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20task(next)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20next()%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20function%20ensureAsync(fn)%20%7B%0A%20%20%20%20%20%20%20%20return%20_restParam(function%20(args)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20callback%20%3D%20args.pop()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20args.push(function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20innerArgs%20%3D%20arguments%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(sync)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20async.setImmediate(function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback.apply(null%2C%20innerArgs)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback.apply(null%2C%20innerArgs)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20sync%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20fn.apply(this%2C%20args)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20sync%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20async.ensureAsync%20%3D%20ensureAsync%3B%0A%0A%20%20%20%20async.constant%20%3D%20_restParam(function(values)%20%7B%0A%20%20%20%20%20%20%20%20var%20args%20%3D%20%5Bnull%5D.concat(values)%3B%0A%20%20%20%20%20%20%20%20return%20function%20(callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20callback.apply(this%2C%20args)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D)%3B%0A%0A%20%20%20%20async.wrapSync%20%3D%0A%20%20%20%20async.asyncify%20%3D%20function%20asyncify(func)%20%7B%0A%20%20%20%20%20%20%20%20return%20_restParam(function%20(args)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20callback%20%3D%20args.pop()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20result%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20result%20%3D%20func.apply(this%2C%20args)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20catch%20(e)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20callback(e)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20if%20result%20is%20Promise%20object%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(_isObject(result)%20%26%26%20typeof%20result.then%20%3D%3D%3D%20%22function%22)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20result.then(function(value)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(null%2C%20value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%5B%22catch%22%5D(function(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err.message%20%3F%20err%20%3A%20new%20Error(err))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(null%2C%20result)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20%2F%2F%20Node.js%0A%20%20%20%20if%20(typeof%20module%20%3D%3D%3D%20'object'%20%26%26%20module.exports)%20%7B%0A%20%20%20%20%20%20%20%20module.exports%20%3D%20async%3B%0A%20%20%20%20%7D%0A%20%20%20%20%2F%2F%20AMD%20%2F%20RequireJS%0A%20%20%20%20else%20if%20(typeof%20define%20%3D%3D%3D%20'function'%20%26%26%20define.amd)%20%7B%0A%20%20%20%20%20%20%20%20define(%5B%5D%2C%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20async%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%20%20%20%20%2F%2F%20included%20directly%20via%20%3Cscript%3E%20tag%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20root.async%20%3D%20async%3B%0A%20%20%20%20%7D%0A%0A%7D())%3B%0A%0A%7D).call(this%2Crequire('_process')%2Ctypeof%20global%20!%3D%3D%20%22undefined%22%20%3F%20global%20%3A%20typeof%20self%20!%3D%3D%20%22undefined%22%20%3F%20self%20%3A%20typeof%20window%20!%3D%3D%20%22undefined%22%20%3F%20window%20%3A%20%7B%7D)%0A%0A%7D%2C%7B%22_process%22%3A3%7D%5D%2C2%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A(function%20(process)%7B%0A%2F%2F%20Copyright%20Joyent%2C%20Inc.%20and%20other%20Node%20contributors.%0A%2F%2F%0A%2F%2F%20Permission%20is%20hereby%20granted%2C%20free%20of%20charge%2C%20to%20any%20person%20obtaining%20a%0A%2F%2F%20copy%20of%20this%20software%20and%20associated%20documentation%20files%20(the%0A%2F%2F%20%22Software%22)%2C%20to%20deal%20in%20the%20Software%20without%20restriction%2C%20including%0A%2F%2F%20without%20limitation%20the%20rights%20to%20use%2C%20copy%2C%20modify%2C%20merge%2C%20publish%2C%0A%2F%2F%20distribute%2C%20sublicense%2C%20and%2For%20sell%20copies%20of%20the%20Software%2C%20and%20to%20permit%0A%2F%2F%20persons%20to%20whom%20the%20Software%20is%20furnished%20to%20do%20so%2C%20subject%20to%20the%0A%2F%2F%20following%20conditions%3A%0A%2F%2F%0A%2F%2F%20The%20above%20copyright%20notice%20and%20this%20permission%20notice%20shall%20be%20included%0A%2F%2F%20in%20all%20copies%20or%20substantial%20portions%20of%20the%20Software.%0A%2F%2F%0A%2F%2F%20THE%20SOFTWARE%20IS%20PROVIDED%20%22AS%20IS%22%2C%20WITHOUT%20WARRANTY%20OF%20ANY%20KIND%2C%20EXPRESS%0A%2F%2F%20OR%20IMPLIED%2C%20INCLUDING%20BUT%20NOT%20LIMITED%20TO%20THE%20WARRANTIES%20OF%0A%2F%2F%20MERCHANTABILITY%2C%20FITNESS%20FOR%20A%20PARTICULAR%20PURPOSE%20AND%20NONINFRINGEMENT.%20IN%0A%2F%2F%20NO%20EVENT%20SHALL%20THE%20AUTHORS%20OR%20COPYRIGHT%20HOLDERS%20BE%20LIABLE%20FOR%20ANY%20CLAIM%2C%0A%2F%2F%20DAMAGES%20OR%20OTHER%20LIABILITY%2C%20WHETHER%20IN%20AN%20ACTION%20OF%20CONTRACT%2C%20TORT%20OR%0A%2F%2F%20OTHERWISE%2C%20ARISING%20FROM%2C%20OUT%20OF%20OR%20IN%20CONNECTION%20WITH%20THE%20SOFTWARE%20OR%20THE%0A%2F%2F%20USE%20OR%20OTHER%20DEALINGS%20IN%20THE%20SOFTWARE.%0A%0A%2F%2F%20resolves%20.%20and%20..%20elements%20in%20a%20path%20array%20with%20directory%20names%20there%0A%2F%2F%20must%20be%20no%20slashes%2C%20empty%20elements%2C%20or%20device%20names%20(c%3A%5C)%20in%20the%20array%0A%2F%2F%20(so%20also%20no%20leading%20and%20trailing%20slashes%20-%20it%20does%20not%20distinguish%0A%2F%2F%20relative%20and%20absolute%20paths)%0Afunction%20normalizeArray(parts%2C%20allowAboveRoot)%20%7B%0A%20%20%2F%2F%20if%20the%20path%20tries%20to%20go%20above%20the%20root%2C%20%60up%60%20ends%20up%20%3E%200%0A%20%20var%20up%20%3D%200%3B%0A%20%20for%20(var%20i%20%3D%20parts.length%20-%201%3B%20i%20%3E%3D%200%3B%20i--)%20%7B%0A%20%20%20%20var%20last%20%3D%20parts%5Bi%5D%3B%0A%20%20%20%20if%20(last%20%3D%3D%3D%20'.')%20%7B%0A%20%20%20%20%20%20parts.splice(i%2C%201)%3B%0A%20%20%20%20%7D%20else%20if%20(last%20%3D%3D%3D%20'..')%20%7B%0A%20%20%20%20%20%20parts.splice(i%2C%201)%3B%0A%20%20%20%20%20%20up%2B%2B%3B%0A%20%20%20%20%7D%20else%20if%20(up)%20%7B%0A%20%20%20%20%20%20parts.splice(i%2C%201)%3B%0A%20%20%20%20%20%20up--%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20if%20the%20path%20is%20allowed%20to%20go%20above%20the%20root%2C%20restore%20leading%20..s%0A%20%20if%20(allowAboveRoot)%20%7B%0A%20%20%20%20for%20(%3B%20up--%3B%20up)%20%7B%0A%20%20%20%20%20%20parts.unshift('..')%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20parts%3B%0A%7D%0A%0A%2F%2F%20Split%20a%20filename%20into%20%5Broot%2C%20dir%2C%20basename%2C%20ext%5D%2C%20unix%20version%0A%2F%2F%20'root'%20is%20just%20a%20slash%2C%20or%20nothing.%0Avar%20splitPathRe%20%3D%0A%20%20%20%20%2F%5E(%5C%2F%3F%7C)(%5B%5Cs%5CS%5D*%3F)((%3F%3A%5C.%7B1%2C2%7D%7C%5B%5E%5C%2F%5D%2B%3F%7C)(%5C.%5B%5E.%5C%2F%5D*%7C))(%3F%3A%5B%5C%2F%5D*)%24%2F%3B%0Avar%20splitPath%20%3D%20function(filename)%20%7B%0A%20%20return%20splitPathRe.exec(filename).slice(1)%3B%0A%7D%3B%0A%0A%2F%2F%20path.resolve(%5Bfrom%20...%5D%2C%20to)%0A%2F%2F%20posix%20version%0Aexports.resolve%20%3D%20function()%20%7B%0A%20%20var%20resolvedPath%20%3D%20''%2C%0A%20%20%20%20%20%20resolvedAbsolute%20%3D%20false%3B%0A%0A%20%20for%20(var%20i%20%3D%20arguments.length%20-%201%3B%20i%20%3E%3D%20-1%20%26%26%20!resolvedAbsolute%3B%20i--)%20%7B%0A%20%20%20%20var%20path%20%3D%20(i%20%3E%3D%200)%20%3F%20arguments%5Bi%5D%20%3A%20process.cwd()%3B%0A%0A%20%20%20%20%2F%2F%20Skip%20empty%20and%20invalid%20entries%0A%20%20%20%20if%20(typeof%20path%20!%3D%3D%20'string')%20%7B%0A%20%20%20%20%20%20throw%20new%20TypeError('Arguments%20to%20path.resolve%20must%20be%20strings')%3B%0A%20%20%20%20%7D%20else%20if%20(!path)%20%7B%0A%20%20%20%20%20%20continue%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20resolvedPath%20%3D%20path%20%2B%20'%2F'%20%2B%20resolvedPath%3B%0A%20%20%20%20resolvedAbsolute%20%3D%20path.charAt(0)%20%3D%3D%3D%20'%2F'%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20At%20this%20point%20the%20path%20should%20be%20resolved%20to%20a%20full%20absolute%20path%2C%20but%0A%20%20%2F%2F%20handle%20relative%20paths%20to%20be%20safe%20(might%20happen%20when%20process.cwd()%20fails)%0A%0A%20%20%2F%2F%20Normalize%20the%20path%0A%20%20resolvedPath%20%3D%20normalizeArray(filter(resolvedPath.split('%2F')%2C%20function(p)%20%7B%0A%20%20%20%20return%20!!p%3B%0A%20%20%7D)%2C%20!resolvedAbsolute).join('%2F')%3B%0A%0A%20%20return%20((resolvedAbsolute%20%3F%20'%2F'%20%3A%20'')%20%2B%20resolvedPath)%20%7C%7C%20'.'%3B%0A%7D%3B%0A%0A%2F%2F%20path.normalize(path)%0A%2F%2F%20posix%20version%0Aexports.normalize%20%3D%20function(path)%20%7B%0A%20%20var%20isAbsolute%20%3D%20exports.isAbsolute(path)%2C%0A%20%20%20%20%20%20trailingSlash%20%3D%20substr(path%2C%20-1)%20%3D%3D%3D%20'%2F'%3B%0A%0A%20%20%2F%2F%20Normalize%20the%20path%0A%20%20path%20%3D%20normalizeArray(filter(path.split('%2F')%2C%20function(p)%20%7B%0A%20%20%20%20return%20!!p%3B%0A%20%20%7D)%2C%20!isAbsolute).join('%2F')%3B%0A%0A%20%20if%20(!path%20%26%26%20!isAbsolute)%20%7B%0A%20%20%20%20path%20%3D%20'.'%3B%0A%20%20%7D%0A%20%20if%20(path%20%26%26%20trailingSlash)%20%7B%0A%20%20%20%20path%20%2B%3D%20'%2F'%3B%0A%20%20%7D%0A%0A%20%20return%20(isAbsolute%20%3F%20'%2F'%20%3A%20'')%20%2B%20path%3B%0A%7D%3B%0A%0A%2F%2F%20posix%20version%0Aexports.isAbsolute%20%3D%20function(path)%20%7B%0A%20%20return%20path.charAt(0)%20%3D%3D%3D%20'%2F'%3B%0A%7D%3B%0A%0A%2F%2F%20posix%20version%0Aexports.join%20%3D%20function()%20%7B%0A%20%20var%20paths%20%3D%20Array.prototype.slice.call(arguments%2C%200)%3B%0A%20%20return%20exports.normalize(filter(paths%2C%20function(p%2C%20index)%20%7B%0A%20%20%20%20if%20(typeof%20p%20!%3D%3D%20'string')%20%7B%0A%20%20%20%20%20%20throw%20new%20TypeError('Arguments%20to%20path.join%20must%20be%20strings')%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20p%3B%0A%20%20%7D).join('%2F'))%3B%0A%7D%3B%0A%0A%0A%2F%2F%20path.relative(from%2C%20to)%0A%2F%2F%20posix%20version%0Aexports.relative%20%3D%20function(from%2C%20to)%20%7B%0A%20%20from%20%3D%20exports.resolve(from).substr(1)%3B%0A%20%20to%20%3D%20exports.resolve(to).substr(1)%3B%0A%0A%20%20function%20trim(arr)%20%7B%0A%20%20%20%20var%20start%20%3D%200%3B%0A%20%20%20%20for%20(%3B%20start%20%3C%20arr.length%3B%20start%2B%2B)%20%7B%0A%20%20%20%20%20%20if%20(arr%5Bstart%5D%20!%3D%3D%20'')%20break%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20end%20%3D%20arr.length%20-%201%3B%0A%20%20%20%20for%20(%3B%20end%20%3E%3D%200%3B%20end--)%20%7B%0A%20%20%20%20%20%20if%20(arr%5Bend%5D%20!%3D%3D%20'')%20break%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(start%20%3E%20end)%20return%20%5B%5D%3B%0A%20%20%20%20return%20arr.slice(start%2C%20end%20-%20start%20%2B%201)%3B%0A%20%20%7D%0A%0A%20%20var%20fromParts%20%3D%20trim(from.split('%2F'))%3B%0A%20%20var%20toParts%20%3D%20trim(to.split('%2F'))%3B%0A%0A%20%20var%20length%20%3D%20Math.min(fromParts.length%2C%20toParts.length)%3B%0A%20%20var%20samePartsLength%20%3D%20length%3B%0A%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20length%3B%20i%2B%2B)%20%7B%0A%20%20%20%20if%20(fromParts%5Bi%5D%20!%3D%3D%20toParts%5Bi%5D)%20%7B%0A%20%20%20%20%20%20samePartsLength%20%3D%20i%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20var%20outputParts%20%3D%20%5B%5D%3B%0A%20%20for%20(var%20i%20%3D%20samePartsLength%3B%20i%20%3C%20fromParts.length%3B%20i%2B%2B)%20%7B%0A%20%20%20%20outputParts.push('..')%3B%0A%20%20%7D%0A%0A%20%20outputParts%20%3D%20outputParts.concat(toParts.slice(samePartsLength))%3B%0A%0A%20%20return%20outputParts.join('%2F')%3B%0A%7D%3B%0A%0Aexports.sep%20%3D%20'%2F'%3B%0Aexports.delimiter%20%3D%20'%3A'%3B%0A%0Aexports.dirname%20%3D%20function(path)%20%7B%0A%20%20var%20result%20%3D%20splitPath(path)%2C%0A%20%20%20%20%20%20root%20%3D%20result%5B0%5D%2C%0A%20%20%20%20%20%20dir%20%3D%20result%5B1%5D%3B%0A%0A%20%20if%20(!root%20%26%26%20!dir)%20%7B%0A%20%20%20%20%2F%2F%20No%20dirname%20whatsoever%0A%20%20%20%20return%20'.'%3B%0A%20%20%7D%0A%0A%20%20if%20(dir)%20%7B%0A%20%20%20%20%2F%2F%20It%20has%20a%20dirname%2C%20strip%20trailing%20slash%0A%20%20%20%20dir%20%3D%20dir.substr(0%2C%20dir.length%20-%201)%3B%0A%20%20%7D%0A%0A%20%20return%20root%20%2B%20dir%3B%0A%7D%3B%0A%0A%0Aexports.basename%20%3D%20function(path%2C%20ext)%20%7B%0A%20%20var%20f%20%3D%20splitPath(path)%5B2%5D%3B%0A%20%20%2F%2F%20TODO%3A%20make%20this%20comparison%20case-insensitive%20on%20windows%3F%0A%20%20if%20(ext%20%26%26%20f.substr(-1%20*%20ext.length)%20%3D%3D%3D%20ext)%20%7B%0A%20%20%20%20f%20%3D%20f.substr(0%2C%20f.length%20-%20ext.length)%3B%0A%20%20%7D%0A%20%20return%20f%3B%0A%7D%3B%0A%0A%0Aexports.extname%20%3D%20function(path)%20%7B%0A%20%20return%20splitPath(path)%5B3%5D%3B%0A%7D%3B%0A%0Afunction%20filter%20(xs%2C%20f)%20%7B%0A%20%20%20%20if%20(xs.filter)%20return%20xs.filter(f)%3B%0A%20%20%20%20var%20res%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20xs.length%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20if%20(f(xs%5Bi%5D%2C%20i%2C%20xs))%20res.push(xs%5Bi%5D)%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20res%3B%0A%7D%0A%0A%2F%2F%20String.prototype.substr%20-%20negative%20index%20don't%20work%20in%20IE8%0Avar%20substr%20%3D%20'ab'.substr(-1)%20%3D%3D%3D%20'b'%0A%20%20%20%20%3F%20function%20(str%2C%20start%2C%20len)%20%7B%20return%20str.substr(start%2C%20len)%20%7D%0A%20%20%20%20%3A%20function%20(str%2C%20start%2C%20len)%20%7B%0A%20%20%20%20%20%20%20%20if%20(start%20%3C%200)%20start%20%3D%20str.length%20%2B%20start%3B%0A%20%20%20%20%20%20%20%20return%20str.substr(start%2C%20len)%3B%0A%20%20%20%20%7D%0A%3B%0A%0A%7D).call(this%2Crequire('_process'))%0A%0A%7D%2C%7B%22_process%22%3A3%7D%5D%2C3%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F%2F%20shim%20for%20using%20process%20in%20browser%0A%0Avar%20process%20%3D%20module.exports%20%3D%20%7B%7D%3B%0Avar%20queue%20%3D%20%5B%5D%3B%0Avar%20draining%20%3D%20false%3B%0Avar%20currentQueue%3B%0Avar%20queueIndex%20%3D%20-1%3B%0A%0Afunction%20cleanUpNextTick()%20%7B%0A%20%20%20%20draining%20%3D%20false%3B%0A%20%20%20%20if%20(currentQueue.length)%20%7B%0A%20%20%20%20%20%20%20%20queue%20%3D%20currentQueue.concat(queue)%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20queueIndex%20%3D%20-1%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20(queue.length)%20%7B%0A%20%20%20%20%20%20%20%20drainQueue()%3B%0A%20%20%20%20%7D%0A%7D%0A%0Afunction%20drainQueue()%20%7B%0A%20%20%20%20if%20(draining)%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20var%20timeout%20%3D%20setTimeout(cleanUpNextTick)%3B%0A%20%20%20%20draining%20%3D%20true%3B%0A%0A%20%20%20%20var%20len%20%3D%20queue.length%3B%0A%20%20%20%20while(len)%20%7B%0A%20%20%20%20%20%20%20%20currentQueue%20%3D%20queue%3B%0A%20%20%20%20%20%20%20%20queue%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20while%20(%2B%2BqueueIndex%20%3C%20len)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(currentQueue)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20currentQueue%5BqueueIndex%5D.run()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20queueIndex%20%3D%20-1%3B%0A%20%20%20%20%20%20%20%20len%20%3D%20queue.length%3B%0A%20%20%20%20%7D%0A%20%20%20%20currentQueue%20%3D%20null%3B%0A%20%20%20%20draining%20%3D%20false%3B%0A%20%20%20%20clearTimeout(timeout)%3B%0A%7D%0A%0Aprocess.nextTick%20%3D%20function%20(fun)%20%7B%0A%20%20%20%20var%20args%20%3D%20new%20Array(arguments.length%20-%201)%3B%0A%20%20%20%20if%20(arguments.length%20%3E%201)%20%7B%0A%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%201%3B%20i%20%3C%20arguments.length%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20args%5Bi%20-%201%5D%20%3D%20arguments%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20queue.push(new%20Item(fun%2C%20args))%3B%0A%20%20%20%20if%20(queue.length%20%3D%3D%3D%201%20%26%26%20!draining)%20%7B%0A%20%20%20%20%20%20%20%20setTimeout(drainQueue%2C%200)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F%2F%20v8%20likes%20predictible%20objects%0Afunction%20Item(fun%2C%20array)%20%7B%0A%20%20%20%20this.fun%20%3D%20fun%3B%0A%20%20%20%20this.array%20%3D%20array%3B%0A%7D%0AItem.prototype.run%20%3D%20function%20()%20%7B%0A%20%20%20%20this.fun.apply(null%2C%20this.array)%3B%0A%7D%3B%0Aprocess.title%20%3D%20'browser'%3B%0Aprocess.browser%20%3D%20true%3B%0Aprocess.env%20%3D%20%7B%7D%3B%0Aprocess.argv%20%3D%20%5B%5D%3B%0Aprocess.version%20%3D%20''%3B%20%2F%2F%20empty%20string%20to%20avoid%20regexp%20issues%0Aprocess.versions%20%3D%20%7B%7D%3B%0A%0Afunction%20noop()%20%7B%7D%0A%0Aprocess.on%20%3D%20noop%3B%0Aprocess.addListener%20%3D%20noop%3B%0Aprocess.once%20%3D%20noop%3B%0Aprocess.off%20%3D%20noop%3B%0Aprocess.removeListener%20%3D%20noop%3B%0Aprocess.removeAllListeners%20%3D%20noop%3B%0Aprocess.emit%20%3D%20noop%3B%0A%0Aprocess.binding%20%3D%20function%20(name)%20%7B%0A%20%20%20%20throw%20new%20Error('process.binding%20is%20not%20supported')%3B%0A%7D%3B%0A%0Aprocess.cwd%20%3D%20function%20()%20%7B%20return%20'%2F'%20%7D%3B%0Aprocess.chdir%20%3D%20function%20(dir)%20%7B%0A%20%20%20%20throw%20new%20Error('process.chdir%20is%20not%20supported')%3B%0A%7D%3B%0Aprocess.umask%20%3D%20function()%20%7B%20return%200%3B%20%7D%3B%0A%0A%7D%2C%7B%7D%5D%2C4%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A(function%20(global)%7B%0A%2F*!%20https%3A%2F%2Fmths.be%2Fpunycode%20v1.3.2%20by%20%40mathias%20*%2F%0A%3B(function(root)%20%7B%0A%0A%09%2F**%20Detect%20free%20variables%20*%2F%0A%09var%20freeExports%20%3D%20typeof%20exports%20%3D%3D%20'object'%20%26%26%20exports%20%26%26%0A%09%09!exports.nodeType%20%26%26%20exports%3B%0A%09var%20freeModule%20%3D%20typeof%20module%20%3D%3D%20'object'%20%26%26%20module%20%26%26%0A%09%09!module.nodeType%20%26%26%20module%3B%0A%09var%20freeGlobal%20%3D%20typeof%20global%20%3D%3D%20'object'%20%26%26%20global%3B%0A%09if%20(%0A%09%09freeGlobal.global%20%3D%3D%3D%20freeGlobal%20%7C%7C%0A%09%09freeGlobal.window%20%3D%3D%3D%20freeGlobal%20%7C%7C%0A%09%09freeGlobal.self%20%3D%3D%3D%20freeGlobal%0A%09)%20%7B%0A%09%09root%20%3D%20freeGlobal%3B%0A%09%7D%0A%0A%09%2F**%0A%09%20*%20The%20%60punycode%60%20object.%0A%09%20*%20%40name%20punycode%0A%09%20*%20%40type%20Object%0A%09%20*%2F%0A%09var%20punycode%2C%0A%0A%09%2F**%20Highest%20positive%20signed%2032-bit%20float%20value%20*%2F%0A%09maxInt%20%3D%202147483647%2C%20%2F%2F%20aka.%200x7FFFFFFF%20or%202%5E31-1%0A%0A%09%2F**%20Bootstring%20parameters%20*%2F%0A%09base%20%3D%2036%2C%0A%09tMin%20%3D%201%2C%0A%09tMax%20%3D%2026%2C%0A%09skew%20%3D%2038%2C%0A%09damp%20%3D%20700%2C%0A%09initialBias%20%3D%2072%2C%0A%09initialN%20%3D%20128%2C%20%2F%2F%200x80%0A%09delimiter%20%3D%20'-'%2C%20%2F%2F%20'%5Cx2D'%0A%0A%09%2F**%20Regular%20expressions%20*%2F%0A%09regexPunycode%20%3D%20%2F%5Exn--%2F%2C%0A%09regexNonASCII%20%3D%20%2F%5B%5E%5Cx20-%5Cx7E%5D%2F%2C%20%2F%2F%20unprintable%20ASCII%20chars%20%2B%20non-ASCII%20chars%0A%09regexSeparators%20%3D%20%2F%5B%5Cx2E%5Cu3002%5CuFF0E%5CuFF61%5D%2Fg%2C%20%2F%2F%20RFC%203490%20separators%0A%0A%09%2F**%20Error%20messages%20*%2F%0A%09errors%20%3D%20%7B%0A%09%09'overflow'%3A%20'Overflow%3A%20input%20needs%20wider%20integers%20to%20process'%2C%0A%09%09'not-basic'%3A%20'Illegal%20input%20%3E%3D%200x80%20(not%20a%20basic%20code%20point)'%2C%0A%09%09'invalid-input'%3A%20'Invalid%20input'%0A%09%7D%2C%0A%0A%09%2F**%20Convenience%20shortcuts%20*%2F%0A%09baseMinusTMin%20%3D%20base%20-%20tMin%2C%0A%09floor%20%3D%20Math.floor%2C%0A%09stringFromCharCode%20%3D%20String.fromCharCode%2C%0A%0A%09%2F**%20Temporary%20variable%20*%2F%0A%09key%3B%0A%0A%09%2F*--------------------------------------------------------------------------*%2F%0A%0A%09%2F**%0A%09%20*%20A%20generic%20error%20utility%20function.%0A%09%20*%20%40private%0A%09%20*%20%40param%20%7BString%7D%20type%20The%20error%20type.%0A%09%20*%20%40returns%20%7BError%7D%20Throws%20a%20%60RangeError%60%20with%20the%20applicable%20error%20message.%0A%09%20*%2F%0A%09function%20error(type)%20%7B%0A%09%09throw%20RangeError(errors%5Btype%5D)%3B%0A%09%7D%0A%0A%09%2F**%0A%09%20*%20A%20generic%20%60Array%23map%60%20utility%20function.%0A%09%20*%20%40private%0A%09%20*%20%40param%20%7BArray%7D%20array%20The%20array%20to%20iterate%20over.%0A%09%20*%20%40param%20%7BFunction%7D%20callback%20The%20function%20that%20gets%20called%20for%20every%20array%0A%09%20*%20item.%0A%09%20*%20%40returns%20%7BArray%7D%20A%20new%20array%20of%20values%20returned%20by%20the%20callback%20function.%0A%09%20*%2F%0A%09function%20map(array%2C%20fn)%20%7B%0A%09%09var%20length%20%3D%20array.length%3B%0A%09%09var%20result%20%3D%20%5B%5D%3B%0A%09%09while%20(length--)%20%7B%0A%09%09%09result%5Blength%5D%20%3D%20fn(array%5Blength%5D)%3B%0A%09%09%7D%0A%09%09return%20result%3B%0A%09%7D%0A%0A%09%2F**%0A%09%20*%20A%20simple%20%60Array%23map%60-like%20wrapper%20to%20work%20with%20domain%20name%20strings%20or%20email%0A%09%20*%20addresses.%0A%09%20*%20%40private%0A%09%20*%20%40param%20%7BString%7D%20domain%20The%20domain%20name%20or%20email%20address.%0A%09%20*%20%40param%20%7BFunction%7D%20callback%20The%20function%20that%20gets%20called%20for%20every%0A%09%20*%20character.%0A%09%20*%20%40returns%20%7BArray%7D%20A%20new%20string%20of%20characters%20returned%20by%20the%20callback%0A%09%20*%20function.%0A%09%20*%2F%0A%09function%20mapDomain(string%2C%20fn)%20%7B%0A%09%09var%20parts%20%3D%20string.split('%40')%3B%0A%09%09var%20result%20%3D%20''%3B%0A%09%09if%20(parts.length%20%3E%201)%20%7B%0A%09%09%09%2F%2F%20In%20email%20addresses%2C%20only%20the%20domain%20name%20should%20be%20punycoded.%20Leave%0A%09%09%09%2F%2F%20the%20local%20part%20(i.e.%20everything%20up%20to%20%60%40%60)%20intact.%0A%09%09%09result%20%3D%20parts%5B0%5D%20%2B%20'%40'%3B%0A%09%09%09string%20%3D%20parts%5B1%5D%3B%0A%09%09%7D%0A%09%09%2F%2F%20Avoid%20%60split(regex)%60%20for%20IE8%20compatibility.%20See%20%2317.%0A%09%09string%20%3D%20string.replace(regexSeparators%2C%20'%5Cx2E')%3B%0A%09%09var%20labels%20%3D%20string.split('.')%3B%0A%09%09var%20encoded%20%3D%20map(labels%2C%20fn).join('.')%3B%0A%09%09return%20result%20%2B%20encoded%3B%0A%09%7D%0A%0A%09%2F**%0A%09%20*%20Creates%20an%20array%20containing%20the%20numeric%20code%20points%20of%20each%20Unicode%0A%09%20*%20character%20in%20the%20string.%20While%20JavaScript%20uses%20UCS-2%20internally%2C%0A%09%20*%20this%20function%20will%20convert%20a%20pair%20of%20surrogate%20halves%20(each%20of%20which%0A%09%20*%20UCS-2%20exposes%20as%20separate%20characters)%20into%20a%20single%20code%20point%2C%0A%09%20*%20matching%20UTF-16.%0A%09%20*%20%40see%20%60punycode.ucs2.encode%60%0A%09%20*%20%40see%20%3Chttps%3A%2F%2Fmathiasbynens.be%2Fnotes%2Fjavascript-encoding%3E%0A%09%20*%20%40memberOf%20punycode.ucs2%0A%09%20*%20%40name%20decode%0A%09%20*%20%40param%20%7BString%7D%20string%20The%20Unicode%20input%20string%20(UCS-2).%0A%09%20*%20%40returns%20%7BArray%7D%20The%20new%20array%20of%20code%20points.%0A%09%20*%2F%0A%09function%20ucs2decode(string)%20%7B%0A%09%09var%20output%20%3D%20%5B%5D%2C%0A%09%09%20%20%20%20counter%20%3D%200%2C%0A%09%09%20%20%20%20length%20%3D%20string.length%2C%0A%09%09%20%20%20%20value%2C%0A%09%09%20%20%20%20extra%3B%0A%09%09while%20(counter%20%3C%20length)%20%7B%0A%09%09%09value%20%3D%20string.charCodeAt(counter%2B%2B)%3B%0A%09%09%09if%20(value%20%3E%3D%200xD800%20%26%26%20value%20%3C%3D%200xDBFF%20%26%26%20counter%20%3C%20length)%20%7B%0A%09%09%09%09%2F%2F%20high%20surrogate%2C%20and%20there%20is%20a%20next%20character%0A%09%09%09%09extra%20%3D%20string.charCodeAt(counter%2B%2B)%3B%0A%09%09%09%09if%20((extra%20%26%200xFC00)%20%3D%3D%200xDC00)%20%7B%20%2F%2F%20low%20surrogate%0A%09%09%09%09%09output.push(((value%20%26%200x3FF)%20%3C%3C%2010)%20%2B%20(extra%20%26%200x3FF)%20%2B%200x10000)%3B%0A%09%09%09%09%7D%20else%20%7B%0A%09%09%09%09%09%2F%2F%20unmatched%20surrogate%3B%20only%20append%20this%20code%20unit%2C%20in%20case%20the%20next%0A%09%09%09%09%09%2F%2F%20code%20unit%20is%20the%20high%20surrogate%20of%20a%20surrogate%20pair%0A%09%09%09%09%09output.push(value)%3B%0A%09%09%09%09%09counter--%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%20else%20%7B%0A%09%09%09%09output.push(value)%3B%0A%09%09%09%7D%0A%09%09%7D%0A%09%09return%20output%3B%0A%09%7D%0A%0A%09%2F**%0A%09%20*%20Creates%20a%20string%20based%20on%20an%20array%20of%20numeric%20code%20points.%0A%09%20*%20%40see%20%60punycode.ucs2.decode%60%0A%09%20*%20%40memberOf%20punycode.ucs2%0A%09%20*%20%40name%20encode%0A%09%20*%20%40param%20%7BArray%7D%20codePoints%20The%20array%20of%20numeric%20code%20points.%0A%09%20*%20%40returns%20%7BString%7D%20The%20new%20Unicode%20string%20(UCS-2).%0A%09%20*%2F%0A%09function%20ucs2encode(array)%20%7B%0A%09%09return%20map(array%2C%20function(value)%20%7B%0A%09%09%09var%20output%20%3D%20''%3B%0A%09%09%09if%20(value%20%3E%200xFFFF)%20%7B%0A%09%09%09%09value%20-%3D%200x10000%3B%0A%09%09%09%09output%20%2B%3D%20stringFromCharCode(value%20%3E%3E%3E%2010%20%26%200x3FF%20%7C%200xD800)%3B%0A%09%09%09%09value%20%3D%200xDC00%20%7C%20value%20%26%200x3FF%3B%0A%09%09%09%7D%0A%09%09%09output%20%2B%3D%20stringFromCharCode(value)%3B%0A%09%09%09return%20output%3B%0A%09%09%7D).join('')%3B%0A%09%7D%0A%0A%09%2F**%0A%09%20*%20Converts%20a%20basic%20code%20point%20into%20a%20digit%2Finteger.%0A%09%20*%20%40see%20%60digitToBasic()%60%0A%09%20*%20%40private%0A%09%20*%20%40param%20%7BNumber%7D%20codePoint%20The%20basic%20numeric%20code%20point%20value.%0A%09%20*%20%40returns%20%7BNumber%7D%20The%20numeric%20value%20of%20a%20basic%20code%20point%20(for%20use%20in%0A%09%20*%20representing%20integers)%20in%20the%20range%20%600%60%20to%20%60base%20-%201%60%2C%20or%20%60base%60%20if%0A%09%20*%20the%20code%20point%20does%20not%20represent%20a%20value.%0A%09%20*%2F%0A%09function%20basicToDigit(codePoint)%20%7B%0A%09%09if%20(codePoint%20-%2048%20%3C%2010)%20%7B%0A%09%09%09return%20codePoint%20-%2022%3B%0A%09%09%7D%0A%09%09if%20(codePoint%20-%2065%20%3C%2026)%20%7B%0A%09%09%09return%20codePoint%20-%2065%3B%0A%09%09%7D%0A%09%09if%20(codePoint%20-%2097%20%3C%2026)%20%7B%0A%09%09%09return%20codePoint%20-%2097%3B%0A%09%09%7D%0A%09%09return%20base%3B%0A%09%7D%0A%0A%09%2F**%0A%09%20*%20Converts%20a%20digit%2Finteger%20into%20a%20basic%20code%20point.%0A%09%20*%20%40see%20%60basicToDigit()%60%0A%09%20*%20%40private%0A%09%20*%20%40param%20%7BNumber%7D%20digit%20The%20numeric%20value%20of%20a%20basic%20code%20point.%0A%09%20*%20%40returns%20%7BNumber%7D%20The%20basic%20code%20point%20whose%20value%20(when%20used%20for%0A%09%20*%20representing%20integers)%20is%20%60digit%60%2C%20which%20needs%20to%20be%20in%20the%20range%0A%09%20*%20%600%60%20to%20%60base%20-%201%60.%20If%20%60flag%60%20is%20non-zero%2C%20the%20uppercase%20form%20is%0A%09%20*%20used%3B%20else%2C%20the%20lowercase%20form%20is%20used.%20The%20behavior%20is%20undefined%0A%09%20*%20if%20%60flag%60%20is%20non-zero%20and%20%60digit%60%20has%20no%20uppercase%20form.%0A%09%20*%2F%0A%09function%20digitToBasic(digit%2C%20flag)%20%7B%0A%09%09%2F%2F%20%200..25%20map%20to%20ASCII%20a..z%20or%20A..Z%0A%09%09%2F%2F%2026..35%20map%20to%20ASCII%200..9%0A%09%09return%20digit%20%2B%2022%20%2B%2075%20*%20(digit%20%3C%2026)%20-%20((flag%20!%3D%200)%20%3C%3C%205)%3B%0A%09%7D%0A%0A%09%2F**%0A%09%20*%20Bias%20adaptation%20function%20as%20per%20section%203.4%20of%20RFC%203492.%0A%09%20*%20http%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc3492%23section-3.4%0A%09%20*%20%40private%0A%09%20*%2F%0A%09function%20adapt(delta%2C%20numPoints%2C%20firstTime)%20%7B%0A%09%09var%20k%20%3D%200%3B%0A%09%09delta%20%3D%20firstTime%20%3F%20floor(delta%20%2F%20damp)%20%3A%20delta%20%3E%3E%201%3B%0A%09%09delta%20%2B%3D%20floor(delta%20%2F%20numPoints)%3B%0A%09%09for%20(%2F*%20no%20initialization%20*%2F%3B%20delta%20%3E%20baseMinusTMin%20*%20tMax%20%3E%3E%201%3B%20k%20%2B%3D%20base)%20%7B%0A%09%09%09delta%20%3D%20floor(delta%20%2F%20baseMinusTMin)%3B%0A%09%09%7D%0A%09%09return%20floor(k%20%2B%20(baseMinusTMin%20%2B%201)%20*%20delta%20%2F%20(delta%20%2B%20skew))%3B%0A%09%7D%0A%0A%09%2F**%0A%09%20*%20Converts%20a%20Punycode%20string%20of%20ASCII-only%20symbols%20to%20a%20string%20of%20Unicode%0A%09%20*%20symbols.%0A%09%20*%20%40memberOf%20punycode%0A%09%20*%20%40param%20%7BString%7D%20input%20The%20Punycode%20string%20of%20ASCII-only%20symbols.%0A%09%20*%20%40returns%20%7BString%7D%20The%20resulting%20string%20of%20Unicode%20symbols.%0A%09%20*%2F%0A%09function%20decode(input)%20%7B%0A%09%09%2F%2F%20Don't%20use%20UCS-2%0A%09%09var%20output%20%3D%20%5B%5D%2C%0A%09%09%20%20%20%20inputLength%20%3D%20input.length%2C%0A%09%09%20%20%20%20out%2C%0A%09%09%20%20%20%20i%20%3D%200%2C%0A%09%09%20%20%20%20n%20%3D%20initialN%2C%0A%09%09%20%20%20%20bias%20%3D%20initialBias%2C%0A%09%09%20%20%20%20basic%2C%0A%09%09%20%20%20%20j%2C%0A%09%09%20%20%20%20index%2C%0A%09%09%20%20%20%20oldi%2C%0A%09%09%20%20%20%20w%2C%0A%09%09%20%20%20%20k%2C%0A%09%09%20%20%20%20digit%2C%0A%09%09%20%20%20%20t%2C%0A%09%09%20%20%20%20%2F**%20Cached%20calculation%20results%20*%2F%0A%09%09%20%20%20%20baseMinusT%3B%0A%0A%09%09%2F%2F%20Handle%20the%20basic%20code%20points%3A%20let%20%60basic%60%20be%20the%20number%20of%20input%20code%0A%09%09%2F%2F%20points%20before%20the%20last%20delimiter%2C%20or%20%600%60%20if%20there%20is%20none%2C%20then%20copy%0A%09%09%2F%2F%20the%20first%20basic%20code%20points%20to%20the%20output.%0A%0A%09%09basic%20%3D%20input.lastIndexOf(delimiter)%3B%0A%09%09if%20(basic%20%3C%200)%20%7B%0A%09%09%09basic%20%3D%200%3B%0A%09%09%7D%0A%0A%09%09for%20(j%20%3D%200%3B%20j%20%3C%20basic%3B%20%2B%2Bj)%20%7B%0A%09%09%09%2F%2F%20if%20it's%20not%20a%20basic%20code%20point%0A%09%09%09if%20(input.charCodeAt(j)%20%3E%3D%200x80)%20%7B%0A%09%09%09%09error('not-basic')%3B%0A%09%09%09%7D%0A%09%09%09output.push(input.charCodeAt(j))%3B%0A%09%09%7D%0A%0A%09%09%2F%2F%20Main%20decoding%20loop%3A%20start%20just%20after%20the%20last%20delimiter%20if%20any%20basic%20code%0A%09%09%2F%2F%20points%20were%20copied%3B%20start%20at%20the%20beginning%20otherwise.%0A%0A%09%09for%20(index%20%3D%20basic%20%3E%200%20%3F%20basic%20%2B%201%20%3A%200%3B%20index%20%3C%20inputLength%3B%20%2F*%20no%20final%20expression%20*%2F)%20%7B%0A%0A%09%09%09%2F%2F%20%60index%60%20is%20the%20index%20of%20the%20next%20character%20to%20be%20consumed.%0A%09%09%09%2F%2F%20Decode%20a%20generalized%20variable-length%20integer%20into%20%60delta%60%2C%0A%09%09%09%2F%2F%20which%20gets%20added%20to%20%60i%60.%20The%20overflow%20checking%20is%20easier%0A%09%09%09%2F%2F%20if%20we%20increase%20%60i%60%20as%20we%20go%2C%20then%20subtract%20off%20its%20starting%0A%09%09%09%2F%2F%20value%20at%20the%20end%20to%20obtain%20%60delta%60.%0A%09%09%09for%20(oldi%20%3D%20i%2C%20w%20%3D%201%2C%20k%20%3D%20base%3B%20%2F*%20no%20condition%20*%2F%3B%20k%20%2B%3D%20base)%20%7B%0A%0A%09%09%09%09if%20(index%20%3E%3D%20inputLength)%20%7B%0A%09%09%09%09%09error('invalid-input')%3B%0A%09%09%09%09%7D%0A%0A%09%09%09%09digit%20%3D%20basicToDigit(input.charCodeAt(index%2B%2B))%3B%0A%0A%09%09%09%09if%20(digit%20%3E%3D%20base%20%7C%7C%20digit%20%3E%20floor((maxInt%20-%20i)%20%2F%20w))%20%7B%0A%09%09%09%09%09error('overflow')%3B%0A%09%09%09%09%7D%0A%0A%09%09%09%09i%20%2B%3D%20digit%20*%20w%3B%0A%09%09%09%09t%20%3D%20k%20%3C%3D%20bias%20%3F%20tMin%20%3A%20(k%20%3E%3D%20bias%20%2B%20tMax%20%3F%20tMax%20%3A%20k%20-%20bias)%3B%0A%0A%09%09%09%09if%20(digit%20%3C%20t)%20%7B%0A%09%09%09%09%09break%3B%0A%09%09%09%09%7D%0A%0A%09%09%09%09baseMinusT%20%3D%20base%20-%20t%3B%0A%09%09%09%09if%20(w%20%3E%20floor(maxInt%20%2F%20baseMinusT))%20%7B%0A%09%09%09%09%09error('overflow')%3B%0A%09%09%09%09%7D%0A%0A%09%09%09%09w%20*%3D%20baseMinusT%3B%0A%0A%09%09%09%7D%0A%0A%09%09%09out%20%3D%20output.length%20%2B%201%3B%0A%09%09%09bias%20%3D%20adapt(i%20-%20oldi%2C%20out%2C%20oldi%20%3D%3D%200)%3B%0A%0A%09%09%09%2F%2F%20%60i%60%20was%20supposed%20to%20wrap%20around%20from%20%60out%60%20to%20%600%60%2C%0A%09%09%09%2F%2F%20incrementing%20%60n%60%20each%20time%2C%20so%20we'll%20fix%20that%20now%3A%0A%09%09%09if%20(floor(i%20%2F%20out)%20%3E%20maxInt%20-%20n)%20%7B%0A%09%09%09%09error('overflow')%3B%0A%09%09%09%7D%0A%0A%09%09%09n%20%2B%3D%20floor(i%20%2F%20out)%3B%0A%09%09%09i%20%25%3D%20out%3B%0A%0A%09%09%09%2F%2F%20Insert%20%60n%60%20at%20position%20%60i%60%20of%20the%20output%0A%09%09%09output.splice(i%2B%2B%2C%200%2C%20n)%3B%0A%0A%09%09%7D%0A%0A%09%09return%20ucs2encode(output)%3B%0A%09%7D%0A%0A%09%2F**%0A%09%20*%20Converts%20a%20string%20of%20Unicode%20symbols%20(e.g.%20a%20domain%20name%20label)%20to%20a%0A%09%20*%20Punycode%20string%20of%20ASCII-only%20symbols.%0A%09%20*%20%40memberOf%20punycode%0A%09%20*%20%40param%20%7BString%7D%20input%20The%20string%20of%20Unicode%20symbols.%0A%09%20*%20%40returns%20%7BString%7D%20The%20resulting%20Punycode%20string%20of%20ASCII-only%20symbols.%0A%09%20*%2F%0A%09function%20encode(input)%20%7B%0A%09%09var%20n%2C%0A%09%09%20%20%20%20delta%2C%0A%09%09%20%20%20%20handledCPCount%2C%0A%09%09%20%20%20%20basicLength%2C%0A%09%09%20%20%20%20bias%2C%0A%09%09%20%20%20%20j%2C%0A%09%09%20%20%20%20m%2C%0A%09%09%20%20%20%20q%2C%0A%09%09%20%20%20%20k%2C%0A%09%09%20%20%20%20t%2C%0A%09%09%20%20%20%20currentValue%2C%0A%09%09%20%20%20%20output%20%3D%20%5B%5D%2C%0A%09%09%20%20%20%20%2F**%20%60inputLength%60%20will%20hold%20the%20number%20of%20code%20points%20in%20%60input%60.%20*%2F%0A%09%09%20%20%20%20inputLength%2C%0A%09%09%20%20%20%20%2F**%20Cached%20calculation%20results%20*%2F%0A%09%09%20%20%20%20handledCPCountPlusOne%2C%0A%09%09%20%20%20%20baseMinusT%2C%0A%09%09%20%20%20%20qMinusT%3B%0A%0A%09%09%2F%2F%20Convert%20the%20input%20in%20UCS-2%20to%20Unicode%0A%09%09input%20%3D%20ucs2decode(input)%3B%0A%0A%09%09%2F%2F%20Cache%20the%20length%0A%09%09inputLength%20%3D%20input.length%3B%0A%0A%09%09%2F%2F%20Initialize%20the%20state%0A%09%09n%20%3D%20initialN%3B%0A%09%09delta%20%3D%200%3B%0A%09%09bias%20%3D%20initialBias%3B%0A%0A%09%09%2F%2F%20Handle%20the%20basic%20code%20points%0A%09%09for%20(j%20%3D%200%3B%20j%20%3C%20inputLength%3B%20%2B%2Bj)%20%7B%0A%09%09%09currentValue%20%3D%20input%5Bj%5D%3B%0A%09%09%09if%20(currentValue%20%3C%200x80)%20%7B%0A%09%09%09%09output.push(stringFromCharCode(currentValue))%3B%0A%09%09%09%7D%0A%09%09%7D%0A%0A%09%09handledCPCount%20%3D%20basicLength%20%3D%20output.length%3B%0A%0A%09%09%2F%2F%20%60handledCPCount%60%20is%20the%20number%20of%20code%20points%20that%20have%20been%20handled%3B%0A%09%09%2F%2F%20%60basicLength%60%20is%20the%20number%20of%20basic%20code%20points.%0A%0A%09%09%2F%2F%20Finish%20the%20basic%20string%20-%20if%20it%20is%20not%20empty%20-%20with%20a%20delimiter%0A%09%09if%20(basicLength)%20%7B%0A%09%09%09output.push(delimiter)%3B%0A%09%09%7D%0A%0A%09%09%2F%2F%20Main%20encoding%20loop%3A%0A%09%09while%20(handledCPCount%20%3C%20inputLength)%20%7B%0A%0A%09%09%09%2F%2F%20All%20non-basic%20code%20points%20%3C%20n%20have%20been%20handled%20already.%20Find%20the%20next%0A%09%09%09%2F%2F%20larger%20one%3A%0A%09%09%09for%20(m%20%3D%20maxInt%2C%20j%20%3D%200%3B%20j%20%3C%20inputLength%3B%20%2B%2Bj)%20%7B%0A%09%09%09%09currentValue%20%3D%20input%5Bj%5D%3B%0A%09%09%09%09if%20(currentValue%20%3E%3D%20n%20%26%26%20currentValue%20%3C%20m)%20%7B%0A%09%09%09%09%09m%20%3D%20currentValue%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%0A%0A%09%09%09%2F%2F%20Increase%20%60delta%60%20enough%20to%20advance%20the%20decoder's%20%3Cn%2Ci%3E%20state%20to%20%3Cm%2C0%3E%2C%0A%09%09%09%2F%2F%20but%20guard%20against%20overflow%0A%09%09%09handledCPCountPlusOne%20%3D%20handledCPCount%20%2B%201%3B%0A%09%09%09if%20(m%20-%20n%20%3E%20floor((maxInt%20-%20delta)%20%2F%20handledCPCountPlusOne))%20%7B%0A%09%09%09%09error('overflow')%3B%0A%09%09%09%7D%0A%0A%09%09%09delta%20%2B%3D%20(m%20-%20n)%20*%20handledCPCountPlusOne%3B%0A%09%09%09n%20%3D%20m%3B%0A%0A%09%09%09for%20(j%20%3D%200%3B%20j%20%3C%20inputLength%3B%20%2B%2Bj)%20%7B%0A%09%09%09%09currentValue%20%3D%20input%5Bj%5D%3B%0A%0A%09%09%09%09if%20(currentValue%20%3C%20n%20%26%26%20%2B%2Bdelta%20%3E%20maxInt)%20%7B%0A%09%09%09%09%09error('overflow')%3B%0A%09%09%09%09%7D%0A%0A%09%09%09%09if%20(currentValue%20%3D%3D%20n)%20%7B%0A%09%09%09%09%09%2F%2F%20Represent%20delta%20as%20a%20generalized%20variable-length%20integer%0A%09%09%09%09%09for%20(q%20%3D%20delta%2C%20k%20%3D%20base%3B%20%2F*%20no%20condition%20*%2F%3B%20k%20%2B%3D%20base)%20%7B%0A%09%09%09%09%09%09t%20%3D%20k%20%3C%3D%20bias%20%3F%20tMin%20%3A%20(k%20%3E%3D%20bias%20%2B%20tMax%20%3F%20tMax%20%3A%20k%20-%20bias)%3B%0A%09%09%09%09%09%09if%20(q%20%3C%20t)%20%7B%0A%09%09%09%09%09%09%09break%3B%0A%09%09%09%09%09%09%7D%0A%09%09%09%09%09%09qMinusT%20%3D%20q%20-%20t%3B%0A%09%09%09%09%09%09baseMinusT%20%3D%20base%20-%20t%3B%0A%09%09%09%09%09%09output.push(%0A%09%09%09%09%09%09%09stringFromCharCode(digitToBasic(t%20%2B%20qMinusT%20%25%20baseMinusT%2C%200))%0A%09%09%09%09%09%09)%3B%0A%09%09%09%09%09%09q%20%3D%20floor(qMinusT%20%2F%20baseMinusT)%3B%0A%09%09%09%09%09%7D%0A%0A%09%09%09%09%09output.push(stringFromCharCode(digitToBasic(q%2C%200)))%3B%0A%09%09%09%09%09bias%20%3D%20adapt(delta%2C%20handledCPCountPlusOne%2C%20handledCPCount%20%3D%3D%20basicLength)%3B%0A%09%09%09%09%09delta%20%3D%200%3B%0A%09%09%09%09%09%2B%2BhandledCPCount%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%0A%0A%09%09%09%2B%2Bdelta%3B%0A%09%09%09%2B%2Bn%3B%0A%0A%09%09%7D%0A%09%09return%20output.join('')%3B%0A%09%7D%0A%0A%09%2F**%0A%09%20*%20Converts%20a%20Punycode%20string%20representing%20a%20domain%20name%20or%20an%20email%20address%0A%09%20*%20to%20Unicode.%20Only%20the%20Punycoded%20parts%20of%20the%20input%20will%20be%20converted%2C%20i.e.%0A%09%20*%20it%20doesn't%20matter%20if%20you%20call%20it%20on%20a%20string%20that%20has%20already%20been%0A%09%20*%20converted%20to%20Unicode.%0A%09%20*%20%40memberOf%20punycode%0A%09%20*%20%40param%20%7BString%7D%20input%20The%20Punycoded%20domain%20name%20or%20email%20address%20to%0A%09%20*%20convert%20to%20Unicode.%0A%09%20*%20%40returns%20%7BString%7D%20The%20Unicode%20representation%20of%20the%20given%20Punycode%0A%09%20*%20string.%0A%09%20*%2F%0A%09function%20toUnicode(input)%20%7B%0A%09%09return%20mapDomain(input%2C%20function(string)%20%7B%0A%09%09%09return%20regexPunycode.test(string)%0A%09%09%09%09%3F%20decode(string.slice(4).toLowerCase())%0A%09%09%09%09%3A%20string%3B%0A%09%09%7D)%3B%0A%09%7D%0A%0A%09%2F**%0A%09%20*%20Converts%20a%20Unicode%20string%20representing%20a%20domain%20name%20or%20an%20email%20address%20to%0A%09%20*%20Punycode.%20Only%20the%20non-ASCII%20parts%20of%20the%20domain%20name%20will%20be%20converted%2C%0A%09%20*%20i.e.%20it%20doesn't%20matter%20if%20you%20call%20it%20with%20a%20domain%20that's%20already%20in%0A%09%20*%20ASCII.%0A%09%20*%20%40memberOf%20punycode%0A%09%20*%20%40param%20%7BString%7D%20input%20The%20domain%20name%20or%20email%20address%20to%20convert%2C%20as%20a%0A%09%20*%20Unicode%20string.%0A%09%20*%20%40returns%20%7BString%7D%20The%20Punycode%20representation%20of%20the%20given%20domain%20name%20or%0A%09%20*%20email%20address.%0A%09%20*%2F%0A%09function%20toASCII(input)%20%7B%0A%09%09return%20mapDomain(input%2C%20function(string)%20%7B%0A%09%09%09return%20regexNonASCII.test(string)%0A%09%09%09%09%3F%20'xn--'%20%2B%20encode(string)%0A%09%09%09%09%3A%20string%3B%0A%09%09%7D)%3B%0A%09%7D%0A%0A%09%2F*--------------------------------------------------------------------------*%2F%0A%0A%09%2F**%20Define%20the%20public%20API%20*%2F%0A%09punycode%20%3D%20%7B%0A%09%09%2F**%0A%09%09%20*%20A%20string%20representing%20the%20current%20Punycode.js%20version%20number.%0A%09%09%20*%20%40memberOf%20punycode%0A%09%09%20*%20%40type%20String%0A%09%09%20*%2F%0A%09%09'version'%3A%20'1.3.2'%2C%0A%09%09%2F**%0A%09%09%20*%20An%20object%20of%20methods%20to%20convert%20from%20JavaScript's%20internal%20character%0A%09%09%20*%20representation%20(UCS-2)%20to%20Unicode%20code%20points%2C%20and%20back.%0A%09%09%20*%20%40see%20%3Chttps%3A%2F%2Fmathiasbynens.be%2Fnotes%2Fjavascript-encoding%3E%0A%09%09%20*%20%40memberOf%20punycode%0A%09%09%20*%20%40type%20Object%0A%09%09%20*%2F%0A%09%09'ucs2'%3A%20%7B%0A%09%09%09'decode'%3A%20ucs2decode%2C%0A%09%09%09'encode'%3A%20ucs2encode%0A%09%09%7D%2C%0A%09%09'decode'%3A%20decode%2C%0A%09%09'encode'%3A%20encode%2C%0A%09%09'toASCII'%3A%20toASCII%2C%0A%09%09'toUnicode'%3A%20toUnicode%0A%09%7D%3B%0A%0A%09%2F**%20Expose%20%60punycode%60%20*%2F%0A%09%2F%2F%20Some%20AMD%20build%20optimizers%2C%20like%20r.js%2C%20check%20for%20specific%20condition%20patterns%0A%09%2F%2F%20like%20the%20following%3A%0A%09if%20(%0A%09%09typeof%20define%20%3D%3D%20'function'%20%26%26%0A%09%09typeof%20define.amd%20%3D%3D%20'object'%20%26%26%0A%09%09define.amd%0A%09)%20%7B%0A%09%09define('punycode'%2C%20function()%20%7B%0A%09%09%09return%20punycode%3B%0A%09%09%7D)%3B%0A%09%7D%20else%20if%20(freeExports%20%26%26%20freeModule)%20%7B%0A%09%09if%20(module.exports%20%3D%3D%20freeExports)%20%7B%20%2F%2F%20in%20Node.js%20or%20RingoJS%20v0.8.0%2B%0A%09%09%09freeModule.exports%20%3D%20punycode%3B%0A%09%09%7D%20else%20%7B%20%2F%2F%20in%20Narwhal%20or%20RingoJS%20v0.7.0-%0A%09%09%09for%20(key%20in%20punycode)%20%7B%0A%09%09%09%09punycode.hasOwnProperty(key)%20%26%26%20(freeExports%5Bkey%5D%20%3D%20punycode%5Bkey%5D)%3B%0A%09%09%09%7D%0A%09%09%7D%0A%09%7D%20else%20%7B%20%2F%2F%20in%20Rhino%20or%20a%20web%20browser%0A%09%09root.punycode%20%3D%20punycode%3B%0A%09%7D%0A%0A%7D(this))%3B%0A%0A%7D).call(this%2Ctypeof%20global%20!%3D%3D%20%22undefined%22%20%3F%20global%20%3A%20typeof%20self%20!%3D%3D%20%22undefined%22%20%3F%20self%20%3A%20typeof%20window%20!%3D%3D%20%22undefined%22%20%3F%20window%20%3A%20%7B%7D)%0A%0A%7D%2C%7B%7D%5D%2C5%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F%2F%20Copyright%20Joyent%2C%20Inc.%20and%20other%20Node%20contributors.%0A%2F%2F%0A%2F%2F%20Permission%20is%20hereby%20granted%2C%20free%20of%20charge%2C%20to%20any%20person%20obtaining%20a%0A%2F%2F%20copy%20of%20this%20software%20and%20associated%20documentation%20files%20(the%0A%2F%2F%20%22Software%22)%2C%20to%20deal%20in%20the%20Software%20without%20restriction%2C%20including%0A%2F%2F%20without%20limitation%20the%20rights%20to%20use%2C%20copy%2C%20modify%2C%20merge%2C%20publish%2C%0A%2F%2F%20distribute%2C%20sublicense%2C%20and%2For%20sell%20copies%20of%20the%20Software%2C%20and%20to%20permit%0A%2F%2F%20persons%20to%20whom%20the%20Software%20is%20furnished%20to%20do%20so%2C%20subject%20to%20the%0A%2F%2F%20following%20conditions%3A%0A%2F%2F%0A%2F%2F%20The%20above%20copyright%20notice%20and%20this%20permission%20notice%20shall%20be%20included%0A%2F%2F%20in%20all%20copies%20or%20substantial%20portions%20of%20the%20Software.%0A%2F%2F%0A%2F%2F%20THE%20SOFTWARE%20IS%20PROVIDED%20%22AS%20IS%22%2C%20WITHOUT%20WARRANTY%20OF%20ANY%20KIND%2C%20EXPRESS%0A%2F%2F%20OR%20IMPLIED%2C%20INCLUDING%20BUT%20NOT%20LIMITED%20TO%20THE%20WARRANTIES%20OF%0A%2F%2F%20MERCHANTABILITY%2C%20FITNESS%20FOR%20A%20PARTICULAR%20PURPOSE%20AND%20NONINFRINGEMENT.%20IN%0A%2F%2F%20NO%20EVENT%20SHALL%20THE%20AUTHORS%20OR%20COPYRIGHT%20HOLDERS%20BE%20LIABLE%20FOR%20ANY%20CLAIM%2C%0A%2F%2F%20DAMAGES%20OR%20OTHER%20LIABILITY%2C%20WHETHER%20IN%20AN%20ACTION%20OF%20CONTRACT%2C%20TORT%20OR%0A%2F%2F%20OTHERWISE%2C%20ARISING%20FROM%2C%20OUT%20OF%20OR%20IN%20CONNECTION%20WITH%20THE%20SOFTWARE%20OR%20THE%0A%2F%2F%20USE%20OR%20OTHER%20DEALINGS%20IN%20THE%20SOFTWARE.%0A%0A'use%20strict'%3B%0A%0A%2F%2F%20If%20obj.hasOwnProperty%20has%20been%20overridden%2C%20then%20calling%0A%2F%2F%20obj.hasOwnProperty(prop)%20will%20break.%0A%2F%2F%20See%3A%20https%3A%2F%2Fgithub.com%2Fjoyent%2Fnode%2Fissues%2F1707%0Afunction%20hasOwnProperty(obj%2C%20prop)%20%7B%0A%20%20return%20Object.prototype.hasOwnProperty.call(obj%2C%20prop)%3B%0A%7D%0A%0Amodule.exports%20%3D%20function(qs%2C%20sep%2C%20eq%2C%20options)%20%7B%0A%20%20sep%20%3D%20sep%20%7C%7C%20'%26'%3B%0A%20%20eq%20%3D%20eq%20%7C%7C%20'%3D'%3B%0A%20%20var%20obj%20%3D%20%7B%7D%3B%0A%0A%20%20if%20(typeof%20qs%20!%3D%3D%20'string'%20%7C%7C%20qs.length%20%3D%3D%3D%200)%20%7B%0A%20%20%20%20return%20obj%3B%0A%20%20%7D%0A%0A%20%20var%20regexp%20%3D%20%2F%5C%2B%2Fg%3B%0A%20%20qs%20%3D%20qs.split(sep)%3B%0A%0A%20%20var%20maxKeys%20%3D%201000%3B%0A%20%20if%20(options%20%26%26%20typeof%20options.maxKeys%20%3D%3D%3D%20'number')%20%7B%0A%20%20%20%20maxKeys%20%3D%20options.maxKeys%3B%0A%20%20%7D%0A%0A%20%20var%20len%20%3D%20qs.length%3B%0A%20%20%2F%2F%20maxKeys%20%3C%3D%200%20means%20that%20we%20should%20not%20limit%20keys%20count%0A%20%20if%20(maxKeys%20%3E%200%20%26%26%20len%20%3E%20maxKeys)%20%7B%0A%20%20%20%20len%20%3D%20maxKeys%3B%0A%20%20%7D%0A%0A%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20len%3B%20%2B%2Bi)%20%7B%0A%20%20%20%20var%20x%20%3D%20qs%5Bi%5D.replace(regexp%2C%20'%2520')%2C%0A%20%20%20%20%20%20%20%20idx%20%3D%20x.indexOf(eq)%2C%0A%20%20%20%20%20%20%20%20kstr%2C%20vstr%2C%20k%2C%20v%3B%0A%0A%20%20%20%20if%20(idx%20%3E%3D%200)%20%7B%0A%20%20%20%20%20%20kstr%20%3D%20x.substr(0%2C%20idx)%3B%0A%20%20%20%20%20%20vstr%20%3D%20x.substr(idx%20%2B%201)%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20kstr%20%3D%20x%3B%0A%20%20%20%20%20%20vstr%20%3D%20''%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20k%20%3D%20decodeURIComponent(kstr)%3B%0A%20%20%20%20v%20%3D%20decodeURIComponent(vstr)%3B%0A%0A%20%20%20%20if%20(!hasOwnProperty(obj%2C%20k))%20%7B%0A%20%20%20%20%20%20obj%5Bk%5D%20%3D%20v%3B%0A%20%20%20%20%7D%20else%20if%20(isArray(obj%5Bk%5D))%20%7B%0A%20%20%20%20%20%20obj%5Bk%5D.push(v)%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20obj%5Bk%5D%20%3D%20%5Bobj%5Bk%5D%2C%20v%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20obj%3B%0A%7D%3B%0A%0Avar%20isArray%20%3D%20Array.isArray%20%7C%7C%20function%20(xs)%20%7B%0A%20%20return%20Object.prototype.toString.call(xs)%20%3D%3D%3D%20'%5Bobject%20Array%5D'%3B%0A%7D%3B%0A%0A%7D%2C%7B%7D%5D%2C6%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F%2F%20Copyright%20Joyent%2C%20Inc.%20and%20other%20Node%20contributors.%0A%2F%2F%0A%2F%2F%20Permission%20is%20hereby%20granted%2C%20free%20of%20charge%2C%20to%20any%20person%20obtaining%20a%0A%2F%2F%20copy%20of%20this%20software%20and%20associated%20documentation%20files%20(the%0A%2F%2F%20%22Software%22)%2C%20to%20deal%20in%20the%20Software%20without%20restriction%2C%20including%0A%2F%2F%20without%20limitation%20the%20rights%20to%20use%2C%20copy%2C%20modify%2C%20merge%2C%20publish%2C%0A%2F%2F%20distribute%2C%20sublicense%2C%20and%2For%20sell%20copies%20of%20the%20Software%2C%20and%20to%20permit%0A%2F%2F%20persons%20to%20whom%20the%20Software%20is%20furnished%20to%20do%20so%2C%20subject%20to%20the%0A%2F%2F%20following%20conditions%3A%0A%2F%2F%0A%2F%2F%20The%20above%20copyright%20notice%20and%20this%20permission%20notice%20shall%20be%20included%0A%2F%2F%20in%20all%20copies%20or%20substantial%20portions%20of%20the%20Software.%0A%2F%2F%0A%2F%2F%20THE%20SOFTWARE%20IS%20PROVIDED%20%22AS%20IS%22%2C%20WITHOUT%20WARRANTY%20OF%20ANY%20KIND%2C%20EXPRESS%0A%2F%2F%20OR%20IMPLIED%2C%20INCLUDING%20BUT%20NOT%20LIMITED%20TO%20THE%20WARRANTIES%20OF%0A%2F%2F%20MERCHANTABILITY%2C%20FITNESS%20FOR%20A%20PARTICULAR%20PURPOSE%20AND%20NONINFRINGEMENT.%20IN%0A%2F%2F%20NO%20EVENT%20SHALL%20THE%20AUTHORS%20OR%20COPYRIGHT%20HOLDERS%20BE%20LIABLE%20FOR%20ANY%20CLAIM%2C%0A%2F%2F%20DAMAGES%20OR%20OTHER%20LIABILITY%2C%20WHETHER%20IN%20AN%20ACTION%20OF%20CONTRACT%2C%20TORT%20OR%0A%2F%2F%20OTHERWISE%2C%20ARISING%20FROM%2C%20OUT%20OF%20OR%20IN%20CONNECTION%20WITH%20THE%20SOFTWARE%20OR%20THE%0A%2F%2F%20USE%20OR%20OTHER%20DEALINGS%20IN%20THE%20SOFTWARE.%0A%0A'use%20strict'%3B%0A%0Avar%20stringifyPrimitive%20%3D%20function(v)%20%7B%0A%20%20switch%20(typeof%20v)%20%7B%0A%20%20%20%20case%20'string'%3A%0A%20%20%20%20%20%20return%20v%3B%0A%0A%20%20%20%20case%20'boolean'%3A%0A%20%20%20%20%20%20return%20v%20%3F%20'true'%20%3A%20'false'%3B%0A%0A%20%20%20%20case%20'number'%3A%0A%20%20%20%20%20%20return%20isFinite(v)%20%3F%20v%20%3A%20''%3B%0A%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20return%20''%3B%0A%20%20%7D%0A%7D%3B%0A%0Amodule.exports%20%3D%20function(obj%2C%20sep%2C%20eq%2C%20name)%20%7B%0A%20%20sep%20%3D%20sep%20%7C%7C%20'%26'%3B%0A%20%20eq%20%3D%20eq%20%7C%7C%20'%3D'%3B%0A%20%20if%20(obj%20%3D%3D%3D%20null)%20%7B%0A%20%20%20%20obj%20%3D%20undefined%3B%0A%20%20%7D%0A%0A%20%20if%20(typeof%20obj%20%3D%3D%3D%20'object')%20%7B%0A%20%20%20%20return%20map(objectKeys(obj)%2C%20function(k)%20%7B%0A%20%20%20%20%20%20var%20ks%20%3D%20encodeURIComponent(stringifyPrimitive(k))%20%2B%20eq%3B%0A%20%20%20%20%20%20if%20(isArray(obj%5Bk%5D))%20%7B%0A%20%20%20%20%20%20%20%20return%20map(obj%5Bk%5D%2C%20function(v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20ks%20%2B%20encodeURIComponent(stringifyPrimitive(v))%3B%0A%20%20%20%20%20%20%20%20%7D).join(sep)%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20ks%20%2B%20encodeURIComponent(stringifyPrimitive(obj%5Bk%5D))%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D).join(sep)%3B%0A%0A%20%20%7D%0A%0A%20%20if%20(!name)%20return%20''%3B%0A%20%20return%20encodeURIComponent(stringifyPrimitive(name))%20%2B%20eq%20%2B%0A%20%20%20%20%20%20%20%20%20encodeURIComponent(stringifyPrimitive(obj))%3B%0A%7D%3B%0A%0Avar%20isArray%20%3D%20Array.isArray%20%7C%7C%20function%20(xs)%20%7B%0A%20%20return%20Object.prototype.toString.call(xs)%20%3D%3D%3D%20'%5Bobject%20Array%5D'%3B%0A%7D%3B%0A%0Afunction%20map%20(xs%2C%20f)%20%7B%0A%20%20if%20(xs.map)%20return%20xs.map(f)%3B%0A%20%20var%20res%20%3D%20%5B%5D%3B%0A%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20xs.length%3B%20i%2B%2B)%20%7B%0A%20%20%20%20res.push(f(xs%5Bi%5D%2C%20i))%3B%0A%20%20%7D%0A%20%20return%20res%3B%0A%7D%0A%0Avar%20objectKeys%20%3D%20Object.keys%20%7C%7C%20function%20(obj)%20%7B%0A%20%20var%20res%20%3D%20%5B%5D%3B%0A%20%20for%20(var%20key%20in%20obj)%20%7B%0A%20%20%20%20if%20(Object.prototype.hasOwnProperty.call(obj%2C%20key))%20res.push(key)%3B%0A%20%20%7D%0A%20%20return%20res%3B%0A%7D%3B%0A%0A%7D%2C%7B%7D%5D%2C7%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A'use%20strict'%3B%0A%0Aexports.decode%20%3D%20exports.parse%20%3D%20require('.%2Fdecode')%3B%0Aexports.encode%20%3D%20exports.stringify%20%3D%20require('.%2Fencode')%3B%0A%0A%7D%2C%7B%22.%2Fdecode%22%3A5%2C%22.%2Fencode%22%3A6%7D%5D%2C8%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F%2F%20Copyright%20Joyent%2C%20Inc.%20and%20other%20Node%20contributors.%0A%2F%2F%0A%2F%2F%20Permission%20is%20hereby%20granted%2C%20free%20of%20charge%2C%20to%20any%20person%20obtaining%20a%0A%2F%2F%20copy%20of%20this%20software%20and%20associated%20documentation%20files%20(the%0A%2F%2F%20%22Software%22)%2C%20to%20deal%20in%20the%20Software%20without%20restriction%2C%20including%0A%2F%2F%20without%20limitation%20the%20rights%20to%20use%2C%20copy%2C%20modify%2C%20merge%2C%20publish%2C%0A%2F%2F%20distribute%2C%20sublicense%2C%20and%2For%20sell%20copies%20of%20the%20Software%2C%20and%20to%20permit%0A%2F%2F%20persons%20to%20whom%20the%20Software%20is%20furnished%20to%20do%20so%2C%20subject%20to%20the%0A%2F%2F%20following%20conditions%3A%0A%2F%2F%0A%2F%2F%20The%20above%20copyright%20notice%20and%20this%20permission%20notice%20shall%20be%20included%0A%2F%2F%20in%20all%20copies%20or%20substantial%20portions%20of%20the%20Software.%0A%2F%2F%0A%2F%2F%20THE%20SOFTWARE%20IS%20PROVIDED%20%22AS%20IS%22%2C%20WITHOUT%20WARRANTY%20OF%20ANY%20KIND%2C%20EXPRESS%0A%2F%2F%20OR%20IMPLIED%2C%20INCLUDING%20BUT%20NOT%20LIMITED%20TO%20THE%20WARRANTIES%20OF%0A%2F%2F%20MERCHANTABILITY%2C%20FITNESS%20FOR%20A%20PARTICULAR%20PURPOSE%20AND%20NONINFRINGEMENT.%20IN%0A%2F%2F%20NO%20EVENT%20SHALL%20THE%20AUTHORS%20OR%20COPYRIGHT%20HOLDERS%20BE%20LIABLE%20FOR%20ANY%20CLAIM%2C%0A%2F%2F%20DAMAGES%20OR%20OTHER%20LIABILITY%2C%20WHETHER%20IN%20AN%20ACTION%20OF%20CONTRACT%2C%20TORT%20OR%0A%2F%2F%20OTHERWISE%2C%20ARISING%20FROM%2C%20OUT%20OF%20OR%20IN%20CONNECTION%20WITH%20THE%20SOFTWARE%20OR%20THE%0A%2F%2F%20USE%20OR%20OTHER%20DEALINGS%20IN%20THE%20SOFTWARE.%0A%0Avar%20punycode%20%3D%20require('punycode')%3B%0A%0Aexports.parse%20%3D%20urlParse%3B%0Aexports.resolve%20%3D%20urlResolve%3B%0Aexports.resolveObject%20%3D%20urlResolveObject%3B%0Aexports.format%20%3D%20urlFormat%3B%0A%0Aexports.Url%20%3D%20Url%3B%0A%0Afunction%20Url()%20%7B%0A%20%20this.protocol%20%3D%20null%3B%0A%20%20this.slashes%20%3D%20null%3B%0A%20%20this.auth%20%3D%20null%3B%0A%20%20this.host%20%3D%20null%3B%0A%20%20this.port%20%3D%20null%3B%0A%20%20this.hostname%20%3D%20null%3B%0A%20%20this.hash%20%3D%20null%3B%0A%20%20this.search%20%3D%20null%3B%0A%20%20this.query%20%3D%20null%3B%0A%20%20this.pathname%20%3D%20null%3B%0A%20%20this.path%20%3D%20null%3B%0A%20%20this.href%20%3D%20null%3B%0A%7D%0A%0A%2F%2F%20Reference%3A%20RFC%203986%2C%20RFC%201808%2C%20RFC%202396%0A%0A%2F%2F%20define%20these%20here%20so%20at%20least%20they%20only%20have%20to%20be%0A%2F%2F%20compiled%20once%20on%20the%20first%20module%20load.%0Avar%20protocolPattern%20%3D%20%2F%5E(%5Ba-z0-9.%2B-%5D%2B%3A)%2Fi%2C%0A%20%20%20%20portPattern%20%3D%20%2F%3A%5B0-9%5D*%24%2F%2C%0A%0A%20%20%20%20%2F%2F%20RFC%202396%3A%20characters%20reserved%20for%20delimiting%20URLs.%0A%20%20%20%20%2F%2F%20We%20actually%20just%20auto-escape%20these.%0A%20%20%20%20delims%20%3D%20%5B'%3C'%2C%20'%3E'%2C%20'%22'%2C%20'%60'%2C%20'%20'%2C%20'%5Cr'%2C%20'%5Cn'%2C%20'%5Ct'%5D%2C%0A%0A%20%20%20%20%2F%2F%20RFC%202396%3A%20characters%20not%20allowed%20for%20various%20reasons.%0A%20%20%20%20unwise%20%3D%20%5B'%7B'%2C%20'%7D'%2C%20'%7C'%2C%20'%5C%5C'%2C%20'%5E'%2C%20'%60'%5D.concat(delims)%2C%0A%0A%20%20%20%20%2F%2F%20Allowed%20by%20RFCs%2C%20but%20cause%20of%20XSS%20attacks.%20%20Always%20escape%20these.%0A%20%20%20%20autoEscape%20%3D%20%5B'%5C''%5D.concat(unwise)%2C%0A%20%20%20%20%2F%2F%20Characters%20that%20are%20never%20ever%20allowed%20in%20a%20hostname.%0A%20%20%20%20%2F%2F%20Note%20that%20any%20invalid%20chars%20are%20also%20handled%2C%20but%20these%0A%20%20%20%20%2F%2F%20are%20the%20ones%20that%20are%20*expected*%20to%20be%20seen%2C%20so%20we%20fast-path%0A%20%20%20%20%2F%2F%20them.%0A%20%20%20%20nonHostChars%20%3D%20%5B'%25'%2C%20'%2F'%2C%20'%3F'%2C%20'%3B'%2C%20'%23'%5D.concat(autoEscape)%2C%0A%20%20%20%20hostEndingChars%20%3D%20%5B'%2F'%2C%20'%3F'%2C%20'%23'%5D%2C%0A%20%20%20%20hostnameMaxLen%20%3D%20255%2C%0A%20%20%20%20hostnamePartPattern%20%3D%20%2F%5E%5Ba-z0-9A-Z_-%5D%7B0%2C63%7D%24%2F%2C%0A%20%20%20%20hostnamePartStart%20%3D%20%2F%5E(%5Ba-z0-9A-Z_-%5D%7B0%2C63%7D)(.*)%24%2F%2C%0A%20%20%20%20%2F%2F%20protocols%20that%20can%20allow%20%22unsafe%22%20and%20%22unwise%22%20chars.%0A%20%20%20%20unsafeProtocol%20%3D%20%7B%0A%20%20%20%20%20%20'javascript'%3A%20true%2C%0A%20%20%20%20%20%20'javascript%3A'%3A%20true%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20protocols%20that%20never%20have%20a%20hostname.%0A%20%20%20%20hostlessProtocol%20%3D%20%7B%0A%20%20%20%20%20%20'javascript'%3A%20true%2C%0A%20%20%20%20%20%20'javascript%3A'%3A%20true%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20protocols%20that%20always%20contain%20a%20%2F%2F%20bit.%0A%20%20%20%20slashedProtocol%20%3D%20%7B%0A%20%20%20%20%20%20'http'%3A%20true%2C%0A%20%20%20%20%20%20'https'%3A%20true%2C%0A%20%20%20%20%20%20'ftp'%3A%20true%2C%0A%20%20%20%20%20%20'gopher'%3A%20true%2C%0A%20%20%20%20%20%20'file'%3A%20true%2C%0A%20%20%20%20%20%20'http%3A'%3A%20true%2C%0A%20%20%20%20%20%20'https%3A'%3A%20true%2C%0A%20%20%20%20%20%20'ftp%3A'%3A%20true%2C%0A%20%20%20%20%20%20'gopher%3A'%3A%20true%2C%0A%20%20%20%20%20%20'file%3A'%3A%20true%0A%20%20%20%20%7D%2C%0A%20%20%20%20querystring%20%3D%20require('querystring')%3B%0A%0Afunction%20urlParse(url%2C%20parseQueryString%2C%20slashesDenoteHost)%20%7B%0A%20%20if%20(url%20%26%26%20isObject(url)%20%26%26%20url%20instanceof%20Url)%20return%20url%3B%0A%0A%20%20var%20u%20%3D%20new%20Url%3B%0A%20%20u.parse(url%2C%20parseQueryString%2C%20slashesDenoteHost)%3B%0A%20%20return%20u%3B%0A%7D%0A%0AUrl.prototype.parse%20%3D%20function(url%2C%20parseQueryString%2C%20slashesDenoteHost)%20%7B%0A%20%20if%20(!isString(url))%20%7B%0A%20%20%20%20throw%20new%20TypeError(%22Parameter%20'url'%20must%20be%20a%20string%2C%20not%20%22%20%2B%20typeof%20url)%3B%0A%20%20%7D%0A%0A%20%20var%20rest%20%3D%20url%3B%0A%0A%20%20%2F%2F%20trim%20before%20proceeding.%0A%20%20%2F%2F%20This%20is%20to%20support%20parse%20stuff%20like%20%22%20%20http%3A%2F%2Ffoo.com%20%20%5Cn%22%0A%20%20rest%20%3D%20rest.trim()%3B%0A%0A%20%20var%20proto%20%3D%20protocolPattern.exec(rest)%3B%0A%20%20if%20(proto)%20%7B%0A%20%20%20%20proto%20%3D%20proto%5B0%5D%3B%0A%20%20%20%20var%20lowerProto%20%3D%20proto.toLowerCase()%3B%0A%20%20%20%20this.protocol%20%3D%20lowerProto%3B%0A%20%20%20%20rest%20%3D%20rest.substr(proto.length)%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20figure%20out%20if%20it's%20got%20a%20host%0A%20%20%2F%2F%20user%40server%20is%20*always*%20interpreted%20as%20a%20hostname%2C%20and%20url%0A%20%20%2F%2F%20resolution%20will%20treat%20%2F%2Ffoo%2Fbar%20as%20host%3Dfoo%2Cpath%3Dbar%20because%20that's%0A%20%20%2F%2F%20how%20the%20browser%20resolves%20relative%20URLs.%0A%20%20if%20(slashesDenoteHost%20%7C%7C%20proto%20%7C%7C%20rest.match(%2F%5E%5C%2F%5C%2F%5B%5E%40%5C%2F%5D%2B%40%5B%5E%40%5C%2F%5D%2B%2F))%20%7B%0A%20%20%20%20var%20slashes%20%3D%20rest.substr(0%2C%202)%20%3D%3D%3D%20'%2F%2F'%3B%0A%20%20%20%20if%20(slashes%20%26%26%20!(proto%20%26%26%20hostlessProtocol%5Bproto%5D))%20%7B%0A%20%20%20%20%20%20rest%20%3D%20rest.substr(2)%3B%0A%20%20%20%20%20%20this.slashes%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20if%20(!hostlessProtocol%5Bproto%5D%20%26%26%0A%20%20%20%20%20%20(slashes%20%7C%7C%20(proto%20%26%26%20!slashedProtocol%5Bproto%5D)))%20%7B%0A%0A%20%20%20%20%2F%2F%20there's%20a%20hostname.%0A%20%20%20%20%2F%2F%20the%20first%20instance%20of%20%2F%2C%20%3F%2C%20%3B%2C%20or%20%23%20ends%20the%20host.%0A%20%20%20%20%2F%2F%0A%20%20%20%20%2F%2F%20If%20there%20is%20an%20%40%20in%20the%20hostname%2C%20then%20non-host%20chars%20*are*%20allowed%0A%20%20%20%20%2F%2F%20to%20the%20left%20of%20the%20last%20%40%20sign%2C%20unless%20some%20host-ending%20character%0A%20%20%20%20%2F%2F%20comes%20*before*%20the%20%40-sign.%0A%20%20%20%20%2F%2F%20URLs%20are%20obnoxious.%0A%20%20%20%20%2F%2F%0A%20%20%20%20%2F%2F%20ex%3A%0A%20%20%20%20%2F%2F%20http%3A%2F%2Fa%40b%40c%2F%20%3D%3E%20user%3Aa%40b%20host%3Ac%0A%20%20%20%20%2F%2F%20http%3A%2F%2Fa%40b%3F%40c%20%3D%3E%20user%3Aa%20host%3Ac%20path%3A%2F%3F%40c%0A%0A%20%20%20%20%2F%2F%20v0.12%20TODO(isaacs)%3A%20This%20is%20not%20quite%20how%20Chrome%20does%20things.%0A%20%20%20%20%2F%2F%20Review%20our%20test%20case%20against%20browsers%20more%20comprehensively.%0A%0A%20%20%20%20%2F%2F%20find%20the%20first%20instance%20of%20any%20hostEndingChars%0A%20%20%20%20var%20hostEnd%20%3D%20-1%3B%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20hostEndingChars.length%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20var%20hec%20%3D%20rest.indexOf(hostEndingChars%5Bi%5D)%3B%0A%20%20%20%20%20%20if%20(hec%20!%3D%3D%20-1%20%26%26%20(hostEnd%20%3D%3D%3D%20-1%20%7C%7C%20hec%20%3C%20hostEnd))%0A%20%20%20%20%20%20%20%20hostEnd%20%3D%20hec%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20at%20this%20point%2C%20either%20we%20have%20an%20explicit%20point%20where%20the%0A%20%20%20%20%2F%2F%20auth%20portion%20cannot%20go%20past%2C%20or%20the%20last%20%40%20char%20is%20the%20decider.%0A%20%20%20%20var%20auth%2C%20atSign%3B%0A%20%20%20%20if%20(hostEnd%20%3D%3D%3D%20-1)%20%7B%0A%20%20%20%20%20%20%2F%2F%20atSign%20can%20be%20anywhere.%0A%20%20%20%20%20%20atSign%20%3D%20rest.lastIndexOf('%40')%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%2F%2F%20atSign%20must%20be%20in%20auth%20portion.%0A%20%20%20%20%20%20%2F%2F%20http%3A%2F%2Fa%40b%2Fc%40d%20%3D%3E%20host%3Ab%20auth%3Aa%20path%3A%2Fc%40d%0A%20%20%20%20%20%20atSign%20%3D%20rest.lastIndexOf('%40'%2C%20hostEnd)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Now%20we%20have%20a%20portion%20which%20is%20definitely%20the%20auth.%0A%20%20%20%20%2F%2F%20Pull%20that%20off.%0A%20%20%20%20if%20(atSign%20!%3D%3D%20-1)%20%7B%0A%20%20%20%20%20%20auth%20%3D%20rest.slice(0%2C%20atSign)%3B%0A%20%20%20%20%20%20rest%20%3D%20rest.slice(atSign%20%2B%201)%3B%0A%20%20%20%20%20%20this.auth%20%3D%20decodeURIComponent(auth)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20the%20host%20is%20the%20remaining%20to%20the%20left%20of%20the%20first%20non-host%20char%0A%20%20%20%20hostEnd%20%3D%20-1%3B%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20nonHostChars.length%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20var%20hec%20%3D%20rest.indexOf(nonHostChars%5Bi%5D)%3B%0A%20%20%20%20%20%20if%20(hec%20!%3D%3D%20-1%20%26%26%20(hostEnd%20%3D%3D%3D%20-1%20%7C%7C%20hec%20%3C%20hostEnd))%0A%20%20%20%20%20%20%20%20hostEnd%20%3D%20hec%3B%0A%20%20%20%20%7D%0A%20%20%20%20%2F%2F%20if%20we%20still%20have%20not%20hit%20it%2C%20then%20the%20entire%20thing%20is%20a%20host.%0A%20%20%20%20if%20(hostEnd%20%3D%3D%3D%20-1)%0A%20%20%20%20%20%20hostEnd%20%3D%20rest.length%3B%0A%0A%20%20%20%20this.host%20%3D%20rest.slice(0%2C%20hostEnd)%3B%0A%20%20%20%20rest%20%3D%20rest.slice(hostEnd)%3B%0A%0A%20%20%20%20%2F%2F%20pull%20out%20port.%0A%20%20%20%20this.parseHost()%3B%0A%0A%20%20%20%20%2F%2F%20we've%20indicated%20that%20there%20is%20a%20hostname%2C%0A%20%20%20%20%2F%2F%20so%20even%20if%20it's%20empty%2C%20it%20has%20to%20be%20present.%0A%20%20%20%20this.hostname%20%3D%20this.hostname%20%7C%7C%20''%3B%0A%0A%20%20%20%20%2F%2F%20if%20hostname%20begins%20with%20%5B%20and%20ends%20with%20%5D%0A%20%20%20%20%2F%2F%20assume%20that%20it's%20an%20IPv6%20address.%0A%20%20%20%20var%20ipv6Hostname%20%3D%20this.hostname%5B0%5D%20%3D%3D%3D%20'%5B'%20%26%26%0A%20%20%20%20%20%20%20%20this.hostname%5Bthis.hostname.length%20-%201%5D%20%3D%3D%3D%20'%5D'%3B%0A%0A%20%20%20%20%2F%2F%20validate%20a%20little.%0A%20%20%20%20if%20(!ipv6Hostname)%20%7B%0A%20%20%20%20%20%20var%20hostparts%20%3D%20this.hostname.split(%2F%5C.%2F)%3B%0A%20%20%20%20%20%20for%20(var%20i%20%3D%200%2C%20l%20%3D%20hostparts.length%3B%20i%20%3C%20l%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20var%20part%20%3D%20hostparts%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20if%20(!part)%20continue%3B%0A%20%20%20%20%20%20%20%20if%20(!part.match(hostnamePartPattern))%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20newpart%20%3D%20''%3B%0A%20%20%20%20%20%20%20%20%20%20for%20(var%20j%20%3D%200%2C%20k%20%3D%20part.length%3B%20j%20%3C%20k%3B%20j%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(part.charCodeAt(j)%20%3E%20127)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20we%20replace%20non-ASCII%20char%20with%20a%20temporary%20placeholder%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20we%20need%20this%20to%20make%20sure%20size%20of%20hostname%20is%20not%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20broken%20by%20replacing%20non-ASCII%20by%20nothing%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20newpart%20%2B%3D%20'x'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20newpart%20%2B%3D%20part%5Bj%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20we%20test%20again%20with%20ASCII%20char%20only%0A%20%20%20%20%20%20%20%20%20%20if%20(!newpart.match(hostnamePartPattern))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20validParts%20%3D%20hostparts.slice(0%2C%20i)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20notHost%20%3D%20hostparts.slice(i%20%2B%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20bit%20%3D%20part.match(hostnamePartStart)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(bit)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20validParts.push(bit%5B1%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20notHost.unshift(bit%5B2%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(notHost.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20rest%20%3D%20'%2F'%20%2B%20notHost.join('.')%20%2B%20rest%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20this.hostname%20%3D%20validParts.join('.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(this.hostname.length%20%3E%20hostnameMaxLen)%20%7B%0A%20%20%20%20%20%20this.hostname%20%3D%20''%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%2F%2F%20hostnames%20are%20always%20lower%20case.%0A%20%20%20%20%20%20this.hostname%20%3D%20this.hostname.toLowerCase()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(!ipv6Hostname)%20%7B%0A%20%20%20%20%20%20%2F%2F%20IDNA%20Support%3A%20Returns%20a%20puny%20coded%20representation%20of%20%22domain%22.%0A%20%20%20%20%20%20%2F%2F%20It%20only%20converts%20the%20part%20of%20the%20domain%20name%20that%0A%20%20%20%20%20%20%2F%2F%20has%20non%20ASCII%20characters.%20I.e.%20it%20dosent%20matter%20if%0A%20%20%20%20%20%20%2F%2F%20you%20call%20it%20with%20a%20domain%20that%20already%20is%20in%20ASCII.%0A%20%20%20%20%20%20var%20domainArray%20%3D%20this.hostname.split('.')%3B%0A%20%20%20%20%20%20var%20newOut%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20domainArray.length%3B%20%2B%2Bi)%20%7B%0A%20%20%20%20%20%20%20%20var%20s%20%3D%20domainArray%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20newOut.push(s.match(%2F%5B%5EA-Za-z0-9_-%5D%2F)%20%3F%0A%20%20%20%20%20%20%20%20%20%20%20%20'xn--'%20%2B%20punycode.encode(s)%20%3A%20s)%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.hostname%20%3D%20newOut.join('.')%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20p%20%3D%20this.port%20%3F%20'%3A'%20%2B%20this.port%20%3A%20''%3B%0A%20%20%20%20var%20h%20%3D%20this.hostname%20%7C%7C%20''%3B%0A%20%20%20%20this.host%20%3D%20h%20%2B%20p%3B%0A%20%20%20%20this.href%20%2B%3D%20this.host%3B%0A%0A%20%20%20%20%2F%2F%20strip%20%5B%20and%20%5D%20from%20the%20hostname%0A%20%20%20%20%2F%2F%20the%20host%20field%20still%20retains%20them%2C%20though%0A%20%20%20%20if%20(ipv6Hostname)%20%7B%0A%20%20%20%20%20%20this.hostname%20%3D%20this.hostname.substr(1%2C%20this.hostname.length%20-%202)%3B%0A%20%20%20%20%20%20if%20(rest%5B0%5D%20!%3D%3D%20'%2F')%20%7B%0A%20%20%20%20%20%20%20%20rest%20%3D%20'%2F'%20%2B%20rest%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20now%20rest%20is%20set%20to%20the%20post-host%20stuff.%0A%20%20%2F%2F%20chop%20off%20any%20delim%20chars.%0A%20%20if%20(!unsafeProtocol%5BlowerProto%5D)%20%7B%0A%0A%20%20%20%20%2F%2F%20First%2C%20make%20100%25%20sure%20that%20any%20%22autoEscape%22%20chars%20get%0A%20%20%20%20%2F%2F%20escaped%2C%20even%20if%20encodeURIComponent%20doesn't%20think%20they%0A%20%20%20%20%2F%2F%20need%20to%20be.%0A%20%20%20%20for%20(var%20i%20%3D%200%2C%20l%20%3D%20autoEscape.length%3B%20i%20%3C%20l%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20var%20ae%20%3D%20autoEscape%5Bi%5D%3B%0A%20%20%20%20%20%20var%20esc%20%3D%20encodeURIComponent(ae)%3B%0A%20%20%20%20%20%20if%20(esc%20%3D%3D%3D%20ae)%20%7B%0A%20%20%20%20%20%20%20%20esc%20%3D%20escape(ae)%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20rest%20%3D%20rest.split(ae).join(esc)%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%0A%20%20%2F%2F%20chop%20off%20from%20the%20tail%20first.%0A%20%20var%20hash%20%3D%20rest.indexOf('%23')%3B%0A%20%20if%20(hash%20!%3D%3D%20-1)%20%7B%0A%20%20%20%20%2F%2F%20got%20a%20fragment%20string.%0A%20%20%20%20this.hash%20%3D%20rest.substr(hash)%3B%0A%20%20%20%20rest%20%3D%20rest.slice(0%2C%20hash)%3B%0A%20%20%7D%0A%20%20var%20qm%20%3D%20rest.indexOf('%3F')%3B%0A%20%20if%20(qm%20!%3D%3D%20-1)%20%7B%0A%20%20%20%20this.search%20%3D%20rest.substr(qm)%3B%0A%20%20%20%20this.query%20%3D%20rest.substr(qm%20%2B%201)%3B%0A%20%20%20%20if%20(parseQueryString)%20%7B%0A%20%20%20%20%20%20this.query%20%3D%20querystring.parse(this.query)%3B%0A%20%20%20%20%7D%0A%20%20%20%20rest%20%3D%20rest.slice(0%2C%20qm)%3B%0A%20%20%7D%20else%20if%20(parseQueryString)%20%7B%0A%20%20%20%20%2F%2F%20no%20query%20string%2C%20but%20parseQueryString%20still%20requested%0A%20%20%20%20this.search%20%3D%20''%3B%0A%20%20%20%20this.query%20%3D%20%7B%7D%3B%0A%20%20%7D%0A%20%20if%20(rest)%20this.pathname%20%3D%20rest%3B%0A%20%20if%20(slashedProtocol%5BlowerProto%5D%20%26%26%0A%20%20%20%20%20%20this.hostname%20%26%26%20!this.pathname)%20%7B%0A%20%20%20%20this.pathname%20%3D%20'%2F'%3B%0A%20%20%7D%0A%0A%20%20%2F%2Fto%20support%20http.request%0A%20%20if%20(this.pathname%20%7C%7C%20this.search)%20%7B%0A%20%20%20%20var%20p%20%3D%20this.pathname%20%7C%7C%20''%3B%0A%20%20%20%20var%20s%20%3D%20this.search%20%7C%7C%20''%3B%0A%20%20%20%20this.path%20%3D%20p%20%2B%20s%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20finally%2C%20reconstruct%20the%20href%20based%20on%20what%20has%20been%20validated.%0A%20%20this.href%20%3D%20this.format()%3B%0A%20%20return%20this%3B%0A%7D%3B%0A%0A%2F%2F%20format%20a%20parsed%20object%20into%20a%20url%20string%0Afunction%20urlFormat(obj)%20%7B%0A%20%20%2F%2F%20ensure%20it's%20an%20object%2C%20and%20not%20a%20string%20url.%0A%20%20%2F%2F%20If%20it's%20an%20obj%2C%20this%20is%20a%20no-op.%0A%20%20%2F%2F%20this%20way%2C%20you%20can%20call%20url_format()%20on%20strings%0A%20%20%2F%2F%20to%20clean%20up%20potentially%20wonky%20urls.%0A%20%20if%20(isString(obj))%20obj%20%3D%20urlParse(obj)%3B%0A%20%20if%20(!(obj%20instanceof%20Url))%20return%20Url.prototype.format.call(obj)%3B%0A%20%20return%20obj.format()%3B%0A%7D%0A%0AUrl.prototype.format%20%3D%20function()%20%7B%0A%20%20var%20auth%20%3D%20this.auth%20%7C%7C%20''%3B%0A%20%20if%20(auth)%20%7B%0A%20%20%20%20auth%20%3D%20encodeURIComponent(auth)%3B%0A%20%20%20%20auth%20%3D%20auth.replace(%2F%253A%2Fi%2C%20'%3A')%3B%0A%20%20%20%20auth%20%2B%3D%20'%40'%3B%0A%20%20%7D%0A%0A%20%20var%20protocol%20%3D%20this.protocol%20%7C%7C%20''%2C%0A%20%20%20%20%20%20pathname%20%3D%20this.pathname%20%7C%7C%20''%2C%0A%20%20%20%20%20%20hash%20%3D%20this.hash%20%7C%7C%20''%2C%0A%20%20%20%20%20%20host%20%3D%20false%2C%0A%20%20%20%20%20%20query%20%3D%20''%3B%0A%0A%20%20if%20(this.host)%20%7B%0A%20%20%20%20host%20%3D%20auth%20%2B%20this.host%3B%0A%20%20%7D%20else%20if%20(this.hostname)%20%7B%0A%20%20%20%20host%20%3D%20auth%20%2B%20(this.hostname.indexOf('%3A')%20%3D%3D%3D%20-1%20%3F%0A%20%20%20%20%20%20%20%20this.hostname%20%3A%0A%20%20%20%20%20%20%20%20'%5B'%20%2B%20this.hostname%20%2B%20'%5D')%3B%0A%20%20%20%20if%20(this.port)%20%7B%0A%20%20%20%20%20%20host%20%2B%3D%20'%3A'%20%2B%20this.port%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20if%20(this.query%20%26%26%0A%20%20%20%20%20%20isObject(this.query)%20%26%26%0A%20%20%20%20%20%20Object.keys(this.query).length)%20%7B%0A%20%20%20%20query%20%3D%20querystring.stringify(this.query)%3B%0A%20%20%7D%0A%0A%20%20var%20search%20%3D%20this.search%20%7C%7C%20(query%20%26%26%20('%3F'%20%2B%20query))%20%7C%7C%20''%3B%0A%0A%20%20if%20(protocol%20%26%26%20protocol.substr(-1)%20!%3D%3D%20'%3A')%20protocol%20%2B%3D%20'%3A'%3B%0A%0A%20%20%2F%2F%20only%20the%20slashedProtocols%20get%20the%20%2F%2F.%20%20Not%20mailto%3A%2C%20xmpp%3A%2C%20etc.%0A%20%20%2F%2F%20unless%20they%20had%20them%20to%20begin%20with.%0A%20%20if%20(this.slashes%20%7C%7C%0A%20%20%20%20%20%20(!protocol%20%7C%7C%20slashedProtocol%5Bprotocol%5D)%20%26%26%20host%20!%3D%3D%20false)%20%7B%0A%20%20%20%20host%20%3D%20'%2F%2F'%20%2B%20(host%20%7C%7C%20'')%3B%0A%20%20%20%20if%20(pathname%20%26%26%20pathname.charAt(0)%20!%3D%3D%20'%2F')%20pathname%20%3D%20'%2F'%20%2B%20pathname%3B%0A%20%20%7D%20else%20if%20(!host)%20%7B%0A%20%20%20%20host%20%3D%20''%3B%0A%20%20%7D%0A%0A%20%20if%20(hash%20%26%26%20hash.charAt(0)%20!%3D%3D%20'%23')%20hash%20%3D%20'%23'%20%2B%20hash%3B%0A%20%20if%20(search%20%26%26%20search.charAt(0)%20!%3D%3D%20'%3F')%20search%20%3D%20'%3F'%20%2B%20search%3B%0A%0A%20%20pathname%20%3D%20pathname.replace(%2F%5B%3F%23%5D%2Fg%2C%20function(match)%20%7B%0A%20%20%20%20return%20encodeURIComponent(match)%3B%0A%20%20%7D)%3B%0A%20%20search%20%3D%20search.replace('%23'%2C%20'%2523')%3B%0A%0A%20%20return%20protocol%20%2B%20host%20%2B%20pathname%20%2B%20search%20%2B%20hash%3B%0A%7D%3B%0A%0Afunction%20urlResolve(source%2C%20relative)%20%7B%0A%20%20return%20urlParse(source%2C%20false%2C%20true).resolve(relative)%3B%0A%7D%0A%0AUrl.prototype.resolve%20%3D%20function(relative)%20%7B%0A%20%20return%20this.resolveObject(urlParse(relative%2C%20false%2C%20true)).format()%3B%0A%7D%3B%0A%0Afunction%20urlResolveObject(source%2C%20relative)%20%7B%0A%20%20if%20(!source)%20return%20relative%3B%0A%20%20return%20urlParse(source%2C%20false%2C%20true).resolveObject(relative)%3B%0A%7D%0A%0AUrl.prototype.resolveObject%20%3D%20function(relative)%20%7B%0A%20%20if%20(isString(relative))%20%7B%0A%20%20%20%20var%20rel%20%3D%20new%20Url()%3B%0A%20%20%20%20rel.parse(relative%2C%20false%2C%20true)%3B%0A%20%20%20%20relative%20%3D%20rel%3B%0A%20%20%7D%0A%0A%20%20var%20result%20%3D%20new%20Url()%3B%0A%20%20Object.keys(this).forEach(function(k)%20%7B%0A%20%20%20%20result%5Bk%5D%20%3D%20this%5Bk%5D%3B%0A%20%20%7D%2C%20this)%3B%0A%0A%20%20%2F%2F%20hash%20is%20always%20overridden%2C%20no%20matter%20what.%0A%20%20%2F%2F%20even%20href%3D%22%22%20will%20remove%20it.%0A%20%20result.hash%20%3D%20relative.hash%3B%0A%0A%20%20%2F%2F%20if%20the%20relative%20url%20is%20empty%2C%20then%20there's%20nothing%20left%20to%20do%20here.%0A%20%20if%20(relative.href%20%3D%3D%3D%20'')%20%7B%0A%20%20%20%20result.href%20%3D%20result.format()%3B%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20hrefs%20like%20%2F%2Ffoo%2Fbar%20always%20cut%20to%20the%20protocol.%0A%20%20if%20(relative.slashes%20%26%26%20!relative.protocol)%20%7B%0A%20%20%20%20%2F%2F%20take%20everything%20except%20the%20protocol%20from%20relative%0A%20%20%20%20Object.keys(relative).forEach(function(k)%20%7B%0A%20%20%20%20%20%20if%20(k%20!%3D%3D%20'protocol')%0A%20%20%20%20%20%20%20%20result%5Bk%5D%20%3D%20relative%5Bk%5D%3B%0A%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%2F%2FurlParse%20appends%20trailing%20%2F%20to%20urls%20like%20http%3A%2F%2Fwww.example.com%0A%20%20%20%20if%20(slashedProtocol%5Bresult.protocol%5D%20%26%26%0A%20%20%20%20%20%20%20%20result.hostname%20%26%26%20!result.pathname)%20%7B%0A%20%20%20%20%20%20result.path%20%3D%20result.pathname%20%3D%20'%2F'%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20result.href%20%3D%20result.format()%3B%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%0A%20%20if%20(relative.protocol%20%26%26%20relative.protocol%20!%3D%3D%20result.protocol)%20%7B%0A%20%20%20%20%2F%2F%20if%20it's%20a%20known%20url%20protocol%2C%20then%20changing%0A%20%20%20%20%2F%2F%20the%20protocol%20does%20weird%20things%0A%20%20%20%20%2F%2F%20first%2C%20if%20it's%20not%20file%3A%2C%20then%20we%20MUST%20have%20a%20host%2C%0A%20%20%20%20%2F%2F%20and%20if%20there%20was%20a%20path%0A%20%20%20%20%2F%2F%20to%20begin%20with%2C%20then%20we%20MUST%20have%20a%20path.%0A%20%20%20%20%2F%2F%20if%20it%20is%20file%3A%2C%20then%20the%20host%20is%20dropped%2C%0A%20%20%20%20%2F%2F%20because%20that's%20known%20to%20be%20hostless.%0A%20%20%20%20%2F%2F%20anything%20else%20is%20assumed%20to%20be%20absolute.%0A%20%20%20%20if%20(!slashedProtocol%5Brelative.protocol%5D)%20%7B%0A%20%20%20%20%20%20Object.keys(relative).forEach(function(k)%20%7B%0A%20%20%20%20%20%20%20%20result%5Bk%5D%20%3D%20relative%5Bk%5D%3B%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20result.href%20%3D%20result.format()%3B%0A%20%20%20%20%20%20return%20result%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20result.protocol%20%3D%20relative.protocol%3B%0A%20%20%20%20if%20(!relative.host%20%26%26%20!hostlessProtocol%5Brelative.protocol%5D)%20%7B%0A%20%20%20%20%20%20var%20relPath%20%3D%20(relative.pathname%20%7C%7C%20'').split('%2F')%3B%0A%20%20%20%20%20%20while%20(relPath.length%20%26%26%20!(relative.host%20%3D%20relPath.shift()))%3B%0A%20%20%20%20%20%20if%20(!relative.host)%20relative.host%20%3D%20''%3B%0A%20%20%20%20%20%20if%20(!relative.hostname)%20relative.hostname%20%3D%20''%3B%0A%20%20%20%20%20%20if%20(relPath%5B0%5D%20!%3D%3D%20'')%20relPath.unshift('')%3B%0A%20%20%20%20%20%20if%20(relPath.length%20%3C%202)%20relPath.unshift('')%3B%0A%20%20%20%20%20%20result.pathname%20%3D%20relPath.join('%2F')%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20result.pathname%20%3D%20relative.pathname%3B%0A%20%20%20%20%7D%0A%20%20%20%20result.search%20%3D%20relative.search%3B%0A%20%20%20%20result.query%20%3D%20relative.query%3B%0A%20%20%20%20result.host%20%3D%20relative.host%20%7C%7C%20''%3B%0A%20%20%20%20result.auth%20%3D%20relative.auth%3B%0A%20%20%20%20result.hostname%20%3D%20relative.hostname%20%7C%7C%20relative.host%3B%0A%20%20%20%20result.port%20%3D%20relative.port%3B%0A%20%20%20%20%2F%2F%20to%20support%20http.request%0A%20%20%20%20if%20(result.pathname%20%7C%7C%20result.search)%20%7B%0A%20%20%20%20%20%20var%20p%20%3D%20result.pathname%20%7C%7C%20''%3B%0A%20%20%20%20%20%20var%20s%20%3D%20result.search%20%7C%7C%20''%3B%0A%20%20%20%20%20%20result.path%20%3D%20p%20%2B%20s%3B%0A%20%20%20%20%7D%0A%20%20%20%20result.slashes%20%3D%20result.slashes%20%7C%7C%20relative.slashes%3B%0A%20%20%20%20result.href%20%3D%20result.format()%3B%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%0A%20%20var%20isSourceAbs%20%3D%20(result.pathname%20%26%26%20result.pathname.charAt(0)%20%3D%3D%3D%20'%2F')%2C%0A%20%20%20%20%20%20isRelAbs%20%3D%20(%0A%20%20%20%20%20%20%20%20%20%20relative.host%20%7C%7C%0A%20%20%20%20%20%20%20%20%20%20relative.pathname%20%26%26%20relative.pathname.charAt(0)%20%3D%3D%3D%20'%2F'%0A%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20mustEndAbs%20%3D%20(isRelAbs%20%7C%7C%20isSourceAbs%20%7C%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(result.host%20%26%26%20relative.pathname))%2C%0A%20%20%20%20%20%20removeAllDots%20%3D%20mustEndAbs%2C%0A%20%20%20%20%20%20srcPath%20%3D%20result.pathname%20%26%26%20result.pathname.split('%2F')%20%7C%7C%20%5B%5D%2C%0A%20%20%20%20%20%20relPath%20%3D%20relative.pathname%20%26%26%20relative.pathname.split('%2F')%20%7C%7C%20%5B%5D%2C%0A%20%20%20%20%20%20psychotic%20%3D%20result.protocol%20%26%26%20!slashedProtocol%5Bresult.protocol%5D%3B%0A%0A%20%20%2F%2F%20if%20the%20url%20is%20a%20non-slashed%20url%2C%20then%20relative%0A%20%20%2F%2F%20links%20like%20..%2F..%20should%20be%20able%0A%20%20%2F%2F%20to%20crawl%20up%20to%20the%20hostname%2C%20as%20well.%20%20This%20is%20strange.%0A%20%20%2F%2F%20result.protocol%20has%20already%20been%20set%20by%20now.%0A%20%20%2F%2F%20Later%20on%2C%20put%20the%20first%20path%20part%20into%20the%20host%20field.%0A%20%20if%20(psychotic)%20%7B%0A%20%20%20%20result.hostname%20%3D%20''%3B%0A%20%20%20%20result.port%20%3D%20null%3B%0A%20%20%20%20if%20(result.host)%20%7B%0A%20%20%20%20%20%20if%20(srcPath%5B0%5D%20%3D%3D%3D%20'')%20srcPath%5B0%5D%20%3D%20result.host%3B%0A%20%20%20%20%20%20else%20srcPath.unshift(result.host)%3B%0A%20%20%20%20%7D%0A%20%20%20%20result.host%20%3D%20''%3B%0A%20%20%20%20if%20(relative.protocol)%20%7B%0A%20%20%20%20%20%20relative.hostname%20%3D%20null%3B%0A%20%20%20%20%20%20relative.port%20%3D%20null%3B%0A%20%20%20%20%20%20if%20(relative.host)%20%7B%0A%20%20%20%20%20%20%20%20if%20(relPath%5B0%5D%20%3D%3D%3D%20'')%20relPath%5B0%5D%20%3D%20relative.host%3B%0A%20%20%20%20%20%20%20%20else%20relPath.unshift(relative.host)%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20relative.host%20%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20mustEndAbs%20%3D%20mustEndAbs%20%26%26%20(relPath%5B0%5D%20%3D%3D%3D%20''%20%7C%7C%20srcPath%5B0%5D%20%3D%3D%3D%20'')%3B%0A%20%20%7D%0A%0A%20%20if%20(isRelAbs)%20%7B%0A%20%20%20%20%2F%2F%20it's%20absolute.%0A%20%20%20%20result.host%20%3D%20(relative.host%20%7C%7C%20relative.host%20%3D%3D%3D%20'')%20%3F%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20relative.host%20%3A%20result.host%3B%0A%20%20%20%20result.hostname%20%3D%20(relative.hostname%20%7C%7C%20relative.hostname%20%3D%3D%3D%20'')%20%3F%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20relative.hostname%20%3A%20result.hostname%3B%0A%20%20%20%20result.search%20%3D%20relative.search%3B%0A%20%20%20%20result.query%20%3D%20relative.query%3B%0A%20%20%20%20srcPath%20%3D%20relPath%3B%0A%20%20%20%20%2F%2F%20fall%20through%20to%20the%20dot-handling%20below.%0A%20%20%7D%20else%20if%20(relPath.length)%20%7B%0A%20%20%20%20%2F%2F%20it's%20relative%0A%20%20%20%20%2F%2F%20throw%20away%20the%20existing%20file%2C%20and%20take%20the%20new%20path%20instead.%0A%20%20%20%20if%20(!srcPath)%20srcPath%20%3D%20%5B%5D%3B%0A%20%20%20%20srcPath.pop()%3B%0A%20%20%20%20srcPath%20%3D%20srcPath.concat(relPath)%3B%0A%20%20%20%20result.search%20%3D%20relative.search%3B%0A%20%20%20%20result.query%20%3D%20relative.query%3B%0A%20%20%7D%20else%20if%20(!isNullOrUndefined(relative.search))%20%7B%0A%20%20%20%20%2F%2F%20just%20pull%20out%20the%20search.%0A%20%20%20%20%2F%2F%20like%20href%3D'%3Ffoo'.%0A%20%20%20%20%2F%2F%20Put%20this%20after%20the%20other%20two%20cases%20because%20it%20simplifies%20the%20booleans%0A%20%20%20%20if%20(psychotic)%20%7B%0A%20%20%20%20%20%20result.hostname%20%3D%20result.host%20%3D%20srcPath.shift()%3B%0A%20%20%20%20%20%20%2F%2Foccationaly%20the%20auth%20can%20get%20stuck%20only%20in%20host%0A%20%20%20%20%20%20%2F%2Fthis%20especialy%20happens%20in%20cases%20like%0A%20%20%20%20%20%20%2F%2Furl.resolveObject('mailto%3Alocal1%40domain1'%2C%20'local2%40domain2')%0A%20%20%20%20%20%20var%20authInHost%20%3D%20result.host%20%26%26%20result.host.indexOf('%40')%20%3E%200%20%3F%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20result.host.split('%40')%20%3A%20false%3B%0A%20%20%20%20%20%20if%20(authInHost)%20%7B%0A%20%20%20%20%20%20%20%20result.auth%20%3D%20authInHost.shift()%3B%0A%20%20%20%20%20%20%20%20result.host%20%3D%20result.hostname%20%3D%20authInHost.shift()%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20result.search%20%3D%20relative.search%3B%0A%20%20%20%20result.query%20%3D%20relative.query%3B%0A%20%20%20%20%2F%2Fto%20support%20http.request%0A%20%20%20%20if%20(!isNull(result.pathname)%20%7C%7C%20!isNull(result.search))%20%7B%0A%20%20%20%20%20%20result.path%20%3D%20(result.pathname%20%3F%20result.pathname%20%3A%20'')%20%2B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(result.search%20%3F%20result.search%20%3A%20'')%3B%0A%20%20%20%20%7D%0A%20%20%20%20result.href%20%3D%20result.format()%3B%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%0A%20%20if%20(!srcPath.length)%20%7B%0A%20%20%20%20%2F%2F%20no%20path%20at%20all.%20%20easy.%0A%20%20%20%20%2F%2F%20we've%20already%20handled%20the%20other%20stuff%20above.%0A%20%20%20%20result.pathname%20%3D%20null%3B%0A%20%20%20%20%2F%2Fto%20support%20http.request%0A%20%20%20%20if%20(result.search)%20%7B%0A%20%20%20%20%20%20result.path%20%3D%20'%2F'%20%2B%20result.search%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20result.path%20%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20result.href%20%3D%20result.format()%3B%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20if%20a%20url%20ENDs%20in%20.%20or%20..%2C%20then%20it%20must%20get%20a%20trailing%20slash.%0A%20%20%2F%2F%20however%2C%20if%20it%20ends%20in%20anything%20else%20non-slashy%2C%0A%20%20%2F%2F%20then%20it%20must%20NOT%20get%20a%20trailing%20slash.%0A%20%20var%20last%20%3D%20srcPath.slice(-1)%5B0%5D%3B%0A%20%20var%20hasTrailingSlash%20%3D%20(%0A%20%20%20%20%20%20(result.host%20%7C%7C%20relative.host)%20%26%26%20(last%20%3D%3D%3D%20'.'%20%7C%7C%20last%20%3D%3D%3D%20'..')%20%7C%7C%0A%20%20%20%20%20%20last%20%3D%3D%3D%20'')%3B%0A%0A%20%20%2F%2F%20strip%20single%20dots%2C%20resolve%20double%20dots%20to%20parent%20dir%0A%20%20%2F%2F%20if%20the%20path%20tries%20to%20go%20above%20the%20root%2C%20%60up%60%20ends%20up%20%3E%200%0A%20%20var%20up%20%3D%200%3B%0A%20%20for%20(var%20i%20%3D%20srcPath.length%3B%20i%20%3E%3D%200%3B%20i--)%20%7B%0A%20%20%20%20last%20%3D%20srcPath%5Bi%5D%3B%0A%20%20%20%20if%20(last%20%3D%3D%20'.')%20%7B%0A%20%20%20%20%20%20srcPath.splice(i%2C%201)%3B%0A%20%20%20%20%7D%20else%20if%20(last%20%3D%3D%3D%20'..')%20%7B%0A%20%20%20%20%20%20srcPath.splice(i%2C%201)%3B%0A%20%20%20%20%20%20up%2B%2B%3B%0A%20%20%20%20%7D%20else%20if%20(up)%20%7B%0A%20%20%20%20%20%20srcPath.splice(i%2C%201)%3B%0A%20%20%20%20%20%20up--%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%20if%20the%20path%20is%20allowed%20to%20go%20above%20the%20root%2C%20restore%20leading%20..s%0A%20%20if%20(!mustEndAbs%20%26%26%20!removeAllDots)%20%7B%0A%20%20%20%20for%20(%3B%20up--%3B%20up)%20%7B%0A%20%20%20%20%20%20srcPath.unshift('..')%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20if%20(mustEndAbs%20%26%26%20srcPath%5B0%5D%20!%3D%3D%20''%20%26%26%0A%20%20%20%20%20%20(!srcPath%5B0%5D%20%7C%7C%20srcPath%5B0%5D.charAt(0)%20!%3D%3D%20'%2F'))%20%7B%0A%20%20%20%20srcPath.unshift('')%3B%0A%20%20%7D%0A%0A%20%20if%20(hasTrailingSlash%20%26%26%20(srcPath.join('%2F').substr(-1)%20!%3D%3D%20'%2F'))%20%7B%0A%20%20%20%20srcPath.push('')%3B%0A%20%20%7D%0A%0A%20%20var%20isAbsolute%20%3D%20srcPath%5B0%5D%20%3D%3D%3D%20''%20%7C%7C%0A%20%20%20%20%20%20(srcPath%5B0%5D%20%26%26%20srcPath%5B0%5D.charAt(0)%20%3D%3D%3D%20'%2F')%3B%0A%0A%20%20%2F%2F%20put%20the%20host%20back%0A%20%20if%20(psychotic)%20%7B%0A%20%20%20%20result.hostname%20%3D%20result.host%20%3D%20isAbsolute%20%3F%20''%20%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20srcPath.length%20%3F%20srcPath.shift()%20%3A%20''%3B%0A%20%20%20%20%2F%2Foccationaly%20the%20auth%20can%20get%20stuck%20only%20in%20host%0A%20%20%20%20%2F%2Fthis%20especialy%20happens%20in%20cases%20like%0A%20%20%20%20%2F%2Furl.resolveObject('mailto%3Alocal1%40domain1'%2C%20'local2%40domain2')%0A%20%20%20%20var%20authInHost%20%3D%20result.host%20%26%26%20result.host.indexOf('%40')%20%3E%200%20%3F%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20result.host.split('%40')%20%3A%20false%3B%0A%20%20%20%20if%20(authInHost)%20%7B%0A%20%20%20%20%20%20result.auth%20%3D%20authInHost.shift()%3B%0A%20%20%20%20%20%20result.host%20%3D%20result.hostname%20%3D%20authInHost.shift()%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20mustEndAbs%20%3D%20mustEndAbs%20%7C%7C%20(result.host%20%26%26%20srcPath.length)%3B%0A%0A%20%20if%20(mustEndAbs%20%26%26%20!isAbsolute)%20%7B%0A%20%20%20%20srcPath.unshift('')%3B%0A%20%20%7D%0A%0A%20%20if%20(!srcPath.length)%20%7B%0A%20%20%20%20result.pathname%20%3D%20null%3B%0A%20%20%20%20result.path%20%3D%20null%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20result.pathname%20%3D%20srcPath.join('%2F')%3B%0A%20%20%7D%0A%0A%20%20%2F%2Fto%20support%20request.http%0A%20%20if%20(!isNull(result.pathname)%20%7C%7C%20!isNull(result.search))%20%7B%0A%20%20%20%20result.path%20%3D%20(result.pathname%20%3F%20result.pathname%20%3A%20'')%20%2B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(result.search%20%3F%20result.search%20%3A%20'')%3B%0A%20%20%7D%0A%20%20result.auth%20%3D%20relative.auth%20%7C%7C%20result.auth%3B%0A%20%20result.slashes%20%3D%20result.slashes%20%7C%7C%20relative.slashes%3B%0A%20%20result.href%20%3D%20result.format()%3B%0A%20%20return%20result%3B%0A%7D%3B%0A%0AUrl.prototype.parseHost%20%3D%20function()%20%7B%0A%20%20var%20host%20%3D%20this.host%3B%0A%20%20var%20port%20%3D%20portPattern.exec(host)%3B%0A%20%20if%20(port)%20%7B%0A%20%20%20%20port%20%3D%20port%5B0%5D%3B%0A%20%20%20%20if%20(port%20!%3D%3D%20'%3A')%20%7B%0A%20%20%20%20%20%20this.port%20%3D%20port.substr(1)%3B%0A%20%20%20%20%7D%0A%20%20%20%20host%20%3D%20host.substr(0%2C%20host.length%20-%20port.length)%3B%0A%20%20%7D%0A%20%20if%20(host)%20this.hostname%20%3D%20host%3B%0A%7D%3B%0A%0Afunction%20isString(arg)%20%7B%0A%20%20return%20typeof%20arg%20%3D%3D%3D%20%22string%22%3B%0A%7D%0A%0Afunction%20isObject(arg)%20%7B%0A%20%20return%20typeof%20arg%20%3D%3D%3D%20'object'%20%26%26%20arg%20!%3D%3D%20null%3B%0A%7D%0A%0Afunction%20isNull(arg)%20%7B%0A%20%20return%20arg%20%3D%3D%3D%20null%3B%0A%7D%0Afunction%20isNullOrUndefined(arg)%20%7B%0A%20%20return%20%20arg%20%3D%3D%20null%3B%0A%7D%0A%0A%7D%2C%7B%22punycode%22%3A4%2C%22querystring%22%3A7%7D%5D%2C9%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A'use%20strict'%3B%0A%0Amodule.exports%20%3D%20earcut%3B%0A%0Afunction%20earcut(data%2C%20holeIndices%2C%20dim)%20%7B%0A%0A%20%20%20%20dim%20%3D%20dim%20%7C%7C%202%3B%0A%0A%20%20%20%20var%20hasHoles%20%3D%20holeIndices%20%26%26%20holeIndices.length%2C%0A%20%20%20%20%20%20%20%20outerLen%20%3D%20hasHoles%20%3F%20holeIndices%5B0%5D%20*%20dim%20%3A%20data.length%2C%0A%20%20%20%20%20%20%20%20outerNode%20%3D%20filterPoints(data%2C%20linkedList(data%2C%200%2C%20outerLen%2C%20dim%2C%20true))%2C%0A%20%20%20%20%20%20%20%20triangles%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20if%20(!outerNode)%20return%20triangles%3B%0A%0A%20%20%20%20var%20minX%2C%20minY%2C%20maxX%2C%20maxY%2C%20x%2C%20y%2C%20size%3B%0A%0A%20%20%20%20if%20(hasHoles)%20outerNode%20%3D%20eliminateHoles(data%2C%20holeIndices%2C%20outerNode%2C%20dim)%3B%0A%0A%20%20%20%20%2F%2F%20if%20the%20shape%20is%20not%20too%20simple%2C%20we'll%20use%20z-order%20curve%20hash%20later%3B%20calculate%20polygon%20bbox%0A%20%20%20%20if%20(data.length%20%3E%2080%20*%20dim)%20%7B%0A%20%20%20%20%20%20%20%20minX%20%3D%20maxX%20%3D%20data%5B0%5D%3B%0A%20%20%20%20%20%20%20%20minY%20%3D%20maxY%20%3D%20data%5B1%5D%3B%0A%0A%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%20dim%3B%20i%20%3C%20outerLen%3B%20i%20%2B%3D%20dim)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20x%20%3D%20data%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20y%20%3D%20data%5Bi%20%2B%201%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(x%20%3C%20minX)%20minX%20%3D%20x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(y%20%3C%20minY)%20minY%20%3D%20y%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(x%20%3E%20maxX)%20maxX%20%3D%20x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(y%20%3E%20maxY)%20maxY%20%3D%20y%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20minX%2C%20minY%20and%20size%20are%20later%20used%20to%20transform%20coords%20into%20integers%20for%20z-order%20calculation%0A%20%20%20%20%20%20%20%20size%20%3D%20Math.max(maxX%20-%20minX%2C%20maxY%20-%20minY)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20earcutLinked(data%2C%20outerNode%2C%20triangles%2C%20dim%2C%20minX%2C%20minY%2C%20size)%3B%0A%0A%20%20%20%20return%20triangles%3B%0A%7D%0A%0A%2F%2F%20create%20a%20circular%20doubly%20linked%20list%20from%20polygon%20points%20in%20the%20specified%20winding%20order%0Afunction%20linkedList(data%2C%20start%2C%20end%2C%20dim%2C%20clockwise)%20%7B%0A%20%20%20%20var%20sum%20%3D%200%2C%0A%20%20%20%20%20%20%20%20i%2C%20j%2C%20last%3B%0A%0A%20%20%20%20%2F%2F%20calculate%20original%20winding%20order%20of%20a%20polygon%20ring%0A%20%20%20%20for%20(i%20%3D%20start%2C%20j%20%3D%20end%20-%20dim%3B%20i%20%3C%20end%3B%20i%20%2B%3D%20dim)%20%7B%0A%20%20%20%20%20%20%20%20sum%20%2B%3D%20(data%5Bj%5D%20-%20data%5Bi%5D)%20*%20(data%5Bi%20%2B%201%5D%20%2B%20data%5Bj%20%2B%201%5D)%3B%0A%20%20%20%20%20%20%20%20j%20%3D%20i%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20link%20points%20into%20circular%20doubly-linked%20list%20in%20the%20specified%20winding%20order%0A%20%20%20%20if%20(clockwise%20%3D%3D%3D%20(sum%20%3E%200))%20%7B%0A%20%20%20%20%20%20%20%20for%20(i%20%3D%20start%3B%20i%20%3C%20end%3B%20i%20%2B%3D%20dim)%20last%20%3D%20insertNode(i%2C%20last)%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20for%20(i%20%3D%20end%20-%20dim%3B%20i%20%3E%3D%20start%3B%20i%20-%3D%20dim)%20last%20%3D%20insertNode(i%2C%20last)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20last%3B%0A%7D%0A%0A%2F%2F%20eliminate%20colinear%20or%20duplicate%20points%0Afunction%20filterPoints(data%2C%20start%2C%20end)%20%7B%0A%20%20%20%20if%20(!end)%20end%20%3D%20start%3B%0A%0A%20%20%20%20var%20node%20%3D%20start%2C%0A%20%20%20%20%20%20%20%20again%3B%0A%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20again%20%3D%20false%3B%0A%0A%20%20%20%20%20%20%20%20if%20(!node.steiner%20%26%26%20(equals(data%2C%20node.i%2C%20node.next.i)%20%7C%7C%20orient(data%2C%20node.prev.i%2C%20node.i%2C%20node.next.i)%20%3D%3D%3D%200))%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20remove%20node%0A%20%20%20%20%20%20%20%20%20%20%20%20node.prev.next%20%3D%20node.next%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20node.next.prev%20%3D%20node.prev%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(node.prevZ)%20node.prevZ.nextZ%20%3D%20node.nextZ%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(node.nextZ)%20node.nextZ.prevZ%20%3D%20node.prevZ%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20node%20%3D%20end%20%3D%20node.prev%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(node%20%3D%3D%3D%20node.next)%20return%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20again%20%3D%20true%3B%0A%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20node%20%3D%20node.next%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20while%20(again%20%7C%7C%20node%20!%3D%3D%20end)%3B%0A%0A%20%20%20%20return%20end%3B%0A%7D%0A%0A%2F%2F%20main%20ear%20slicing%20loop%20which%20triangulates%20a%20polygon%20(given%20as%20a%20linked%20list)%0Afunction%20earcutLinked(data%2C%20ear%2C%20triangles%2C%20dim%2C%20minX%2C%20minY%2C%20size%2C%20pass)%20%7B%0A%20%20%20%20if%20(!ear)%20return%3B%0A%0A%20%20%20%20%2F%2F%20interlink%20polygon%20nodes%20in%20z-order%0A%20%20%20%20if%20(!pass%20%26%26%20minX%20!%3D%3D%20undefined)%20indexCurve(data%2C%20ear%2C%20minX%2C%20minY%2C%20size)%3B%0A%0A%20%20%20%20var%20stop%20%3D%20ear%2C%0A%20%20%20%20%20%20%20%20prev%2C%20next%3B%0A%0A%20%20%20%20%2F%2F%20iterate%20through%20ears%2C%20slicing%20them%20one%20by%20one%0A%20%20%20%20while%20(ear.prev%20!%3D%3D%20ear.next)%20%7B%0A%20%20%20%20%20%20%20%20prev%20%3D%20ear.prev%3B%0A%20%20%20%20%20%20%20%20next%20%3D%20ear.next%3B%0A%0A%20%20%20%20%20%20%20%20if%20(isEar(data%2C%20ear%2C%20minX%2C%20minY%2C%20size))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20cut%20off%20the%20triangle%0A%20%20%20%20%20%20%20%20%20%20%20%20triangles.push(prev.i%20%2F%20dim)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20triangles.push(ear.i%20%2F%20dim)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20triangles.push(next.i%20%2F%20dim)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20remove%20ear%20node%0A%20%20%20%20%20%20%20%20%20%20%20%20next.prev%20%3D%20prev%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20prev.next%20%3D%20next%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(ear.prevZ)%20ear.prevZ.nextZ%20%3D%20ear.nextZ%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(ear.nextZ)%20ear.nextZ.prevZ%20%3D%20ear.prevZ%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20skipping%20the%20next%20vertice%20leads%20to%20less%20sliver%20triangles%0A%20%20%20%20%20%20%20%20%20%20%20%20ear%20%3D%20next.next%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20stop%20%3D%20next.next%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20ear%20%3D%20next%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20if%20we%20looped%20through%20the%20whole%20remaining%20polygon%20and%20can't%20find%20any%20more%20ears%0A%20%20%20%20%20%20%20%20if%20(ear%20%3D%3D%3D%20stop)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20try%20filtering%20points%20and%20slicing%20again%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!pass)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20earcutLinked(data%2C%20filterPoints(data%2C%20ear)%2C%20triangles%2C%20dim%2C%20minX%2C%20minY%2C%20size%2C%201)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20if%20this%20didn't%20work%2C%20try%20curing%20all%20small%20self-intersections%20locally%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20(pass%20%3D%3D%3D%201)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ear%20%3D%20cureLocalIntersections(data%2C%20ear%2C%20triangles%2C%20dim)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20earcutLinked(data%2C%20ear%2C%20triangles%2C%20dim%2C%20minX%2C%20minY%2C%20size%2C%202)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20as%20a%20last%20resort%2C%20try%20splitting%20the%20remaining%20polygon%20into%20two%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20(pass%20%3D%3D%3D%202)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20splitEarcut(data%2C%20ear%2C%20triangles%2C%20dim%2C%20minX%2C%20minY%2C%20size)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%0A%0A%2F%2F%20check%20whether%20a%20polygon%20node%20forms%20a%20valid%20ear%20with%20adjacent%20nodes%0Afunction%20isEar(data%2C%20ear%2C%20minX%2C%20minY%2C%20size)%20%7B%0A%0A%20%20%20%20var%20a%20%3D%20ear.prev.i%2C%0A%20%20%20%20%20%20%20%20b%20%3D%20ear.i%2C%0A%20%20%20%20%20%20%20%20c%20%3D%20ear.next.i%2C%0A%0A%20%20%20%20%20%20%20%20ax%20%3D%20data%5Ba%5D%2C%20ay%20%3D%20data%5Ba%20%2B%201%5D%2C%0A%20%20%20%20%20%20%20%20bx%20%3D%20data%5Bb%5D%2C%20by%20%3D%20data%5Bb%20%2B%201%5D%2C%0A%20%20%20%20%20%20%20%20cx%20%3D%20data%5Bc%5D%2C%20cy%20%3D%20data%5Bc%20%2B%201%5D%2C%0A%0A%20%20%20%20%20%20%20%20abd%20%3D%20ax%20*%20by%20-%20ay%20*%20bx%2C%0A%20%20%20%20%20%20%20%20acd%20%3D%20ax%20*%20cy%20-%20ay%20*%20cx%2C%0A%20%20%20%20%20%20%20%20cbd%20%3D%20cx%20*%20by%20-%20cy%20*%20bx%2C%0A%20%20%20%20%20%20%20%20A%20%3D%20abd%20-%20acd%20-%20cbd%3B%0A%0A%20%20%20%20if%20(A%20%3C%3D%200)%20return%20false%3B%20%2F%2F%20reflex%2C%20can't%20be%20an%20ear%0A%0A%20%20%20%20%2F%2F%20now%20make%20sure%20we%20don't%20have%20other%20points%20inside%20the%20potential%20ear%3B%0A%20%20%20%20%2F%2F%20the%20code%20below%20is%20a%20bit%20verbose%20and%20repetitive%20but%20this%20is%20done%20for%20performance%0A%0A%20%20%20%20var%20cay%20%3D%20cy%20-%20ay%2C%0A%20%20%20%20%20%20%20%20acx%20%3D%20ax%20-%20cx%2C%0A%20%20%20%20%20%20%20%20aby%20%3D%20ay%20-%20by%2C%0A%20%20%20%20%20%20%20%20bax%20%3D%20bx%20-%20ax%2C%0A%20%20%20%20%20%20%20%20i%2C%20px%2C%20py%2C%20s%2C%20t%2C%20k%2C%20node%3B%0A%0A%20%20%20%20%2F%2F%20if%20we%20use%20z-order%20curve%20hashing%2C%20iterate%20through%20the%20curve%0A%20%20%20%20if%20(minX%20!%3D%3D%20undefined)%20%7B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20triangle%20bbox%3B%20min%20%26%20max%20are%20calculated%20like%20this%20for%20speed%0A%20%20%20%20%20%20%20%20var%20minTX%20%3D%20ax%20%3C%20bx%20%3F%20(ax%20%3C%20cx%20%3F%20ax%20%3A%20cx)%20%3A%20(bx%20%3C%20cx%20%3F%20bx%20%3A%20cx)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20minTY%20%3D%20ay%20%3C%20by%20%3F%20(ay%20%3C%20cy%20%3F%20ay%20%3A%20cy)%20%3A%20(by%20%3C%20cy%20%3F%20by%20%3A%20cy)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20maxTX%20%3D%20ax%20%3E%20bx%20%3F%20(ax%20%3E%20cx%20%3F%20ax%20%3A%20cx)%20%3A%20(bx%20%3E%20cx%20%3F%20bx%20%3A%20cx)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20maxTY%20%3D%20ay%20%3E%20by%20%3F%20(ay%20%3E%20cy%20%3F%20ay%20%3A%20cy)%20%3A%20(by%20%3E%20cy%20%3F%20by%20%3A%20cy)%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20z-order%20range%20for%20the%20current%20triangle%20bbox%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20minZ%20%3D%20zOrder(minTX%2C%20minTY%2C%20minX%2C%20minY%2C%20size)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20maxZ%20%3D%20zOrder(maxTX%2C%20maxTY%2C%20minX%2C%20minY%2C%20size)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20first%20look%20for%20points%20inside%20the%20triangle%20in%20increasing%20z-order%0A%20%20%20%20%20%20%20%20node%20%3D%20ear.nextZ%3B%0A%0A%20%20%20%20%20%20%20%20while%20(node%20%26%26%20node.z%20%3C%3D%20maxZ)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20i%20%3D%20node.i%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20node%20%3D%20node.nextZ%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(i%20%3D%3D%3D%20a%20%7C%7C%20i%20%3D%3D%3D%20c)%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20px%20%3D%20data%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20py%20%3D%20data%5Bi%20%2B%201%5D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20s%20%3D%20cay%20*%20px%20%2B%20acx%20*%20py%20-%20acd%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(s%20%3E%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20t%20%3D%20aby%20*%20px%20%2B%20bax%20*%20py%20%2B%20abd%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(t%20%3E%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20k%20%3D%20A%20-%20s%20-%20t%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20((k%20%3E%3D%200)%20%26%26%20((s%20%26%26%20t)%20%7C%7C%20(s%20%26%26%20k)%20%7C%7C%20(t%20%26%26%20k)))%20return%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20then%20look%20for%20points%20in%20decreasing%20z-order%0A%20%20%20%20%20%20%20%20node%20%3D%20ear.prevZ%3B%0A%0A%20%20%20%20%20%20%20%20while%20(node%20%26%26%20node.z%20%3E%3D%20minZ)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20i%20%3D%20node.i%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20node%20%3D%20node.prevZ%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(i%20%3D%3D%3D%20a%20%7C%7C%20i%20%3D%3D%3D%20c)%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20px%20%3D%20data%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20py%20%3D%20data%5Bi%20%2B%201%5D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20s%20%3D%20cay%20*%20px%20%2B%20acx%20*%20py%20-%20acd%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(s%20%3E%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20t%20%3D%20aby%20*%20px%20%2B%20bax%20*%20py%20%2B%20abd%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(t%20%3E%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20k%20%3D%20A%20-%20s%20-%20t%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20((k%20%3E%3D%200)%20%26%26%20((s%20%26%26%20t)%20%7C%7C%20(s%20%26%26%20k)%20%7C%7C%20(t%20%26%26%20k)))%20return%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20if%20we%20don't%20use%20z-order%20curve%20hash%2C%20simply%20iterate%20through%20all%20other%20points%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20ear.next.next%3B%0A%0A%20%20%20%20%20%20%20%20while%20(node%20!%3D%3D%20ear.prev)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20i%20%3D%20node.i%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20node%20%3D%20node.next%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20px%20%3D%20data%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20py%20%3D%20data%5Bi%20%2B%201%5D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20s%20%3D%20cay%20*%20px%20%2B%20acx%20*%20py%20-%20acd%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(s%20%3E%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20t%20%3D%20aby%20*%20px%20%2B%20bax%20*%20py%20%2B%20abd%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(t%20%3E%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20k%20%3D%20A%20-%20s%20-%20t%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20((k%20%3E%3D%200)%20%26%26%20((s%20%26%26%20t)%20%7C%7C%20(s%20%26%26%20k)%20%7C%7C%20(t%20%26%26%20k)))%20return%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20true%3B%0A%7D%0A%0A%2F%2F%20go%20through%20all%20polygon%20nodes%20and%20cure%20small%20local%20self-intersections%0Afunction%20cureLocalIntersections(data%2C%20start%2C%20triangles%2C%20dim)%20%7B%0A%20%20%20%20var%20node%20%3D%20start%3B%0A%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20var%20a%20%3D%20node.prev%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20b%20%3D%20node.next.next%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20a%20self-intersection%20where%20edge%20(v%5Bi-1%5D%2Cv%5Bi%5D)%20intersects%20(v%5Bi%2B1%5D%2Cv%5Bi%2B2%5D)%0A%20%20%20%20%20%20%20%20if%20(a.i%20!%3D%3D%20b.i%20%26%26%20intersects(data%2C%20a.i%2C%20node.i%2C%20node.next.i%2C%20b.i)%20%26%26%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20locallyInside(data%2C%20a%2C%20b)%20%26%26%20locallyInside(data%2C%20b%2C%20a))%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20triangles.push(a.i%20%2F%20dim)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20triangles.push(node.i%20%2F%20dim)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20triangles.push(b.i%20%2F%20dim)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20remove%20two%20nodes%20involved%0A%20%20%20%20%20%20%20%20%20%20%20%20a.next%20%3D%20b%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20b.prev%20%3D%20a%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20az%20%3D%20node.prevZ%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bz%20%3D%20node.nextZ%20%26%26%20node.nextZ.nextZ%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(az)%20az.nextZ%20%3D%20bz%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(bz)%20bz.prevZ%20%3D%20az%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20node%20%3D%20start%20%3D%20b%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20node%20%3D%20node.next%3B%0A%20%20%20%20%7D%20while%20(node%20!%3D%3D%20start)%3B%0A%0A%20%20%20%20return%20node%3B%0A%7D%0A%0A%2F%2F%20try%20splitting%20polygon%20into%20two%20and%20triangulate%20them%20independently%0Afunction%20splitEarcut(data%2C%20start%2C%20triangles%2C%20dim%2C%20minX%2C%20minY%2C%20size)%20%7B%0A%20%20%20%20%2F%2F%20look%20for%20a%20valid%20diagonal%20that%20divides%20the%20polygon%20into%20two%0A%20%20%20%20var%20a%20%3D%20start%3B%0A%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20var%20b%20%3D%20a.next.next%3B%0A%20%20%20%20%20%20%20%20while%20(b%20!%3D%3D%20a.prev)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(a.i%20!%3D%3D%20b.i%20%26%26%20isValidDiagonal(data%2C%20a%2C%20b))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20split%20the%20polygon%20in%20two%20by%20the%20diagonal%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20c%20%3D%20splitPolygon(a%2C%20b)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20filter%20colinear%20points%20around%20the%20cuts%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20a%20%3D%20filterPoints(data%2C%20a%2C%20a.next)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20c%20%3D%20filterPoints(data%2C%20c%2C%20c.next)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20run%20earcut%20on%20each%20half%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20earcutLinked(data%2C%20a%2C%20triangles%2C%20dim%2C%20minX%2C%20minY%2C%20size)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20earcutLinked(data%2C%20c%2C%20triangles%2C%20dim%2C%20minX%2C%20minY%2C%20size)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20b%20%3D%20b.next%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20a%20%3D%20a.next%3B%0A%20%20%20%20%7D%20while%20(a%20!%3D%3D%20start)%3B%0A%7D%0A%0A%2F%2F%20link%20every%20hole%20into%20the%20outer%20loop%2C%20producing%20a%20single-ring%20polygon%20without%20holes%0Afunction%20eliminateHoles(data%2C%20holeIndices%2C%20outerNode%2C%20dim)%20%7B%0A%20%20%20%20var%20queue%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20i%2C%20len%2C%20start%2C%20end%2C%20list%3B%0A%0A%20%20%20%20for%20(i%20%3D%200%2C%20len%20%3D%20holeIndices.length%3B%20i%20%3C%20len%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20start%20%3D%20holeIndices%5Bi%5D%20*%20dim%3B%0A%20%20%20%20%20%20%20%20end%20%3D%20i%20%3C%20len%20-%201%20%3F%20holeIndices%5Bi%20%2B%201%5D%20*%20dim%20%3A%20data.length%3B%0A%20%20%20%20%20%20%20%20list%20%3D%20linkedList(data%2C%20start%2C%20end%2C%20dim%2C%20false)%3B%0A%20%20%20%20%20%20%20%20if%20(list%20%3D%3D%3D%20list.next)%20list.steiner%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20list%20%3D%20filterPoints(data%2C%20list)%3B%0A%20%20%20%20%20%20%20%20if%20(list)%20queue.push(getLeftmost(data%2C%20list))%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20queue.sort(function%20(a%2C%20b)%20%7B%0A%20%20%20%20%20%20%20%20return%20data%5Ba.i%5D%20-%20data%5Bb.i%5D%3B%0A%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%2F%2F%20process%20holes%20from%20left%20to%20right%0A%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20queue.length%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20eliminateHole(data%2C%20queue%5Bi%5D%2C%20outerNode)%3B%0A%20%20%20%20%20%20%20%20outerNode%20%3D%20filterPoints(data%2C%20outerNode%2C%20outerNode.next)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20outerNode%3B%0A%7D%0A%0A%2F%2F%20find%20a%20bridge%20between%20vertices%20that%20connects%20hole%20with%20an%20outer%20ring%20and%20and%20link%20it%0Afunction%20eliminateHole(data%2C%20holeNode%2C%20outerNode)%20%7B%0A%20%20%20%20outerNode%20%3D%20findHoleBridge(data%2C%20holeNode%2C%20outerNode)%3B%0A%20%20%20%20if%20(outerNode)%20%7B%0A%20%20%20%20%20%20%20%20var%20b%20%3D%20splitPolygon(outerNode%2C%20holeNode)%3B%0A%20%20%20%20%20%20%20%20filterPoints(data%2C%20b%2C%20b.next)%3B%0A%20%20%20%20%7D%0A%7D%0A%0A%2F%2F%20David%20Eberly's%20algorithm%20for%20finding%20a%20bridge%20between%20hole%20and%20outer%20polygon%0Afunction%20findHoleBridge(data%2C%20holeNode%2C%20outerNode)%20%7B%0A%20%20%20%20var%20node%20%3D%20outerNode%2C%0A%20%20%20%20%20%20%20%20i%20%3D%20holeNode.i%2C%0A%20%20%20%20%20%20%20%20px%20%3D%20data%5Bi%5D%2C%0A%20%20%20%20%20%20%20%20py%20%3D%20data%5Bi%20%2B%201%5D%2C%0A%20%20%20%20%20%20%20%20qMax%20%3D%20-Infinity%2C%0A%20%20%20%20%20%20%20%20mNode%2C%20a%2C%20b%3B%0A%0A%20%20%20%20%2F%2F%20find%20a%20segment%20intersected%20by%20a%20ray%20from%20the%20hole's%20leftmost%20point%20to%20the%20left%3B%0A%20%20%20%20%2F%2F%20segment's%20endpoint%20with%20lesser%20x%20will%20be%20potential%20connection%20point%0A%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20a%20%3D%20node.i%3B%0A%20%20%20%20%20%20%20%20b%20%3D%20node.next.i%3B%0A%0A%20%20%20%20%20%20%20%20if%20(py%20%3C%3D%20data%5Ba%20%2B%201%5D%20%26%26%20py%20%3E%3D%20data%5Bb%20%2B%201%5D)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20qx%20%3D%20data%5Ba%5D%20%2B%20(py%20-%20data%5Ba%20%2B%201%5D)%20*%20(data%5Bb%5D%20-%20data%5Ba%5D)%20%2F%20(data%5Bb%20%2B%201%5D%20-%20data%5Ba%20%2B%201%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(qx%20%3C%3D%20px%20%26%26%20qx%20%3E%20qMax)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20qMax%20%3D%20qx%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mNode%20%3D%20data%5Ba%5D%20%3C%20data%5Bb%5D%20%3F%20node%20%3A%20node.next%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20node%20%3D%20node.next%3B%0A%20%20%20%20%7D%20while%20(node%20!%3D%3D%20outerNode)%3B%0A%0A%20%20%20%20if%20(!mNode)%20return%20null%3B%0A%0A%20%20%20%20%2F%2F%20look%20for%20points%20strictly%20inside%20the%20triangle%20of%20hole%20point%2C%20segment%20intersection%20and%20endpoint%3B%0A%20%20%20%20%2F%2F%20if%20there%20are%20no%20points%20found%2C%20we%20have%20a%20valid%20connection%3B%0A%20%20%20%20%2F%2F%20otherwise%20choose%20the%20point%20of%20the%20minimum%20angle%20with%20the%20ray%20as%20connection%20point%0A%0A%20%20%20%20var%20bx%20%3D%20data%5BmNode.i%5D%2C%0A%20%20%20%20%20%20%20%20by%20%3D%20data%5BmNode.i%20%2B%201%5D%2C%0A%20%20%20%20%20%20%20%20pbd%20%3D%20px%20*%20by%20-%20py%20*%20bx%2C%0A%20%20%20%20%20%20%20%20pcd%20%3D%20px%20*%20py%20-%20py%20*%20qMax%2C%0A%20%20%20%20%20%20%20%20cpy%20%3D%20py%20-%20py%2C%0A%20%20%20%20%20%20%20%20pcx%20%3D%20px%20-%20qMax%2C%0A%20%20%20%20%20%20%20%20pby%20%3D%20py%20-%20by%2C%0A%20%20%20%20%20%20%20%20bpx%20%3D%20bx%20-%20px%2C%0A%20%20%20%20%20%20%20%20A%20%3D%20pbd%20-%20pcd%20-%20(qMax%20*%20by%20-%20py%20*%20bx)%2C%0A%20%20%20%20%20%20%20%20sign%20%3D%20A%20%3C%3D%200%20%3F%20-1%20%3A%201%2C%0A%20%20%20%20%20%20%20%20stop%20%3D%20mNode%2C%0A%20%20%20%20%20%20%20%20tanMin%20%3D%20Infinity%2C%0A%20%20%20%20%20%20%20%20mx%2C%20my%2C%20amx%2C%20s%2C%20t%2C%20tan%3B%0A%0A%20%20%20%20node%20%3D%20mNode.next%3B%0A%0A%20%20%20%20while%20(node%20!%3D%3D%20stop)%20%7B%0A%0A%20%20%20%20%20%20%20%20mx%20%3D%20data%5Bnode.i%5D%3B%0A%20%20%20%20%20%20%20%20my%20%3D%20data%5Bnode.i%20%2B%201%5D%3B%0A%20%20%20%20%20%20%20%20amx%20%3D%20px%20-%20mx%3B%0A%0A%20%20%20%20%20%20%20%20if%20(amx%20%3E%3D%200%20%26%26%20mx%20%3E%3D%20bx)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20s%20%3D%20(cpy%20*%20mx%20%2B%20pcx%20*%20my%20-%20pcd)%20*%20sign%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(s%20%3E%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20t%20%3D%20(pby%20*%20mx%20%2B%20bpx%20*%20my%20%2B%20pbd)%20*%20sign%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(t%20%3E%3D%200%20%26%26%20A%20*%20sign%20-%20s%20-%20t%20%3E%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20tan%20%3D%20Math.abs(py%20-%20my)%20%2F%20amx%3B%20%2F%2F%20tangential%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(tan%20%3C%20tanMin%20%26%26%20locallyInside(data%2C%20node%2C%20holeNode))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mNode%20%3D%20node%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20tanMin%20%3D%20tan%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20node%20%3D%20node.next%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20mNode%3B%0A%7D%0A%0A%2F%2F%20interlink%20polygon%20nodes%20in%20z-order%0Afunction%20indexCurve(data%2C%20start%2C%20minX%2C%20minY%2C%20size)%20%7B%0A%20%20%20%20var%20node%20%3D%20start%3B%0A%0A%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20if%20(node.z%20%3D%3D%3D%20null)%20node.z%20%3D%20zOrder(data%5Bnode.i%5D%2C%20data%5Bnode.i%20%2B%201%5D%2C%20minX%2C%20minY%2C%20size)%3B%0A%20%20%20%20%20%20%20%20node.prevZ%20%3D%20node.prev%3B%0A%20%20%20%20%20%20%20%20node.nextZ%20%3D%20node.next%3B%0A%20%20%20%20%20%20%20%20node%20%3D%20node.next%3B%0A%20%20%20%20%7D%20while%20(node%20!%3D%3D%20start)%3B%0A%0A%20%20%20%20node.prevZ.nextZ%20%3D%20null%3B%0A%20%20%20%20node.prevZ%20%3D%20null%3B%0A%0A%20%20%20%20sortLinked(node)%3B%0A%7D%0A%0A%2F%2F%20Simon%20Tatham's%20linked%20list%20merge%20sort%20algorithm%0A%2F%2F%20http%3A%2F%2Fwww.chiark.greenend.org.uk%2F~sgtatham%2Falgorithms%2Flistsort.html%0Afunction%20sortLinked(list)%20%7B%0A%20%20%20%20var%20i%2C%20p%2C%20q%2C%20e%2C%20tail%2C%20numMerges%2C%20pSize%2C%20qSize%2C%0A%20%20%20%20%20%20%20%20inSize%20%3D%201%3B%0A%0A%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20p%20%3D%20list%3B%0A%20%20%20%20%20%20%20%20list%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20tail%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20numMerges%20%3D%200%3B%0A%0A%20%20%20%20%20%20%20%20while%20(p)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20numMerges%2B%2B%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20q%20%3D%20p%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20pSize%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20inSize%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pSize%2B%2B%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q%20%3D%20q.nextZ%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!q)%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20qSize%20%3D%20inSize%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20while%20(pSize%20%3E%200%20%7C%7C%20(qSize%20%3E%200%20%26%26%20q))%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(pSize%20%3D%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20e%20%3D%20q%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q%20%3D%20q.nextZ%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20qSize--%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20(qSize%20%3D%3D%3D%200%20%7C%7C%20!q)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20e%20%3D%20p%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20p%20%3D%20p.nextZ%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pSize--%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20(p.z%20%3C%3D%20q.z)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20e%20%3D%20p%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20p%20%3D%20p.nextZ%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pSize--%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20e%20%3D%20q%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q%20%3D%20q.nextZ%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20qSize--%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(tail)%20tail.nextZ%20%3D%20e%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20list%20%3D%20e%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20e.prevZ%20%3D%20tail%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20tail%20%3D%20e%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20p%20%3D%20q%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20tail.nextZ%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20inSize%20*%3D%202%3B%0A%0A%20%20%20%20%7D%20while%20(numMerges%20%3E%201)%3B%0A%0A%20%20%20%20return%20list%3B%0A%7D%0A%0A%2F%2F%20z-order%20of%20a%20point%20given%20coords%20and%20size%20of%20the%20data%20bounding%20box%0Afunction%20zOrder(x%2C%20y%2C%20minX%2C%20minY%2C%20size)%20%7B%0A%20%20%20%20%2F%2F%20coords%20are%20transformed%20into%20(0..1000)%20integer%20range%0A%20%20%20%20x%20%3D%201000%20*%20(x%20-%20minX)%20%2F%20size%3B%0A%20%20%20%20x%20%3D%20(x%20%7C%20(x%20%3C%3C%208))%20%26%200x00FF00FF%3B%0A%20%20%20%20x%20%3D%20(x%20%7C%20(x%20%3C%3C%204))%20%26%200x0F0F0F0F%3B%0A%20%20%20%20x%20%3D%20(x%20%7C%20(x%20%3C%3C%202))%20%26%200x33333333%3B%0A%20%20%20%20x%20%3D%20(x%20%7C%20(x%20%3C%3C%201))%20%26%200x55555555%3B%0A%0A%20%20%20%20y%20%3D%201000%20*%20(y%20-%20minY)%20%2F%20size%3B%0A%20%20%20%20y%20%3D%20(y%20%7C%20(y%20%3C%3C%208))%20%26%200x00FF00FF%3B%0A%20%20%20%20y%20%3D%20(y%20%7C%20(y%20%3C%3C%204))%20%26%200x0F0F0F0F%3B%0A%20%20%20%20y%20%3D%20(y%20%7C%20(y%20%3C%3C%202))%20%26%200x33333333%3B%0A%20%20%20%20y%20%3D%20(y%20%7C%20(y%20%3C%3C%201))%20%26%200x55555555%3B%0A%0A%20%20%20%20return%20x%20%7C%20(y%20%3C%3C%201)%3B%0A%7D%0A%0A%2F%2F%20find%20the%20leftmost%20node%20of%20a%20polygon%20ring%0Afunction%20getLeftmost(data%2C%20start)%20%7B%0A%20%20%20%20var%20node%20%3D%20start%2C%0A%20%20%20%20%20%20%20%20leftmost%20%3D%20start%3B%0A%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20if%20(data%5Bnode.i%5D%20%3C%20data%5Bleftmost.i%5D)%20leftmost%20%3D%20node%3B%0A%20%20%20%20%20%20%20%20node%20%3D%20node.next%3B%0A%20%20%20%20%7D%20while%20(node%20!%3D%3D%20start)%3B%0A%0A%20%20%20%20return%20leftmost%3B%0A%7D%0A%0A%2F%2F%20check%20if%20a%20diagonal%20between%20two%20polygon%20nodes%20is%20valid%20(lies%20in%20polygon%20interior)%0Afunction%20isValidDiagonal(data%2C%20a%2C%20b)%20%7B%0A%20%20%20%20return%20a.next.i%20!%3D%3D%20b.i%20%26%26%20a.prev.i%20!%3D%3D%20b.i%20%26%26%0A%20%20%20%20%20%20%20%20%20%20%20!intersectsPolygon(data%2C%20a%2C%20a.i%2C%20b.i)%20%26%26%0A%20%20%20%20%20%20%20%20%20%20%20locallyInside(data%2C%20a%2C%20b)%20%26%26%20locallyInside(data%2C%20b%2C%20a)%20%26%26%0A%20%20%20%20%20%20%20%20%20%20%20middleInside(data%2C%20a%2C%20a.i%2C%20b.i)%3B%0A%7D%0A%0A%2F%2F%20winding%20order%20of%20triangle%20formed%20by%203%20given%20points%0Afunction%20orient(data%2C%20p%2C%20q%2C%20r)%20%7B%0A%20%20%20%20var%20o%20%3D%20(data%5Bq%20%2B%201%5D%20-%20data%5Bp%20%2B%201%5D)%20*%20(data%5Br%5D%20-%20data%5Bq%5D)%20-%20(data%5Bq%5D%20-%20data%5Bp%5D)%20*%20(data%5Br%20%2B%201%5D%20-%20data%5Bq%20%2B%201%5D)%3B%0A%20%20%20%20return%20o%20%3E%200%20%3F%201%20%3A%0A%20%20%20%20%20%20%20%20%20%20%20o%20%3C%200%20%3F%20-1%20%3A%200%3B%0A%7D%0A%0A%2F%2F%20check%20if%20two%20points%20are%20equal%0Afunction%20equals(data%2C%20p1%2C%20p2)%20%7B%0A%20%20%20%20return%20data%5Bp1%5D%20%3D%3D%3D%20data%5Bp2%5D%20%26%26%20data%5Bp1%20%2B%201%5D%20%3D%3D%3D%20data%5Bp2%20%2B%201%5D%3B%0A%7D%0A%0A%2F%2F%20check%20if%20two%20segments%20intersect%0Afunction%20intersects(data%2C%20p1%2C%20q1%2C%20p2%2C%20q2)%20%7B%0A%20%20%20%20return%20orient(data%2C%20p1%2C%20q1%2C%20p2)%20!%3D%3D%20orient(data%2C%20p1%2C%20q1%2C%20q2)%20%26%26%0A%20%20%20%20%20%20%20%20%20%20%20orient(data%2C%20p2%2C%20q2%2C%20p1)%20!%3D%3D%20orient(data%2C%20p2%2C%20q2%2C%20q1)%3B%0A%7D%0A%0A%2F%2F%20check%20if%20a%20polygon%20diagonal%20intersects%20any%20polygon%20segments%0Afunction%20intersectsPolygon(data%2C%20start%2C%20a%2C%20b)%20%7B%0A%20%20%20%20var%20node%20%3D%20start%3B%0A%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20var%20p1%20%3D%20node.i%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20p2%20%3D%20node.next.i%3B%0A%0A%20%20%20%20%20%20%20%20if%20(p1%20!%3D%3D%20a%20%26%26%20p2%20!%3D%3D%20a%20%26%26%20p1%20!%3D%3D%20b%20%26%26%20p2%20!%3D%3D%20b%20%26%26%20intersects(data%2C%20p1%2C%20p2%2C%20a%2C%20b))%20return%20true%3B%0A%0A%20%20%20%20%20%20%20%20node%20%3D%20node.next%3B%0A%20%20%20%20%7D%20while%20(node%20!%3D%3D%20start)%3B%0A%0A%20%20%20%20return%20false%3B%0A%7D%0A%0A%2F%2F%20check%20if%20a%20polygon%20diagonal%20is%20locally%20inside%20the%20polygon%0Afunction%20locallyInside(data%2C%20a%2C%20b)%20%7B%0A%20%20%20%20return%20orient(data%2C%20a.prev.i%2C%20a.i%2C%20a.next.i)%20%3D%3D%3D%20-1%20%3F%0A%20%20%20%20%20%20%20%20orient(data%2C%20a.i%2C%20b.i%2C%20a.next.i)%20!%3D%3D%20-1%20%26%26%20orient(data%2C%20a.i%2C%20a.prev.i%2C%20b.i)%20!%3D%3D%20-1%20%3A%0A%20%20%20%20%20%20%20%20orient(data%2C%20a.i%2C%20b.i%2C%20a.prev.i)%20%3D%3D%3D%20-1%20%7C%7C%20orient(data%2C%20a.i%2C%20a.next.i%2C%20b.i)%20%3D%3D%3D%20-1%3B%0A%7D%0A%0A%2F%2F%20check%20if%20the%20middle%20point%20of%20a%20polygon%20diagonal%20is%20inside%20the%20polygon%0Afunction%20middleInside(data%2C%20start%2C%20a%2C%20b)%20%7B%0A%20%20%20%20var%20node%20%3D%20start%2C%0A%20%20%20%20%20%20%20%20inside%20%3D%20false%2C%0A%20%20%20%20%20%20%20%20px%20%3D%20(data%5Ba%5D%20%2B%20data%5Bb%5D)%20%2F%202%2C%0A%20%20%20%20%20%20%20%20py%20%3D%20(data%5Ba%20%2B%201%5D%20%2B%20data%5Bb%20%2B%201%5D)%20%2F%202%3B%0A%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20var%20p1%20%3D%20node.i%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20p2%20%3D%20node.next.i%3B%0A%0A%20%20%20%20%20%20%20%20if%20(((data%5Bp1%20%2B%201%5D%20%3E%20py)%20!%3D%3D%20(data%5Bp2%20%2B%201%5D%20%3E%20py))%20%26%26%0A%20%20%20%20%20%20%20%20%20%20%20%20(px%20%3C%20(data%5Bp2%5D%20-%20data%5Bp1%5D)%20*%20(py%20-%20data%5Bp1%20%2B%201%5D)%20%2F%20(data%5Bp2%20%2B%201%5D%20-%20data%5Bp1%20%2B%201%5D)%20%2B%20data%5Bp1%5D))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inside%20%3D%20!inside%3B%0A%0A%20%20%20%20%20%20%20%20node%20%3D%20node.next%3B%0A%20%20%20%20%7D%20while%20(node%20!%3D%3D%20start)%3B%0A%0A%20%20%20%20return%20inside%3B%0A%7D%0A%0A%2F%2F%20link%20two%20polygon%20vertices%20with%20a%20bridge%3B%20if%20the%20vertices%20belong%20to%20the%20same%20ring%2C%20it%20splits%20polygon%20into%20two%3B%0A%2F%2F%20if%20one%20belongs%20to%20the%20outer%20ring%20and%20another%20to%20a%20hole%2C%20it%20merges%20it%20into%20a%20single%20ring%0Afunction%20splitPolygon(a%2C%20b)%20%7B%0A%20%20%20%20var%20a2%20%3D%20new%20Node(a.i)%2C%0A%20%20%20%20%20%20%20%20b2%20%3D%20new%20Node(b.i)%2C%0A%20%20%20%20%20%20%20%20an%20%3D%20a.next%2C%0A%20%20%20%20%20%20%20%20bp%20%3D%20b.prev%3B%0A%0A%20%20%20%20a.next%20%3D%20b%3B%0A%20%20%20%20b.prev%20%3D%20a%3B%0A%0A%20%20%20%20a2.next%20%3D%20an%3B%0A%20%20%20%20an.prev%20%3D%20a2%3B%0A%0A%20%20%20%20b2.next%20%3D%20a2%3B%0A%20%20%20%20a2.prev%20%3D%20b2%3B%0A%0A%20%20%20%20bp.next%20%3D%20b2%3B%0A%20%20%20%20b2.prev%20%3D%20bp%3B%0A%0A%20%20%20%20return%20b2%3B%0A%7D%0A%0A%2F%2F%20create%20a%20node%20and%20optionally%20link%20it%20with%20previous%20one%20(in%20a%20circular%20doubly%20linked%20list)%0Afunction%20insertNode(i%2C%20last)%20%7B%0A%20%20%20%20var%20node%20%3D%20new%20Node(i)%3B%0A%0A%20%20%20%20if%20(!last)%20%7B%0A%20%20%20%20%20%20%20%20node.prev%20%3D%20node%3B%0A%20%20%20%20%20%20%20%20node.next%20%3D%20node%3B%0A%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node.next%20%3D%20last.next%3B%0A%20%20%20%20%20%20%20%20node.prev%20%3D%20last%3B%0A%20%20%20%20%20%20%20%20last.next.prev%20%3D%20node%3B%0A%20%20%20%20%20%20%20%20last.next%20%3D%20node%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20node%3B%0A%7D%0A%0Afunction%20Node(i)%20%7B%0A%20%20%20%20%2F%2F%20vertex%20coordinates%0A%20%20%20%20this.i%20%3D%20i%3B%0A%0A%20%20%20%20%2F%2F%20previous%20and%20next%20vertice%20nodes%20in%20a%20polygon%20ring%0A%20%20%20%20this.prev%20%3D%20null%3B%0A%20%20%20%20this.next%20%3D%20null%3B%0A%0A%20%20%20%20%2F%2F%20z-order%20curve%20value%0A%20%20%20%20this.z%20%3D%20null%3B%0A%0A%20%20%20%20%2F%2F%20previous%20and%20next%20nodes%20in%20z-order%0A%20%20%20%20this.prevZ%20%3D%20null%3B%0A%20%20%20%20this.nextZ%20%3D%20null%3B%0A%0A%20%20%20%20%2F%2F%20indicates%20whether%20this%20is%20a%20steiner%20point%0A%20%20%20%20this.steiner%20%3D%20false%3B%0A%7D%0A%0A%7D%2C%7B%7D%5D%2C10%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A'use%20strict'%3B%0A%0A%2F%2F%0A%2F%2F%20We%20store%20our%20EE%20objects%20in%20a%20plain%20object%20whose%20properties%20are%20event%20names.%0A%2F%2F%20If%20%60Object.create(null)%60%20is%20not%20supported%20we%20prefix%20the%20event%20names%20with%20a%0A%2F%2F%20%60~%60%20to%20make%20sure%20that%20the%20built-in%20object%20properties%20are%20not%20overridden%20or%0A%2F%2F%20used%20as%20an%20attack%20vector.%0A%2F%2F%20We%20also%20assume%20that%20%60Object.create(null)%60%20is%20available%20when%20the%20event%20name%0A%2F%2F%20is%20an%20ES6%20Symbol.%0A%2F%2F%0Avar%20prefix%20%3D%20typeof%20Object.create%20!%3D%3D%20'function'%20%3F%20'~'%20%3A%20false%3B%0A%0A%2F**%0A%20*%20Representation%20of%20a%20single%20EventEmitter%20function.%0A%20*%0A%20*%20%40param%20%7BFunction%7D%20fn%20Event%20handler%20to%20be%20called.%0A%20*%20%40param%20%7BMixed%7D%20context%20Context%20for%20function%20execution.%0A%20*%20%40param%20%7BBoolean%7D%20once%20Only%20emit%20once%0A%20*%20%40api%20private%0A%20*%2F%0Afunction%20EE(fn%2C%20context%2C%20once)%20%7B%0A%20%20this.fn%20%3D%20fn%3B%0A%20%20this.context%20%3D%20context%3B%0A%20%20this.once%20%3D%20once%20%7C%7C%20false%3B%0A%7D%0A%0A%2F**%0A%20*%20Minimal%20EventEmitter%20interface%20that%20is%20molded%20against%20the%20Node.js%0A%20*%20EventEmitter%20interface.%0A%20*%0A%20*%20%40constructor%0A%20*%20%40api%20public%0A%20*%2F%0Afunction%20EventEmitter()%20%7B%20%2F*%20Nothing%20to%20set%20*%2F%20%7D%0A%0A%2F**%0A%20*%20Holds%20the%20assigned%20EventEmitters%20by%20name.%0A%20*%0A%20*%20%40type%20%7BObject%7D%0A%20*%20%40private%0A%20*%2F%0AEventEmitter.prototype._events%20%3D%20undefined%3B%0A%0A%2F**%0A%20*%20Return%20a%20list%20of%20assigned%20event%20listeners.%0A%20*%0A%20*%20%40param%20%7BString%7D%20event%20The%20events%20that%20should%20be%20listed.%0A%20*%20%40param%20%7BBoolean%7D%20exists%20We%20only%20need%20to%20know%20if%20there%20are%20listeners.%0A%20*%20%40returns%20%7BArray%7CBoolean%7D%0A%20*%20%40api%20public%0A%20*%2F%0AEventEmitter.prototype.listeners%20%3D%20function%20listeners(event%2C%20exists)%20%7B%0A%20%20var%20evt%20%3D%20prefix%20%3F%20prefix%20%2B%20event%20%3A%20event%0A%20%20%20%20%2C%20available%20%3D%20this._events%20%26%26%20this._events%5Bevt%5D%3B%0A%0A%20%20if%20(exists)%20return%20!!available%3B%0A%20%20if%20(!available)%20return%20%5B%5D%3B%0A%20%20if%20(available.fn)%20return%20%5Bavailable.fn%5D%3B%0A%0A%20%20for%20(var%20i%20%3D%200%2C%20l%20%3D%20available.length%2C%20ee%20%3D%20new%20Array(l)%3B%20i%20%3C%20l%3B%20i%2B%2B)%20%7B%0A%20%20%20%20ee%5Bi%5D%20%3D%20available%5Bi%5D.fn%3B%0A%20%20%7D%0A%0A%20%20return%20ee%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Emit%20an%20event%20to%20all%20registered%20event%20listeners.%0A%20*%0A%20*%20%40param%20%7BString%7D%20event%20The%20name%20of%20the%20event.%0A%20*%20%40returns%20%7BBoolean%7D%20Indication%20if%20we've%20emitted%20an%20event.%0A%20*%20%40api%20public%0A%20*%2F%0AEventEmitter.prototype.emit%20%3D%20function%20emit(event%2C%20a1%2C%20a2%2C%20a3%2C%20a4%2C%20a5)%20%7B%0A%20%20var%20evt%20%3D%20prefix%20%3F%20prefix%20%2B%20event%20%3A%20event%3B%0A%0A%20%20if%20(!this._events%20%7C%7C%20!this._events%5Bevt%5D)%20return%20false%3B%0A%0A%20%20var%20listeners%20%3D%20this._events%5Bevt%5D%0A%20%20%20%20%2C%20len%20%3D%20arguments.length%0A%20%20%20%20%2C%20args%0A%20%20%20%20%2C%20i%3B%0A%0A%20%20if%20('function'%20%3D%3D%3D%20typeof%20listeners.fn)%20%7B%0A%20%20%20%20if%20(listeners.once)%20this.removeListener(event%2C%20listeners.fn%2C%20undefined%2C%20true)%3B%0A%0A%20%20%20%20switch%20(len)%20%7B%0A%20%20%20%20%20%20case%201%3A%20return%20listeners.fn.call(listeners.context)%2C%20true%3B%0A%20%20%20%20%20%20case%202%3A%20return%20listeners.fn.call(listeners.context%2C%20a1)%2C%20true%3B%0A%20%20%20%20%20%20case%203%3A%20return%20listeners.fn.call(listeners.context%2C%20a1%2C%20a2)%2C%20true%3B%0A%20%20%20%20%20%20case%204%3A%20return%20listeners.fn.call(listeners.context%2C%20a1%2C%20a2%2C%20a3)%2C%20true%3B%0A%20%20%20%20%20%20case%205%3A%20return%20listeners.fn.call(listeners.context%2C%20a1%2C%20a2%2C%20a3%2C%20a4)%2C%20true%3B%0A%20%20%20%20%20%20case%206%3A%20return%20listeners.fn.call(listeners.context%2C%20a1%2C%20a2%2C%20a3%2C%20a4%2C%20a5)%2C%20true%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20for%20(i%20%3D%201%2C%20args%20%3D%20new%20Array(len%20-1)%3B%20i%20%3C%20len%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20args%5Bi%20-%201%5D%20%3D%20arguments%5Bi%5D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20listeners.fn.apply(listeners.context%2C%20args)%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20var%20length%20%3D%20listeners.length%0A%20%20%20%20%20%20%2C%20j%3B%0A%0A%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20length%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20if%20(listeners%5Bi%5D.once)%20this.removeListener(event%2C%20listeners%5Bi%5D.fn%2C%20undefined%2C%20true)%3B%0A%0A%20%20%20%20%20%20switch%20(len)%20%7B%0A%20%20%20%20%20%20%20%20case%201%3A%20listeners%5Bi%5D.fn.call(listeners%5Bi%5D.context)%3B%20break%3B%0A%20%20%20%20%20%20%20%20case%202%3A%20listeners%5Bi%5D.fn.call(listeners%5Bi%5D.context%2C%20a1)%3B%20break%3B%0A%20%20%20%20%20%20%20%20case%203%3A%20listeners%5Bi%5D.fn.call(listeners%5Bi%5D.context%2C%20a1%2C%20a2)%3B%20break%3B%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20if%20(!args)%20for%20(j%20%3D%201%2C%20args%20%3D%20new%20Array(len%20-1)%3B%20j%20%3C%20len%3B%20j%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20args%5Bj%20-%201%5D%20%3D%20arguments%5Bj%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20listeners%5Bi%5D.fn.apply(listeners%5Bi%5D.context%2C%20args)%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20true%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Register%20a%20new%20EventListener%20for%20the%20given%20event.%0A%20*%0A%20*%20%40param%20%7BString%7D%20event%20Name%20of%20the%20event.%0A%20*%20%40param%20%7BFuncton%7D%20fn%20Callback%20function.%0A%20*%20%40param%20%7BMixed%7D%20context%20The%20context%20of%20the%20function.%0A%20*%20%40api%20public%0A%20*%2F%0AEventEmitter.prototype.on%20%3D%20function%20on(event%2C%20fn%2C%20context)%20%7B%0A%20%20var%20listener%20%3D%20new%20EE(fn%2C%20context%20%7C%7C%20this)%0A%20%20%20%20%2C%20evt%20%3D%20prefix%20%3F%20prefix%20%2B%20event%20%3A%20event%3B%0A%0A%20%20if%20(!this._events)%20this._events%20%3D%20prefix%20%3F%20%7B%7D%20%3A%20Object.create(null)%3B%0A%20%20if%20(!this._events%5Bevt%5D)%20this._events%5Bevt%5D%20%3D%20listener%3B%0A%20%20else%20%7B%0A%20%20%20%20if%20(!this._events%5Bevt%5D.fn)%20this._events%5Bevt%5D.push(listener)%3B%0A%20%20%20%20else%20this._events%5Bevt%5D%20%3D%20%5B%0A%20%20%20%20%20%20this._events%5Bevt%5D%2C%20listener%0A%20%20%20%20%5D%3B%0A%20%20%7D%0A%0A%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Add%20an%20EventListener%20that's%20only%20called%20once.%0A%20*%0A%20*%20%40param%20%7BString%7D%20event%20Name%20of%20the%20event.%0A%20*%20%40param%20%7BFunction%7D%20fn%20Callback%20function.%0A%20*%20%40param%20%7BMixed%7D%20context%20The%20context%20of%20the%20function.%0A%20*%20%40api%20public%0A%20*%2F%0AEventEmitter.prototype.once%20%3D%20function%20once(event%2C%20fn%2C%20context)%20%7B%0A%20%20var%20listener%20%3D%20new%20EE(fn%2C%20context%20%7C%7C%20this%2C%20true)%0A%20%20%20%20%2C%20evt%20%3D%20prefix%20%3F%20prefix%20%2B%20event%20%3A%20event%3B%0A%0A%20%20if%20(!this._events)%20this._events%20%3D%20prefix%20%3F%20%7B%7D%20%3A%20Object.create(null)%3B%0A%20%20if%20(!this._events%5Bevt%5D)%20this._events%5Bevt%5D%20%3D%20listener%3B%0A%20%20else%20%7B%0A%20%20%20%20if%20(!this._events%5Bevt%5D.fn)%20this._events%5Bevt%5D.push(listener)%3B%0A%20%20%20%20else%20this._events%5Bevt%5D%20%3D%20%5B%0A%20%20%20%20%20%20this._events%5Bevt%5D%2C%20listener%0A%20%20%20%20%5D%3B%0A%20%20%7D%0A%0A%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Remove%20event%20listeners.%0A%20*%0A%20*%20%40param%20%7BString%7D%20event%20The%20event%20we%20want%20to%20remove.%0A%20*%20%40param%20%7BFunction%7D%20fn%20The%20listener%20that%20we%20need%20to%20find.%0A%20*%20%40param%20%7BMixed%7D%20context%20Only%20remove%20listeners%20matching%20this%20context.%0A%20*%20%40param%20%7BBoolean%7D%20once%20Only%20remove%20once%20listeners.%0A%20*%20%40api%20public%0A%20*%2F%0AEventEmitter.prototype.removeListener%20%3D%20function%20removeListener(event%2C%20fn%2C%20context%2C%20once)%20%7B%0A%20%20var%20evt%20%3D%20prefix%20%3F%20prefix%20%2B%20event%20%3A%20event%3B%0A%0A%20%20if%20(!this._events%20%7C%7C%20!this._events%5Bevt%5D)%20return%20this%3B%0A%0A%20%20var%20listeners%20%3D%20this._events%5Bevt%5D%0A%20%20%20%20%2C%20events%20%3D%20%5B%5D%3B%0A%0A%20%20if%20(fn)%20%7B%0A%20%20%20%20if%20(listeners.fn)%20%7B%0A%20%20%20%20%20%20if%20(%0A%20%20%20%20%20%20%20%20%20%20%20listeners.fn%20!%3D%3D%20fn%0A%20%20%20%20%20%20%20%20%7C%7C%20(once%20%26%26%20!listeners.once)%0A%20%20%20%20%20%20%20%20%7C%7C%20(context%20%26%26%20listeners.context%20!%3D%3D%20context)%0A%20%20%20%20%20%20)%20%7B%0A%20%20%20%20%20%20%20%20events.push(listeners)%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20for%20(var%20i%20%3D%200%2C%20length%20%3D%20listeners.length%3B%20i%20%3C%20length%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20if%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20listeners%5Bi%5D.fn%20!%3D%3D%20fn%0A%20%20%20%20%20%20%20%20%20%20%7C%7C%20(once%20%26%26%20!listeners%5Bi%5D.once)%0A%20%20%20%20%20%20%20%20%20%20%7C%7C%20(context%20%26%26%20listeners%5Bi%5D.context%20!%3D%3D%20context)%0A%20%20%20%20%20%20%20%20)%20%7B%0A%20%20%20%20%20%20%20%20%20%20events.push(listeners%5Bi%5D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%0A%20%20%2F%2F%20Reset%20the%20array%2C%20or%20remove%20it%20completely%20if%20we%20have%20no%20more%20listeners.%0A%20%20%2F%2F%0A%20%20if%20(events.length)%20%7B%0A%20%20%20%20this._events%5Bevt%5D%20%3D%20events.length%20%3D%3D%3D%201%20%3F%20events%5B0%5D%20%3A%20events%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20delete%20this._events%5Bevt%5D%3B%0A%20%20%7D%0A%0A%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Remove%20all%20listeners%20or%20only%20the%20listeners%20for%20the%20specified%20event.%0A%20*%0A%20*%20%40param%20%7BString%7D%20event%20The%20event%20want%20to%20remove%20all%20listeners%20for.%0A%20*%20%40api%20public%0A%20*%2F%0AEventEmitter.prototype.removeAllListeners%20%3D%20function%20removeAllListeners(event)%20%7B%0A%20%20if%20(!this._events)%20return%20this%3B%0A%0A%20%20if%20(event)%20delete%20this._events%5Bprefix%20%3F%20prefix%20%2B%20event%20%3A%20event%5D%3B%0A%20%20else%20this._events%20%3D%20prefix%20%3F%20%7B%7D%20%3A%20Object.create(null)%3B%0A%0A%20%20return%20this%3B%0A%7D%3B%0A%0A%2F%2F%0A%2F%2F%20Alias%20methods%20names%20because%20people%20roll%20like%20that.%0A%2F%2F%0AEventEmitter.prototype.off%20%3D%20EventEmitter.prototype.removeListener%3B%0AEventEmitter.prototype.addListener%20%3D%20EventEmitter.prototype.on%3B%0A%0A%2F%2F%0A%2F%2F%20This%20function%20doesn't%20apply%20anymore.%0A%2F%2F%0AEventEmitter.prototype.setMaxListeners%20%3D%20function%20setMaxListeners()%20%7B%0A%20%20return%20this%3B%0A%7D%3B%0A%0A%2F%2F%0A%2F%2F%20Expose%20the%20prefix.%0A%2F%2F%0AEventEmitter.prefixed%20%3D%20prefix%3B%0A%0A%2F%2F%0A%2F%2F%20Expose%20the%20module.%0A%2F%2F%0Aif%20('undefined'%20!%3D%3D%20typeof%20module)%20%7B%0A%20%20module.exports%20%3D%20EventEmitter%3B%0A%7D%0A%0A%7D%2C%7B%7D%5D%2C11%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F*%20eslint-disable%20no-unused-vars%20*%2F%0A'use%20strict'%3B%0Avar%20hasOwnProperty%20%3D%20Object.prototype.hasOwnProperty%3B%0Avar%20propIsEnumerable%20%3D%20Object.prototype.propertyIsEnumerable%3B%0A%0Afunction%20toObject(val)%20%7B%0A%09if%20(val%20%3D%3D%3D%20null%20%7C%7C%20val%20%3D%3D%3D%20undefined)%20%7B%0A%09%09throw%20new%20TypeError('Object.assign%20cannot%20be%20called%20with%20null%20or%20undefined')%3B%0A%09%7D%0A%0A%09return%20Object(val)%3B%0A%7D%0A%0Amodule.exports%20%3D%20Object.assign%20%7C%7C%20function%20(target%2C%20source)%20%7B%0A%09var%20from%3B%0A%09var%20to%20%3D%20toObject(target)%3B%0A%09var%20symbols%3B%0A%0A%09for%20(var%20s%20%3D%201%3B%20s%20%3C%20arguments.length%3B%20s%2B%2B)%20%7B%0A%09%09from%20%3D%20Object(arguments%5Bs%5D)%3B%0A%0A%09%09for%20(var%20key%20in%20from)%20%7B%0A%09%09%09if%20(hasOwnProperty.call(from%2C%20key))%20%7B%0A%09%09%09%09to%5Bkey%5D%20%3D%20from%5Bkey%5D%3B%0A%09%09%09%7D%0A%09%09%7D%0A%0A%09%09if%20(Object.getOwnPropertySymbols)%20%7B%0A%09%09%09symbols%20%3D%20Object.getOwnPropertySymbols(from)%3B%0A%09%09%09for%20(var%20i%20%3D%200%3B%20i%20%3C%20symbols.length%3B%20i%2B%2B)%20%7B%0A%09%09%09%09if%20(propIsEnumerable.call(from%2C%20symbols%5Bi%5D))%20%7B%0A%09%09%09%09%09to%5Bsymbols%5Bi%5D%5D%20%3D%20from%5Bsymbols%5Bi%5D%5D%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%0A%09%09%7D%0A%09%7D%0A%0A%09return%20to%3B%0A%7D%3B%0A%0A%7D%2C%7B%7D%5D%2C12%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Amodule.exports%3D%7B%0A%20%20%22name%22%3A%20%22pixi.js%22%2C%0A%20%20%22version%22%3A%20%223.0.8%22%2C%0A%20%20%22description%22%3A%20%22Pixi.js%20is%20a%20fast%20lightweight%202D%20library%20that%20works%20across%20all%20devices.%22%2C%0A%20%20%22author%22%3A%20%22Mat%20Groves%22%2C%0A%20%20%22contributors%22%3A%20%5B%0A%20%20%20%20%22Chad%20Engler%20%3Cchad%40pantherdev.com%3E%22%2C%0A%20%20%20%20%22Richard%20Davey%20%3Crdavey%40gmail.com%3E%22%0A%20%20%5D%2C%0A%20%20%22main%22%3A%20%22.%2Fsrc%2Findex.js%22%2C%0A%20%20%22homepage%22%3A%20%22http%3A%2F%2Fgoodboydigital.com%2F%22%2C%0A%20%20%22bugs%22%3A%20%22https%3A%2F%2Fgithub.com%2Fpixijs%2Fpixi.js%2Fissues%22%2C%0A%20%20%22license%22%3A%20%22MIT%22%2C%0A%20%20%22repository%22%3A%20%7B%0A%20%20%20%20%22type%22%3A%20%22git%22%2C%0A%20%20%20%20%22url%22%3A%20%22https%3A%2F%2Fgithub.com%2Fpixijs%2Fpixi.js.git%22%0A%20%20%7D%2C%0A%20%20%22scripts%22%3A%20%7B%0A%20%20%20%20%22start%22%3A%20%22gulp%20%26%26%20gulp%20watch%22%2C%0A%20%20%20%20%22test%22%3A%20%22gulp%20%26%26%20testem%20ci%22%2C%0A%20%20%20%20%22build%22%3A%20%22gulp%22%2C%0A%20%20%20%20%22docs%22%3A%20%22jsdoc%20-c%20.%2Fgulp%2Futil%2Fjsdoc.conf.json%20-R%20README.md%22%0A%20%20%7D%2C%0A%20%20%22files%22%3A%20%5B%0A%20%20%20%20%22bin%2F%22%2C%0A%20%20%20%20%22src%2F%22%2C%0A%20%20%20%20%22CONTRIBUTING.md%22%2C%0A%20%20%20%20%22LICENSE%22%2C%0A%20%20%20%20%22package.json%22%2C%0A%20%20%20%20%22README.md%22%0A%20%20%5D%2C%0A%20%20%22dependencies%22%3A%20%7B%0A%20%20%20%20%22async%22%3A%20%22%5E1.4.2%22%2C%0A%20%20%20%20%22brfs%22%3A%20%22%5E1.4.1%22%2C%0A%20%20%20%20%22earcut%22%3A%20%22%5E2.0.2%22%2C%0A%20%20%20%20%22eventemitter3%22%3A%20%22%5E1.1.1%22%2C%0A%20%20%20%20%22gulp-header%22%3A%20%22%5E1.7.1%22%2C%0A%20%20%20%20%22object-assign%22%3A%20%22%5E4.0.1%22%2C%0A%20%20%20%20%22resource-loader%22%3A%20%22%5E1.6.2%22%0A%20%20%7D%2C%0A%20%20%22devDependencies%22%3A%20%7B%0A%20%20%20%20%22browserify%22%3A%20%22%5E11.1.0%22%2C%0A%20%20%20%20%22chai%22%3A%20%22%5E3.2.0%22%2C%0A%20%20%20%20%22del%22%3A%20%22%5E2.0.2%22%2C%0A%20%20%20%20%22gulp%22%3A%20%22%5E3.9.0%22%2C%0A%20%20%20%20%22gulp-cached%22%3A%20%22%5E1.1.0%22%2C%0A%20%20%20%20%22gulp-concat%22%3A%20%22%5E2.6.0%22%2C%0A%20%20%20%20%22gulp-debug%22%3A%20%22%5E2.1.0%22%2C%0A%20%20%20%20%22gulp-jshint%22%3A%20%22%5E1.11.2%22%2C%0A%20%20%20%20%22gulp-mirror%22%3A%20%22%5E0.4.0%22%2C%0A%20%20%20%20%22gulp-plumber%22%3A%20%22%5E1.0.1%22%2C%0A%20%20%20%20%22gulp-rename%22%3A%20%22%5E1.2.2%22%2C%0A%20%20%20%20%22gulp-sourcemaps%22%3A%20%22%5E1.5.2%22%2C%0A%20%20%20%20%22gulp-uglify%22%3A%20%22%5E1.4.1%22%2C%0A%20%20%20%20%22gulp-util%22%3A%20%22%5E3.0.6%22%2C%0A%20%20%20%20%22jaguarjs-jsdoc%22%3A%20%22git%2Bhttps%3A%2F%2Fgithub.com%2Fdavidshimjs%2Fjaguarjs-jsdoc.git%22%2C%0A%20%20%20%20%22jsdoc%22%3A%20%22%5E3.3.2%22%2C%0A%20%20%20%20%22jshint-summary%22%3A%20%22%5E0.4.0%22%2C%0A%20%20%20%20%22minimist%22%3A%20%22%5E1.2.0%22%2C%0A%20%20%20%20%22mocha%22%3A%20%22%5E2.3.2%22%2C%0A%20%20%20%20%22require-dir%22%3A%20%22%5E0.3.0%22%2C%0A%20%20%20%20%22run-sequence%22%3A%20%22%5E1.1.2%22%2C%0A%20%20%20%20%22testem%22%3A%20%22%5E0.9.4%22%2C%0A%20%20%20%20%22vinyl-buffer%22%3A%20%22%5E1.0.0%22%2C%0A%20%20%20%20%22vinyl-source-stream%22%3A%20%22%5E1.1.0%22%2C%0A%20%20%20%20%22watchify%22%3A%20%22%5E3.4.0%22%0A%20%20%7D%2C%0A%20%20%22browserify%22%3A%20%7B%0A%20%20%20%20%22transform%22%3A%20%5B%0A%20%20%20%20%20%20%22brfs%22%0A%20%20%20%20%5D%0A%20%20%7D%0A%7D%0A%0A%7D%2C%7B%7D%5D%2C13%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F**%0A%20*%20Constant%20values%20used%20in%20pixi%0A%20*%0A%20*%20%40lends%20PIXI%0A%20*%2F%0Avar%20CONST%20%3D%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20String%20of%20the%20current%20PIXI%20version%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40static%0A%20%20%20%20%20*%20%40constant%0A%20%20%20%20%20*%20%40property%20%7Bstring%7D%20VERSION%0A%20%20%20%20%20*%2F%0A%20%20%20%20VERSION%3A%20require('..%2F..%2Fpackage.json').version%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20PI_2%20-%20Two%20Pi%0A%20%20%20%20%20*%20%40constant%0A%20%20%20%20%20*%20%40static%0A%20%20%20%20%20*%2F%0A%20%20%20%20PI_2%3A%20Math.PI%20*%202%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20RAD_TO_DEG%20-%20Constant%20conversion%20factor%20for%20converting%20radians%20to%20degrees%0A%20%20%20%20%20*%20%40constant%0A%20%20%20%20%20*%20%40static%0A%20%20%20%20%20*%2F%0A%20%20%20%20RAD_TO_DEG%3A%20180%20%2F%20Math.PI%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40property%20%7BNumber%7D%20DEG_TO_RAD%20-%20Constant%20conversion%20factor%20for%20converting%20degrees%20to%20radians%0A%20%20%20%20%20*%20%40constant%0A%20%20%20%20%20*%20%40static%0A%20%20%20%20%20*%2F%0A%20%20%20%20DEG_TO_RAD%3A%20Math.PI%20%2F%20180%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Target%20frames%20per%20millisecond.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40static%0A%20%20%20%20%20*%20%40constant%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20TARGET_FPMS%3D0.06%0A%20%20%20%20%20*%2F%0A%20%20%20%20TARGET_FPMS%3A%200.06%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Constant%20to%20identify%20the%20Renderer%20Type.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40static%0A%20%20%20%20%20*%20%40constant%0A%20%20%20%20%20*%20%40property%20%7Bobject%7D%20RENDERER_TYPE%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20RENDERER_TYPE.UNKNOWN%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20RENDERER_TYPE.WEBGL%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20RENDERER_TYPE.CANVAS%0A%20%20%20%20%20*%2F%0A%20%20%20%20RENDERER_TYPE%3A%20%7B%0A%20%20%20%20%20%20%20%20UNKNOWN%3A%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20WEBGL%3A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%20CANVAS%3A%20%20%20%20%202%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Various%20blend%20modes%20supported%20by%20PIXI.%20IMPORTANT%20-%20The%20WebGL%20renderer%20only%20supports%0A%20%20%20%20%20*%20the%20NORMAL%2C%20ADD%2C%20MULTIPLY%20and%20SCREEN%20blend%20modes.%20Anything%20else%20will%20silently%20act%20like%0A%20%20%20%20%20*%20NORMAL.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40static%0A%20%20%20%20%20*%20%40constant%0A%20%20%20%20%20*%20%40property%20%7Bobject%7D%20BLEND_MODES%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20BLEND_MODES.NORMAL%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20BLEND_MODES.ADD%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20BLEND_MODES.MULTIPLY%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20BLEND_MODES.SCREEN%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20BLEND_MODES.OVERLAY%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20BLEND_MODES.DARKEN%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20BLEND_MODES.LIGHTEN%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20BLEND_MODES.COLOR_DODGE%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20BLEND_MODES.COLOR_BURN%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20BLEND_MODES.HARD_LIGHT%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20BLEND_MODES.SOFT_LIGHT%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20BLEND_MODES.DIFFERENCE%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20BLEND_MODES.EXCLUSION%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20BLEND_MODES.HUE%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20BLEND_MODES.SATURATION%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20BLEND_MODES.COLOR%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20BLEND_MODES.LUMINOSITY%0A%20%20%20%20%20*%2F%0A%20%20%20%20BLEND_MODES%3A%20%7B%0A%20%20%20%20%20%20%20%20NORMAL%3A%20%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20ADD%3A%20%20%20%20%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%20MULTIPLY%3A%20%20%20%20%20%20%202%2C%0A%20%20%20%20%20%20%20%20SCREEN%3A%20%20%20%20%20%20%20%20%203%2C%0A%20%20%20%20%20%20%20%20OVERLAY%3A%20%20%20%20%20%20%20%204%2C%0A%20%20%20%20%20%20%20%20DARKEN%3A%20%20%20%20%20%20%20%20%205%2C%0A%20%20%20%20%20%20%20%20LIGHTEN%3A%20%20%20%20%20%20%20%206%2C%0A%20%20%20%20%20%20%20%20COLOR_DODGE%3A%20%20%20%207%2C%0A%20%20%20%20%20%20%20%20COLOR_BURN%3A%20%20%20%20%208%2C%0A%20%20%20%20%20%20%20%20HARD_LIGHT%3A%20%20%20%20%209%2C%0A%20%20%20%20%20%20%20%20SOFT_LIGHT%3A%20%20%20%20%2010%2C%0A%20%20%20%20%20%20%20%20DIFFERENCE%3A%20%20%20%20%2011%2C%0A%20%20%20%20%20%20%20%20EXCLUSION%3A%20%20%20%20%20%2012%2C%0A%20%20%20%20%20%20%20%20HUE%3A%20%20%20%20%20%20%20%20%20%20%20%2013%2C%0A%20%20%20%20%20%20%20%20SATURATION%3A%20%20%20%20%2014%2C%0A%20%20%20%20%20%20%20%20COLOR%3A%20%20%20%20%20%20%20%20%20%2015%2C%0A%20%20%20%20%20%20%20%20LUMINOSITY%3A%20%20%20%20%2016%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Various%20webgl%20draw%20modes.%20These%20can%20be%20used%20to%20specify%20which%20GL%20drawMode%20to%20use%0A%20%20%20%20%20*%20under%20certain%20situations%20and%20renderers.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40static%0A%20%20%20%20%20*%20%40constant%0A%20%20%20%20%20*%20%40property%20%7Bobject%7D%20DRAW_MODES%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20DRAW_MODES.POINTS%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20DRAW_MODES.LINES%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20DRAW_MODES.LINE_LOOP%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20DRAW_MODES.LINE_STRIP%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20DRAW_MODES.TRIANGLES%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20DRAW_MODES.TRIANGLE_STRIP%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20DRAW_MODES.TRIANGLE_FAN%0A%20%20%20%20%20*%2F%0A%20%20%20%20DRAW_MODES%3A%20%7B%0A%20%20%20%20%20%20%20%20POINTS%3A%20%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20LINES%3A%20%20%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%20LINE_LOOP%3A%20%20%20%20%20%202%2C%0A%20%20%20%20%20%20%20%20LINE_STRIP%3A%20%20%20%20%203%2C%0A%20%20%20%20%20%20%20%20TRIANGLES%3A%20%20%20%20%20%204%2C%0A%20%20%20%20%20%20%20%20TRIANGLE_STRIP%3A%205%2C%0A%20%20%20%20%20%20%20%20TRIANGLE_FAN%3A%20%20%206%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20scale%20modes%20that%20are%20supported%20by%20pixi.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20The%20DEFAULT%20scale%20mode%20affects%20the%20default%20scaling%20mode%20of%20future%20operations.%0A%20%20%20%20%20*%20It%20can%20be%20re-assigned%20to%20either%20LINEAR%20or%20NEAREST%2C%20depending%20upon%20suitability.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40static%0A%20%20%20%20%20*%20%40constant%0A%20%20%20%20%20*%20%40property%20%7Bobject%7D%20SCALE_MODES%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20SCALE_MODES.DEFAULT%3DLINEAR%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20SCALE_MODES.LINEAR%20Smooth%20scaling%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20SCALE_MODES.NEAREST%20Pixelating%20scaling%0A%20%20%20%20%20*%2F%0A%20%20%20%20SCALE_MODES%3A%20%7B%0A%20%20%20%20%20%20%20%20DEFAULT%3A%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20LINEAR%3A%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20NEAREST%3A%20%20%20%201%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20prefix%20that%20denotes%20a%20URL%20is%20for%20a%20retina%20asset%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40static%0A%20%20%20%20%20*%20%40constant%0A%20%20%20%20%20*%20%40property%20%7Bstring%7D%20RETINA_PREFIX%0A%20%20%20%20%20*%2F%0A%20%20%20%20%2F%2Fexample%3A%20'%402x'%2C%0A%20%20%20%20RETINA_PREFIX%3A%20%2F%40(.%2B)x%2F%2C%0A%0A%20%20%20%20RESOLUTION%3A1%2C%0A%0A%20%20%20%20FILTER_RESOLUTION%3A1%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20default%20render%20options%20if%20none%20are%20supplied%20to%20%7B%40link%20PIXI.WebGLRenderer%7D%0A%20%20%20%20%20*%20or%20%7B%40link%20PIXI.CanvasRenderer%7D.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40static%0A%20%20%20%20%20*%20%40constant%0A%20%20%20%20%20*%20%40property%20%7Bobject%7D%20DEFAULT_RENDER_OPTIONS%0A%20%20%20%20%20*%20%40property%20%7BHTMLCanvasElement%7D%20DEFAULT_RENDER_OPTIONS.view%3Dnull%0A%20%20%20%20%20*%20%40property%20%7Bboolean%7D%20DEFAULT_RENDER_OPTIONS.transparent%3Dfalse%0A%20%20%20%20%20*%20%40property%20%7Bboolean%7D%20DEFAULT_RENDER_OPTIONS.antialias%3Dfalse%0A%20%20%20%20%20*%20%40property%20%7Bboolean%7D%20DEFAULT_RENDER_OPTIONS.forceFXAA%3Dfalse%0A%20%20%20%20%20*%20%40property%20%7Bboolean%7D%20DEFAULT_RENDER_OPTIONS.preserveDrawingBuffer%3Dfalse%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20DEFAULT_RENDER_OPTIONS.resolution%3D1%0A%20%20%20%20%20*%20%40property%20%7Bnumber%7D%20DEFAULT_RENDER_OPTIONS.backgroundColor%3D0x000000%0A%20%20%20%20%20*%20%40property%20%7Bboolean%7D%20DEFAULT_RENDER_OPTIONS.clearBeforeRender%3Dtrue%0A%20%20%20%20%20*%20%40property%20%7Bboolean%7D%20DEFAULT_RENDER_OPTIONS.autoResize%3Dfalse%0A%20%20%20%20%20*%2F%0A%20%20%20%20DEFAULT_RENDER_OPTIONS%3A%20%7B%0A%20%20%20%20%20%20%20%20view%3A%20null%2C%0A%20%20%20%20%20%20%20%20resolution%3A%201%2C%0A%20%20%20%20%20%20%20%20antialias%3A%20false%2C%0A%20%20%20%20%20%20%20%20forceFXAA%3A%20false%2C%0A%20%20%20%20%20%20%20%20autoResize%3A%20false%2C%0A%20%20%20%20%20%20%20%20transparent%3A%20false%2C%0A%20%20%20%20%20%20%20%20backgroundColor%3A%200x000000%2C%0A%20%20%20%20%20%20%20%20clearBeforeRender%3A%20true%2C%0A%20%20%20%20%20%20%20%20preserveDrawingBuffer%3A%20false%2C%0A%20%20%20%20%20%20%20%20roundPixels%3A%20false%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Constants%20that%20identify%20shapes%2C%20mainly%20to%20prevent%20%60instanceof%60%20calls.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40static%0A%20%20%20%20%20*%20%40constant%0A%20%20%20%20%20*%20%40property%20%7Bobject%7D%20SHAPES%0A%20%20%20%20%20*%20%40property%20%7Bobject%7D%20SHAPES.POLY%3D0%0A%20%20%20%20%20*%20%40property%20%7Bobject%7D%20SHAPES.RECT%3D1%0A%20%20%20%20%20*%20%40property%20%7Bobject%7D%20SHAPES.CIRC%3D2%0A%20%20%20%20%20*%20%40property%20%7Bobject%7D%20SHAPES.ELIP%3D3%0A%20%20%20%20%20*%20%40property%20%7Bobject%7D%20SHAPES.RREC%3D4%0A%20%20%20%20%20*%2F%0A%20%20%20%20SHAPES%3A%20%7B%0A%20%20%20%20%20%20%20%20POLY%3A%200%2C%0A%20%20%20%20%20%20%20%20RECT%3A%201%2C%0A%20%20%20%20%20%20%20%20CIRC%3A%202%2C%0A%20%20%20%20%20%20%20%20ELIP%3A%203%2C%0A%20%20%20%20%20%20%20%20RREC%3A%204%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F%2F%20TODO%3A%20maybe%20change%20to%20SPRITE.BATCH_SIZE%3A%202000%0A%20%20%20%20%2F%2F%20TODO%3A%20maybe%20add%20PARTICLE.BATCH_SIZE%3A%2015000%0A%20%20%20%20SPRITE_BATCH_SIZE%3A%202000%20%2F%2Fnice%20balance%20between%20mobile%20and%20desktop%20machines%0A%7D%3B%0A%0Amodule.exports%20%3D%20CONST%3B%0A%0A%7D%2C%7B%22..%2F..%2Fpackage.json%22%3A12%7D%5D%2C14%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20math%20%3D%20require('..%2Fmath')%2C%0A%20%20%20%20DisplayObject%20%3D%20require('.%2FDisplayObject')%2C%0A%20%20%20%20RenderTexture%20%3D%20require('..%2Ftextures%2FRenderTexture')%2C%0A%20%20%20%20_tempMatrix%20%3D%20new%20math.Matrix()%3B%0A%0A%2F**%0A%20*%20A%20Container%20represents%20a%20collection%20of%20display%20objects.%0A%20*%20It%20is%20the%20base%20class%20of%20all%20display%20objects%20that%20act%20as%20a%20container%20for%20other%20objects.%0A%20*%0A%20*%60%60%60js%0A%20*%20var%20container%20%3D%20new%20PIXI.Container()%3B%0A%20*%20container.addChild(sprite)%3B%0A%20*%20%60%60%60%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.DisplayObject%0A%20*%20%40memberof%20PIXI%0A%20*%2F%0Afunction%20Container()%0A%7B%0A%20%20%20%20DisplayObject.call(this)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20array%20of%20children%20of%20this%20container.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.DisplayObject%5B%5D%7D%0A%20%20%20%20%20*%20%40readonly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.children%20%3D%20%5B%5D%3B%0A%7D%0A%0A%2F%2F%20constructor%0AContainer.prototype%20%3D%20Object.create(DisplayObject.prototype)%3B%0AContainer.prototype.constructor%20%3D%20Container%3B%0Amodule.exports%20%3D%20Container%3B%0A%0AObject.defineProperties(Container.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20width%20of%20the%20Container%2C%20setting%20this%20will%20actually%20modify%20the%20scale%20to%20achieve%20the%20value%20set%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.Container%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20width%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.scale.x%20*%20this.getLocalBounds().width%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20width%20%3D%20this.getLocalBounds().width%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(width%20!%3D%3D%200)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.scale.x%20%3D%20value%20%2F%20width%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.scale.x%20%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20this._width%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20height%20of%20the%20Container%2C%20setting%20this%20will%20actually%20modify%20the%20scale%20to%20achieve%20the%20value%20set%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.Container%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20height%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%20this.scale.y%20*%20this.getLocalBounds().height%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20height%20%3D%20this.getLocalBounds().height%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(height%20!%3D%3D%200)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.scale.y%20%3D%20value%20%2F%20height%20%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.scale.y%20%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20this._height%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%2F**%0A%20*%20Overridable%20method%20that%20can%20be%20used%20by%20Container%20subclasses%20whenever%20the%20children%20array%20is%20modified%0A%20*%0A%20*%20%40private%0A%20*%2F%0AContainer.prototype.onChildrenChange%20%3D%20function%20()%20%7B%7D%3B%0A%0A%2F**%0A%20*%20Adds%20a%20child%20to%20the%20container.%0A%20*%0A%20*%20%40param%20child%20%7BPIXI.DisplayObject%7D%20The%20DisplayObject%20to%20add%20to%20the%20container%0A%20*%20%40return%20%7BPIXI.DisplayObject%7D%20The%20child%20that%20was%20added.%0A%20*%2F%0AContainer.prototype.addChild%20%3D%20function%20(child)%0A%7B%0A%20%20%20%20return%20this.addChildAt(child%2C%20this.children.length)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Adds%20a%20child%20to%20the%20container%20at%20a%20specified%20index.%20If%20the%20index%20is%20out%20of%20bounds%20an%20error%20will%20be%20thrown%0A%20*%0A%20*%20%40param%20child%20%7BPIXI.DisplayObject%7D%20The%20child%20to%20add%0A%20*%20%40param%20index%20%7Bnumber%7D%20The%20index%20to%20place%20the%20child%20in%0A%20*%20%40return%20%7BPIXI.DisplayObject%7D%20The%20child%20that%20was%20added.%0A%20*%2F%0AContainer.prototype.addChildAt%20%3D%20function%20(child%2C%20index)%0A%7B%0A%20%20%20%20%2F%2F%20prevent%20adding%20self%20as%20child%0A%20%20%20%20if%20(child%20%3D%3D%3D%20this)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20child%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(index%20%3E%3D%200%20%26%26%20index%20%3C%3D%20this.children.length)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(child.parent)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20child.parent.removeChild(child)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20child.parent%20%3D%20this%3B%0A%0A%20%20%20%20%20%20%20%20this.children.splice(index%2C%200%2C%20child)%3B%0A%20%20%20%20%20%20%20%20this.onChildrenChange(index)%3B%0A%0A%20%20%20%20%20%20%20%20child.emit('added'%2C%20this)%3B%0A%0A%20%20%20%20%20%20%20%20return%20child%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error(child%20%2B%20'addChildAt%3A%20The%20index%20'%2B%20index%20%2B'%20supplied%20is%20out%20of%20bounds%20'%20%2B%20this.children.length)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Swaps%20the%20position%20of%202%20Display%20Objects%20within%20this%20container.%0A%20*%0A%20*%20%40param%20child%20%7BPIXI.DisplayObject%7D%0A%20*%20%40param%20child2%20%7BPIXI.DisplayObject%7D%0A%20*%2F%0AContainer.prototype.swapChildren%20%3D%20function%20(child%2C%20child2)%0A%7B%0A%20%20%20%20if%20(child%20%3D%3D%3D%20child2)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20index1%20%3D%20this.getChildIndex(child)%3B%0A%20%20%20%20var%20index2%20%3D%20this.getChildIndex(child2)%3B%0A%0A%20%20%20%20if%20(index1%20%3C%200%20%7C%7C%20index2%20%3C%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error('swapChildren%3A%20Both%20the%20supplied%20DisplayObjects%20must%20be%20children%20of%20the%20caller.')%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.children%5Bindex1%5D%20%3D%20child2%3B%0A%20%20%20%20this.children%5Bindex2%5D%20%3D%20child%3B%0A%20%20%20%20this.onChildrenChange(index1%20%3C%20index2%20%3F%20index1%20%3A%20index2)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Returns%20the%20index%20position%20of%20a%20child%20DisplayObject%20instance%0A%20*%0A%20*%20%40param%20child%20%7BPIXI.DisplayObject%7D%20The%20DisplayObject%20instance%20to%20identify%0A%20*%20%40return%20%7Bnumber%7D%20The%20index%20position%20of%20the%20child%20display%20object%20to%20identify%0A%20*%2F%0AContainer.prototype.getChildIndex%20%3D%20function%20(child)%0A%7B%0A%20%20%20%20var%20index%20%3D%20this.children.indexOf(child)%3B%0A%0A%20%20%20%20if%20(index%20%3D%3D%3D%20-1)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error('The%20supplied%20DisplayObject%20must%20be%20a%20child%20of%20the%20caller')%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20index%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Changes%20the%20position%20of%20an%20existing%20child%20in%20the%20display%20object%20container%0A%20*%0A%20*%20%40param%20child%20%7BPIXI.DisplayObject%7D%20The%20child%20DisplayObject%20instance%20for%20which%20you%20want%20to%20change%20the%20index%20number%0A%20*%20%40param%20index%20%7Bnumber%7D%20The%20resulting%20index%20number%20for%20the%20child%20display%20object%0A%20*%2F%0AContainer.prototype.setChildIndex%20%3D%20function%20(child%2C%20index)%0A%7B%0A%20%20%20%20if%20(index%20%3C%200%20%7C%7C%20index%20%3E%3D%20this.children.length)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error('The%20supplied%20index%20is%20out%20of%20bounds')%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20currentIndex%20%3D%20this.getChildIndex(child)%3B%0A%0A%20%20%20%20this.children.splice(currentIndex%2C%201)%3B%20%2F%2Fremove%20from%20old%20position%0A%20%20%20%20this.children.splice(index%2C%200%2C%20child)%3B%20%2F%2Fadd%20at%20new%20position%0A%20%20%20%20this.onChildrenChange(index)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Returns%20the%20child%20at%20the%20specified%20index%0A%20*%0A%20*%20%40param%20index%20%7Bnumber%7D%20The%20index%20to%20get%20the%20child%20at%0A%20*%20%40return%20%7BPIXI.DisplayObject%7D%20The%20child%20at%20the%20given%20index%2C%20if%20any.%0A%20*%2F%0AContainer.prototype.getChildAt%20%3D%20function%20(index)%0A%7B%0A%20%20%20%20if%20(index%20%3C%200%20%7C%7C%20index%20%3E%3D%20this.children.length)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error('getChildAt%3A%20Supplied%20index%20'%20%2B%20index%20%2B%20'%20does%20not%20exist%20in%20the%20child%20list%2C%20or%20the%20supplied%20DisplayObject%20is%20not%20a%20child%20of%20the%20caller')%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20this.children%5Bindex%5D%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Removes%20a%20child%20from%20the%20container.%0A%20*%0A%20*%20%40param%20child%20%7BPIXI.DisplayObject%7D%20The%20DisplayObject%20to%20remove%0A%20*%20%40return%20%7BPIXI.DisplayObject%7D%20The%20child%20that%20was%20removed.%0A%20*%2F%0AContainer.prototype.removeChild%20%3D%20function%20(child)%0A%7B%0A%20%20%20%20var%20index%20%3D%20this.children.indexOf(child)%3B%0A%0A%20%20%20%20if%20(index%20%3D%3D%3D%20-1)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20this.removeChildAt(index)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Removes%20a%20child%20from%20the%20specified%20index%20position.%0A%20*%0A%20*%20%40param%20index%20%7Bnumber%7D%20The%20index%20to%20get%20the%20child%20from%0A%20*%20%40return%20%7BPIXI.DisplayObject%7D%20The%20child%20that%20was%20removed.%0A%20*%2F%0AContainer.prototype.removeChildAt%20%3D%20function%20(index)%0A%7B%0A%20%20%20%20var%20child%20%3D%20this.getChildAt(index)%3B%0A%0A%20%20%20%20child.parent%20%3D%20null%3B%0A%20%20%20%20this.children.splice(index%2C%201)%3B%0A%20%20%20%20this.onChildrenChange(index)%3B%0A%0A%20%20%20%20child.emit('removed'%2C%20this)%3B%0A%0A%20%20%20%20return%20child%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Removes%20all%20children%20from%20this%20container%20that%20are%20within%20the%20begin%20and%20end%20indexes.%0A%20*%0A%20*%20%40param%20beginIndex%20%7Bnumber%7D%20The%20beginning%20position.%20Default%20value%20is%200.%0A%20*%20%40param%20endIndex%20%7Bnumber%7D%20The%20ending%20position.%20Default%20value%20is%20size%20of%20the%20container.%0A%20*%2F%0AContainer.prototype.removeChildren%20%3D%20function%20(beginIndex%2C%20endIndex)%0A%7B%0A%20%20%20%20var%20begin%20%3D%20beginIndex%20%7C%7C%200%3B%0A%20%20%20%20var%20end%20%3D%20typeof%20endIndex%20%3D%3D%3D%20'number'%20%3F%20endIndex%20%3A%20this.children.length%3B%0A%20%20%20%20var%20range%20%3D%20end%20-%20begin%3B%0A%20%20%20%20var%20removed%2C%20i%3B%0A%0A%20%20%20%20if%20(range%20%3E%200%20%26%26%20range%20%3C%3D%20end)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20removed%20%3D%20this.children.splice(begin%2C%20range)%3B%0A%0A%20%20%20%20%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20removed.length%3B%20%2B%2Bi)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20removed%5Bi%5D.parent%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20this.onChildrenChange(beginIndex)%3B%0A%0A%20%20%20%20%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20removed.length%3B%20%2B%2Bi)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20removed%5Bi%5D.emit('removed'%2C%20this)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20return%20removed%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%20if%20(range%20%3D%3D%3D%200%20%26%26%20this.children.length%20%3D%3D%3D%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20%5B%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20RangeError('removeChildren%3A%20numeric%20values%20are%20outside%20the%20acceptable%20range.')%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Useful%20function%20that%20returns%20a%20texture%20of%20the%20display%20object%20that%20can%20then%20be%20used%20to%20create%20sprites%0A%20*%20This%20can%20be%20quite%20useful%20if%20your%20displayObject%20is%20static%20%2F%20complicated%20and%20needs%20to%20be%20reused%20multiple%20times.%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.CanvasRenderer%7CPIXI.WebGLRenderer%7D%20The%20renderer%20used%20to%20generate%20the%20texture.%0A%20*%20%40param%20resolution%20%7Bnumber%7D%20The%20resolution%20of%20the%20texture%20being%20generated%0A%20*%20%40param%20scaleMode%20%7Bnumber%7D%20See%20%7B%40link%20PIXI.SCALE_MODES%7D%20for%20possible%20values%0A%20*%20%40return%20%7BPIXI.Texture%7D%20a%20texture%20of%20the%20display%20object%0A%20*%2F%0AContainer.prototype.generateTexture%20%3D%20function%20(renderer%2C%20resolution%2C%20scaleMode)%0A%7B%0A%20%20%20%20var%20bounds%20%3D%20this.getLocalBounds()%3B%0A%0A%20%20%20%20var%20renderTexture%20%3D%20new%20RenderTexture(renderer%2C%20bounds.width%20%7C%200%2C%20bounds.height%20%7C%200%2C%20scaleMode%2C%20resolution)%3B%0A%0A%20%20%20%20_tempMatrix.tx%20%3D%20-bounds.x%3B%0A%20%20%20%20_tempMatrix.ty%20%3D%20-bounds.y%3B%0A%0A%20%20%20%20renderTexture.render(this%2C%20_tempMatrix)%3B%0A%0A%20%20%20%20return%20renderTexture%3B%0A%7D%3B%0A%0A%2F*%0A%20*%20Updates%20the%20transform%20on%20all%20children%20of%20this%20container%20for%20rendering%0A%20*%0A%20*%20%40private%0A%20*%2F%0AContainer.prototype.updateTransform%20%3D%20function%20()%0A%7B%0A%20%20%20%20if%20(!this.visible)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.displayObjectUpdateTransform()%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%2C%20j%20%3D%20this.children.length%3B%20i%20%3C%20j%3B%20%2B%2Bi)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.children%5Bi%5D.updateTransform()%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F%2F%20performance%20increase%20to%20avoid%20using%20call..%20(10x%20faster)%0AContainer.prototype.containerUpdateTransform%20%3D%20Container.prototype.updateTransform%3B%0A%0A%2F**%0A%20*%20Retrieves%20the%20bounds%20of%20the%20Container%20as%20a%20rectangle.%20The%20bounds%20calculation%20takes%20all%20visible%20children%20into%20consideration.%0A%20*%0A%20*%20%40return%20%7BPIXI.Rectangle%7D%20The%20rectangular%20bounding%20area%0A%20*%2F%0AContainer.prototype.getBounds%20%3D%20function%20()%0A%7B%0A%20%20%20%20if(!this._currentBounds)%0A%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20if%20(this.children.length%20%3D%3D%3D%200)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20math.Rectangle.EMPTY%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20TODO%20the%20bounds%20have%20already%20been%20calculated%20this%20render%20session%20so%20return%20what%20we%20have%0A%0A%20%20%20%20%20%20%20%20var%20minX%20%3D%20Infinity%3B%0A%20%20%20%20%20%20%20%20var%20minY%20%3D%20Infinity%3B%0A%0A%20%20%20%20%20%20%20%20var%20maxX%20%3D%20-Infinity%3B%0A%20%20%20%20%20%20%20%20var%20maxY%20%3D%20-Infinity%3B%0A%0A%20%20%20%20%20%20%20%20var%20childBounds%3B%0A%20%20%20%20%20%20%20%20var%20childMaxX%3B%0A%20%20%20%20%20%20%20%20var%20childMaxY%3B%0A%0A%20%20%20%20%20%20%20%20var%20childVisible%20%3D%20false%3B%0A%0A%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%200%2C%20j%20%3D%20this.children.length%3B%20i%20%3C%20j%3B%20%2B%2Bi)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20child%20%3D%20this.children%5Bi%5D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!child.visible)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20childVisible%20%3D%20true%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20childBounds%20%3D%20this.children%5Bi%5D.getBounds()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20minX%20%3D%20minX%20%3C%20childBounds.x%20%3F%20minX%20%3A%20childBounds.x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20minY%20%3D%20minY%20%3C%20childBounds.y%20%3F%20minY%20%3A%20childBounds.y%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20childMaxX%20%3D%20childBounds.width%20%2B%20childBounds.x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20childMaxY%20%3D%20childBounds.height%20%2B%20childBounds.y%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20maxX%20%3D%20maxX%20%3E%20childMaxX%20%3F%20maxX%20%3A%20childMaxX%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20maxY%20%3D%20maxY%20%3E%20childMaxY%20%3F%20maxY%20%3A%20childMaxY%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if%20(!childVisible)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20math.Rectangle.EMPTY%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20var%20bounds%20%3D%20this._bounds%3B%0A%0A%20%20%20%20%20%20%20%20bounds.x%20%3D%20minX%3B%0A%20%20%20%20%20%20%20%20bounds.y%20%3D%20minY%3B%0A%20%20%20%20%20%20%20%20bounds.width%20%3D%20maxX%20-%20minX%3B%0A%20%20%20%20%20%20%20%20bounds.height%20%3D%20maxY%20-%20minY%3B%0A%0A%20%20%20%20%20%20%20%20this._currentBounds%20%3D%20bounds%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20this._currentBounds%3B%0A%7D%3B%0A%0AContainer.prototype.containerGetBounds%20%3D%20Container.prototype.getBounds%3B%0A%0A%2F**%0A%20*%20Retrieves%20the%20non-global%20local%20bounds%20of%20the%20Container%20as%20a%20rectangle.%0A%20*%20The%20calculation%20takes%20all%20visible%20children%20into%20consideration.%0A%20*%0A%20*%20%40return%20%7BPIXI.Rectangle%7D%20The%20rectangular%20bounding%20area%0A%20*%2F%0AContainer.prototype.getLocalBounds%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20matrixCache%20%3D%20this.worldTransform%3B%0A%0A%20%20%20%20this.worldTransform%20%3D%20math.Matrix.IDENTITY%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%2C%20j%20%3D%20this.children.length%3B%20i%20%3C%20j%3B%20%2B%2Bi)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.children%5Bi%5D.updateTransform()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.worldTransform%20%3D%20matrixCache%3B%0A%0A%20%20%20%20this._currentBounds%20%3D%20null%3B%0A%0A%20%20%20%20return%20this.getBounds(%20math.Matrix.IDENTITY%20)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Renders%20the%20object%20using%20the%20WebGL%20renderer%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20The%20renderer%0A%20*%2F%0AContainer.prototype.renderWebGL%20%3D%20function%20(renderer)%0A%7B%0A%0A%20%20%20%20%2F%2F%20if%20the%20object%20is%20not%20visible%20or%20the%20alpha%20is%200%20then%20no%20need%20to%20render%20this%20element%0A%20%20%20%20if%20(!this.visible%20%7C%7C%20this.worldAlpha%20%3C%3D%200%20%7C%7C%20!this.renderable)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20i%2C%20j%3B%0A%0A%20%20%20%20%2F%2F%20do%20a%20quick%20check%20to%20see%20if%20this%20element%20has%20a%20mask%20or%20a%20filter.%0A%20%20%20%20if%20(this._mask%20%7C%7C%20this._filters)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20renderer.currentRenderer.flush()%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20push%20filter%20first%20as%20we%20need%20to%20ensure%20the%20stencil%20buffer%20is%20correct%20for%20any%20masking%0A%20%20%20%20%20%20%20%20if%20(this._filters%20%26%26%20this._filters.length)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderer.filterManager.pushFilter(this%2C%20this._filters)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if%20(this._mask)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderer.maskManager.pushMask(this%2C%20this._mask)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20renderer.currentRenderer.start()%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20add%20this%20object%20to%20the%20batch%2C%20only%20rendered%20if%20it%20has%20a%20texture.%0A%20%20%20%20%20%20%20%20this._renderWebGL(renderer)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20now%20loop%20through%20the%20children%20and%20make%20sure%20they%20get%20rendered%0A%20%20%20%20%20%20%20%20for%20(i%20%3D%200%2C%20j%20%3D%20this.children.length%3B%20i%20%3C%20j%3B%20i%2B%2B)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.children%5Bi%5D.renderWebGL(renderer)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20renderer.currentRenderer.flush()%3B%0A%0A%20%20%20%20%20%20%20%20if%20(this._mask)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderer.maskManager.popMask(this%2C%20this._mask)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if%20(this._filters)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderer.filterManager.popFilter()%3B%0A%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20renderer.currentRenderer.start()%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this._renderWebGL(renderer)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20simple%20render%20children!%0A%20%20%20%20%20%20%20%20for%20(i%20%3D%200%2C%20j%20%3D%20this.children.length%3B%20i%20%3C%20j%3B%20%2B%2Bi)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.children%5Bi%5D.renderWebGL(renderer)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20To%20be%20overridden%20by%20the%20subclass%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20The%20renderer%0A%20*%20%40private%0A%20*%2F%0AContainer.prototype._renderWebGL%20%3D%20function%20(renderer)%20%2F%2F%20jshint%20unused%3Afalse%0A%7B%0A%20%20%20%20%2F%2F%20this%20is%20where%20content%20itself%20gets%20rendered...%0A%7D%3B%0A%0A%2F**%0A%20*%20To%20be%20overridden%20by%20the%20subclass%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.CanvasRenderer%7D%20The%20renderer%0A%20*%20%40private%0A%20*%2F%0AContainer.prototype._renderCanvas%20%3D%20function%20(renderer)%20%2F%2F%20jshint%20unused%3Afalse%0A%7B%0A%20%20%20%20%2F%2F%20this%20is%20where%20content%20itself%20gets%20rendered...%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Renders%20the%20object%20using%20the%20Canvas%20renderer%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.CanvasRenderer%7D%20The%20renderer%0A%20*%2F%0AContainer.prototype.renderCanvas%20%3D%20function%20(renderer)%0A%7B%0A%20%20%20%20%2F%2F%20if%20not%20visible%20or%20the%20alpha%20is%200%20then%20no%20need%20to%20render%20this%0A%20%20%20%20if%20(!this.visible%20%7C%7C%20this.alpha%20%3C%3D%200%20%7C%7C%20!this.renderable)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(this._mask)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20renderer.maskManager.pushMask(this._mask%2C%20renderer)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this._renderCanvas(renderer)%3B%0A%20%20%20%20for%20(var%20i%20%3D%200%2C%20j%20%3D%20this.children.length%3B%20i%20%3C%20j%3B%20%2B%2Bi)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.children%5Bi%5D.renderCanvas(renderer)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(this._mask)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20renderer.maskManager.popMask(renderer)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20the%20container%0A%20*%20%40param%20%5BdestroyChildren%3Dfalse%5D%20%7Bboolean%7D%20if%20set%20to%20true%2C%20all%20the%20children%20will%20have%20their%20destroy%20method%20called%20as%20well%0A%20*%2F%0AContainer.prototype.destroy%20%3D%20function%20(destroyChildren)%0A%7B%0A%20%20%20%20DisplayObject.prototype.destroy.call(this)%3B%0A%0A%20%20%20%20if%20(destroyChildren)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%200%2C%20j%20%3D%20this.children.length%3B%20i%20%3C%20j%3B%20%2B%2Bi)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.children%5Bi%5D.destroy(destroyChildren)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.removeChildren()%3B%0A%0A%20%20%20%20this.children%20%3D%20null%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fmath%22%3A23%2C%22..%2Ftextures%2FRenderTexture%22%3A61%2C%22.%2FDisplayObject%22%3A15%7D%5D%2C15%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20math%20%3D%20require('..%2Fmath')%2C%0A%20%20%20%20RenderTexture%20%3D%20require('..%2Ftextures%2FRenderTexture')%2C%0A%20%20%20%20EventEmitter%20%3D%20require('eventemitter3')%2C%0A%20%20%20%20CONST%20%3D%20require('..%2Fconst')%2C%0A%20%20%20%20_tempMatrix%20%3D%20new%20math.Matrix()%2C%0A%20%20%20%20_tempDisplayObjectParent%20%3D%20%7BworldTransform%3Anew%20math.Matrix()%2C%20worldAlpha%3A1%2C%20children%3A%5B%5D%7D%3B%0A%0A%0A%2F**%0A%20*%20The%20base%20class%20for%20all%20objects%20that%20are%20rendered%20on%20the%20screen.%0A%20*%20This%20is%20an%20abstract%20class%20and%20should%20not%20be%20used%20on%20its%20own%20rather%20it%20should%20be%20extended.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20EventEmitter%0A%20*%20%40memberof%20PIXI%0A%20*%2F%0Afunction%20DisplayObject()%0A%7B%0A%20%20%20%20EventEmitter.call(this)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20coordinate%20of%20the%20object%20relative%20to%20the%20local%20coordinates%20of%20the%20parent.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Point%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.position%20%3D%20new%20math.Point()%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20scale%20factor%20of%20the%20object.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Point%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.scale%20%3D%20new%20math.Point(1%2C%201)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20pivot%20point%20of%20the%20displayObject%20that%20it%20rotates%20around%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Point%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.pivot%20%3D%20new%20math.Point(0%2C%200)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20rotation%20of%20the%20object%20in%20radians.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.rotation%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20opacity%20of%20the%20object.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.alpha%20%3D%201%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20visibility%20of%20the%20object.%20If%20false%20the%20object%20will%20not%20be%20drawn%2C%20and%0A%20%20%20%20%20*%20the%20updateTransform%20function%20will%20not%20be%20called.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.visible%20%3D%20true%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Can%20this%20object%20be%20rendered%2C%20if%20false%20the%20object%20will%20not%20be%20drawn%20but%20the%20updateTransform%0A%20%20%20%20%20*%20methods%20will%20still%20be%20called.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.renderable%20%3D%20true%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20display%20object%20container%20that%20contains%20this%20display%20object.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Container%7D%0A%20%20%20%20%20*%20%40readOnly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.parent%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20multiplied%20alpha%20of%20the%20displayObject%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40readOnly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.worldAlpha%20%3D%201%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Current%20transform%20of%20the%20object%20based%20on%20world%20(parent)%20factors%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Matrix%7D%0A%20%20%20%20%20*%20%40readOnly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.worldTransform%20%3D%20new%20math.Matrix()%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20area%20the%20filter%20is%20applied%20to.%20This%20is%20used%20as%20more%20of%20an%20optimisation%0A%20%20%20%20%20*%20rather%20than%20figuring%20out%20the%20dimensions%20of%20the%20displayObject%20each%20frame%20you%20can%20set%20this%20rectangle%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Rectangle%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.filterArea%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20cached%20sin%20rotation%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._sr%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20cached%20cos%20rotation%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._cr%20%3D%201%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20original%2C%20cached%20bounds%20of%20the%20object%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Rectangle%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._bounds%20%3D%20new%20math.Rectangle(0%2C%200%2C%201%2C%201)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20most%20up-to-date%20bounds%20of%20the%20object%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Rectangle%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._currentBounds%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20original%2C%20cached%20mask%20of%20the%20object%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Rectangle%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._mask%20%3D%20null%3B%0A%7D%0A%0A%2F%2F%20constructor%0ADisplayObject.prototype%20%3D%20Object.create(EventEmitter.prototype)%3B%0ADisplayObject.prototype.constructor%20%3D%20DisplayObject%3B%0Amodule.exports%20%3D%20DisplayObject%3B%0A%0AObject.defineProperties(DisplayObject.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20position%20of%20the%20displayObject%20on%20the%20x%20axis%20relative%20to%20the%20local%20coordinates%20of%20the%20parent.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.DisplayObject%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20x%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.position.x%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.position.x%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20position%20of%20the%20displayObject%20on%20the%20y%20axis%20relative%20to%20the%20local%20coordinates%20of%20the%20parent.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.DisplayObject%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20y%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.position.y%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.position.y%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Indicates%20if%20the%20sprite%20is%20globally%20visible.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.DisplayObject%23%0A%20%20%20%20%20*%20%40readonly%0A%20%20%20%20%20*%2F%0A%20%20%20%20worldVisible%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20item%20%3D%20this%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!item.visible)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20item%20%3D%20item.parent%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20while%20(item)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20a%20mask%20for%20the%20displayObject.%20A%20mask%20is%20an%20object%20that%20limits%20the%20visibility%20of%20an%20object%20to%20the%20shape%20of%20the%20mask%20applied%20to%20it.%0A%20%20%20%20%20*%20In%20PIXI%20a%20regular%20mask%20must%20be%20a%20PIXI.Graphics%20or%20a%20PIXI.Sprite%20object.%20This%20allows%20for%20much%20faster%20masking%20in%20canvas%20as%20it%20utilises%20shape%20clipping.%0A%20%20%20%20%20*%20To%20remove%20a%20mask%2C%20set%20this%20property%20to%20null.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Graphics%7CPIXI.Sprite%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.DisplayObject%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20mask%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this._mask%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(this._mask)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._mask.renderable%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20this._mask%20%3D%20value%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(this._mask)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._mask.renderable%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20filters%20for%20the%20displayObject.%0A%20%20%20%20%20*%20*%20IMPORTANT%3A%20This%20is%20a%20webGL%20only%20feature%20and%20will%20be%20ignored%20by%20the%20canvas%20renderer.%0A%20%20%20%20%20*%20To%20remove%20filters%20simply%20set%20this%20property%20to%20'null'%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.AbstractFilter%5B%5D%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.DisplayObject%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20filters%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this._filters%20%26%26%20this._filters.slice()%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._filters%20%3D%20value%20%26%26%20value.slice()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%7D)%3B%0A%0A%2F*%0A%20*%20Updates%20the%20object%20transform%20for%20rendering%0A%20*%0A%20*%20TODO%20-%20Optimization%20pass!%0A%20*%2F%0ADisplayObject.prototype.updateTransform%20%3D%20function%20()%0A%7B%0A%0A%20%20%20%20%2F%2F%20create%20some%20matrix%20refs%20for%20easy%20access%0A%20%20%20%20var%20pt%20%3D%20this.parent.worldTransform%3B%0A%20%20%20%20var%20wt%20%3D%20this.worldTransform%3B%0A%0A%20%20%20%20%2F%2F%20temporary%20matrix%20variables%0A%20%20%20%20var%20a%2C%20b%2C%20c%2C%20d%2C%20tx%2C%20ty%3B%0A%0A%20%20%20%20%2F%2F%20so%20if%20rotation%20is%20between%200%20then%20we%20can%20simplify%20the%20multiplication%20process...%0A%20%20%20%20if%20(this.rotation%20%25%20CONST.PI_2)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20check%20to%20see%20if%20the%20rotation%20is%20the%20same%20as%20the%20previous%20render.%20This%20means%20we%20only%20need%20to%20use%20sin%20and%20cos%20when%20rotation%20actually%20changes%0A%20%20%20%20%20%20%20%20if%20(this.rotation%20!%3D%3D%20this.rotationCache)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.rotationCache%20%3D%20this.rotation%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._sr%20%3D%20Math.sin(this.rotation)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._cr%20%3D%20Math.cos(this.rotation)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20get%20the%20matrix%20values%20of%20the%20displayobject%20based%20on%20its%20transform%20properties..%0A%20%20%20%20%20%20%20%20a%20%20%3D%20%20this._cr%20*%20this.scale.x%3B%0A%20%20%20%20%20%20%20%20b%20%20%3D%20%20this._sr%20*%20this.scale.x%3B%0A%20%20%20%20%20%20%20%20c%20%20%3D%20-this._sr%20*%20this.scale.y%3B%0A%20%20%20%20%20%20%20%20d%20%20%3D%20%20this._cr%20*%20this.scale.y%3B%0A%20%20%20%20%20%20%20%20tx%20%3D%20%20this.position.x%3B%0A%20%20%20%20%20%20%20%20ty%20%3D%20%20this.position.y%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20check%20for%20pivot..%20not%20often%20used%20so%20geared%20towards%20that%20fact!%0A%20%20%20%20%20%20%20%20if%20(this.pivot.x%20%7C%7C%20this.pivot.y)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20tx%20-%3D%20this.pivot.x%20*%20a%20%2B%20this.pivot.y%20*%20c%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20ty%20-%3D%20this.pivot.x%20*%20b%20%2B%20this.pivot.y%20*%20d%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20concat%20the%20parent%20matrix%20with%20the%20objects%20transform.%0A%20%20%20%20%20%20%20%20wt.a%20%20%3D%20a%20%20*%20pt.a%20%2B%20b%20%20*%20pt.c%3B%0A%20%20%20%20%20%20%20%20wt.b%20%20%3D%20a%20%20*%20pt.b%20%2B%20b%20%20*%20pt.d%3B%0A%20%20%20%20%20%20%20%20wt.c%20%20%3D%20c%20%20*%20pt.a%20%2B%20d%20%20*%20pt.c%3B%0A%20%20%20%20%20%20%20%20wt.d%20%20%3D%20c%20%20*%20pt.b%20%2B%20d%20%20*%20pt.d%3B%0A%20%20%20%20%20%20%20%20wt.tx%20%3D%20tx%20*%20pt.a%20%2B%20ty%20*%20pt.c%20%2B%20pt.tx%3B%0A%20%20%20%20%20%20%20%20wt.ty%20%3D%20tx%20*%20pt.b%20%2B%20ty%20*%20pt.d%20%2B%20pt.ty%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20lets%20do%20the%20fast%20version%20as%20we%20know%20there%20is%20no%20rotation..%0A%20%20%20%20%20%20%20%20a%20%20%3D%20this.scale.x%3B%0A%20%20%20%20%20%20%20%20d%20%20%3D%20this.scale.y%3B%0A%0A%20%20%20%20%20%20%20%20tx%20%3D%20this.position.x%20-%20this.pivot.x%20*%20a%3B%0A%20%20%20%20%20%20%20%20ty%20%3D%20this.position.y%20-%20this.pivot.y%20*%20d%3B%0A%0A%20%20%20%20%20%20%20%20wt.a%20%20%3D%20a%20%20*%20pt.a%3B%0A%20%20%20%20%20%20%20%20wt.b%20%20%3D%20a%20%20*%20pt.b%3B%0A%20%20%20%20%20%20%20%20wt.c%20%20%3D%20d%20%20*%20pt.c%3B%0A%20%20%20%20%20%20%20%20wt.d%20%20%3D%20d%20%20*%20pt.d%3B%0A%20%20%20%20%20%20%20%20wt.tx%20%3D%20tx%20*%20pt.a%20%2B%20ty%20*%20pt.c%20%2B%20pt.tx%3B%0A%20%20%20%20%20%20%20%20wt.ty%20%3D%20tx%20*%20pt.b%20%2B%20ty%20*%20pt.d%20%2B%20pt.ty%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20multiply%20the%20alphas..%0A%20%20%20%20this.worldAlpha%20%3D%20this.alpha%20*%20this.parent.worldAlpha%3B%0A%0A%20%20%20%20%2F%2F%20reset%20the%20bounds%20each%20time%20this%20is%20called!%0A%20%20%20%20this._currentBounds%20%3D%20null%3B%0A%7D%3B%0A%0A%2F%2F%20performance%20increase%20to%20avoid%20using%20call..%20(10x%20faster)%0ADisplayObject.prototype.displayObjectUpdateTransform%20%3D%20DisplayObject.prototype.updateTransform%3B%0A%0A%2F**%0A%20*%0A%20*%0A%20*%20Retrieves%20the%20bounds%20of%20the%20displayObject%20as%20a%20rectangle%20object%0A%20*%0A%20*%20%40param%20matrix%20%7BPIXI.Matrix%7D%0A%20*%20%40return%20%7BPIXI.Rectangle%7D%20the%20rectangular%20bounding%20area%0A%20*%2F%0ADisplayObject.prototype.getBounds%20%3D%20function%20(matrix)%20%2F%2F%20jshint%20unused%3Afalse%0A%7B%0A%20%20%20%20return%20math.Rectangle.EMPTY%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Retrieves%20the%20local%20bounds%20of%20the%20displayObject%20as%20a%20rectangle%20object%0A%20*%0A%20*%20%40return%20%7BPIXI.Rectangle%7D%20the%20rectangular%20bounding%20area%0A%20*%2F%0ADisplayObject.prototype.getLocalBounds%20%3D%20function%20()%0A%7B%0A%20%20%20%20return%20this.getBounds(math.Matrix.IDENTITY)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Calculates%20the%20global%20position%20of%20the%20display%20object%0A%20*%0A%20*%20%40param%20position%20%7BPIXI.Point%7D%20The%20world%20origin%20to%20calculate%20from%0A%20*%20%40return%20%7BPIXI.Point%7D%20A%20point%20object%20representing%20the%20position%20of%20this%20object%0A%20*%2F%0ADisplayObject.prototype.toGlobal%20%3D%20function%20(position)%0A%7B%0A%20%20%20%20%2F%2F%20this%20parent%20check%20is%20for%20just%20in%20case%20the%20item%20is%20a%20root%20object.%0A%20%20%20%20%2F%2F%20If%20it%20is%20we%20need%20to%20give%20it%20a%20temporary%20parent%20so%20that%20displayObjectUpdateTransform%20works%20correctly%0A%20%20%20%20%2F%2F%20this%20is%20mainly%20to%20avoid%20a%20parent%20check%20in%20the%20main%20loop.%20Every%20little%20helps%20for%20performance%20%3A)%0A%20%20%20%20if(!this.parent)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.parent%20%3D%20_tempDisplayObjectParent%3B%0A%20%20%20%20%20%20%20%20this.displayObjectUpdateTransform()%3B%0A%20%20%20%20%20%20%20%20this.parent%20%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.displayObjectUpdateTransform()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20don't%20need%20to%20update%20the%20lot%0A%20%20%20%20return%20this.worldTransform.apply(position)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Calculates%20the%20local%20position%20of%20the%20display%20object%20relative%20to%20another%20point%0A%20*%0A%20*%20%40param%20position%20%7BPIXI.Point%7D%20The%20world%20origin%20to%20calculate%20from%0A%20*%20%40param%20%5Bfrom%5D%20%7BPIXI.DisplayObject%7D%20The%20DisplayObject%20to%20calculate%20the%20global%20position%20from%0A%20*%20%40return%20%7BPIXI.Point%7D%20A%20point%20object%20representing%20the%20position%20of%20this%20object%0A%20*%2F%0ADisplayObject.prototype.toLocal%20%3D%20function%20(position%2C%20from)%0A%7B%0A%20%20%20%20if%20(from)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20position%20%3D%20from.toGlobal(position)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20this%20parent%20check%20is%20for%20just%20in%20case%20the%20item%20is%20a%20root%20object.%0A%20%20%20%20%2F%2F%20If%20it%20is%20we%20need%20to%20give%20it%20a%20temporary%20parent%20so%20that%20displayObjectUpdateTransform%20works%20correctly%0A%20%20%20%20%2F%2F%20this%20is%20mainly%20to%20avoid%20a%20parent%20check%20in%20the%20main%20loop.%20Every%20little%20helps%20for%20performance%20%3A)%0A%20%20%20%20if(!this.parent)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.parent%20%3D%20_tempDisplayObjectParent%3B%0A%20%20%20%20%20%20%20%20this.displayObjectUpdateTransform()%3B%0A%20%20%20%20%20%20%20%20this.parent%20%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.displayObjectUpdateTransform()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20simply%20apply%20the%20matrix..%0A%20%20%20%20return%20this.worldTransform.applyInverse(position)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Renders%20the%20object%20using%20the%20WebGL%20renderer%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20The%20renderer%0A%20*%20%40private%0A%20*%2F%0ADisplayObject.prototype.renderWebGL%20%3D%20function%20(renderer)%20%2F%2F%20jshint%20unused%3Afalse%0A%7B%0A%20%20%20%20%2F%2F%20OVERWRITE%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Renders%20the%20object%20using%20the%20Canvas%20renderer%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.CanvasRenderer%7D%20The%20renderer%0A%20*%20%40private%0A%20*%2F%0ADisplayObject.prototype.renderCanvas%20%3D%20function%20(renderer)%20%2F%2F%20jshint%20unused%3Afalse%0A%7B%0A%20%20%20%20%2F%2F%20OVERWRITE%3B%0A%7D%3B%0A%2F**%0A%20*%20Useful%20function%20that%20returns%20a%20texture%20of%20the%20display%20object%20that%20can%20then%20be%20used%20to%20create%20sprites%0A%20*%20This%20can%20be%20quite%20useful%20if%20your%20displayObject%20is%20static%20%2F%20complicated%20and%20needs%20to%20be%20reused%20multiple%20times.%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.CanvasRenderer%7CPIXI.WebGLRenderer%7D%20The%20renderer%20used%20to%20generate%20the%20texture.%0A%20*%20%40param%20scaleMode%20%7Bnumber%7D%20See%20%7B%40link%20PIXI.SCALE_MODES%7D%20for%20possible%20values%0A%20*%20%40param%20resolution%20%7Bnumber%7D%20The%20resolution%20of%20the%20texture%20being%20generated%0A%20*%20%40return%20%7BPIXI.Texture%7D%20a%20texture%20of%20the%20display%20object%0A%20*%2F%0ADisplayObject.prototype.generateTexture%20%3D%20function%20(renderer%2C%20scaleMode%2C%20resolution)%0A%7B%0A%20%20%20%20var%20bounds%20%3D%20this.getLocalBounds()%3B%0A%0A%20%20%20%20var%20renderTexture%20%3D%20new%20RenderTexture(renderer%2C%20bounds.width%20%7C%200%2C%20bounds.height%20%7C%200%2C%20scaleMode%2C%20resolution)%3B%0A%0A%20%20%20%20_tempMatrix.tx%20%3D%20-bounds.x%3B%0A%20%20%20%20_tempMatrix.ty%20%3D%20-bounds.y%3B%0A%0A%20%20%20%20renderTexture.render(this%2C%20_tempMatrix)%3B%0A%0A%20%20%20%20return%20renderTexture%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Set%20the%20parent%20Container%20of%20this%20DisplayObject%0A%20*%0A%20*%20%40param%20container%20%7BContainer%7D%20The%20Container%20to%20add%20this%20DisplayObject%20to%0A%20*%20%40return%20%7BContainer%7D%20The%20Container%20that%20this%20DisplayObject%20was%20added%20to%0A%20*%2F%0ADisplayObject.prototype.setParent%20%3D%20function%20(container)%0A%7B%0A%20%20%20%20if%20(!container%20%7C%7C%20!container.addChild)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error('setParent%3A%20Argument%20must%20be%20a%20Container')%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20container.addChild(this)%3B%0A%20%20%20%20return%20container%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Base%20destroy%20method%20for%20generic%20display%20objects%0A%20*%0A%20*%2F%0ADisplayObject.prototype.destroy%20%3D%20function%20()%0A%7B%0A%0A%20%20%20%20this.position%20%3D%20null%3B%0A%20%20%20%20this.scale%20%3D%20null%3B%0A%20%20%20%20this.pivot%20%3D%20null%3B%0A%0A%20%20%20%20this.parent%20%3D%20null%3B%0A%0A%20%20%20%20this._bounds%20%3D%20null%3B%0A%20%20%20%20this._currentBounds%20%3D%20null%3B%0A%20%20%20%20this._mask%20%3D%20null%3B%0A%0A%20%20%20%20this.worldTransform%20%3D%20null%3B%0A%20%20%20%20this.filterArea%20%3D%20null%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fconst%22%3A13%2C%22..%2Fmath%22%3A23%2C%22..%2Ftextures%2FRenderTexture%22%3A61%2C%22eventemitter3%22%3A10%7D%5D%2C16%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20Container%20%3D%20require('..%2Fdisplay%2FContainer')%2C%0A%20%20%20%20Texture%20%3D%20require('..%2Ftextures%2FTexture')%2C%0A%20%20%20%20CanvasBuffer%20%3D%20require('..%2Frenderers%2Fcanvas%2Futils%2FCanvasBuffer')%2C%0A%20%20%20%20CanvasGraphics%20%3D%20require('..%2Frenderers%2Fcanvas%2Futils%2FCanvasGraphics')%2C%0A%20%20%20%20GraphicsData%20%3D%20require('.%2FGraphicsData')%2C%0A%20%20%20%20math%20%3D%20require('..%2Fmath')%2C%0A%20%20%20%20CONST%20%3D%20require('..%2Fconst')%2C%0A%20%20%20%20tempPoint%20%3D%20new%20math.Point()%3B%0A%0A%2F**%0A%20*%20The%20Graphics%20class%20contains%20methods%20used%20to%20draw%20primitive%20shapes%20such%20as%20lines%2C%20circles%20and%0A%20*%20rectangles%20to%20the%20display%2C%20and%20to%20color%20and%20fill%20them.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.Container%0A%20*%20%40memberof%20PIXI%0A%20*%2F%0Afunction%20Graphics()%0A%7B%0A%20%20%20%20Container.call(this)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20alpha%20value%20used%20when%20filling%20the%20Graphics%20object.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%201%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.fillAlpha%20%3D%201%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20width%20(thickness)%20of%20any%20lines%20drawn.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.lineWidth%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20color%20of%20any%20lines%20drawn.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bstring%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.lineColor%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Graphics%20data%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.GraphicsData%5B%5D%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.graphicsData%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20tint%20applied%20to%20the%20graphic%20shape.%20This%20is%20a%20hex%20value.%20Apply%20a%20value%20of%200xFFFFFF%20to%20reset%20the%20tint.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200xFFFFFF%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.tint%20%3D%200xFFFFFF%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20previous%20tint%20applied%20to%20the%20graphic%20shape.%20Used%20to%20compare%20to%20the%20current%20tint%20and%20check%20if%20theres%20change.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40default%200xFFFFFF%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._prevTint%20%3D%200xFFFFFF%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20blend%20mode%20to%20be%20applied%20to%20the%20graphic%20shape.%20Apply%20a%20value%20of%20%60PIXI.BLEND_MODES.NORMAL%60%20to%20reset%20the%20blend%20mode.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%20PIXI.BLEND_MODES.NORMAL%3B%0A%20%20%20%20%20*%20%40see%20PIXI.BLEND_MODES%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.blendMode%20%3D%20CONST.BLEND_MODES.NORMAL%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Current%20path%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.GraphicsData%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.currentPath%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Array%20containing%20some%20WebGL-related%20properties%20used%20by%20the%20WebGL%20renderer.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bobject%3Cnumber%2C%20object%3E%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20%2F%2F%20TODO%20-%20_webgl%20should%20use%20a%20prototype%20object%2C%20not%20a%20random%20undocumented%20object...%0A%20%20%20%20this._webGL%20%3D%20%7B%7D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Whether%20this%20shape%20is%20being%20used%20as%20a%20mask.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.isMask%20%3D%20false%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20bounds'%20padding%20used%20for%20bounds%20calculation.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.boundsPadding%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20A%20cache%20of%20the%20local%20bounds%20to%20prevent%20recalculation.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Rectangle%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._localBounds%20%3D%20new%20math.Rectangle(0%2C0%2C1%2C1)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Used%20to%20detect%20if%20the%20graphics%20object%20has%20changed.%20If%20this%20is%20set%20to%20true%20then%20the%20graphics%0A%20%20%20%20%20*%20object%20will%20be%20recalculated.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.dirty%20%3D%20true%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Used%20to%20detect%20if%20the%20WebGL%20graphics%20object%20has%20changed.%20If%20this%20is%20set%20to%20true%20then%20the%0A%20%20%20%20%20*%20graphics%20object%20will%20be%20recalculated.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.glDirty%20%3D%20false%3B%0A%0A%20%20%20%20this.boundsDirty%20%3D%20true%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Used%20to%20detect%20if%20the%20cached%20sprite%20object%20needs%20to%20be%20updated.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.cachedSpriteDirty%20%3D%20false%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20When%20cacheAsBitmap%20is%20set%20to%20true%20the%20graphics%20object%20will%20be%20rendered%20as%20if%20it%20was%20a%20sprite.%0A%20%20%20%20%20*%20This%20is%20useful%20if%20your%20graphics%20element%20does%20not%20change%20often%2C%20as%20it%20will%20speed%20up%20the%20rendering%0A%20%20%20%20%20*%20of%20the%20object%20in%20exchange%20for%20taking%20up%20texture%20memory.%20It%20is%20also%20useful%20if%20you%20need%20the%20graphics%0A%20%20%20%20%20*%20object%20to%20be%20anti-aliased%2C%20because%20it%20will%20be%20rendered%20using%20canvas.%20This%20is%20not%20recommended%20if%0A%20%20%20%20%20*%20you%20are%20constantly%20redrawing%20the%20graphics%20element.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40name%20cacheAsBitmap%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.Graphics%23%0A%20%20%20%20%20*%20%40default%20false%0A%20%20%20%20%20*%2F%0A%7D%0A%0A%2F%2F%20constructor%0AGraphics.prototype%20%3D%20Object.create(Container.prototype)%3B%0AGraphics.prototype.constructor%20%3D%20Graphics%3B%0Amodule.exports%20%3D%20Graphics%3B%0A%0A%2F**%0A%20*%20Creates%20a%20new%20Graphics%20object%20with%20the%20same%20values%20as%20this%20one.%0A%20*%20Note%20that%20the%20only%20the%20properties%20of%20the%20object%20are%20cloned%2C%20not%20its%20transform%20(position%2Cscale%2Cetc)%0A%20*%0A%20*%20%40return%20%7BPIXI.Graphics%7D%0A%20*%2F%0AGraphics.prototype.clone%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20clone%20%3D%20new%20Graphics()%3B%0A%0A%20%20%20%20clone.renderable%20%20%20%20%3D%20this.renderable%3B%0A%20%20%20%20clone.fillAlpha%20%20%20%20%20%3D%20this.fillAlpha%3B%0A%20%20%20%20clone.lineWidth%20%20%20%20%20%3D%20this.lineWidth%3B%0A%20%20%20%20clone.lineColor%20%20%20%20%20%3D%20this.lineColor%3B%0A%20%20%20%20clone.tint%20%20%20%20%20%20%20%20%20%20%3D%20this.tint%3B%0A%20%20%20%20clone.blendMode%20%20%20%20%20%3D%20this.blendMode%3B%0A%20%20%20%20clone.isMask%20%20%20%20%20%20%20%20%3D%20this.isMask%3B%0A%20%20%20%20clone.boundsPadding%20%3D%20this.boundsPadding%3B%0A%20%20%20%20clone.dirty%20%20%20%20%20%20%20%20%20%3D%20true%3B%0A%20%20%20%20clone.glDirty%20%20%20%20%20%20%20%3D%20true%3B%0A%20%20%20%20clone.cachedSpriteDirty%20%3D%20this.cachedSpriteDirty%3B%0A%0A%20%20%20%20%2F%2F%20copy%20graphics%20data%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20this.graphicsData.length%3B%20%2B%2Bi)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20clone.graphicsData.push(this.graphicsData%5Bi%5D.clone())%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20clone.currentPath%20%3D%20clone.graphicsData%5Bclone.graphicsData.length%20-%201%5D%3B%0A%0A%20%20%20%20clone.updateLocalBounds()%3B%0A%0A%20%20%20%20return%20clone%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Specifies%20the%20line%20style%20used%20for%20subsequent%20calls%20to%20Graphics%20methods%20such%20as%20the%20lineTo()%20method%20or%20the%20drawCircle()%20method.%0A%20*%0A%20*%20%40param%20lineWidth%20%7Bnumber%7D%20width%20of%20the%20line%20to%20draw%2C%20will%20update%20the%20objects%20stored%20style%0A%20*%20%40param%20color%20%7Bnumber%7D%20color%20of%20the%20line%20to%20draw%2C%20will%20update%20the%20objects%20stored%20style%0A%20*%20%40param%20alpha%20%7Bnumber%7D%20alpha%20of%20the%20line%20to%20draw%2C%20will%20update%20the%20objects%20stored%20style%0A%20*%20%40return%20%7BPIXI.Graphics%7D%0A%20*%2F%0AGraphics.prototype.lineStyle%20%3D%20function%20(lineWidth%2C%20color%2C%20alpha)%0A%7B%0A%20%20%20%20this.lineWidth%20%3D%20lineWidth%20%7C%7C%200%3B%0A%20%20%20%20this.lineColor%20%3D%20color%20%7C%7C%200%3B%0A%20%20%20%20this.lineAlpha%20%3D%20(alpha%20%3D%3D%3D%20undefined)%20%3F%201%20%3A%20alpha%3B%0A%0A%20%20%20%20if%20(this.currentPath)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(this.currentPath.shape.points.length)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20halfway%20through%20a%20line%3F%20start%20a%20new%20one!%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20shape%20%3D%20new%20math.Polygon(this.currentPath.shape.points.slice(-2))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20shape.closed%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.drawShape(shape)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20otherwise%20its%20empty%20so%20lets%20just%20set%20the%20line%20properties%0A%20%20%20%20%20%20%20%20%20%20%20%20this.currentPath.lineWidth%20%3D%20this.lineWidth%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.currentPath.lineColor%20%3D%20this.lineColor%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.currentPath.lineAlpha%20%3D%20this.lineAlpha%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Moves%20the%20current%20drawing%20position%20to%20x%2C%20y.%0A%20*%0A%20*%20%40param%20x%20%7Bnumber%7D%20the%20X%20coordinate%20to%20move%20to%0A%20*%20%40param%20y%20%7Bnumber%7D%20the%20Y%20coordinate%20to%20move%20to%0A%20*%20%40return%20%7BPIXI.Graphics%7D%0A%20%20*%2F%0AGraphics.prototype.moveTo%20%3D%20function%20(x%2C%20y)%0A%7B%0A%20%20%20%20var%20shape%20%3D%20new%20math.Polygon(%5Bx%2Cy%5D)%3B%0A%20%20%20%20shape.closed%20%3D%20false%3B%0A%20%20%20%20this.drawShape(shape)%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Draws%20a%20line%20using%20the%20current%20line%20style%20from%20the%20current%20drawing%20position%20to%20(x%2C%20y)%3B%0A%20*%20The%20current%20drawing%20position%20is%20then%20set%20to%20(x%2C%20y).%0A%20*%0A%20*%20%40param%20x%20%7Bnumber%7D%20the%20X%20coordinate%20to%20draw%20to%0A%20*%20%40param%20y%20%7Bnumber%7D%20the%20Y%20coordinate%20to%20draw%20to%0A%20*%20%40return%20%7BPIXI.Graphics%7D%0A%20*%2F%0AGraphics.prototype.lineTo%20%3D%20function%20(x%2C%20y)%0A%7B%0A%20%20%20%20this.currentPath.shape.points.push(x%2C%20y)%3B%0A%20%20%20%20this.dirty%20%3D%20true%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Calculate%20the%20points%20for%20a%20quadratic%20bezier%20curve%20and%20then%20draws%20it.%0A%20*%20Based%20on%3A%20https%3A%2F%2Fstackoverflow.com%2Fquestions%2F785097%2Fhow-do-i-implement-a-bezier-curve-in-c%0A%20*%0A%20*%20%40param%20cpX%20%7Bnumber%7D%20Control%20point%20x%0A%20*%20%40param%20cpY%20%7Bnumber%7D%20Control%20point%20y%0A%20*%20%40param%20toX%20%7Bnumber%7D%20Destination%20point%20x%0A%20*%20%40param%20toY%20%7Bnumber%7D%20Destination%20point%20y%0A%20*%20%40return%20%7BPIXI.Graphics%7D%0A%20*%2F%0AGraphics.prototype.quadraticCurveTo%20%3D%20function%20(cpX%2C%20cpY%2C%20toX%2C%20toY)%0A%7B%0A%20%20%20%20if%20(this.currentPath)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(this.currentPath.shape.points.length%20%3D%3D%3D%200)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.currentPath.shape.points%20%3D%20%5B0%2C%200%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.moveTo(0%2C0)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20xa%2C%0A%20%20%20%20%20%20%20%20ya%2C%0A%20%20%20%20%20%20%20%20n%20%3D%2020%2C%0A%20%20%20%20%20%20%20%20points%20%3D%20this.currentPath.shape.points%3B%0A%0A%20%20%20%20if%20(points.length%20%3D%3D%3D%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.moveTo(0%2C%200)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20fromX%20%3D%20points%5Bpoints.length-2%5D%3B%0A%20%20%20%20var%20fromY%20%3D%20points%5Bpoints.length-1%5D%3B%0A%0A%20%20%20%20var%20j%20%3D%200%3B%0A%20%20%20%20for%20(var%20i%20%3D%201%3B%20i%20%3C%3D%20n%3B%20%2B%2Bi)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20j%20%3D%20i%20%2F%20n%3B%0A%0A%20%20%20%20%20%20%20%20xa%20%3D%20fromX%20%2B%20(%20(cpX%20-%20fromX)%20*%20j%20)%3B%0A%20%20%20%20%20%20%20%20ya%20%3D%20fromY%20%2B%20(%20(cpY%20-%20fromY)%20*%20j%20)%3B%0A%0A%20%20%20%20%20%20%20%20points.push(%20xa%20%2B%20(%20((cpX%20%2B%20(%20(toX%20-%20cpX)%20*%20j%20))%20-%20xa)%20*%20j%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ya%20%2B%20(%20((cpY%20%2B%20(%20(toY%20-%20cpY)%20*%20j%20))%20-%20ya)%20*%20j%20)%20)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.dirty%20%3D%20this.boundsDirty%20%3D%20true%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Calculate%20the%20points%20for%20a%20bezier%20curve%20and%20then%20draws%20it.%0A%20*%0A%20*%20%40param%20cpX%20%7Bnumber%7D%20Control%20point%20x%0A%20*%20%40param%20cpY%20%7Bnumber%7D%20Control%20point%20y%0A%20*%20%40param%20cpX2%20%7Bnumber%7D%20Second%20Control%20point%20x%0A%20*%20%40param%20cpY2%20%7Bnumber%7D%20Second%20Control%20point%20y%0A%20*%20%40param%20toX%20%7Bnumber%7D%20Destination%20point%20x%0A%20*%20%40param%20toY%20%7Bnumber%7D%20Destination%20point%20y%0A%20*%20%40return%20%7BPIXI.Graphics%7D%0A%20*%2F%0AGraphics.prototype.bezierCurveTo%20%3D%20function%20(cpX%2C%20cpY%2C%20cpX2%2C%20cpY2%2C%20toX%2C%20toY)%0A%7B%0A%20%20%20%20if%20(this.currentPath)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(this.currentPath.shape.points.length%20%3D%3D%3D%200)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.currentPath.shape.points%20%3D%20%5B0%2C%200%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.moveTo(0%2C0)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20n%20%3D%2020%2C%0A%20%20%20%20%20%20%20%20dt%2C%0A%20%20%20%20%20%20%20%20dt2%2C%0A%20%20%20%20%20%20%20%20dt3%2C%0A%20%20%20%20%20%20%20%20t2%2C%0A%20%20%20%20%20%20%20%20t3%2C%0A%20%20%20%20%20%20%20%20points%20%3D%20this.currentPath.shape.points%3B%0A%0A%20%20%20%20var%20fromX%20%3D%20points%5Bpoints.length-2%5D%3B%0A%20%20%20%20var%20fromY%20%3D%20points%5Bpoints.length-1%5D%3B%0A%0A%20%20%20%20var%20j%20%3D%200%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%201%3B%20i%20%3C%3D%20n%3B%20%2B%2Bi)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20j%20%3D%20i%20%2F%20n%3B%0A%0A%20%20%20%20%20%20%20%20dt%20%3D%20(1%20-%20j)%3B%0A%20%20%20%20%20%20%20%20dt2%20%3D%20dt%20*%20dt%3B%0A%20%20%20%20%20%20%20%20dt3%20%3D%20dt2%20*%20dt%3B%0A%0A%20%20%20%20%20%20%20%20t2%20%3D%20j%20*%20j%3B%0A%20%20%20%20%20%20%20%20t3%20%3D%20t2%20*%20j%3B%0A%0A%20%20%20%20%20%20%20%20points.push(%20dt3%20*%20fromX%20%2B%203%20*%20dt2%20*%20j%20*%20cpX%20%2B%203%20*%20dt%20*%20t2%20*%20cpX2%20%2B%20t3%20*%20toX%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dt3%20*%20fromY%20%2B%203%20*%20dt2%20*%20j%20*%20cpY%20%2B%203%20*%20dt%20*%20t2%20*%20cpY2%20%2B%20t3%20*%20toY)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.dirty%20%3D%20this.boundsDirty%20%3D%20true%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20The%20arcTo()%20method%20creates%20an%20arc%2Fcurve%20between%20two%20tangents%20on%20the%20canvas.%0A%20*%0A%20*%20%22borrowed%22%20from%20https%3A%2F%2Fcode.google.com%2Fp%2Ffxcanvas%2F%20-%20thanks%20google!%0A%20*%0A%20*%20%40param%20x1%20%7Bnumber%7D%20The%20x-coordinate%20of%20the%20beginning%20of%20the%20arc%0A%20*%20%40param%20y1%20%7Bnumber%7D%20The%20y-coordinate%20of%20the%20beginning%20of%20the%20arc%0A%20*%20%40param%20x2%20%7Bnumber%7D%20The%20x-coordinate%20of%20the%20end%20of%20the%20arc%0A%20*%20%40param%20y2%20%7Bnumber%7D%20The%20y-coordinate%20of%20the%20end%20of%20the%20arc%0A%20*%20%40param%20radius%20%7Bnumber%7D%20The%20radius%20of%20the%20arc%0A%20*%20%40return%20%7BPIXI.Graphics%7D%0A%20*%2F%0AGraphics.prototype.arcTo%20%3D%20function%20(x1%2C%20y1%2C%20x2%2C%20y2%2C%20radius)%0A%7B%0A%20%20%20%20if%20(this.currentPath)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(this.currentPath.shape.points.length%20%3D%3D%3D%200)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.currentPath.shape.points.push(x1%2C%20y1)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.moveTo(x1%2C%20y1)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20points%20%3D%20this.currentPath.shape.points%2C%0A%20%20%20%20%20%20%20%20fromX%20%3D%20points%5Bpoints.length-2%5D%2C%0A%20%20%20%20%20%20%20%20fromY%20%3D%20points%5Bpoints.length-1%5D%2C%0A%20%20%20%20%20%20%20%20a1%20%3D%20fromY%20-%20y1%2C%0A%20%20%20%20%20%20%20%20b1%20%3D%20fromX%20-%20x1%2C%0A%20%20%20%20%20%20%20%20a2%20%3D%20y2%20%20%20-%20y1%2C%0A%20%20%20%20%20%20%20%20b2%20%3D%20x2%20%20%20-%20x1%2C%0A%20%20%20%20%20%20%20%20mm%20%3D%20Math.abs(a1%20*%20b2%20-%20b1%20*%20a2)%3B%0A%0A%20%20%20%20if%20(mm%20%3C%201.0e-8%20%7C%7C%20radius%20%3D%3D%3D%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(points%5Bpoints.length-2%5D%20!%3D%3D%20x1%20%7C%7C%20points%5Bpoints.length-1%5D%20!%3D%3D%20y1)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20points.push(x1%2C%20y1)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20dd%20%3D%20a1%20*%20a1%20%2B%20b1%20*%20b1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20cc%20%3D%20a2%20*%20a2%20%2B%20b2%20*%20b2%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tt%20%3D%20a1%20*%20a2%20%2B%20b1%20*%20b2%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20k1%20%3D%20radius%20*%20Math.sqrt(dd)%20%2F%20mm%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20k2%20%3D%20radius%20*%20Math.sqrt(cc)%20%2F%20mm%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20j1%20%3D%20k1%20*%20tt%20%2F%20dd%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20j2%20%3D%20k2%20*%20tt%20%2F%20cc%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20cx%20%3D%20k1%20*%20b2%20%2B%20k2%20*%20b1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20cy%20%3D%20k1%20*%20a2%20%2B%20k2%20*%20a1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20px%20%3D%20b1%20*%20(k2%20%2B%20j1)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20py%20%3D%20a1%20*%20(k2%20%2B%20j1)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20qx%20%3D%20b2%20*%20(k1%20%2B%20j2)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20qy%20%3D%20a2%20*%20(k1%20%2B%20j2)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20startAngle%20%3D%20Math.atan2(py%20-%20cy%2C%20px%20-%20cx)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20endAngle%20%20%20%3D%20Math.atan2(qy%20-%20cy%2C%20qx%20-%20cx)%3B%0A%0A%20%20%20%20%20%20%20%20this.arc(cx%20%2B%20x1%2C%20cy%20%2B%20y1%2C%20radius%2C%20startAngle%2C%20endAngle%2C%20b1%20*%20a2%20%3E%20b2%20*%20a1)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.dirty%20%3D%20this.boundsDirty%20%3D%20true%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20The%20arc%20method%20creates%20an%20arc%2Fcurve%20(used%20to%20create%20circles%2C%20or%20parts%20of%20circles).%0A%20*%0A%20*%20%40param%20cx%20%7Bnumber%7D%20The%20x-coordinate%20of%20the%20center%20of%20the%20circle%0A%20*%20%40param%20cy%20%7Bnumber%7D%20The%20y-coordinate%20of%20the%20center%20of%20the%20circle%0A%20*%20%40param%20radius%20%7Bnumber%7D%20The%20radius%20of%20the%20circle%0A%20*%20%40param%20startAngle%20%7Bnumber%7D%20The%20starting%20angle%2C%20in%20radians%20(0%20is%20at%20the%203%20o'clock%20position%20of%20the%20arc's%20circle)%0A%20*%20%40param%20endAngle%20%7Bnumber%7D%20The%20ending%20angle%2C%20in%20radians%0A%20*%20%40param%20anticlockwise%20%7Bboolean%7D%20Optional.%20Specifies%20whether%20the%20drawing%20should%20be%20counterclockwise%20or%20clockwise.%20False%20is%20default%2C%20and%20indicates%20clockwise%2C%20while%20true%20indicates%20counter-clockwise.%0A%20*%20%40return%20%7BPIXI.Graphics%7D%0A%20*%2F%0AGraphics.prototype.arc%20%3D%20function(cx%2C%20cy%2C%20radius%2C%20startAngle%2C%20endAngle%2C%20anticlockwise)%0A%7B%0A%20%20%20%20anticlockwise%20%3D%20anticlockwise%20%7C%7C%20false%3B%0A%0A%20%20%20%20if%20(startAngle%20%3D%3D%3D%20endAngle)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(%20!anticlockwise%20%26%26%20endAngle%20%3C%3D%20startAngle%20)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20endAngle%20%2B%3D%20Math.PI%20*%202%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%20if(%20anticlockwise%20%26%26%20startAngle%20%3C%3D%20endAngle%20)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20startAngle%20%2B%3D%20Math.PI%20*%202%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20sweep%20%3D%20anticlockwise%20%3F%20(startAngle%20-%20endAngle)%20*%20-1%20%3A%20(endAngle%20-%20startAngle)%3B%0A%20%20%20%20var%20segs%20%3D%20%20Math.ceil(Math.abs(sweep)%20%2F%20(Math.PI%20*%202))%20*%2040%3B%0A%0A%20%20%20%20if(sweep%20%3D%3D%3D%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20startX%20%3D%20cx%20%2B%20Math.cos(startAngle)%20*%20radius%3B%0A%20%20%20%20var%20startY%20%3D%20cy%20%2B%20Math.sin(startAngle)%20*%20radius%3B%0A%0A%20%20%20%20if%20(this.currentPath)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.currentPath.shape.points.push(startX%2C%20startY)%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.moveTo(startX%2C%20startY)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20points%20%3D%20this.currentPath.shape.points%3B%0A%0A%20%20%20%20var%20theta%20%3D%20sweep%2F(segs*2)%3B%0A%20%20%20%20var%20theta2%20%3D%20theta*2%3B%0A%0A%20%20%20%20var%20cTheta%20%3D%20Math.cos(theta)%3B%0A%20%20%20%20var%20sTheta%20%3D%20Math.sin(theta)%3B%0A%0A%20%20%20%20var%20segMinus%20%3D%20segs%20-%201%3B%0A%0A%20%20%20%20var%20remainder%20%3D%20(%20segMinus%20%25%201%20)%20%2F%20segMinus%3B%0A%0A%20%20%20%20for(var%20i%3D0%3B%20i%3C%3DsegMinus%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20real%20%3D%20%20i%20%2B%20remainder%20*%20i%3B%0A%0A%0A%20%20%20%20%20%20%20%20var%20angle%20%3D%20((theta)%20%2B%20startAngle%20%2B%20(theta2%20*%20real))%3B%0A%0A%20%20%20%20%20%20%20%20var%20c%20%3D%20Math.cos(angle)%3B%0A%20%20%20%20%20%20%20%20var%20s%20%3D%20-Math.sin(angle)%3B%0A%0A%20%20%20%20%20%20%20%20points.push((%20(cTheta%20*%20%20c)%20%2B%20(sTheta%20*%20s)%20)%20*%20radius%20%2B%20cx%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%20(cTheta%20*%20-s)%20%2B%20(sTheta%20*%20c)%20)%20*%20radius%20%2B%20cy)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.dirty%20%3D%20this.boundsDirty%20%3D%20true%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Specifies%20a%20simple%20one-color%20fill%20that%20subsequent%20calls%20to%20other%20Graphics%20methods%0A%20*%20(such%20as%20lineTo()%20or%20drawCircle())%20use%20when%20drawing.%0A%20*%0A%20*%20%40param%20color%20%7Bnumber%7D%20the%20color%20of%20the%20fill%0A%20*%20%40param%20alpha%20%7Bnumber%7D%20the%20alpha%20of%20the%20fill%0A%20*%20%40return%20%7BPIXI.Graphics%7D%0A%20*%2F%0AGraphics.prototype.beginFill%20%3D%20function%20(color%2C%20alpha)%0A%7B%0A%20%20%20%20this.filling%20%3D%20true%3B%0A%20%20%20%20this.fillColor%20%3D%20color%20%7C%7C%200%3B%0A%20%20%20%20this.fillAlpha%20%3D%20(alpha%20%3D%3D%3D%20undefined)%20%3F%201%20%3A%20alpha%3B%0A%0A%20%20%20%20if%20(this.currentPath)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(this.currentPath.shape.points.length%20%3C%3D%202)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.currentPath.fill%20%3D%20this.filling%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.currentPath.fillColor%20%3D%20this.fillColor%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.currentPath.fillAlpha%20%3D%20this.fillAlpha%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Applies%20a%20fill%20to%20the%20lines%20and%20shapes%20that%20were%20added%20since%20the%20last%20call%20to%20the%20beginFill()%20method.%0A%20*%0A%20*%20%40return%20%7BGraphics%7D%0A%20*%2F%0AGraphics.prototype.endFill%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.filling%20%3D%20false%3B%0A%20%20%20%20this.fillColor%20%3D%20null%3B%0A%20%20%20%20this.fillAlpha%20%3D%201%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%0A%20*%20%40param%20x%20%7Bnumber%7D%20The%20X%20coord%20of%20the%20top-left%20of%20the%20rectangle%0A%20*%20%40param%20y%20%7Bnumber%7D%20The%20Y%20coord%20of%20the%20top-left%20of%20the%20rectangle%0A%20*%20%40param%20width%20%7Bnumber%7D%20The%20width%20of%20the%20rectangle%0A%20*%20%40param%20height%20%7Bnumber%7D%20The%20height%20of%20the%20rectangle%0A%20*%20%40return%20%7BPIXI.Graphics%7D%0A%20*%2F%0AGraphics.prototype.drawRect%20%3D%20function%20(%20x%2C%20y%2C%20width%2C%20height%20)%0A%7B%0A%20%20%20%20this.drawShape(new%20math.Rectangle(x%2Cy%2C%20width%2C%20height))%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%0A%20*%20%40param%20x%20%7Bnumber%7D%20The%20X%20coord%20of%20the%20top-left%20of%20the%20rectangle%0A%20*%20%40param%20y%20%7Bnumber%7D%20The%20Y%20coord%20of%20the%20top-left%20of%20the%20rectangle%0A%20*%20%40param%20width%20%7Bnumber%7D%20The%20width%20of%20the%20rectangle%0A%20*%20%40param%20height%20%7Bnumber%7D%20The%20height%20of%20the%20rectangle%0A%20*%20%40param%20radius%20%7Bnumber%7D%20Radius%20of%20the%20rectangle%20corners%0A%20*%20%40return%20%7BPIXI.Graphics%7D%0A%20*%2F%0AGraphics.prototype.drawRoundedRect%20%3D%20function%20(%20x%2C%20y%2C%20width%2C%20height%2C%20radius%20)%0A%7B%0A%20%20%20%20this.drawShape(new%20math.RoundedRectangle(x%2C%20y%2C%20width%2C%20height%2C%20radius))%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Draws%20a%20circle.%0A%20*%0A%20*%20%40param%20x%20%7Bnumber%7D%20The%20X%20coordinate%20of%20the%20center%20of%20the%20circle%0A%20*%20%40param%20y%20%7Bnumber%7D%20The%20Y%20coordinate%20of%20the%20center%20of%20the%20circle%0A%20*%20%40param%20radius%20%7Bnumber%7D%20The%20radius%20of%20the%20circle%0A%20*%20%40return%20%7BPIXI.Graphics%7D%0A%20*%2F%0AGraphics.prototype.drawCircle%20%3D%20function%20(x%2C%20y%2C%20radius)%0A%7B%0A%20%20%20%20this.drawShape(new%20math.Circle(x%2Cy%2C%20radius))%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Draws%20an%20ellipse.%0A%20*%0A%20*%20%40param%20x%20%7Bnumber%7D%20The%20X%20coordinate%20of%20the%20center%20of%20the%20ellipse%0A%20*%20%40param%20y%20%7Bnumber%7D%20The%20Y%20coordinate%20of%20the%20center%20of%20the%20ellipse%0A%20*%20%40param%20width%20%7Bnumber%7D%20The%20half%20width%20of%20the%20ellipse%0A%20*%20%40param%20height%20%7Bnumber%7D%20The%20half%20height%20of%20the%20ellipse%0A%20*%20%40return%20%7BPIXI.Graphics%7D%0A%20*%2F%0AGraphics.prototype.drawEllipse%20%3D%20function%20(x%2C%20y%2C%20width%2C%20height)%0A%7B%0A%20%20%20%20this.drawShape(new%20math.Ellipse(x%2C%20y%2C%20width%2C%20height))%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Draws%20a%20polygon%20using%20the%20given%20path.%0A%20*%0A%20*%20%40param%20path%20%7Bnumber%5B%5D%7CPIXI.Point%5B%5D%7D%20The%20path%20data%20used%20to%20construct%20the%20polygon.%0A%20*%20%40return%20%7BPIXI.Graphics%7D%0A%20*%2F%0AGraphics.prototype.drawPolygon%20%3D%20function%20(path)%0A%7B%0A%20%20%20%20%2F%2F%20prevents%20an%20argument%20assignment%20deopt%0A%20%20%20%20%2F%2F%20see%20section%203.1%3A%20https%3A%2F%2Fgithub.com%2Fpetkaantonov%2Fbluebird%2Fwiki%2FOptimization-killers%233-managing-arguments%0A%20%20%20%20var%20points%20%3D%20path%3B%0A%0A%20%20%20%20var%20closed%20%3D%20true%3B%0A%0A%20%20%20%20if%20(points%20instanceof%20math.Polygon)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20closed%20%3D%20points.closed%3B%0A%20%20%20%20%20%20%20%20points%20%3D%20points.points%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(!Array.isArray(points))%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20prevents%20an%20argument%20leak%20deopt%0A%20%20%20%20%20%20%20%20%2F%2F%20see%20section%203.2%3A%20https%3A%2F%2Fgithub.com%2Fpetkaantonov%2Fbluebird%2Fwiki%2FOptimization-killers%233-managing-arguments%0A%20%20%20%20%20%20%20%20points%20%3D%20new%20Array(arguments.length)%3B%0A%0A%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20points.length%3B%20%2B%2Bi)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%5Bi%5D%20%3D%20arguments%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20shape%20%3D%20new%20math.Polygon(points)%3B%0A%20%20%20%20shape.closed%20%3D%20closed%3B%0A%0A%20%20%20%20this.drawShape(shape)%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Clears%20the%20graphics%20that%20were%20drawn%20to%20this%20Graphics%20object%2C%20and%20resets%20fill%20and%20line%20style%20settings.%0A%20*%0A%20*%20%40return%20%7BPIXI.Graphics%7D%0A%20*%2F%0AGraphics.prototype.clear%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.lineWidth%20%3D%200%3B%0A%20%20%20%20this.filling%20%3D%20false%3B%0A%0A%20%20%20%20this.dirty%20%3D%20true%3B%0A%20%20%20%20this.clearDirty%20%3D%20true%3B%0A%20%20%20%20this.graphicsData%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Useful%20function%20that%20returns%20a%20texture%20of%20the%20graphics%20object%20that%20can%20then%20be%20used%20to%20create%20sprites%0A%20*%20This%20can%20be%20quite%20useful%20if%20your%20geometry%20is%20complicated%20and%20needs%20to%20be%20reused%20multiple%20times.%0A%20*%0A%20*%20%40param%20resolution%20%7Bnumber%7D%20The%20resolution%20of%20the%20texture%20being%20generated%0A%20*%20%40param%20scaleMode%20%7Bnumber%7D%20Should%20be%20one%20of%20the%20scaleMode%20consts%0A%20*%20%40return%20%7BPIXI.Texture%7D%20a%20texture%20of%20the%20graphics%20object%0A%20*%2F%0AGraphics.prototype.generateTexture%20%3D%20function%20(renderer%2C%20resolution%2C%20scaleMode)%0A%7B%0A%0A%20%20%20%20resolution%20%3D%20resolution%20%7C%7C%201%3B%0A%0A%20%20%20%20var%20bounds%20%3D%20this.getLocalBounds()%3B%0A%0A%20%20%20%20var%20canvasBuffer%20%3D%20new%20CanvasBuffer(bounds.width%20*%20resolution%2C%20bounds.height%20*%20resolution)%3B%0A%0A%20%20%20%20var%20texture%20%3D%20Texture.fromCanvas(canvasBuffer.canvas%2C%20scaleMode)%3B%0A%20%20%20%20texture.baseTexture.resolution%20%3D%20resolution%3B%0A%0A%20%20%20%20canvasBuffer.context.scale(resolution%2C%20resolution)%3B%0A%0A%20%20%20%20canvasBuffer.context.translate(-bounds.x%2C-bounds.y)%3B%0A%0A%20%20%20%20CanvasGraphics.renderGraphics(this%2C%20canvasBuffer.context)%3B%0A%0A%20%20%20%20return%20texture%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Renders%20the%20object%20using%20the%20WebGL%20renderer%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%0A%20*%20%40private%0A%20*%2F%0AGraphics.prototype._renderWebGL%20%3D%20function%20(renderer)%0A%7B%0A%20%20%20%20%2F%2F%20if%20the%20sprite%20is%20not%20visible%20or%20the%20alpha%20is%200%20then%20no%20need%20to%20render%20this%20element%0A%0A%20%20%20%20%2F%2F%20this%20code%20may%20still%20be%20needed%20so%20leaving%20for%20now..%0A%20%20%20%20%2F%2F%0A%20%20%20%20%2F*%0A%20%20%20%20if%20(this._cacheAsBitmap)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(this.dirty%20%7C%7C%20this.cachedSpriteDirty)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._generateCachedSprite()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20we%20will%20also%20need%20to%20update%20the%20texture%20on%20the%20gpu%20too!%0A%20%20%20%20%20%20%20%20%20%20%20%20this.updateCachedSpriteTexture()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20this.cachedSpriteDirty%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.dirty%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20this._cachedSprite.worldAlpha%20%3D%20this.worldAlpha%3B%0A%0A%20%20%20%20%20%20%20%20Sprite.prototype.renderWebGL.call(this._cachedSprite%2C%20renderer)%3B%0A%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20*%2F%0A%0A%20%20%20%20if%20(this.glDirty)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.dirty%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20this.glDirty%20%3D%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20renderer.setObjectRenderer(renderer.plugins.graphics)%3B%0A%20%20%20%20renderer.plugins.graphics.render(this)%3B%0A%0A%7D%3B%0A%0A%2F**%0A%20*%20Renders%20the%20object%20using%20the%20Canvas%20renderer%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.CanvasRenderer%7D%0A%20*%20%40private%0A%20*%2F%0AGraphics.prototype._renderCanvas%20%3D%20function%20(renderer)%0A%7B%0A%20%20%20%20if%20(this.isMask%20%3D%3D%3D%20true)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20if%20the%20tint%20has%20changed%2C%20set%20the%20graphics%20object%20to%20dirty.%0A%20%20%20%20if%20(this._prevTint%20!%3D%3D%20this.tint)%20%7B%0A%20%20%20%20%20%20%20%20this.dirty%20%3D%20true%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20this%20code%20may%20still%20be%20needed%20so%20leaving%20for%20now..%0A%20%20%20%20%2F%2F%0A%20%20%20%20%2F*%0A%20%20%20%20if%20(this._cacheAsBitmap)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(this.dirty%20%7C%7C%20this.cachedSpriteDirty)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._generateCachedSprite()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20we%20will%20also%20need%20to%20update%20the%20texture%0A%20%20%20%20%20%20%20%20%20%20%20%20this.updateCachedSpriteTexture()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20this.cachedSpriteDirty%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.dirty%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20this._cachedSprite.alpha%20%3D%20this.alpha%3B%0A%0A%20%20%20%20%20%20%20%20Sprite.prototype._renderCanvas.call(this._cachedSprite%2C%20renderer)%3B%0A%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20*%2F%0A%20%20%20%20var%20context%20%3D%20renderer.context%3B%0A%20%20%20%20var%20transform%20%3D%20this.worldTransform%3B%0A%0A%20%20%20%20var%20compositeOperation%20%3D%20renderer.blendModes%5Bthis.blendMode%5D%3B%0A%20%20%20%20if%20(compositeOperation%20!%3D%3D%20context.globalCompositeOperation)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20context.globalCompositeOperation%20%3D%20compositeOperation%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20resolution%20%3D%20renderer.resolution%3B%0A%20%20%20%20context.setTransform(%0A%20%20%20%20%20%20%20%20transform.a%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20transform.b%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20transform.c%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20transform.d%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20transform.tx%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20transform.ty%20*%20resolution%0A%20%20%20%20)%3B%0A%0A%20%20%20%20CanvasGraphics.renderGraphics(this%2C%20context)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Retrieves%20the%20bounds%20of%20the%20graphic%20shape%20as%20a%20rectangle%20object%0A%20*%0A%20*%20%40param%20%5Bmatrix%5D%20%7BPIXI.Matrix%7D%20The%20world%20transform%20matrix%20to%20use%2C%20defaults%20to%20this%0A%20*%20%20object's%20worldTransform.%0A%20*%20%40return%20%7BPIXI.Rectangle%7D%20the%20rectangular%20bounding%20area%0A%20*%2F%0AGraphics.prototype.getBounds%20%3D%20function%20(matrix)%0A%7B%0A%20%20%20%20if(!this._currentBounds)%0A%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20return%20an%20empty%20object%20if%20the%20item%20is%20a%20mask!%0A%20%20%20%20%20%20%20%20if%20(!this.renderable)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20math.Rectangle.EMPTY%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if%20(this.boundsDirty)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.updateLocalBounds()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20this.glDirty%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.cachedSpriteDirty%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.boundsDirty%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20var%20bounds%20%3D%20this._localBounds%3B%0A%0A%20%20%20%20%20%20%20%20var%20w0%20%3D%20bounds.x%3B%0A%20%20%20%20%20%20%20%20var%20w1%20%3D%20bounds.width%20%2B%20bounds.x%3B%0A%0A%20%20%20%20%20%20%20%20var%20h0%20%3D%20bounds.y%3B%0A%20%20%20%20%20%20%20%20var%20h1%20%3D%20bounds.height%20%2B%20bounds.y%3B%0A%0A%20%20%20%20%20%20%20%20var%20worldTransform%20%3D%20matrix%20%7C%7C%20this.worldTransform%3B%0A%0A%20%20%20%20%20%20%20%20var%20a%20%3D%20worldTransform.a%3B%0A%20%20%20%20%20%20%20%20var%20b%20%3D%20worldTransform.b%3B%0A%20%20%20%20%20%20%20%20var%20c%20%3D%20worldTransform.c%3B%0A%20%20%20%20%20%20%20%20var%20d%20%3D%20worldTransform.d%3B%0A%20%20%20%20%20%20%20%20var%20tx%20%3D%20worldTransform.tx%3B%0A%20%20%20%20%20%20%20%20var%20ty%20%3D%20worldTransform.ty%3B%0A%0A%20%20%20%20%20%20%20%20var%20x1%20%3D%20a%20*%20w1%20%2B%20c%20*%20h1%20%2B%20tx%3B%0A%20%20%20%20%20%20%20%20var%20y1%20%3D%20d%20*%20h1%20%2B%20b%20*%20w1%20%2B%20ty%3B%0A%0A%20%20%20%20%20%20%20%20var%20x2%20%3D%20a%20*%20w0%20%2B%20c%20*%20h1%20%2B%20tx%3B%0A%20%20%20%20%20%20%20%20var%20y2%20%3D%20d%20*%20h1%20%2B%20b%20*%20w0%20%2B%20ty%3B%0A%0A%20%20%20%20%20%20%20%20var%20x3%20%3D%20a%20*%20w0%20%2B%20c%20*%20h0%20%2B%20tx%3B%0A%20%20%20%20%20%20%20%20var%20y3%20%3D%20d%20*%20h0%20%2B%20b%20*%20w0%20%2B%20ty%3B%0A%0A%20%20%20%20%20%20%20%20var%20x4%20%3D%20%20a%20*%20w1%20%2B%20c%20*%20h0%20%2B%20tx%3B%0A%20%20%20%20%20%20%20%20var%20y4%20%3D%20%20d%20*%20h0%20%2B%20b%20*%20w1%20%2B%20ty%3B%0A%0A%20%20%20%20%20%20%20%20var%20maxX%20%3D%20x1%3B%0A%20%20%20%20%20%20%20%20var%20maxY%20%3D%20y1%3B%0A%0A%20%20%20%20%20%20%20%20var%20minX%20%3D%20x1%3B%0A%20%20%20%20%20%20%20%20var%20minY%20%3D%20y1%3B%0A%0A%20%20%20%20%20%20%20%20minX%20%3D%20x2%20%3C%20minX%20%3F%20x2%20%3A%20minX%3B%0A%20%20%20%20%20%20%20%20minX%20%3D%20x3%20%3C%20minX%20%3F%20x3%20%3A%20minX%3B%0A%20%20%20%20%20%20%20%20minX%20%3D%20x4%20%3C%20minX%20%3F%20x4%20%3A%20minX%3B%0A%0A%20%20%20%20%20%20%20%20minY%20%3D%20y2%20%3C%20minY%20%3F%20y2%20%3A%20minY%3B%0A%20%20%20%20%20%20%20%20minY%20%3D%20y3%20%3C%20minY%20%3F%20y3%20%3A%20minY%3B%0A%20%20%20%20%20%20%20%20minY%20%3D%20y4%20%3C%20minY%20%3F%20y4%20%3A%20minY%3B%0A%0A%20%20%20%20%20%20%20%20maxX%20%3D%20x2%20%3E%20maxX%20%3F%20x2%20%3A%20maxX%3B%0A%20%20%20%20%20%20%20%20maxX%20%3D%20x3%20%3E%20maxX%20%3F%20x3%20%3A%20maxX%3B%0A%20%20%20%20%20%20%20%20maxX%20%3D%20x4%20%3E%20maxX%20%3F%20x4%20%3A%20maxX%3B%0A%0A%20%20%20%20%20%20%20%20maxY%20%3D%20y2%20%3E%20maxY%20%3F%20y2%20%3A%20maxY%3B%0A%20%20%20%20%20%20%20%20maxY%20%3D%20y3%20%3E%20maxY%20%3F%20y3%20%3A%20maxY%3B%0A%20%20%20%20%20%20%20%20maxY%20%3D%20y4%20%3E%20maxY%20%3F%20y4%20%3A%20maxY%3B%0A%0A%20%20%20%20%20%20%20%20this._bounds.x%20%3D%20minX%3B%0A%20%20%20%20%20%20%20%20this._bounds.width%20%3D%20maxX%20-%20minX%3B%0A%0A%20%20%20%20%20%20%20%20this._bounds.y%20%3D%20minY%3B%0A%20%20%20%20%20%20%20%20this._bounds.height%20%3D%20maxY%20-%20minY%3B%0A%0A%20%20%20%20%20%20%20%20this._currentBounds%20%3D%20this._bounds%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20this._currentBounds%3B%0A%7D%3B%0A%0A%2F**%0A*%20Tests%20if%20a%20point%20is%20inside%20this%20graphics%20object%0A*%0A*%20%40param%20point%20%7BPIXI.Point%7D%20the%20point%20to%20test%0A*%20%40return%20%7Bboolean%7D%20the%20result%20of%20the%20test%0A*%2F%0AGraphics.prototype.containsPoint%20%3D%20function(%20point%20)%0A%7B%0A%20%20%20%20this.worldTransform.applyInverse(point%2C%20%20tempPoint)%3B%0A%0A%20%20%20%20var%20graphicsData%20%3D%20this.graphicsData%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20graphicsData.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20data%20%3D%20graphicsData%5Bi%5D%3B%0A%0A%20%20%20%20%20%20%20%20if%20(!data.fill)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20only%20deal%20with%20fills..%0A%20%20%20%20%20%20%20%20if%20(data.shape)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(%20data.shape.contains(%20tempPoint.x%2C%20tempPoint.y%20)%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20false%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Update%20the%20bounds%20of%20the%20object%0A%20*%0A%20*%2F%0AGraphics.prototype.updateLocalBounds%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20minX%20%3D%20Infinity%3B%0A%20%20%20%20var%20maxX%20%3D%20-Infinity%3B%0A%0A%20%20%20%20var%20minY%20%3D%20Infinity%3B%0A%20%20%20%20var%20maxY%20%3D%20-Infinity%3B%0A%0A%20%20%20%20if%20(this.graphicsData.length)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20shape%2C%20points%2C%20x%2C%20y%2C%20w%2C%20h%3B%0A%0A%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20this.graphicsData.length%3B%20i%2B%2B)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20data%20%3D%20this.graphicsData%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20type%20%3D%20data.type%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20lineWidth%20%3D%20data.lineWidth%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20shape%20%3D%20data.shape%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(type%20%3D%3D%3D%20CONST.SHAPES.RECT%20%7C%7C%20type%20%3D%3D%3D%20CONST.SHAPES.RREC)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%20%3D%20shape.x%20-%20lineWidth%2F2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%20%3D%20shape.y%20-%20lineWidth%2F2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20w%20%3D%20shape.width%20%2B%20lineWidth%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20h%20%3D%20shape.height%20%2B%20lineWidth%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20minX%20%3D%20x%20%3C%20minX%20%3F%20x%20%3A%20minX%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20maxX%20%3D%20x%20%2B%20w%20%3E%20maxX%20%3F%20x%20%2B%20w%20%3A%20maxX%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20minY%20%3D%20y%20%3C%20minY%20%3F%20y%20%3A%20minY%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20maxY%20%3D%20y%20%2B%20h%20%3E%20maxY%20%3F%20y%20%2B%20h%20%3A%20maxY%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20if%20(type%20%3D%3D%3D%20CONST.SHAPES.CIRC)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%20%3D%20shape.x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%20%3D%20shape.y%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20w%20%3D%20shape.radius%20%2B%20lineWidth%2F2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20h%20%3D%20shape.radius%20%2B%20lineWidth%2F2%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20minX%20%3D%20x%20-%20w%20%3C%20minX%20%3F%20x%20-%20w%20%3A%20minX%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20maxX%20%3D%20x%20%2B%20w%20%3E%20maxX%20%3F%20x%20%2B%20w%20%3A%20maxX%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20minY%20%3D%20y%20-%20h%20%3C%20minY%20%3F%20y%20-%20h%20%3A%20minY%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20maxY%20%3D%20y%20%2B%20h%20%3E%20maxY%20%3F%20y%20%2B%20h%20%3A%20maxY%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20if%20(type%20%3D%3D%3D%20CONST.SHAPES.ELIP)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%20%3D%20shape.x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%20%3D%20shape.y%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20w%20%3D%20shape.width%20%2B%20lineWidth%2F2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20h%20%3D%20shape.height%20%2B%20lineWidth%2F2%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20minX%20%3D%20x%20-%20w%20%3C%20minX%20%3F%20x%20-%20w%20%3A%20minX%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20maxX%20%3D%20x%20%2B%20w%20%3E%20maxX%20%3F%20x%20%2B%20w%20%3A%20maxX%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20minY%20%3D%20y%20-%20h%20%3C%20minY%20%3F%20y%20-%20h%20%3A%20minY%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20maxY%20%3D%20y%20%2B%20h%20%3E%20maxY%20%3F%20y%20%2B%20h%20%3A%20maxY%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20POLY%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20points%20%3D%20shape.points%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20(var%20j%20%3D%200%3B%20j%20%3C%20points.length%3B%20j%20%2B%3D%202)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%20%3D%20points%5Bj%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%20%3D%20points%5Bj%2B1%5D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20minX%20%3D%20x-lineWidth%20%3C%20minX%20%3F%20x-lineWidth%20%3A%20minX%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20maxX%20%3D%20x%2BlineWidth%20%3E%20maxX%20%3F%20x%2BlineWidth%20%3A%20maxX%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20minY%20%3D%20y-lineWidth%20%3C%20minY%20%3F%20y-lineWidth%20%3A%20minY%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20maxY%20%3D%20y%2BlineWidth%20%3E%20maxY%20%3F%20y%2BlineWidth%20%3A%20maxY%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20minX%20%3D%200%3B%0A%20%20%20%20%20%20%20%20maxX%20%3D%200%3B%0A%20%20%20%20%20%20%20%20minY%20%3D%200%3B%0A%20%20%20%20%20%20%20%20maxY%20%3D%200%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20padding%20%3D%20this.boundsPadding%3B%0A%0A%20%20%20%20this._localBounds.x%20%3D%20minX%20-%20padding%3B%0A%20%20%20%20this._localBounds.width%20%3D%20(maxX%20-%20minX)%20%2B%20padding%20*%202%3B%0A%0A%20%20%20%20this._localBounds.y%20%3D%20minY%20-%20padding%3B%0A%20%20%20%20this._localBounds.height%20%3D%20(maxY%20-%20minY)%20%2B%20padding%20*%202%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Generates%20the%20cached%20sprite%20when%20the%20sprite%20has%20cacheAsBitmap%20%3D%20true%0A%20*%0A%20*%20%40private%0A%20*%2F%0A%2F*%0AGraphics.prototype._generateCachedSprite%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20bounds%20%3D%20this.getLocalBounds()%3B%0A%0A%20%20%20%20if%20(!this._cachedSprite)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20canvasBuffer%20%3D%20new%20CanvasBuffer(bounds.width%2C%20bounds.height)%3B%0A%20%20%20%20%20%20%20%20var%20texture%20%3D%20Texture.fromCanvas(canvasBuffer.canvas)%3B%0A%0A%20%20%20%20%20%20%20%20this._cachedSprite%20%3D%20new%20Sprite(texture)%3B%0A%20%20%20%20%20%20%20%20this._cachedSprite.buffer%20%3D%20canvasBuffer%3B%0A%0A%20%20%20%20%20%20%20%20this._cachedSprite.worldTransform%20%3D%20this.worldTransform%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this._cachedSprite.buffer.resize(bounds.width%2C%20bounds.height)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20leverage%20the%20anchor%20to%20account%20for%20the%20offset%20of%20the%20element%0A%20%20%20%20this._cachedSprite.anchor.x%20%3D%20-(%20bounds.x%20%2F%20bounds.width%20)%3B%0A%20%20%20%20this._cachedSprite.anchor.y%20%3D%20-(%20bounds.y%20%2F%20bounds.height%20)%3B%0A%0A%20%20%20%20%2F%2F%20this._cachedSprite.buffer.context.save()%3B%0A%20%20%20%20this._cachedSprite.buffer.context.translate(-bounds.x%2C-bounds.y)%3B%0A%0A%20%20%20%20%2F%2F%20make%20sure%20we%20set%20the%20alpha%20of%20the%20graphics%20to%201%20for%20the%20render..%0A%20%20%20%20this.worldAlpha%20%3D%201%3B%0A%0A%20%20%20%20%2F%2F%20now%20render%20the%20graphic..%0A%20%20%20%20CanvasGraphics.renderGraphics(this%2C%20this._cachedSprite.buffer.context)%3B%0A%0A%20%20%20%20this._cachedSprite.alpha%20%3D%20this.alpha%3B%0A%7D%3B%0A*%2F%0A%2F**%0A%20*%20Updates%20texture%20size%20based%20on%20canvas%20size%0A%20*%0A%20*%20%40private%0A%20*%2F%0A%2F*%0AGraphics.prototype.updateCachedSpriteTexture%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20cachedSprite%20%3D%20this._cachedSprite%3B%0A%20%20%20%20var%20texture%20%3D%20cachedSprite.texture%3B%0A%20%20%20%20var%20canvas%20%3D%20cachedSprite.buffer.canvas%3B%0A%0A%20%20%20%20texture.baseTexture.width%20%3D%20canvas.width%3B%0A%20%20%20%20texture.baseTexture.height%20%3D%20canvas.height%3B%0A%20%20%20%20texture.crop.width%20%3D%20texture.frame.width%20%3D%20canvas.width%3B%0A%20%20%20%20texture.crop.height%20%3D%20texture.frame.height%20%3D%20canvas.height%3B%0A%0A%20%20%20%20cachedSprite._width%20%3D%20canvas.width%3B%0A%20%20%20%20cachedSprite._height%20%3D%20canvas.height%3B%0A%0A%20%20%20%20%2F%2F%20update%20the%20dirty%20base%20textures%0A%20%20%20%20texture.baseTexture.dirty()%3B%0A%7D%3B*%2F%0A%0A%2F**%0A%20*%20Destroys%20a%20previous%20cached%20sprite.%0A%20*%0A%20*%2F%0A%2F*%0AGraphics.prototype.destroyCachedSprite%20%3D%20function%20()%0A%7B%0A%20%20%20%20this._cachedSprite.texture.destroy(true)%3B%0A%0A%20%20%20%20%2F%2F%20let%20the%20gc%20collect%20the%20unused%20sprite%0A%20%20%20%20%2F%2F%20TODO%20could%20be%20object%20pooled!%0A%20%20%20%20this._cachedSprite%20%3D%20null%3B%0A%7D%3B*%2F%0A%0A%2F**%0A%20*%20Draws%20the%20given%20shape%20to%20this%20Graphics%20object.%20Can%20be%20any%20of%20Circle%2C%20Rectangle%2C%20Ellipse%2C%20Line%20or%20Polygon.%0A%20*%0A%20*%20%40param%20shape%20%7BPIXI.Circle%7CPIXI.Rectangle%7CPIXI.Ellipse%7CPIXI.Line%7CPIXI.Polygon%7D%20The%20shape%20object%20to%20draw.%0A%20*%20%40return%20%7BPIXI.GraphicsData%7D%20The%20generated%20GraphicsData%20object.%0A%20*%2F%0AGraphics.prototype.drawShape%20%3D%20function%20(shape)%0A%7B%0A%20%20%20%20if%20(this.currentPath)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20check%20current%20path!%0A%20%20%20%20%20%20%20%20if%20(this.currentPath.shape.points.length%20%3C%3D%202)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.graphicsData.pop()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.currentPath%20%3D%20null%3B%0A%0A%20%20%20%20var%20data%20%3D%20new%20GraphicsData(this.lineWidth%2C%20this.lineColor%2C%20this.lineAlpha%2C%20this.fillColor%2C%20this.fillAlpha%2C%20this.filling%2C%20shape)%3B%0A%0A%20%20%20%20this.graphicsData.push(data)%3B%0A%0A%20%20%20%20if%20(data.type%20%3D%3D%3D%20CONST.SHAPES.POLY)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20data.shape.closed%20%3D%20data.shape.closed%20%7C%7C%20this.filling%3B%0A%20%20%20%20%20%20%20%20this.currentPath%20%3D%20data%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.dirty%20%3D%20this.boundsDirty%20%3D%20true%3B%0A%0A%20%20%20%20return%20data%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20the%20Graphics%20object.%0A%20*%2F%0AGraphics.prototype.destroy%20%3D%20function%20()%20%7B%0A%20%20%20%20Container.prototype.destroy.apply(this%2C%20arguments)%3B%0A%0A%20%20%20%20%2F%2F%20destroy%20each%20of%20the%20GraphicsData%20objects%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20this.graphicsData.length%3B%20%2B%2Bi)%20%7B%0A%20%20%20%20%20%20%20%20this.graphicsData%5Bi%5D.destroy()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20for%20each%20webgl%20data%20entry%2C%20destroy%20the%20WebGLGraphicsData%0A%20%20%20%20for%20(var%20id%20in%20this._webgl)%20%7B%0A%20%20%20%20%20%20%20%20for%20(var%20j%20%3D%200%3B%20j%20%3C%20this._webgl%5Bid%5D.data.length%3B%20%2B%2Bj)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._webgl%5Bid%5D.data%5Bj%5D.destroy()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.graphicsData%20%3D%20null%3B%0A%0A%20%20%20%20this.currentPath%20%3D%20null%3B%0A%20%20%20%20this._webgl%20%3D%20null%3B%0A%20%20%20%20this._localBounds%20%3D%20null%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fconst%22%3A13%2C%22..%2Fdisplay%2FContainer%22%3A14%2C%22..%2Fmath%22%3A23%2C%22..%2Frenderers%2Fcanvas%2Futils%2FCanvasBuffer%22%3A35%2C%22..%2Frenderers%2Fcanvas%2Futils%2FCanvasGraphics%22%3A36%2C%22..%2Ftextures%2FTexture%22%3A62%2C%22.%2FGraphicsData%22%3A17%7D%5D%2C17%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F**%0A%20*%20A%20GraphicsData%20object.%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20lineWidth%20%7Bnumber%7D%20the%20width%20of%20the%20line%20to%20draw%0A%20*%20%40param%20lineColor%20%7Bnumber%7D%20the%20color%20of%20the%20line%20to%20draw%0A%20*%20%40param%20lineAlpha%20%7Bnumber%7D%20the%20alpha%20of%20the%20line%20to%20draw%0A%20*%20%40param%20fillColor%20%7Bnumber%7D%20the%20color%20of%20the%20fill%0A%20*%20%40param%20fillAlpha%20%7Bnumber%7D%20the%20alpha%20of%20the%20fill%0A%20*%20%40param%20fill%20%20%20%20%20%20%7Bboolean%7D%20whether%20or%20not%20the%20shape%20is%20filled%20with%20a%20colour%0A%20*%20%40param%20shape%20%20%20%20%20%7BCircle%7CRectangle%7CEllipse%7CLine%7CPolygon%7D%20The%20shape%20object%20to%20draw.%0A%20*%2F%0Afunction%20GraphicsData(lineWidth%2C%20lineColor%2C%20lineAlpha%2C%20fillColor%2C%20fillAlpha%2C%20fill%2C%20shape)%0A%7B%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%20the%20width%20of%20the%20line%20to%20draw%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.lineWidth%20%3D%20lineWidth%3B%0A%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%20the%20color%20of%20the%20line%20to%20draw%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.lineColor%20%3D%20lineColor%3B%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%20the%20alpha%20of%20the%20line%20to%20draw%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.lineAlpha%20%3D%20lineAlpha%3B%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%20cached%20tint%20of%20the%20line%20to%20draw%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._lineTint%20%3D%20lineColor%3B%0A%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%20the%20color%20of%20the%20fill%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.fillColor%20%3D%20fillColor%3B%0A%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%20the%20alpha%20of%20the%20fill%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.fillAlpha%20%3D%20fillAlpha%3B%0A%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%20cached%20tint%20of%20the%20fill%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._fillTint%20%3D%20fillColor%3B%0A%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%20whether%20or%20not%20the%20shape%20is%20filled%20with%20a%20colour%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.fill%20%3D%20fill%3B%0A%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Circle%7CPIXI.Rectangle%7CPIXI.Ellipse%7CPIXI.Line%7CPIXI.Polygon%7D%20The%20shape%20object%20to%20draw.%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.shape%20%3D%20shape%3B%0A%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%20The%20type%20of%20the%20shape%2C%20see%20the%20Const.Shapes%20file%20for%20all%20the%20existing%20types%2C%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.type%20%3D%20shape.type%3B%0A%7D%0A%0AGraphicsData.prototype.constructor%20%3D%20GraphicsData%3B%0Amodule.exports%20%3D%20GraphicsData%3B%0A%0A%2F**%0A%20*%20Creates%20a%20new%20GraphicsData%20object%20with%20the%20same%20values%20as%20this%20one.%0A%20*%0A%20*%20%40return%20%7BPIXI.GraphicsData%7D%0A%20*%2F%0AGraphicsData.prototype.clone%20%3D%20function%20()%0A%7B%0A%20%20%20%20return%20new%20GraphicsData(%0A%20%20%20%20%20%20%20%20this.lineWidth%2C%0A%20%20%20%20%20%20%20%20this.lineColor%2C%0A%20%20%20%20%20%20%20%20this.lineAlpha%2C%0A%20%20%20%20%20%20%20%20this.fillColor%2C%0A%20%20%20%20%20%20%20%20this.fillAlpha%2C%0A%20%20%20%20%20%20%20%20this.fill%2C%0A%20%20%20%20%20%20%20%20this.shape%0A%20%20%20%20)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20the%20Graphics%20data.%0A%20*%2F%0AGraphicsData.prototype.destroy%20%3D%20function%20()%20%7B%0A%20%20%20%20this.shape%20%3D%20null%3B%0A%7D%3B%0A%0A%7D%2C%7B%7D%5D%2C18%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20utils%20%3D%20require('..%2F..%2Futils')%2C%0A%20%20%20%20math%20%3D%20require('..%2F..%2Fmath')%2C%0A%20%20%20%20CONST%20%3D%20require('..%2F..%2Fconst')%2C%0A%20%20%20%20ObjectRenderer%20%3D%20require('..%2F..%2Frenderers%2Fwebgl%2Futils%2FObjectRenderer')%2C%0A%20%20%20%20WebGLRenderer%20%3D%20require('..%2F..%2Frenderers%2Fwebgl%2FWebGLRenderer')%2C%0A%20%20%20%20WebGLGraphicsData%20%3D%20require('.%2FWebGLGraphicsData')%2C%0A%20%20%20%20earcut%20%3D%20require('earcut')%3B%0A%0A%2F**%0A%20*%20Renders%20the%20graphics%20object.%0A%20*%0A%20*%20%40class%0A%20*%20%40private%0A%20*%20%40memberof%20PIXI%0A%20*%20%40extends%20PIXI.ObjectRenderer%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20The%20renderer%20this%20object%20renderer%20works%20for.%0A%20*%2F%0Afunction%20GraphicsRenderer(renderer)%0A%7B%0A%20%20%20%20ObjectRenderer.call(this%2C%20renderer)%3B%0A%0A%20%20%20%20this.graphicsDataPool%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20this.primitiveShader%20%3D%20null%3B%0A%20%20%20%20this.complexPrimitiveShader%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20This%20is%20the%20maximum%20number%20of%20points%20a%20poly%20can%20contain%20before%20it%20is%20rendered%20as%20a%20complex%20polygon%20(using%20the%20stencil%20buffer)%0A%20%20%20%20%20*%20%40type%20%7BNumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.maximumSimplePolySize%20%3D%20200%3B%0A%7D%0A%0AGraphicsRenderer.prototype%20%3D%20Object.create(ObjectRenderer.prototype)%3B%0AGraphicsRenderer.prototype.constructor%20%3D%20GraphicsRenderer%3B%0Amodule.exports%20%3D%20GraphicsRenderer%3B%0A%0AWebGLRenderer.registerPlugin('graphics'%2C%20GraphicsRenderer)%3B%0A%0A%2F**%0A%20*%20Called%20when%20there%20is%20a%20WebGL%20context%20change%0A%20*%0A%20*%20%40private%0A%20*%0A%20*%2F%0AGraphicsRenderer.prototype.onContextChange%20%3D%20function()%0A%7B%0A%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20this%20renderer.%0A%20*%0A%20*%2F%0AGraphicsRenderer.prototype.destroy%20%3D%20function%20()%20%7B%0A%20%20%20%20ObjectRenderer.prototype.destroy.call(this)%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20this.graphicsDataPool.length%3B%20%2B%2Bi)%20%7B%0A%20%20%20%20%20%20%20%20this.graphicsDataPool%5Bi%5D.destroy()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.graphicsDataPool%20%3D%20null%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Renders%20a%20graphics%20object.%0A%20*%0A%20*%20%40param%20graphics%20%7BPIXI.Graphics%7D%20The%20graphics%20object%20to%20render.%0A%20*%2F%0AGraphicsRenderer.prototype.render%20%3D%20function(graphics)%0A%7B%0A%20%20%20%20var%20renderer%20%3D%20this.renderer%3B%0A%20%20%20%20var%20gl%20%3D%20renderer.gl%3B%0A%0A%20%20%20%20var%20shader%20%3D%20renderer.shaderManager.plugins.primitiveShader%2C%0A%20%20%20%20%20%20%20%20webGLData%3B%0A%0A%20%20%20%20if%20(graphics.dirty)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.updateGraphics(graphics)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20webGL%20%3D%20graphics._webGL%5Bgl.id%5D%3B%0A%0A%20%20%20%20%2F%2F%20This%20%20could%20be%20speeded%20up%20for%20sure!%0A%0A%20%20%20%20renderer.blendModeManager.setBlendMode(%20graphics.blendMode%20)%3B%0A%0A%2F%2F%20%20%20%20var%20matrix%20%3D%20%20graphics.worldTransform.clone()%3B%0A%2F%2F%20%20%20%20var%20matrix%20%3D%20%20renderer.currentRenderTarget.projectionMatrix.clone()%3B%0A%2F%2F%20%20%20%20matrix.append(graphics.worldTransform)%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%2C%20n%20%3D%20webGL.data.length%3B%20i%20%3C%20n%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20webGLData%20%3D%20webGL.data%5Bi%5D%3B%0A%0A%20%20%20%20%20%20%20%20if%20(webGL.data%5Bi%5D.mode%20%3D%3D%3D%201)%0A%20%20%20%20%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20renderer.stencilManager.pushStencil(graphics%2C%20webGLData)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform1f(renderer.shaderManager.complexPrimitiveShader.uniforms.alpha._location%2C%20graphics.worldAlpha%20*%20webGLData.alpha)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20render%20quad..%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.drawElements(gl.TRIANGLE_FAN%2C%204%2C%20gl.UNSIGNED_SHORT%2C%20(%20webGLData.indices.length%20-%204%20)%20*%202%20)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20renderer.stencilManager.popStencil(graphics%2C%20webGLData)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20shader%20%3D%20renderer.shaderManager.primitiveShader%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20renderer.shaderManager.setShader(%20shader%20)%3B%2F%2FactivatePrimitiveShader()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniformMatrix3fv(shader.uniforms.translationMatrix._location%2C%20false%2C%20graphics.worldTransform.toArray(true))%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniformMatrix3fv(shader.uniforms.projectionMatrix._location%2C%20false%2C%20renderer.currentRenderTarget.projectionMatrix.toArray(true))%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform3fv(shader.uniforms.tint._location%2C%20utils.hex2rgb(graphics.tint))%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform1f(shader.uniforms.alpha._location%2C%20graphics.worldAlpha)%3B%0A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20webGLData.buffer)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.vertexAttribPointer(shader.attributes.aVertexPosition%2C%202%2C%20gl.FLOAT%2C%20false%2C%204%20*%206%2C%200)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.vertexAttribPointer(shader.attributes.aColor%2C%204%2C%20gl.FLOAT%2C%20false%2C4%20*%206%2C%202%20*%204)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20set%20the%20index%20buffer!%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER%2C%20webGLData.indexBuffer)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.drawElements(gl.TRIANGLE_STRIP%2C%20%20webGLData.indices.length%2C%20gl.UNSIGNED_SHORT%2C%200%20)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20renderer.drawCount%2B%2B%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Updates%20the%20graphics%20object%0A%20*%0A%20*%20%40private%0A%20*%20%40param%20graphics%20%7BPIXI.Graphics%7D%20The%20graphics%20object%20to%20update%0A%20*%2F%0AGraphicsRenderer.prototype.updateGraphics%20%3D%20function(graphics)%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%0A%20%20%20%20%20%2F%2F%20get%20the%20contexts%20graphics%20object%0A%20%20%20%20var%20webGL%20%3D%20graphics._webGL%5Bgl.id%5D%3B%0A%0A%20%20%20%20%2F%2F%20if%20the%20graphics%20object%20does%20not%20exist%20in%20the%20webGL%20context%20time%20to%20create%20it!%0A%20%20%20%20if%20(!webGL)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20webGL%20%3D%20graphics._webGL%5Bgl.id%5D%20%3D%20%7BlastIndex%3A0%2C%20data%3A%5B%5D%2C%20gl%3Agl%7D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20flag%20the%20graphics%20as%20not%20dirty%20as%20we%20are%20about%20to%20update%20it...%0A%20%20%20%20graphics.dirty%20%3D%20false%3B%0A%0A%20%20%20%20var%20i%3B%0A%0A%20%20%20%20%2F%2F%20if%20the%20user%20cleared%20the%20graphics%20object%20we%20will%20need%20to%20clear%20every%20object%0A%20%20%20%20if%20(graphics.clearDirty)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20graphics.clearDirty%20%3D%20false%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20loop%20through%20and%20return%20all%20the%20webGLDatas%20to%20the%20object%20pool%20so%20than%20can%20be%20reused%20later%20on%0A%20%20%20%20%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20webGL.data.length%3B%20i%2B%2B)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20graphicsData%20%3D%20webGL.data%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20graphicsData.reset()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.graphicsDataPool.push(%20graphicsData%20)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20clear%20the%20array%20and%20reset%20the%20index..%0A%20%20%20%20%20%20%20%20webGL.data%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20webGL.lastIndex%20%3D%200%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20webGLData%3B%0A%0A%20%20%20%20%2F%2F%20loop%20through%20the%20graphics%20datas%20and%20construct%20each%20one..%0A%20%20%20%20%2F%2F%20if%20the%20object%20is%20a%20complex%20fill%20then%20the%20new%20stencil%20buffer%20technique%20will%20be%20used%0A%20%20%20%20%2F%2F%20other%20wise%20graphics%20objects%20will%20be%20pushed%20into%20a%20batch..%0A%20%20%20%20for%20(i%20%3D%20webGL.lastIndex%3B%20i%20%3C%20graphics.graphicsData.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20data%20%3D%20graphics.graphicsData%5Bi%5D%3B%0A%0A%20%20%20%20%20%20%20%20if%20(data.type%20%3D%3D%3D%20CONST.SHAPES.POLY)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20need%20to%20add%20the%20points%20the%20the%20graphics%20object..%0A%20%20%20%20%20%20%20%20%20%20%20%20data.points%20%3D%20data.shape.points.slice()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.shape.closed)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20close%20the%20poly%20if%20the%20value%20is%20true!%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.points%5B0%5D%20!%3D%3D%20data.points%5Bdata.points.length-2%5D%20%7C%7C%20data.points%5B1%5D%20!%3D%3D%20data.points%5Bdata.points.length-1%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data.points.push(data.points%5B0%5D%2C%20data.points%5B1%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20MAKE%20SURE%20WE%20HAVE%20THE%20CORRECT%20TYPE..%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.fill)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.points.length%20%3E%3D%206)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.points.length%20%3C%20this.maximumSimplePolySize%20*%202)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20webGLData%20%3D%20this.switchMode(webGL%2C%200)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20canDrawUsingSimple%20%3D%20this.buildPoly(data%2C%20webGLData)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!canDrawUsingSimple)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20webGLData%20%3D%20this.switchMode(webGL%2C%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.buildComplexPoly(data%2C%20webGLData)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20webGLData%20%3D%20this.switchMode(webGL%2C%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.buildComplexPoly(data%2C%20webGLData)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.lineWidth%20%3E%200)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20webGLData%20%3D%20this.switchMode(webGL%2C%200)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.buildLine(data%2C%20webGLData)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20webGLData%20%3D%20this.switchMode(webGL%2C%200)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.type%20%3D%3D%3D%20CONST.SHAPES.RECT)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.buildRectangle(data%2C%20webGLData)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20if%20(data.type%20%3D%3D%3D%20CONST.SHAPES.CIRC%20%7C%7C%20data.type%20%3D%3D%3D%20CONST.SHAPES.ELIP)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.buildCircle(data%2C%20webGLData)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20if%20(data.type%20%3D%3D%3D%20CONST.SHAPES.RREC)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.buildRoundedRectangle(data%2C%20webGLData)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20webGL.lastIndex%2B%2B%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20upload%20all%20the%20dirty%20data...%0A%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20webGL.data.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20webGLData%20%3D%20webGL.data%5Bi%5D%3B%0A%0A%20%20%20%20%20%20%20%20if%20(webGLData.dirty)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20webGLData.upload()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%0A%20*%0A%20*%20%40private%0A%20*%20%40param%20webGL%20%7BWebGLRenderingContext%7D%20the%20current%20WebGL%20drawing%20context%0A%20*%20%40param%20type%20%7Bnumber%7D%20TODO%20%40Alvin%0A%20*%2F%0AGraphicsRenderer.prototype.switchMode%20%3D%20function%20(webGL%2C%20type)%0A%7B%0A%20%20%20%20var%20webGLData%3B%0A%0A%20%20%20%20if%20(!webGL.data.length)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20webGLData%20%3D%20this.graphicsDataPool.pop()%20%7C%7C%20new%20WebGLGraphicsData(webGL.gl)%3B%0A%20%20%20%20%20%20%20%20webGLData.mode%20%3D%20type%3B%0A%20%20%20%20%20%20%20%20webGL.data.push(webGLData)%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20webGLData%20%3D%20webGL.data%5BwebGL.data.length-1%5D%3B%0A%0A%20%20%20%20%20%20%20%20if%20((webGLData.points.length%20%3E%20320000)%20%7C%7C%20webGLData.mode%20!%3D%3D%20type%20%7C%7C%20type%20%3D%3D%3D%201)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20webGLData%20%3D%20this.graphicsDataPool.pop()%20%7C%7C%20new%20WebGLGraphicsData(webGL.gl)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20webGLData.mode%20%3D%20type%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20webGL.data.push(webGLData)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20webGLData.dirty%20%3D%20true%3B%0A%0A%20%20%20%20return%20webGLData%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Builds%20a%20rectangle%20to%20draw%0A%20*%0A%20*%20%40private%0A%20*%20%40param%20graphicsData%20%7BPIXI.Graphics%7D%20The%20graphics%20object%20containing%20all%20the%20necessary%20properties%0A%20*%20%40param%20webGLData%20%7Bobject%7D%20an%20object%20containing%20all%20the%20webGL-specific%20information%20to%20create%20this%20shape%0A%20*%2F%0AGraphicsRenderer.prototype.buildRectangle%20%3D%20function%20(graphicsData%2C%20webGLData)%0A%7B%0A%20%20%20%20%2F%2F%20---%20%2F%2F%0A%20%20%20%20%2F%2F%20need%20to%20convert%20points%20to%20a%20nice%20regular%20data%0A%20%20%20%20%2F%2F%0A%20%20%20%20var%20rectData%20%3D%20graphicsData.shape%3B%0A%20%20%20%20var%20x%20%3D%20rectData.x%3B%0A%20%20%20%20var%20y%20%3D%20rectData.y%3B%0A%20%20%20%20var%20width%20%3D%20rectData.width%3B%0A%20%20%20%20var%20height%20%3D%20rectData.height%3B%0A%0A%20%20%20%20if%20(graphicsData.fill)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20color%20%3D%20utils.hex2rgb(graphicsData.fillColor)%3B%0A%20%20%20%20%20%20%20%20var%20alpha%20%3D%20graphicsData.fillAlpha%3B%0A%0A%20%20%20%20%20%20%20%20var%20r%20%3D%20color%5B0%5D%20*%20alpha%3B%0A%20%20%20%20%20%20%20%20var%20g%20%3D%20color%5B1%5D%20*%20alpha%3B%0A%20%20%20%20%20%20%20%20var%20b%20%3D%20color%5B2%5D%20*%20alpha%3B%0A%0A%20%20%20%20%20%20%20%20var%20verts%20%3D%20webGLData.points%3B%0A%20%20%20%20%20%20%20%20var%20indices%20%3D%20webGLData.indices%3B%0A%0A%20%20%20%20%20%20%20%20var%20vertPos%20%3D%20verts.length%2F6%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20start%0A%20%20%20%20%20%20%20%20verts.push(x%2C%20y)%3B%0A%20%20%20%20%20%20%20%20verts.push(r%2C%20g%2C%20b%2C%20alpha)%3B%0A%0A%20%20%20%20%20%20%20%20verts.push(x%20%2B%20width%2C%20y)%3B%0A%20%20%20%20%20%20%20%20verts.push(r%2C%20g%2C%20b%2C%20alpha)%3B%0A%0A%20%20%20%20%20%20%20%20verts.push(x%20%2C%20y%20%2B%20height)%3B%0A%20%20%20%20%20%20%20%20verts.push(r%2C%20g%2C%20b%2C%20alpha)%3B%0A%0A%20%20%20%20%20%20%20%20verts.push(x%20%2B%20width%2C%20y%20%2B%20height)%3B%0A%20%20%20%20%20%20%20%20verts.push(r%2C%20g%2C%20b%2C%20alpha)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20insert%202%20dead%20triangles..%0A%20%20%20%20%20%20%20%20indices.push(vertPos%2C%20vertPos%2C%20vertPos%2B1%2C%20vertPos%2B2%2C%20vertPos%2B3%2C%20vertPos%2B3)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(graphicsData.lineWidth)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20tempPoints%20%3D%20graphicsData.points%3B%0A%0A%20%20%20%20%20%20%20%20graphicsData.points%20%3D%20%5Bx%2C%20y%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%20%2B%20width%2C%20y%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%20%2B%20width%2C%20y%20%2B%20height%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%2C%20y%20%2B%20height%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%2C%20y%5D%3B%0A%0A%0A%20%20%20%20%20%20%20%20this.buildLine(graphicsData%2C%20webGLData)%3B%0A%0A%20%20%20%20%20%20%20%20graphicsData.points%20%3D%20tempPoints%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Builds%20a%20rounded%20rectangle%20to%20draw%0A%20*%0A%20*%20%40private%0A%20*%20%40param%20graphicsData%20%7BPIXI.Graphics%7D%20The%20graphics%20object%20containing%20all%20the%20necessary%20properties%0A%20*%20%40param%20webGLData%20%7Bobject%7D%20an%20object%20containing%20all%20the%20webGL-specific%20information%20to%20create%20this%20shape%0A%20*%2F%0AGraphicsRenderer.prototype.buildRoundedRectangle%20%3D%20function%20(graphicsData%2C%20webGLData)%0A%7B%0A%20%20%20%20var%20rrectData%20%3D%20graphicsData.shape%3B%0A%20%20%20%20var%20x%20%3D%20rrectData.x%3B%0A%20%20%20%20var%20y%20%3D%20rrectData.y%3B%0A%20%20%20%20var%20width%20%3D%20rrectData.width%3B%0A%20%20%20%20var%20height%20%3D%20rrectData.height%3B%0A%0A%20%20%20%20var%20radius%20%3D%20rrectData.radius%3B%0A%0A%20%20%20%20var%20recPoints%20%3D%20%5B%5D%3B%0A%20%20%20%20recPoints.push(x%2C%20y%20%2B%20radius)%3B%0A%20%20%20%20this.quadraticBezierCurve(x%2C%20y%20%2B%20height%20-%20radius%2C%20x%2C%20y%20%2B%20height%2C%20x%20%2B%20radius%2C%20y%20%2B%20height%2C%20recPoints)%3B%0A%20%20%20%20this.quadraticBezierCurve(x%20%2B%20width%20-%20radius%2C%20y%20%2B%20height%2C%20x%20%2B%20width%2C%20y%20%2B%20height%2C%20x%20%2B%20width%2C%20y%20%2B%20height%20-%20radius%2C%20recPoints)%3B%0A%20%20%20%20this.quadraticBezierCurve(x%20%2B%20width%2C%20y%20%2B%20radius%2C%20x%20%2B%20width%2C%20y%2C%20x%20%2B%20width%20-%20radius%2C%20y%2C%20recPoints)%3B%0A%20%20%20%20this.quadraticBezierCurve(x%20%2B%20radius%2C%20y%2C%20x%2C%20y%2C%20x%2C%20y%20%2B%20radius%20%2B%200.0000000001%2C%20recPoints)%3B%0A%0A%20%20%20%20%2F%2F%20this%20tiny%20number%20deals%20with%20the%20issue%20that%20occurs%20when%20points%20overlap%20and%20earcut%20fails%20to%20triangulate%20the%20item.%0A%20%20%20%20%2F%2F%20TODO%20-%20fix%20this%20properly%2C%20this%20is%20not%20very%20elegant..%20but%20it%20works%20for%20now.%0A%0A%20%20%20%20if%20(graphicsData.fill)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20color%20%3D%20utils.hex2rgb(graphicsData.fillColor)%3B%0A%20%20%20%20%20%20%20%20var%20alpha%20%3D%20graphicsData.fillAlpha%3B%0A%0A%20%20%20%20%20%20%20%20var%20r%20%3D%20color%5B0%5D%20*%20alpha%3B%0A%20%20%20%20%20%20%20%20var%20g%20%3D%20color%5B1%5D%20*%20alpha%3B%0A%20%20%20%20%20%20%20%20var%20b%20%3D%20color%5B2%5D%20*%20alpha%3B%0A%0A%20%20%20%20%20%20%20%20var%20verts%20%3D%20webGLData.points%3B%0A%20%20%20%20%20%20%20%20var%20indices%20%3D%20webGLData.indices%3B%0A%0A%20%20%20%20%20%20%20%20var%20vecPos%20%3D%20verts.length%2F6%3B%0A%0A%20%20%20%20%20%20%20%20var%20triangles%20%3D%20earcut(recPoints%2C%20null%2C%202)%3B%0A%0A%20%20%20%20%20%20%20%20var%20i%20%3D%200%3B%0A%20%20%20%20%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20triangles.length%3B%20i%2B%3D3)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20indices.push(triangles%5Bi%5D%20%2B%20vecPos)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20indices.push(triangles%5Bi%5D%20%2B%20vecPos)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20indices.push(triangles%5Bi%2B1%5D%20%2B%20vecPos)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20indices.push(triangles%5Bi%2B2%5D%20%2B%20vecPos)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20indices.push(triangles%5Bi%2B2%5D%20%2B%20vecPos)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20recPoints.length%3B%20i%2B%2B)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20verts.push(recPoints%5Bi%5D%2C%20recPoints%5B%2B%2Bi%5D%2C%20r%2C%20g%2C%20b%2C%20alpha)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(graphicsData.lineWidth)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20tempPoints%20%3D%20graphicsData.points%3B%0A%0A%20%20%20%20%20%20%20%20graphicsData.points%20%3D%20recPoints%3B%0A%0A%20%20%20%20%20%20%20%20this.buildLine(graphicsData%2C%20webGLData)%3B%0A%0A%20%20%20%20%20%20%20%20graphicsData.points%20%3D%20tempPoints%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Calculate%20the%20points%20for%20a%20quadratic%20bezier%20curve.%20(helper%20function..)%0A%20*%20Based%20on%3A%20https%3A%2F%2Fstackoverflow.com%2Fquestions%2F785097%2Fhow-do-i-implement-a-bezier-curve-in-c%0A%20*%0A%20*%20%40private%0A%20*%20%40param%20fromX%20%7Bnumber%7D%20Origin%20point%20x%0A%20*%20%40param%20fromY%20%7Bnumber%7D%20Origin%20point%20x%0A%20*%20%40param%20cpX%20%7Bnumber%7D%20Control%20point%20x%0A%20*%20%40param%20cpY%20%7Bnumber%7D%20Control%20point%20y%0A%20*%20%40param%20toX%20%7Bnumber%7D%20Destination%20point%20x%0A%20*%20%40param%20toY%20%7Bnumber%7D%20Destination%20point%20y%0A%20*%20%40param%20%5Bout%5D%20%7Bnumber%5B%5D%7D%20The%20output%20array%20to%20add%20points%20into.%20If%20not%20passed%2C%20a%20new%20array%20is%20created.%0A%20*%20%40return%20%7Bnumber%5B%5D%7D%20an%20array%20of%20points%0A%20*%2F%0AGraphicsRenderer.prototype.quadraticBezierCurve%20%3D%20function%20(fromX%2C%20fromY%2C%20cpX%2C%20cpY%2C%20toX%2C%20toY%2C%20out)%0A%7B%0A%20%20%20%20var%20xa%2C%0A%20%20%20%20%20%20%20%20ya%2C%0A%20%20%20%20%20%20%20%20xb%2C%0A%20%20%20%20%20%20%20%20yb%2C%0A%20%20%20%20%20%20%20%20x%2C%0A%20%20%20%20%20%20%20%20y%2C%0A%20%20%20%20%20%20%20%20n%20%3D%2020%2C%0A%20%20%20%20%20%20%20%20points%20%3D%20out%20%7C%7C%20%5B%5D%3B%0A%0A%20%20%20%20function%20getPt(n1%20%2C%20n2%2C%20perc)%20%7B%0A%20%20%20%20%20%20%20%20var%20diff%20%3D%20n2%20-%20n1%3B%0A%0A%20%20%20%20%20%20%20%20return%20n1%20%2B%20(%20diff%20*%20perc%20)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20j%20%3D%200%3B%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%3D%20n%3B%20i%2B%2B%20)%20%7B%0A%20%20%20%20%20%20%20%20j%20%3D%20i%20%2F%20n%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20The%20Green%20Line%0A%20%20%20%20%20%20%20%20xa%20%3D%20getPt(%20fromX%20%2C%20cpX%20%2C%20j%20)%3B%0A%20%20%20%20%20%20%20%20ya%20%3D%20getPt(%20fromY%20%2C%20cpY%20%2C%20j%20)%3B%0A%20%20%20%20%20%20%20%20xb%20%3D%20getPt(%20cpX%20%2C%20toX%20%2C%20j%20)%3B%0A%20%20%20%20%20%20%20%20yb%20%3D%20getPt(%20cpY%20%2C%20toY%20%2C%20j%20)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20The%20Black%20Dot%0A%20%20%20%20%20%20%20%20x%20%3D%20getPt(%20xa%20%2C%20xb%20%2C%20j%20)%3B%0A%20%20%20%20%20%20%20%20y%20%3D%20getPt(%20ya%20%2C%20yb%20%2C%20j%20)%3B%0A%0A%20%20%20%20%20%20%20%20points.push(x%2C%20y)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20points%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Builds%20a%20circle%20to%20draw%0A%20*%0A%20*%20%40private%0A%20*%20%40param%20graphicsData%20%7BPIXI.Graphics%7D%20The%20graphics%20object%20to%20draw%0A%20*%20%40param%20webGLData%20%7Bobject%7D%20an%20object%20containing%20all%20the%20webGL-specific%20information%20to%20create%20this%20shape%0A%20*%2F%0AGraphicsRenderer.prototype.buildCircle%20%3D%20function%20(graphicsData%2C%20webGLData)%0A%7B%0A%20%20%20%20%2F%2F%20need%20to%20convert%20points%20to%20a%20nice%20regular%20data%0A%20%20%20%20var%20circleData%20%3D%20graphicsData.shape%3B%0A%20%20%20%20var%20x%20%3D%20circleData.x%3B%0A%20%20%20%20var%20y%20%3D%20circleData.y%3B%0A%20%20%20%20var%20width%3B%0A%20%20%20%20var%20height%3B%0A%0A%20%20%20%20%2F%2F%20TODO%20-%20bit%20hacky%3F%3F%0A%20%20%20%20if%20(graphicsData.type%20%3D%3D%3D%20CONST.SHAPES.CIRC)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20width%20%3D%20circleData.radius%3B%0A%20%20%20%20%20%20%20%20height%20%3D%20circleData.radius%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20width%20%3D%20circleData.width%3B%0A%20%20%20%20%20%20%20%20height%20%3D%20circleData.height%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20totalSegs%20%3D%20Math.floor(30%20*%20Math.sqrt(circleData.radius))%20%7C%7C%20Math.floor(15%20*%20Math.sqrt(circleData.width%20%2B%20circleData.height))%3B%0A%20%20%20%20var%20seg%20%3D%20(Math.PI%20*%202)%20%2F%20totalSegs%20%3B%0A%0A%20%20%20%20var%20i%20%3D%200%3B%0A%0A%20%20%20%20if%20(graphicsData.fill)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20color%20%3D%20utils.hex2rgb(graphicsData.fillColor)%3B%0A%20%20%20%20%20%20%20%20var%20alpha%20%3D%20graphicsData.fillAlpha%3B%0A%0A%20%20%20%20%20%20%20%20var%20r%20%3D%20color%5B0%5D%20*%20alpha%3B%0A%20%20%20%20%20%20%20%20var%20g%20%3D%20color%5B1%5D%20*%20alpha%3B%0A%20%20%20%20%20%20%20%20var%20b%20%3D%20color%5B2%5D%20*%20alpha%3B%0A%0A%20%20%20%20%20%20%20%20var%20verts%20%3D%20webGLData.points%3B%0A%20%20%20%20%20%20%20%20var%20indices%20%3D%20webGLData.indices%3B%0A%0A%20%20%20%20%20%20%20%20var%20vecPos%20%3D%20verts.length%2F6%3B%0A%0A%20%20%20%20%20%20%20%20indices.push(vecPos)%3B%0A%0A%20%20%20%20%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20totalSegs%20%2B%201%20%3B%20i%2B%2B)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20verts.push(x%2Cy%2C%20r%2C%20g%2C%20b%2C%20alpha)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20verts.push(x%20%2B%20Math.sin(seg%20*%20i)%20*%20width%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%20%2B%20Math.cos(seg%20*%20i)%20*%20height%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20r%2C%20g%2C%20b%2C%20alpha)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20indices.push(vecPos%2B%2B%2C%20vecPos%2B%2B)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20indices.push(vecPos-1)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(graphicsData.lineWidth)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20tempPoints%20%3D%20graphicsData.points%3B%0A%0A%20%20%20%20%20%20%20%20graphicsData.points%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20totalSegs%20%2B%201%3B%20i%2B%2B)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20graphicsData.points.push(x%20%2B%20Math.sin(seg%20*%20i)%20*%20width%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%20%2B%20Math.cos(seg%20*%20i)%20*%20height)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20this.buildLine(graphicsData%2C%20webGLData)%3B%0A%0A%20%20%20%20%20%20%20%20graphicsData.points%20%3D%20tempPoints%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Builds%20a%20line%20to%20draw%0A%20*%0A%20*%20%40private%0A%20*%20%40param%20graphicsData%20%7BPIXI.Graphics%7D%20The%20graphics%20object%20containing%20all%20the%20necessary%20properties%0A%20*%20%40param%20webGLData%20%7Bobject%7D%20an%20object%20containing%20all%20the%20webGL-specific%20information%20to%20create%20this%20shape%0A%20*%2F%0AGraphicsRenderer.prototype.buildLine%20%3D%20function%20(graphicsData%2C%20webGLData)%0A%7B%0A%20%20%20%20%2F%2F%20TODO%20OPTIMISE!%0A%20%20%20%20var%20i%20%3D%200%3B%0A%20%20%20%20var%20points%20%3D%20graphicsData.points%3B%0A%0A%20%20%20%20if%20(points.length%20%3D%3D%3D%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20%2F%2F%20if%20the%20line%20width%20is%20an%20odd%20number%20add%200.5%20to%20align%20to%20a%20whole%20pixel%0A%20%20%20%20%2F%2F%20commenting%20this%20out%20fixes%20%23711%20and%20%231620%0A%20%20%20%20%2F%2F%20if%20(graphicsData.lineWidth%252)%0A%20%20%20%20%2F%2F%20%7B%0A%20%20%20%20%2F%2F%20%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20points.length%3B%20i%2B%2B)%0A%20%20%20%20%2F%2F%20%20%20%20%20%7B%0A%20%20%20%20%2F%2F%20%20%20%20%20%20%20%20%20points%5Bi%5D%20%2B%3D%200.5%3B%0A%20%20%20%20%2F%2F%20%20%20%20%20%7D%0A%20%20%20%20%2F%2F%20%7D%0A%0A%20%20%20%20%2F%2F%20get%20first%20and%20last%20point..%20figure%20out%20the%20middle!%0A%20%20%20%20var%20firstPoint%20%3D%20new%20math.Point(points%5B0%5D%2C%20points%5B1%5D)%3B%0A%20%20%20%20var%20lastPoint%20%3D%20new%20math.Point(points%5Bpoints.length%20-%202%5D%2C%20points%5Bpoints.length%20-%201%5D)%3B%0A%0A%20%20%20%20%2F%2F%20if%20the%20first%20point%20is%20the%20last%20point%20-%20gonna%20have%20issues%20%3A)%0A%20%20%20%20if%20(firstPoint.x%20%3D%3D%3D%20lastPoint.x%20%26%26%20firstPoint.y%20%3D%3D%3D%20lastPoint.y)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20need%20to%20clone%20as%20we%20are%20going%20to%20slightly%20modify%20the%20shape..%0A%20%20%20%20%20%20%20%20points%20%3D%20points.slice()%3B%0A%0A%20%20%20%20%20%20%20%20points.pop()%3B%0A%20%20%20%20%20%20%20%20points.pop()%3B%0A%0A%20%20%20%20%20%20%20%20lastPoint%20%3D%20new%20math.Point(points%5Bpoints.length%20-%202%5D%2C%20points%5Bpoints.length%20-%201%5D)%3B%0A%0A%20%20%20%20%20%20%20%20var%20midPointX%20%3D%20lastPoint.x%20%2B%20(firstPoint.x%20-%20lastPoint.x)%20*0.5%3B%0A%20%20%20%20%20%20%20%20var%20midPointY%20%3D%20lastPoint.y%20%2B%20(firstPoint.y%20-%20lastPoint.y)%20*0.5%3B%0A%0A%20%20%20%20%20%20%20%20points.unshift(midPointX%2C%20midPointY)%3B%0A%20%20%20%20%20%20%20%20points.push(midPointX%2C%20midPointY)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20verts%20%3D%20webGLData.points%3B%0A%20%20%20%20var%20indices%20%3D%20webGLData.indices%3B%0A%20%20%20%20var%20length%20%3D%20points.length%20%2F%202%3B%0A%20%20%20%20var%20indexCount%20%3D%20points.length%3B%0A%20%20%20%20var%20indexStart%20%3D%20verts.length%2F6%3B%0A%0A%20%20%20%20%2F%2F%20DRAW%20the%20Line%0A%20%20%20%20var%20width%20%3D%20graphicsData.lineWidth%20%2F%202%3B%0A%0A%20%20%20%20%2F%2F%20sort%20color%0A%20%20%20%20var%20color%20%3D%20utils.hex2rgb(graphicsData.lineColor)%3B%0A%20%20%20%20var%20alpha%20%3D%20graphicsData.lineAlpha%3B%0A%20%20%20%20var%20r%20%3D%20color%5B0%5D%20*%20alpha%3B%0A%20%20%20%20var%20g%20%3D%20color%5B1%5D%20*%20alpha%3B%0A%20%20%20%20var%20b%20%3D%20color%5B2%5D%20*%20alpha%3B%0A%0A%20%20%20%20var%20px%2C%20py%2C%20p1x%2C%20p1y%2C%20p2x%2C%20p2y%2C%20p3x%2C%20p3y%3B%0A%20%20%20%20var%20perpx%2C%20perpy%2C%20perp2x%2C%20perp2y%2C%20perp3x%2C%20perp3y%3B%0A%20%20%20%20var%20a1%2C%20b1%2C%20c1%2C%20a2%2C%20b2%2C%20c2%3B%0A%20%20%20%20var%20denom%2C%20pdist%2C%20dist%3B%0A%0A%20%20%20%20p1x%20%3D%20points%5B0%5D%3B%0A%20%20%20%20p1y%20%3D%20points%5B1%5D%3B%0A%0A%20%20%20%20p2x%20%3D%20points%5B2%5D%3B%0A%20%20%20%20p2y%20%3D%20points%5B3%5D%3B%0A%0A%20%20%20%20perpx%20%3D%20-(p1y%20-%20p2y)%3B%0A%20%20%20%20perpy%20%3D%20%20p1x%20-%20p2x%3B%0A%0A%20%20%20%20dist%20%3D%20Math.sqrt(perpx*perpx%20%2B%20perpy*perpy)%3B%0A%0A%20%20%20%20perpx%20%2F%3D%20dist%3B%0A%20%20%20%20perpy%20%2F%3D%20dist%3B%0A%20%20%20%20perpx%20*%3D%20width%3B%0A%20%20%20%20perpy%20*%3D%20width%3B%0A%0A%20%20%20%20%2F%2F%20start%0A%20%20%20%20verts.push(p1x%20-%20perpx%20%2C%20p1y%20-%20perpy%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20r%2C%20g%2C%20b%2C%20alpha)%3B%0A%0A%20%20%20%20verts.push(p1x%20%2B%20perpx%20%2C%20p1y%20%2B%20perpy%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20r%2C%20g%2C%20b%2C%20alpha)%3B%0A%0A%20%20%20%20for%20(i%20%3D%201%3B%20i%20%3C%20length-1%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20p1x%20%3D%20points%5B(i-1)*2%5D%3B%0A%20%20%20%20%20%20%20%20p1y%20%3D%20points%5B(i-1)*2%20%2B%201%5D%3B%0A%0A%20%20%20%20%20%20%20%20p2x%20%3D%20points%5B(i)*2%5D%3B%0A%20%20%20%20%20%20%20%20p2y%20%3D%20points%5B(i)*2%20%2B%201%5D%3B%0A%0A%20%20%20%20%20%20%20%20p3x%20%3D%20points%5B(i%2B1)*2%5D%3B%0A%20%20%20%20%20%20%20%20p3y%20%3D%20points%5B(i%2B1)*2%20%2B%201%5D%3B%0A%0A%20%20%20%20%20%20%20%20perpx%20%3D%20-(p1y%20-%20p2y)%3B%0A%20%20%20%20%20%20%20%20perpy%20%3D%20p1x%20-%20p2x%3B%0A%0A%20%20%20%20%20%20%20%20dist%20%3D%20Math.sqrt(perpx*perpx%20%2B%20perpy*perpy)%3B%0A%20%20%20%20%20%20%20%20perpx%20%2F%3D%20dist%3B%0A%20%20%20%20%20%20%20%20perpy%20%2F%3D%20dist%3B%0A%20%20%20%20%20%20%20%20perpx%20*%3D%20width%3B%0A%20%20%20%20%20%20%20%20perpy%20*%3D%20width%3B%0A%0A%20%20%20%20%20%20%20%20perp2x%20%3D%20-(p2y%20-%20p3y)%3B%0A%20%20%20%20%20%20%20%20perp2y%20%3D%20p2x%20-%20p3x%3B%0A%0A%20%20%20%20%20%20%20%20dist%20%3D%20Math.sqrt(perp2x*perp2x%20%2B%20perp2y*perp2y)%3B%0A%20%20%20%20%20%20%20%20perp2x%20%2F%3D%20dist%3B%0A%20%20%20%20%20%20%20%20perp2y%20%2F%3D%20dist%3B%0A%20%20%20%20%20%20%20%20perp2x%20*%3D%20width%3B%0A%20%20%20%20%20%20%20%20perp2y%20*%3D%20width%3B%0A%0A%20%20%20%20%20%20%20%20a1%20%3D%20(-perpy%20%2B%20p1y)%20-%20(-perpy%20%2B%20p2y)%3B%0A%20%20%20%20%20%20%20%20b1%20%3D%20(-perpx%20%2B%20p2x)%20-%20(-perpx%20%2B%20p1x)%3B%0A%20%20%20%20%20%20%20%20c1%20%3D%20(-perpx%20%2B%20p1x)%20*%20(-perpy%20%2B%20p2y)%20-%20(-perpx%20%2B%20p2x)%20*%20(-perpy%20%2B%20p1y)%3B%0A%20%20%20%20%20%20%20%20a2%20%3D%20(-perp2y%20%2B%20p3y)%20-%20(-perp2y%20%2B%20p2y)%3B%0A%20%20%20%20%20%20%20%20b2%20%3D%20(-perp2x%20%2B%20p2x)%20-%20(-perp2x%20%2B%20p3x)%3B%0A%20%20%20%20%20%20%20%20c2%20%3D%20(-perp2x%20%2B%20p3x)%20*%20(-perp2y%20%2B%20p2y)%20-%20(-perp2x%20%2B%20p2x)%20*%20(-perp2y%20%2B%20p3y)%3B%0A%0A%20%20%20%20%20%20%20%20denom%20%3D%20a1*b2%20-%20a2*b1%3B%0A%0A%20%20%20%20%20%20%20%20if%20(Math.abs(denom)%20%3C%200.1%20)%0A%20%20%20%20%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20denom%2B%3D10.1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20verts.push(p2x%20-%20perpx%20%2C%20p2y%20-%20perpy%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20r%2C%20g%2C%20b%2C%20alpha)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20verts.push(p2x%20%2B%20perpx%20%2C%20p2y%20%2B%20perpy%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20r%2C%20g%2C%20b%2C%20alpha)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20px%20%3D%20(b1*c2%20-%20b2*c1)%2Fdenom%3B%0A%20%20%20%20%20%20%20%20py%20%3D%20(a2*c1%20-%20a1*c2)%2Fdenom%3B%0A%0A%0A%20%20%20%20%20%20%20%20pdist%20%3D%20(px%20-p2x)%20*%20(px%20-p2x)%20%2B%20(py%20-p2y)%20%2B%20(py%20-p2y)%3B%0A%0A%0A%20%20%20%20%20%20%20%20if%20(pdist%20%3E%20140%20*%20140)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20perp3x%20%3D%20perpx%20-%20perp2x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20perp3y%20%3D%20perpy%20-%20perp2y%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20dist%20%3D%20Math.sqrt(perp3x*perp3x%20%2B%20perp3y*perp3y)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20perp3x%20%2F%3D%20dist%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20perp3y%20%2F%3D%20dist%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20perp3x%20*%3D%20width%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20perp3y%20*%3D%20width%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20verts.push(p2x%20-%20perp3x%2C%20p2y%20-perp3y)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20verts.push(r%2C%20g%2C%20b%2C%20alpha)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20verts.push(p2x%20%2B%20perp3x%2C%20p2y%20%2Bperp3y)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20verts.push(r%2C%20g%2C%20b%2C%20alpha)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20verts.push(p2x%20-%20perp3x%2C%20p2y%20-perp3y)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20verts.push(r%2C%20g%2C%20b%2C%20alpha)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20indexCount%2B%2B%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20verts.push(px%20%2C%20py)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20verts.push(r%2C%20g%2C%20b%2C%20alpha)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20verts.push(p2x%20-%20(px-p2x)%2C%20p2y%20-%20(py%20-%20p2y))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20verts.push(r%2C%20g%2C%20b%2C%20alpha)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20p1x%20%3D%20points%5B(length-2)*2%5D%3B%0A%20%20%20%20p1y%20%3D%20points%5B(length-2)*2%20%2B%201%5D%3B%0A%0A%20%20%20%20p2x%20%3D%20points%5B(length-1)*2%5D%3B%0A%20%20%20%20p2y%20%3D%20points%5B(length-1)*2%20%2B%201%5D%3B%0A%0A%20%20%20%20perpx%20%3D%20-(p1y%20-%20p2y)%3B%0A%20%20%20%20perpy%20%3D%20p1x%20-%20p2x%3B%0A%0A%20%20%20%20dist%20%3D%20Math.sqrt(perpx*perpx%20%2B%20perpy*perpy)%3B%0A%20%20%20%20perpx%20%2F%3D%20dist%3B%0A%20%20%20%20perpy%20%2F%3D%20dist%3B%0A%20%20%20%20perpx%20*%3D%20width%3B%0A%20%20%20%20perpy%20*%3D%20width%3B%0A%0A%20%20%20%20verts.push(p2x%20-%20perpx%20%2C%20p2y%20-%20perpy)%3B%0A%20%20%20%20verts.push(r%2C%20g%2C%20b%2C%20alpha)%3B%0A%0A%20%20%20%20verts.push(p2x%20%2B%20perpx%20%2C%20p2y%20%2B%20perpy)%3B%0A%20%20%20%20verts.push(r%2C%20g%2C%20b%2C%20alpha)%3B%0A%0A%20%20%20%20indices.push(indexStart)%3B%0A%0A%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20indexCount%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20indices.push(indexStart%2B%2B)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20indices.push(indexStart-1)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Builds%20a%20complex%20polygon%20to%20draw%0A%20*%0A%20*%20%40private%0A%20*%20%40param%20graphicsData%20%7BPIXI.Graphics%7D%20The%20graphics%20object%20containing%20all%20the%20necessary%20properties%0A%20*%20%40param%20webGLData%20%7Bobject%7D%20an%20object%20containing%20all%20the%20webGL-specific%20information%20to%20create%20this%20shape%0A%20*%2F%0AGraphicsRenderer.prototype.buildComplexPoly%20%3D%20function%20(graphicsData%2C%20webGLData)%0A%7B%0A%20%20%20%20%2F%2FTODO%20-%20no%20need%20to%20copy%20this%20as%20it%20gets%20turned%20into%20a%20FLoat32Array%20anyways..%0A%20%20%20%20var%20points%20%3D%20graphicsData.points.slice()%3B%0A%0A%20%20%20%20if%20(points.length%20%3C%206)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20get%20first%20and%20last%20point..%20figure%20out%20the%20middle!%0A%20%20%20%20var%20indices%20%3D%20webGLData.indices%3B%0A%20%20%20%20webGLData.points%20%3D%20points%3B%0A%20%20%20%20webGLData.alpha%20%3D%20graphicsData.fillAlpha%3B%0A%20%20%20%20webGLData.color%20%3D%20utils.hex2rgb(graphicsData.fillColor)%3B%0A%0A%20%20%20%20%2F%2F%20calclate%20the%20bounds..%0A%20%20%20%20var%20minX%20%3D%20Infinity%3B%0A%20%20%20%20var%20maxX%20%3D%20-Infinity%3B%0A%0A%20%20%20%20var%20minY%20%3D%20Infinity%3B%0A%20%20%20%20var%20maxY%20%3D%20-Infinity%3B%0A%0A%20%20%20%20var%20x%2Cy%3B%0A%0A%20%20%20%20%2F%2F%20get%20size..%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20points.length%3B%20i%2B%3D2)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20x%20%3D%20points%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20y%20%3D%20points%5Bi%2B1%5D%3B%0A%0A%20%20%20%20%20%20%20%20minX%20%3D%20x%20%3C%20minX%20%3F%20x%20%3A%20minX%3B%0A%20%20%20%20%20%20%20%20maxX%20%3D%20x%20%3E%20maxX%20%3F%20x%20%3A%20maxX%3B%0A%0A%20%20%20%20%20%20%20%20minY%20%3D%20y%20%3C%20minY%20%3F%20y%20%3A%20minY%3B%0A%20%20%20%20%20%20%20%20maxY%20%3D%20y%20%3E%20maxY%20%3F%20y%20%3A%20maxY%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20add%20a%20quad%20to%20the%20end%20cos%20there%20is%20no%20point%20making%20another%20buffer!%0A%20%20%20%20points.push(minX%2C%20minY%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20maxX%2C%20minY%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20maxX%2C%20maxY%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20minX%2C%20maxY)%3B%0A%0A%20%20%20%20%2F%2F%20push%20a%20quad%20onto%20the%20end..%0A%0A%20%20%20%20%2F%2FTODO%20-%20this%20aint%20needed!%0A%20%20%20%20var%20length%20%3D%20points.length%20%2F%202%3B%0A%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20indices.push(%20i%20)%3B%0A%20%20%20%20%7D%0A%0A%7D%3B%0A%0A%2F**%0A%20*%20Builds%20a%20polygon%20to%20draw%0A%20*%0A%20*%20%40private%0A%20*%20%40param%20graphicsData%20%7BPIXI.WebGLGraphicsData%7D%20The%20graphics%20object%20containing%20all%20the%20necessary%20properties%0A%20*%20%40param%20webGLData%20%7Bobject%7D%20an%20object%20containing%20all%20the%20webGL-specific%20information%20to%20create%20this%20shape%0A%20*%2F%0AGraphicsRenderer.prototype.buildPoly%20%3D%20function%20(graphicsData%2C%20webGLData)%0A%7B%0A%20%20%20%20var%20points%20%3D%20graphicsData.points%3B%0A%0A%20%20%20%20if%20(points.length%20%3C%206)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20get%20first%20and%20last%20point..%20figure%20out%20the%20middle!%0A%20%20%20%20var%20verts%20%3D%20webGLData.points%3B%0A%20%20%20%20var%20indices%20%3D%20webGLData.indices%3B%0A%0A%20%20%20%20var%20length%20%3D%20points.length%20%2F%202%3B%0A%0A%20%20%20%20%2F%2F%20sort%20color%0A%20%20%20%20var%20color%20%3D%20utils.hex2rgb(graphicsData.fillColor)%3B%0A%20%20%20%20var%20alpha%20%3D%20graphicsData.fillAlpha%3B%0A%20%20%20%20var%20r%20%3D%20color%5B0%5D%20*%20alpha%3B%0A%20%20%20%20var%20g%20%3D%20color%5B1%5D%20*%20alpha%3B%0A%20%20%20%20var%20b%20%3D%20color%5B2%5D%20*%20alpha%3B%0A%0A%20%20%20%20var%20triangles%20%3D%20earcut(points%2C%20null%2C%202)%3B%0A%0A%20%20%20%20if%20(!triangles)%20%7B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20vertPos%20%3D%20verts.length%20%2F%206%3B%0A%0A%20%20%20%20var%20i%20%3D%200%3B%0A%0A%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20triangles.length%3B%20i%2B%3D3)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20indices.push(triangles%5Bi%5D%20%2B%20vertPos)%3B%0A%20%20%20%20%20%20%20%20indices.push(triangles%5Bi%5D%20%2B%20vertPos)%3B%0A%20%20%20%20%20%20%20%20indices.push(triangles%5Bi%2B1%5D%20%2B%20vertPos)%3B%0A%20%20%20%20%20%20%20%20indices.push(triangles%5Bi%2B2%5D%20%2BvertPos)%3B%0A%20%20%20%20%20%20%20%20indices.push(triangles%5Bi%2B2%5D%20%2B%20vertPos)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20verts.push(points%5Bi%20*%202%5D%2C%20points%5Bi%20*%202%20%2B%201%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20r%2C%20g%2C%20b%2C%20alpha)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20true%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2F..%2Fconst%22%3A13%2C%22..%2F..%2Fmath%22%3A23%2C%22..%2F..%2Frenderers%2Fwebgl%2FWebGLRenderer%22%3A39%2C%22..%2F..%2Frenderers%2Fwebgl%2Futils%2FObjectRenderer%22%3A53%2C%22..%2F..%2Futils%22%3A67%2C%22.%2FWebGLGraphicsData%22%3A19%2C%22earcut%22%3A9%7D%5D%2C19%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F**%0A%20*%20An%20object%20containing%20WebGL%20specific%20properties%20to%20be%20used%20by%20the%20WebGL%20renderer%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20gl%20%7BWebGLRenderingContext%7D%20the%20current%20WebGL%20drawing%20context%0A%20*%20%40private%0A%20*%2F%0Afunction%20WebGLGraphicsData(gl)%20%7B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20current%20WebGL%20drawing%20context%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BWebGLRenderingContext%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.gl%20%3D%20gl%3B%0A%0A%20%20%20%20%2F%2FTODO%20does%20this%20need%20to%20be%20split%20before%20uploding%3F%3F%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20An%20array%20of%20color%20components%20(r%2Cg%2Cb)%0A%20%20%20%20%20*%20%40member%20%7Bnumber%5B%5D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.color%20%3D%20%5B0%2C0%2C0%5D%3B%20%2F%2F%20color%20split!%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20An%20array%20of%20points%20to%20draw%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Point%5B%5D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.points%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20indices%20of%20the%20vertices%0A%20%20%20%20%20*%20%40member%20%7Bnumber%5B%5D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.indices%20%3D%20%5B%5D%3B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20main%20buffer%0A%20%20%20%20%20*%20%40member%20%7BWebGLBuffer%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.buffer%20%3D%20gl.createBuffer()%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20index%20buffer%0A%20%20%20%20%20*%20%40member%20%7BWebGLBuffer%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.indexBuffer%20%3D%20gl.createBuffer()%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20todo%20%40alvin%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.mode%20%3D%201%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20alpha%20of%20the%20graphics%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.alpha%20%3D%201%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Whether%20this%20graphics%20is%20dirty%20or%20not%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.dirty%20%3D%20true%3B%0A%0A%20%20%20%20this.glPoints%20%3D%20null%3B%0A%20%20%20%20this.glIndices%20%3D%20null%3B%0A%7D%0A%0AWebGLGraphicsData.prototype.constructor%20%3D%20WebGLGraphicsData%3B%0Amodule.exports%20%3D%20WebGLGraphicsData%3B%0A%0A%2F**%0A%20*%20Resets%20the%20vertices%20and%20the%20indices%0A%20*%2F%0AWebGLGraphicsData.prototype.reset%20%3D%20function%20()%20%7B%0A%20%20%20%20this.points.length%20%3D%200%3B%0A%20%20%20%20this.indices.length%20%3D%200%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Binds%20the%20buffers%20and%20uploads%20the%20data%0A%20*%2F%0AWebGLGraphicsData.prototype.upload%20%3D%20function%20()%20%7B%0A%20%20%20%20var%20gl%20%3D%20this.gl%3B%0A%0A%2F%2F%20%20%20%20this.lastIndex%20%3D%20graphics.graphicsData.length%3B%0A%20%20%20%20this.glPoints%20%3D%20new%20Float32Array(this.points)%3B%0A%0A%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20this.buffer)%3B%0A%20%20%20%20gl.bufferData(gl.ARRAY_BUFFER%2C%20this.glPoints%2C%20gl.STATIC_DRAW)%3B%0A%0A%20%20%20%20this.glIndices%20%3D%20new%20Uint16Array(this.indices)%3B%0A%0A%20%20%20%20gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER%2C%20this.indexBuffer)%3B%0A%20%20%20%20gl.bufferData(gl.ELEMENT_ARRAY_BUFFER%2C%20this.glIndices%2C%20gl.STATIC_DRAW)%3B%0A%0A%20%20%20%20this.dirty%20%3D%20false%3B%0A%7D%3B%0A%0AWebGLGraphicsData.prototype.destroy%20%3D%20function%20()%20%7B%0A%20%20%20%20this.color%20%3D%20null%3B%0A%20%20%20%20this.points%20%3D%20null%3B%0A%20%20%20%20this.indices%20%3D%20null%3B%0A%0A%20%20%20%20this.gl.deleteBuffer(this.buffer)%3B%0A%20%20%20%20this.gl.deleteBuffer(this.indexBuffer)%3B%0A%20%20%20%20%0A%20%20%20%20this.gl%20%3D%20null%3B%0A%0A%20%20%20%20this.buffer%20%3D%20null%3B%0A%20%20%20%20this.indexBuffer%20%3D%20null%3B%0A%0A%20%20%20%20this.glPoints%20%3D%20null%3B%0A%20%20%20%20this.glIndices%20%3D%20null%3B%0A%7D%3B%0A%0A%7D%2C%7B%7D%5D%2C20%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F**%0A%20*%20%40file%20%20%20%20%20%20%20%20Main%20export%20of%20the%20PIXI%20core%20library%0A%20*%20%40author%20%20%20%20%20%20Mat%20Groves%20%3Cmat%40goodboydigital.com%3E%0A%20*%20%40copyright%20%20%202013-2015%20GoodBoyDigital%0A%20*%20%40license%20%20%20%20%20%7B%40link%20https%3A%2F%2Fgithub.com%2Fpixijs%2Fpixi.js%2Fblob%2Fmaster%2FLICENSE%7CMIT%20License%7D%0A%20*%2F%0A%0A%2F**%0A%20*%20%40namespace%20PIXI%0A%20*%2F%0A%2F%2F%20export%20core%20and%20const.%20We%20assign%20core%20to%20const%20so%20that%20the%20non-reference%20types%20in%20const%20remain%20in-tact%0Avar%20core%20%3D%20module.exports%20%3D%20Object.assign(require('.%2Fconst')%2C%20require('.%2Fmath')%2C%20%7B%0A%20%20%20%20%2F%2F%20utils%0A%20%20%20%20utils%3A%20require('.%2Futils')%2C%0A%20%20%20%20ticker%3A%20require('.%2Fticker')%2C%0A%0A%20%20%20%20%2F%2F%20display%0A%20%20%20%20DisplayObject%3A%20%20%20%20%20%20%20%20%20%20require('.%2Fdisplay%2FDisplayObject')%2C%0A%20%20%20%20Container%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20require('.%2Fdisplay%2FContainer')%2C%0A%0A%20%20%20%20%2F%2F%20sprites%0A%20%20%20%20Sprite%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20require('.%2Fsprites%2FSprite')%2C%0A%20%20%20%20ParticleContainer%3A%20%20%20%20%20%20require('.%2Fparticles%2FParticleContainer')%2C%0A%20%20%20%20SpriteRenderer%3A%20%20%20%20%20%20%20%20%20require('.%2Fsprites%2Fwebgl%2FSpriteRenderer')%2C%0A%20%20%20%20ParticleRenderer%3A%20%20%20%20%20%20%20require('.%2Fparticles%2Fwebgl%2FParticleRenderer')%2C%0A%0A%20%20%20%20%2F%2F%20text%0A%20%20%20%20Text%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20require('.%2Ftext%2FText')%2C%0A%0A%20%20%20%20%2F%2F%20primitives%0A%20%20%20%20Graphics%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20require('.%2Fgraphics%2FGraphics')%2C%0A%20%20%20%20GraphicsData%3A%20%20%20%20%20%20%20%20%20%20%20require('.%2Fgraphics%2FGraphicsData')%2C%0A%20%20%20%20GraphicsRenderer%3A%20%20%20%20%20%20%20require('.%2Fgraphics%2Fwebgl%2FGraphicsRenderer')%2C%0A%0A%20%20%20%20%2F%2F%20textures%0A%20%20%20%20Texture%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20require('.%2Ftextures%2FTexture')%2C%0A%20%20%20%20BaseTexture%3A%20%20%20%20%20%20%20%20%20%20%20%20require('.%2Ftextures%2FBaseTexture')%2C%0A%20%20%20%20RenderTexture%3A%20%20%20%20%20%20%20%20%20%20require('.%2Ftextures%2FRenderTexture')%2C%0A%20%20%20%20VideoBaseTexture%3A%20%20%20%20%20%20%20require('.%2Ftextures%2FVideoBaseTexture')%2C%0A%20%20%20%20TextureUvs%3A%20%20%20%20%20%20%20%20%20%20%20%20%20require('.%2Ftextures%2FTextureUvs')%2C%0A%0A%20%20%20%20%2F%2F%20renderers%20-%20canvas%0A%20%20%20%20CanvasRenderer%3A%20%20%20%20%20%20%20%20%20require('.%2Frenderers%2Fcanvas%2FCanvasRenderer')%2C%0A%20%20%20%20CanvasGraphics%3A%20%20%20%20%20%20%20%20%20require('.%2Frenderers%2Fcanvas%2Futils%2FCanvasGraphics')%2C%0A%20%20%20%20CanvasBuffer%3A%20%20%20%20%20%20%20%20%20%20%20require('.%2Frenderers%2Fcanvas%2Futils%2FCanvasBuffer')%2C%0A%0A%20%20%20%20%2F%2F%20renderers%20-%20webgl%0A%20%20%20%20WebGLRenderer%3A%20%20%20%20%20%20%20%20%20%20require('.%2Frenderers%2Fwebgl%2FWebGLRenderer')%2C%0A%20%20%20%20ShaderManager%3A%20%20%20%20%20%20%20%20%20%20require('.%2Frenderers%2Fwebgl%2Fmanagers%2FShaderManager')%2C%0A%20%20%20%20Shader%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20require('.%2Frenderers%2Fwebgl%2Fshaders%2FShader')%2C%0A%20%20%20%20ObjectRenderer%3A%20%20%20%20%20%20%20%20%20require('.%2Frenderers%2Fwebgl%2Futils%2FObjectRenderer')%2C%0A%20%20%20%20RenderTarget%3A%20%20%20%20%20%20%20%20%20%20%20require('.%2Frenderers%2Fwebgl%2Futils%2FRenderTarget')%2C%0A%0A%20%20%20%20%2F%2F%20filters%20-%20webgl%0A%20%20%20%20AbstractFilter%3A%20%20%20%20%20%20%20%20%20require('.%2Frenderers%2Fwebgl%2Ffilters%2FAbstractFilter')%2C%0A%20%20%20%20FXAAFilter%3A%20%20%20%20%20%20%20%20%20%20%20%20%20require('.%2Frenderers%2Fwebgl%2Ffilters%2FFXAAFilter')%2C%0A%20%20%20%20SpriteMaskFilter%3A%20%20%20%20%20%20%20require('.%2Frenderers%2Fwebgl%2Ffilters%2FSpriteMaskFilter')%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20This%20helper%20function%20will%20automatically%20detect%20which%20renderer%20you%20should%20be%20using.%0A%20%20%20%20%20*%20WebGL%20is%20the%20preferred%20renderer%20as%20it%20is%20a%20lot%20faster.%20If%20webGL%20is%20not%20supported%20by%0A%20%20%20%20%20*%20the%20browser%20then%20this%20function%20will%20return%20a%20canvas%20renderer%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40memberof%20PIXI%0A%20%20%20%20%20*%20%40param%20width%3D800%20%7Bnumber%7D%20the%20width%20of%20the%20renderers%20view%0A%20%20%20%20%20*%20%40param%20height%3D600%20%7Bnumber%7D%20the%20height%20of%20the%20renderers%20view%0A%20%20%20%20%20*%20%40param%20%5Boptions%5D%20%7Bobject%7D%20The%20optional%20renderer%20parameters%0A%20%20%20%20%20*%20%40param%20%5Boptions.view%5D%20%7BHTMLCanvasElement%7D%20the%20canvas%20to%20use%20as%20a%20view%2C%20optional%0A%20%20%20%20%20*%20%40param%20%5Boptions.transparent%3Dfalse%5D%20%7Bboolean%7D%20If%20the%20render%20view%20is%20transparent%2C%20default%20false%0A%20%20%20%20%20*%20%40param%20%5Boptions.antialias%3Dfalse%5D%20%7Bboolean%7D%20sets%20antialias%20(only%20applicable%20in%20chrome%20at%20the%20moment)%0A%20%20%20%20%20*%20%40param%20%5Boptions.preserveDrawingBuffer%3Dfalse%5D%20%7Bboolean%7D%20enables%20drawing%20buffer%20preservation%2C%20enable%20this%20if%20you%0A%20%20%20%20%20*%20%20%20%20%20%20need%20to%20call%20toDataUrl%20on%20the%20webgl%20context%0A%20%20%20%20%20*%20%40param%20%5Boptions.resolution%3D1%5D%20%7Bnumber%7D%20the%20resolution%20of%20the%20renderer%2C%20retina%20would%20be%202%0A%20%20%20%20%20*%20%40param%20%5BnoWebGL%3Dfalse%5D%20%7Bboolean%7D%20prevents%20selection%20of%20WebGL%20renderer%2C%20even%20if%20such%20is%20present%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40return%20%7BWebGLRenderer%7CCanvasRenderer%7D%20Returns%20WebGL%20renderer%20if%20available%2C%20otherwise%20CanvasRenderer%0A%20%20%20%20%20*%2F%0A%20%20%20%20autoDetectRenderer%3A%20function%20(width%2C%20height%2C%20options%2C%20noWebGL)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20width%20%3D%20width%20%7C%7C%20800%3B%0A%20%20%20%20%20%20%20%20height%20%3D%20height%20%7C%7C%20600%3B%0A%0A%20%20%20%20%20%20%20%20if%20(!noWebGL%20%26%26%20core.utils.isWebGLSupported())%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20new%20core.WebGLRenderer(width%2C%20height%2C%20options)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20return%20new%20core.CanvasRenderer(width%2C%20height%2C%20options)%3B%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22.%2Fconst%22%3A13%2C%22.%2Fdisplay%2FContainer%22%3A14%2C%22.%2Fdisplay%2FDisplayObject%22%3A15%2C%22.%2Fgraphics%2FGraphics%22%3A16%2C%22.%2Fgraphics%2FGraphicsData%22%3A17%2C%22.%2Fgraphics%2Fwebgl%2FGraphicsRenderer%22%3A18%2C%22.%2Fmath%22%3A23%2C%22.%2Fparticles%2FParticleContainer%22%3A29%2C%22.%2Fparticles%2Fwebgl%2FParticleRenderer%22%3A31%2C%22.%2Frenderers%2Fcanvas%2FCanvasRenderer%22%3A34%2C%22.%2Frenderers%2Fcanvas%2Futils%2FCanvasBuffer%22%3A35%2C%22.%2Frenderers%2Fcanvas%2Futils%2FCanvasGraphics%22%3A36%2C%22.%2Frenderers%2Fwebgl%2FWebGLRenderer%22%3A39%2C%22.%2Frenderers%2Fwebgl%2Ffilters%2FAbstractFilter%22%3A40%2C%22.%2Frenderers%2Fwebgl%2Ffilters%2FFXAAFilter%22%3A41%2C%22.%2Frenderers%2Fwebgl%2Ffilters%2FSpriteMaskFilter%22%3A42%2C%22.%2Frenderers%2Fwebgl%2Fmanagers%2FShaderManager%22%3A46%2C%22.%2Frenderers%2Fwebgl%2Fshaders%2FShader%22%3A51%2C%22.%2Frenderers%2Fwebgl%2Futils%2FObjectRenderer%22%3A53%2C%22.%2Frenderers%2Fwebgl%2Futils%2FRenderTarget%22%3A55%2C%22.%2Fsprites%2FSprite%22%3A57%2C%22.%2Fsprites%2Fwebgl%2FSpriteRenderer%22%3A58%2C%22.%2Ftext%2FText%22%3A59%2C%22.%2Ftextures%2FBaseTexture%22%3A60%2C%22.%2Ftextures%2FRenderTexture%22%3A61%2C%22.%2Ftextures%2FTexture%22%3A62%2C%22.%2Ftextures%2FTextureUvs%22%3A63%2C%22.%2Ftextures%2FVideoBaseTexture%22%3A64%2C%22.%2Fticker%22%3A66%2C%22.%2Futils%22%3A67%7D%5D%2C21%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20Point%20%3D%20require('.%2FPoint')%3B%0A%0A%2F**%0A%20*%20The%20pixi%20Matrix%20class%20as%20an%20object%2C%20which%20makes%20it%20a%20lot%20faster%2C%0A%20*%20here%20is%20a%20representation%20of%20it%20%3A%0A%20*%20%7C%20a%20%7C%20b%20%7C%20tx%7C%0A%20*%20%7C%20c%20%7C%20d%20%7C%20ty%7C%0A%20*%20%7C%200%20%7C%200%20%7C%201%20%7C%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%2F%0Afunction%20Matrix()%0A%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%201%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.a%20%3D%201%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.b%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.c%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%201%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.d%20%3D%201%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.tx%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.ty%20%3D%200%3B%0A%7D%0A%0AMatrix.prototype.constructor%20%3D%20Matrix%3B%0Amodule.exports%20%3D%20Matrix%3B%0A%0A%2F**%0A%20*%20Creates%20a%20Matrix%20object%20based%20on%20the%20given%20array.%20The%20Element%20to%20Matrix%20mapping%20order%20is%20as%20follows%3A%0A%20*%0A%20*%20a%20%3D%20array%5B0%5D%0A%20*%20b%20%3D%20array%5B1%5D%0A%20*%20c%20%3D%20array%5B3%5D%0A%20*%20d%20%3D%20array%5B4%5D%0A%20*%20tx%20%3D%20array%5B2%5D%0A%20*%20ty%20%3D%20array%5B5%5D%0A%20*%0A%20*%20%40param%20array%20%7Bnumber%5B%5D%7D%20The%20array%20that%20the%20matrix%20will%20be%20populated%20from.%0A%20*%2F%0AMatrix.prototype.fromArray%20%3D%20function%20(array)%0A%7B%0A%20%20%20%20this.a%20%3D%20array%5B0%5D%3B%0A%20%20%20%20this.b%20%3D%20array%5B1%5D%3B%0A%20%20%20%20this.c%20%3D%20array%5B3%5D%3B%0A%20%20%20%20this.d%20%3D%20array%5B4%5D%3B%0A%20%20%20%20this.tx%20%3D%20array%5B2%5D%3B%0A%20%20%20%20this.ty%20%3D%20array%5B5%5D%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Creates%20an%20array%20from%20the%20current%20Matrix%20object.%0A%20*%0A%20*%20%40param%20transpose%20%7Bboolean%7D%20Whether%20we%20need%20to%20transpose%20the%20matrix%20or%20not%0A%20*%20%40return%20%7Bnumber%5B%5D%7D%20the%20newly%20created%20array%20which%20contains%20the%20matrix%0A%20*%2F%0AMatrix.prototype.toArray%20%3D%20function%20(transpose%2C%20out)%0A%7B%0A%20%20%20%20if%20(!this.array)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.array%20%3D%20new%20Float32Array(9)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20array%20%3D%20out%20%7C%7C%20this.array%3B%0A%0A%20%20%20%20if%20(transpose)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20array%5B0%5D%20%3D%20this.a%3B%0A%20%20%20%20%20%20%20%20array%5B1%5D%20%3D%20this.b%3B%0A%20%20%20%20%20%20%20%20array%5B2%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20array%5B3%5D%20%3D%20this.c%3B%0A%20%20%20%20%20%20%20%20array%5B4%5D%20%3D%20this.d%3B%0A%20%20%20%20%20%20%20%20array%5B5%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20array%5B6%5D%20%3D%20this.tx%3B%0A%20%20%20%20%20%20%20%20array%5B7%5D%20%3D%20this.ty%3B%0A%20%20%20%20%20%20%20%20array%5B8%5D%20%3D%201%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20array%5B0%5D%20%3D%20this.a%3B%0A%20%20%20%20%20%20%20%20array%5B1%5D%20%3D%20this.c%3B%0A%20%20%20%20%20%20%20%20array%5B2%5D%20%3D%20this.tx%3B%0A%20%20%20%20%20%20%20%20array%5B3%5D%20%3D%20this.b%3B%0A%20%20%20%20%20%20%20%20array%5B4%5D%20%3D%20this.d%3B%0A%20%20%20%20%20%20%20%20array%5B5%5D%20%3D%20this.ty%3B%0A%20%20%20%20%20%20%20%20array%5B6%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20array%5B7%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20array%5B8%5D%20%3D%201%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20array%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Get%20a%20new%20position%20with%20the%20current%20transformation%20applied.%0A%20*%20Can%20be%20used%20to%20go%20from%20a%20child's%20coordinate%20space%20to%20the%20world%20coordinate%20space.%20(e.g.%20rendering)%0A%20*%0A%20*%20%40param%20pos%20%7BPIXI.Point%7D%20The%20origin%0A%20*%20%40param%20%5BnewPos%5D%20%7BPIXI.Point%7D%20The%20point%20that%20the%20new%20position%20is%20assigned%20to%20(allowed%20to%20be%20same%20as%20input)%0A%20*%20%40return%20%7BPIXI.Point%7D%20The%20new%20point%2C%20transformed%20through%20this%20matrix%0A%20*%2F%0AMatrix.prototype.apply%20%3D%20function%20(pos%2C%20newPos)%0A%7B%0A%20%20%20%20newPos%20%3D%20newPos%20%7C%7C%20new%20Point()%3B%0A%0A%20%20%20%20var%20x%20%3D%20pos.x%3B%0A%20%20%20%20var%20y%20%3D%20pos.y%3B%0A%0A%20%20%20%20newPos.x%20%3D%20this.a%20*%20x%20%2B%20this.c%20*%20y%20%2B%20this.tx%3B%0A%20%20%20%20newPos.y%20%3D%20this.b%20*%20x%20%2B%20this.d%20*%20y%20%2B%20this.ty%3B%0A%0A%20%20%20%20return%20newPos%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Get%20a%20new%20position%20with%20the%20inverse%20of%20the%20current%20transformation%20applied.%0A%20*%20Can%20be%20used%20to%20go%20from%20the%20world%20coordinate%20space%20to%20a%20child's%20coordinate%20space.%20(e.g.%20input)%0A%20*%0A%20*%20%40param%20pos%20%7BPIXI.Point%7D%20The%20origin%0A%20*%20%40param%20%5BnewPos%5D%20%7BPIXI.Point%7D%20The%20point%20that%20the%20new%20position%20is%20assigned%20to%20(allowed%20to%20be%20same%20as%20input)%0A%20*%20%40return%20%7BPIXI.Point%7D%20The%20new%20point%2C%20inverse-transformed%20through%20this%20matrix%0A%20*%2F%0AMatrix.prototype.applyInverse%20%3D%20function%20(pos%2C%20newPos)%0A%7B%0A%20%20%20%20newPos%20%3D%20newPos%20%7C%7C%20new%20Point()%3B%0A%0A%20%20%20%20var%20id%20%3D%201%20%2F%20(this.a%20*%20this.d%20%2B%20this.c%20*%20-this.b)%3B%0A%0A%20%20%20%20var%20x%20%3D%20pos.x%3B%0A%20%20%20%20var%20y%20%3D%20pos.y%3B%0A%0A%20%20%20%20newPos.x%20%3D%20this.d%20*%20id%20*%20x%20%2B%20-this.c%20*%20id%20*%20y%20%2B%20(this.ty%20*%20this.c%20-%20this.tx%20*%20this.d)%20*%20id%3B%0A%20%20%20%20newPos.y%20%3D%20this.a%20*%20id%20*%20y%20%2B%20-this.b%20*%20id%20*%20x%20%2B%20(-this.ty%20*%20this.a%20%2B%20this.tx%20*%20this.b)%20*%20id%3B%0A%0A%20%20%20%20return%20newPos%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Translates%20the%20matrix%20on%20the%20x%20and%20y.%0A%20*%0A%20*%20%40param%20%7Bnumber%7D%20x%0A%20*%20%40param%20%7Bnumber%7D%20y%0A%20*%20%40return%20%7BPIXI.Matrix%7D%20This%20matrix.%20Good%20for%20chaining%20method%20calls.%0A%20*%2F%0AMatrix.prototype.translate%20%3D%20function%20(x%2C%20y)%0A%7B%0A%20%20%20%20this.tx%20%2B%3D%20x%3B%0A%20%20%20%20this.ty%20%2B%3D%20y%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Applies%20a%20scale%20transformation%20to%20the%20matrix.%0A%20*%0A%20*%20%40param%20%7Bnumber%7D%20x%20The%20amount%20to%20scale%20horizontally%0A%20*%20%40param%20%7Bnumber%7D%20y%20The%20amount%20to%20scale%20vertically%0A%20*%20%40return%20%7BPIXI.Matrix%7D%20This%20matrix.%20Good%20for%20chaining%20method%20calls.%0A%20*%2F%0AMatrix.prototype.scale%20%3D%20function%20(x%2C%20y)%0A%7B%0A%20%20%20%20this.a%20*%3D%20x%3B%0A%20%20%20%20this.d%20*%3D%20y%3B%0A%20%20%20%20this.c%20*%3D%20x%3B%0A%20%20%20%20this.b%20*%3D%20y%3B%0A%20%20%20%20this.tx%20*%3D%20x%3B%0A%20%20%20%20this.ty%20*%3D%20y%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Applies%20a%20rotation%20transformation%20to%20the%20matrix.%0A%20*%0A%20*%20%40param%20%7Bnumber%7D%20angle%20-%20The%20angle%20in%20radians.%0A%20*%20%40return%20%7BPIXI.Matrix%7D%20This%20matrix.%20Good%20for%20chaining%20method%20calls.%0A%20*%2F%0AMatrix.prototype.rotate%20%3D%20function%20(angle)%0A%7B%0A%20%20%20%20var%20cos%20%3D%20Math.cos(%20angle%20)%3B%0A%20%20%20%20var%20sin%20%3D%20Math.sin(%20angle%20)%3B%0A%0A%20%20%20%20var%20a1%20%3D%20this.a%3B%0A%20%20%20%20var%20c1%20%3D%20this.c%3B%0A%20%20%20%20var%20tx1%20%3D%20this.tx%3B%0A%0A%20%20%20%20this.a%20%3D%20a1%20*%20cos-this.b%20*%20sin%3B%0A%20%20%20%20this.b%20%3D%20a1%20*%20sin%2Bthis.b%20*%20cos%3B%0A%20%20%20%20this.c%20%3D%20c1%20*%20cos-this.d%20*%20sin%3B%0A%20%20%20%20this.d%20%3D%20c1%20*%20sin%2Bthis.d%20*%20cos%3B%0A%20%20%20%20this.tx%20%3D%20tx1%20*%20cos%20-%20this.ty%20*%20sin%3B%0A%20%20%20%20this.ty%20%3D%20tx1%20*%20sin%20%2B%20this.ty%20*%20cos%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Appends%20the%20given%20Matrix%20to%20this%20Matrix.%0A%20*%0A%20*%20%40param%20%7BPIXI.Matrix%7D%20matrix%0A%20*%20%40return%20%7BPIXI.Matrix%7D%20This%20matrix.%20Good%20for%20chaining%20method%20calls.%0A%20*%2F%0AMatrix.prototype.append%20%3D%20function%20(matrix)%0A%7B%0A%20%20%20%20var%20a1%20%3D%20this.a%3B%0A%20%20%20%20var%20b1%20%3D%20this.b%3B%0A%20%20%20%20var%20c1%20%3D%20this.c%3B%0A%20%20%20%20var%20d1%20%3D%20this.d%3B%0A%0A%20%20%20%20this.a%20%20%3D%20matrix.a%20*%20a1%20%2B%20matrix.b%20*%20c1%3B%0A%20%20%20%20this.b%20%20%3D%20matrix.a%20*%20b1%20%2B%20matrix.b%20*%20d1%3B%0A%20%20%20%20this.c%20%20%3D%20matrix.c%20*%20a1%20%2B%20matrix.d%20*%20c1%3B%0A%20%20%20%20this.d%20%20%3D%20matrix.c%20*%20b1%20%2B%20matrix.d%20*%20d1%3B%0A%0A%20%20%20%20this.tx%20%3D%20matrix.tx%20*%20a1%20%2B%20matrix.ty%20*%20c1%20%2B%20this.tx%3B%0A%20%20%20%20this.ty%20%3D%20matrix.tx%20*%20b1%20%2B%20matrix.ty%20*%20d1%20%2B%20this.ty%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Prepends%20the%20given%20Matrix%20to%20this%20Matrix.%0A%20*%0A%20*%20%40param%20%7BPIXI.Matrix%7D%20matrix%0A%20*%20%40return%20%7BPIXI.Matrix%7D%20This%20matrix.%20Good%20for%20chaining%20method%20calls.%0A%20*%2F%0AMatrix.prototype.prepend%20%3D%20function(matrix)%0A%7B%0A%20%20%20%20var%20tx1%20%3D%20this.tx%3B%0A%0A%20%20%20%20if%20(matrix.a%20!%3D%3D%201%20%7C%7C%20matrix.b%20!%3D%3D%200%20%7C%7C%20matrix.c%20!%3D%3D%200%20%7C%7C%20matrix.d%20!%3D%3D%201)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20a1%20%3D%20this.a%3B%0A%20%20%20%20%20%20%20%20var%20c1%20%3D%20this.c%3B%0A%20%20%20%20%20%20%20%20this.a%20%20%3D%20a1*matrix.a%2Bthis.b*matrix.c%3B%0A%20%20%20%20%20%20%20%20this.b%20%20%3D%20a1*matrix.b%2Bthis.b*matrix.d%3B%0A%20%20%20%20%20%20%20%20this.c%20%20%3D%20c1*matrix.a%2Bthis.d*matrix.c%3B%0A%20%20%20%20%20%20%20%20this.d%20%20%3D%20c1*matrix.b%2Bthis.d*matrix.d%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.tx%20%3D%20tx1*matrix.a%2Bthis.ty*matrix.c%2Bmatrix.tx%3B%0A%20%20%20%20this.ty%20%3D%20tx1*matrix.b%2Bthis.ty*matrix.d%2Bmatrix.ty%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Inverts%20this%20matrix%0A%20*%0A%20*%20%40return%20%7BPIXI.Matrix%7D%20This%20matrix.%20Good%20for%20chaining%20method%20calls.%0A%20*%2F%0AMatrix.prototype.invert%20%3D%20function()%0A%7B%0A%20%20%20%20var%20a1%20%3D%20this.a%3B%0A%20%20%20%20var%20b1%20%3D%20this.b%3B%0A%20%20%20%20var%20c1%20%3D%20this.c%3B%0A%20%20%20%20var%20d1%20%3D%20this.d%3B%0A%20%20%20%20var%20tx1%20%3D%20this.tx%3B%0A%20%20%20%20var%20n%20%3D%20a1*d1-b1*c1%3B%0A%0A%20%20%20%20this.a%20%3D%20d1%2Fn%3B%0A%20%20%20%20this.b%20%3D%20-b1%2Fn%3B%0A%20%20%20%20this.c%20%3D%20-c1%2Fn%3B%0A%20%20%20%20this.d%20%3D%20a1%2Fn%3B%0A%20%20%20%20this.tx%20%3D%20(c1*this.ty-d1*tx1)%2Fn%3B%0A%20%20%20%20this.ty%20%3D%20-(a1*this.ty-b1*tx1)%2Fn%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Resets%20this%20Matix%20to%20an%20identity%20(default)%20matrix.%0A%20*%0A%20*%20%40return%20%7BPIXI.Matrix%7D%20This%20matrix.%20Good%20for%20chaining%20method%20calls.%0A%20*%2F%0AMatrix.prototype.identity%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.a%20%3D%201%3B%0A%20%20%20%20this.b%20%3D%200%3B%0A%20%20%20%20this.c%20%3D%200%3B%0A%20%20%20%20this.d%20%3D%201%3B%0A%20%20%20%20this.tx%20%3D%200%3B%0A%20%20%20%20this.ty%20%3D%200%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Creates%20a%20new%20Matrix%20object%20with%20the%20same%20values%20as%20this%20one.%0A%20*%0A%20*%20%40return%20%7BPIXI.Matrix%7D%20A%20copy%20of%20this%20matrix.%20Good%20for%20chaining%20method%20calls.%0A%20*%2F%0AMatrix.prototype.clone%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20matrix%20%3D%20new%20Matrix()%3B%0A%20%20%20%20matrix.a%20%3D%20this.a%3B%0A%20%20%20%20matrix.b%20%3D%20this.b%3B%0A%20%20%20%20matrix.c%20%3D%20this.c%3B%0A%20%20%20%20matrix.d%20%3D%20this.d%3B%0A%20%20%20%20matrix.tx%20%3D%20this.tx%3B%0A%20%20%20%20matrix.ty%20%3D%20this.ty%3B%0A%0A%20%20%20%20return%20matrix%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Changes%20the%20values%20of%20the%20given%20matrix%20to%20be%20the%20same%20as%20the%20ones%20in%20this%20matrix%0A%20*%0A%20*%20%40return%20%7BPIXI.Matrix%7D%20The%20matrix%20given%20in%20parameter%20with%20its%20values%20updated.%0A%20*%2F%0AMatrix.prototype.copy%20%3D%20function%20(matrix)%0A%7B%0A%20%20%20%20matrix.a%20%3D%20this.a%3B%0A%20%20%20%20matrix.b%20%3D%20this.b%3B%0A%20%20%20%20matrix.c%20%3D%20this.c%3B%0A%20%20%20%20matrix.d%20%3D%20this.d%3B%0A%20%20%20%20matrix.tx%20%3D%20this.tx%3B%0A%20%20%20%20matrix.ty%20%3D%20this.ty%3B%0A%0A%20%20%20%20return%20matrix%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20A%20default%20(identity)%20matrix%0A%20*%0A%20*%20%40static%0A%20*%20%40const%0A%20*%2F%0AMatrix.IDENTITY%20%3D%20new%20Matrix()%3B%0A%0A%2F**%0A%20*%20A%20temp%20matrix%0A%20*%0A%20*%20%40static%0A%20*%20%40const%0A%20*%2F%0AMatrix.TEMP_MATRIX%20%3D%20new%20Matrix()%3B%0A%0A%7D%2C%7B%22.%2FPoint%22%3A22%7D%5D%2C22%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F**%0A%20*%20The%20Point%20object%20represents%20a%20location%20in%20a%20two-dimensional%20coordinate%20system%2C%20where%20x%20represents%0A%20*%20the%20horizontal%20axis%20and%20y%20represents%20the%20vertical%20axis.%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20%5Bx%3D0%5D%20%7Bnumber%7D%20position%20of%20the%20point%20on%20the%20x%20axis%0A%20*%20%40param%20%5By%3D0%5D%20%7Bnumber%7D%20position%20of%20the%20point%20on%20the%20y%20axis%0A%20*%2F%0Afunction%20Point(x%2C%20y)%0A%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.x%20%3D%20x%20%7C%7C%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.y%20%3D%20y%20%7C%7C%200%3B%0A%7D%0A%0APoint.prototype.constructor%20%3D%20Point%3B%0Amodule.exports%20%3D%20Point%3B%0A%0A%2F**%0A%20*%20Creates%20a%20clone%20of%20this%20point%0A%20*%0A%20*%20%40return%20%7BPIXI.Point%7D%20a%20copy%20of%20the%20point%0A%20*%2F%0APoint.prototype.clone%20%3D%20function%20()%0A%7B%0A%20%20%20%20return%20new%20Point(this.x%2C%20this.y)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Copies%20x%20and%20y%20from%20the%20given%20point%0A%20*%0A%20*%20%40param%20p%20%7BPIXI.Point%7D%0A%20*%2F%0APoint.prototype.copy%20%3D%20function%20(p)%20%7B%0A%20%20%20%20this.set(p.x%2C%20p.y)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Returns%20true%20if%20the%20given%20point%20is%20equal%20to%20this%20point%0A%20*%0A%20*%20%40param%20p%20%7BPIXI.Point%7D%0A%20*%20%40returns%20%7Bboolean%7D%0A%20*%2F%0APoint.prototype.equals%20%3D%20function%20(p)%20%7B%0A%20%20%20%20return%20(p.x%20%3D%3D%3D%20this.x)%20%26%26%20(p.y%20%3D%3D%3D%20this.y)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Sets%20the%20point%20to%20a%20new%20x%20and%20y%20position.%0A%20*%20If%20y%20is%20omitted%2C%20both%20x%20and%20y%20will%20be%20set%20to%20x.%0A%20*%0A%20*%20%40param%20%5Bx%3D0%5D%20%7Bnumber%7D%20position%20of%20the%20point%20on%20the%20x%20axis%0A%20*%20%40param%20%5By%3D0%5D%20%7Bnumber%7D%20position%20of%20the%20point%20on%20the%20y%20axis%0A%20*%2F%0APoint.prototype.set%20%3D%20function%20(x%2C%20y)%0A%7B%0A%20%20%20%20this.x%20%3D%20x%20%7C%7C%200%3B%0A%20%20%20%20this.y%20%3D%20y%20%7C%7C%20(%20(y%20!%3D%3D%200)%20%3F%20this.x%20%3A%200%20)%20%3B%0A%7D%3B%0A%0A%7D%2C%7B%7D%5D%2C23%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F**%0A%20*%20Math%20classes%20and%20utilities%20mixed%20into%20PIXI%20namespace.%0A%20*%0A%20*%20%40lends%20PIXI%0A%20*%2F%0Amodule.exports%20%3D%20%7B%0A%20%20%20%20%2F%2F%20These%20will%20be%20mixed%20to%20be%20made%20publicly%20available%2C%0A%20%20%20%20%2F%2F%20while%20this%20module%20is%20used%20internally%20in%20core%0A%20%20%20%20%2F%2F%20to%20avoid%20circular%20dependencies%20and%20cut%20down%20on%0A%20%20%20%20%2F%2F%20internal%20module%20requires.%0A%0A%20%20%20%20Point%3A%20%20%20%20%20%20require('.%2FPoint')%2C%0A%20%20%20%20Matrix%3A%20%20%20%20%20require('.%2FMatrix')%2C%0A%0A%20%20%20%20Circle%3A%20%20%20%20%20require('.%2Fshapes%2FCircle')%2C%0A%20%20%20%20Ellipse%3A%20%20%20%20require('.%2Fshapes%2FEllipse')%2C%0A%20%20%20%20Polygon%3A%20%20%20%20require('.%2Fshapes%2FPolygon')%2C%0A%20%20%20%20Rectangle%3A%20%20require('.%2Fshapes%2FRectangle')%2C%0A%20%20%20%20RoundedRectangle%3A%20require('.%2Fshapes%2FRoundedRectangle')%0A%7D%3B%0A%0A%7D%2C%7B%22.%2FMatrix%22%3A21%2C%22.%2FPoint%22%3A22%2C%22.%2Fshapes%2FCircle%22%3A24%2C%22.%2Fshapes%2FEllipse%22%3A25%2C%22.%2Fshapes%2FPolygon%22%3A26%2C%22.%2Fshapes%2FRectangle%22%3A27%2C%22.%2Fshapes%2FRoundedRectangle%22%3A28%7D%5D%2C24%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20Rectangle%20%3D%20require('.%2FRectangle')%2C%0A%20%20%20%20CONST%20%3D%20require('..%2F..%2Fconst')%3B%0A%0A%2F**%0A%20*%20The%20Circle%20object%20can%20be%20used%20to%20specify%20a%20hit%20area%20for%20displayObjects%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20x%20%7Bnumber%7D%20The%20X%20coordinate%20of%20the%20center%20of%20this%20circle%0A%20*%20%40param%20y%20%7Bnumber%7D%20The%20Y%20coordinate%20of%20the%20center%20of%20this%20circle%0A%20*%20%40param%20radius%20%7Bnumber%7D%20The%20radius%20of%20the%20circle%0A%20*%2F%0Afunction%20Circle(x%2C%20y%2C%20radius)%0A%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.x%20%3D%20x%20%7C%7C%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.y%20%3D%20y%20%7C%7C%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.radius%20%3D%20radius%20%7C%7C%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20type%20of%20the%20object%2C%20mainly%20used%20to%20avoid%20%60instanceof%60%20checks%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.type%20%3D%20CONST.SHAPES.CIRC%3B%0A%7D%0A%0ACircle.prototype.constructor%20%3D%20Circle%3B%0Amodule.exports%20%3D%20Circle%3B%0A%0A%2F**%0A%20*%20Creates%20a%20clone%20of%20this%20Circle%20instance%0A%20*%0A%20*%20%40return%20%7BPIXI.Circle%7D%20a%20copy%20of%20the%20Circle%0A%20*%2F%0ACircle.prototype.clone%20%3D%20function%20()%0A%7B%0A%20%20%20%20return%20new%20Circle(this.x%2C%20this.y%2C%20this.radius)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Checks%20whether%20the%20x%20and%20y%20coordinates%20given%20are%20contained%20within%20this%20circle%0A%20*%0A%20*%20%40param%20x%20%7Bnumber%7D%20The%20X%20coordinate%20of%20the%20point%20to%20test%0A%20*%20%40param%20y%20%7Bnumber%7D%20The%20Y%20coordinate%20of%20the%20point%20to%20test%0A%20*%20%40return%20%7Bboolean%7D%20Whether%20the%20x%2Fy%20coordinates%20are%20within%20this%20Circle%0A%20*%2F%0ACircle.prototype.contains%20%3D%20function%20(x%2C%20y)%0A%7B%0A%20%20%20%20if%20(this.radius%20%3C%3D%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20dx%20%3D%20(this.x%20-%20x)%2C%0A%20%20%20%20%20%20%20%20dy%20%3D%20(this.y%20-%20y)%2C%0A%20%20%20%20%20%20%20%20r2%20%3D%20this.radius%20*%20this.radius%3B%0A%0A%20%20%20%20dx%20*%3D%20dx%3B%0A%20%20%20%20dy%20*%3D%20dy%3B%0A%0A%20%20%20%20return%20(dx%20%2B%20dy%20%3C%3D%20r2)%3B%0A%7D%3B%0A%0A%2F**%0A*%20Returns%20the%20framing%20rectangle%20of%20the%20circle%20as%20a%20Rectangle%20object%0A*%0A*%20%40return%20%7BPIXI.Rectangle%7D%20the%20framing%20rectangle%0A*%2F%0ACircle.prototype.getBounds%20%3D%20function%20()%0A%7B%0A%20%20%20%20return%20new%20Rectangle(this.x%20-%20this.radius%2C%20this.y%20-%20this.radius%2C%20this.radius%20*%202%2C%20this.radius%20*%202)%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2F..%2Fconst%22%3A13%2C%22.%2FRectangle%22%3A27%7D%5D%2C25%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20Rectangle%20%3D%20require('.%2FRectangle')%2C%0A%20%20%20%20CONST%20%3D%20require('..%2F..%2Fconst')%3B%0A%0A%2F**%0A%20*%20The%20Ellipse%20object%20can%20be%20used%20to%20specify%20a%20hit%20area%20for%20displayObjects%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20x%20%7Bnumber%7D%20The%20X%20coordinate%20of%20the%20center%20of%20the%20ellipse%0A%20*%20%40param%20y%20%7Bnumber%7D%20The%20Y%20coordinate%20of%20the%20center%20of%20the%20ellipse%0A%20*%20%40param%20width%20%7Bnumber%7D%20The%20half%20width%20of%20this%20ellipse%0A%20*%20%40param%20height%20%7Bnumber%7D%20The%20half%20height%20of%20this%20ellipse%0A%20*%2F%0Afunction%20Ellipse(x%2C%20y%2C%20width%2C%20height)%0A%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.x%20%3D%20x%20%7C%7C%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.y%20%3D%20y%20%7C%7C%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.width%20%3D%20width%20%7C%7C%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.height%20%3D%20height%20%7C%7C%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20type%20of%20the%20object%2C%20mainly%20used%20to%20avoid%20%60instanceof%60%20checks%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.type%20%3D%20CONST.SHAPES.ELIP%3B%0A%7D%0A%0AEllipse.prototype.constructor%20%3D%20Ellipse%3B%0Amodule.exports%20%3D%20Ellipse%3B%0A%0A%2F**%0A%20*%20Creates%20a%20clone%20of%20this%20Ellipse%20instance%0A%20*%0A%20*%20%40return%20%7BPIXI.Ellipse%7D%20a%20copy%20of%20the%20ellipse%0A%20*%2F%0AEllipse.prototype.clone%20%3D%20function%20()%0A%7B%0A%20%20%20%20return%20new%20Ellipse(this.x%2C%20this.y%2C%20this.width%2C%20this.height)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Checks%20whether%20the%20x%20and%20y%20coordinates%20given%20are%20contained%20within%20this%20ellipse%0A%20*%0A%20*%20%40param%20x%20%7Bnumber%7D%20The%20X%20coordinate%20of%20the%20point%20to%20test%0A%20*%20%40param%20y%20%7Bnumber%7D%20The%20Y%20coordinate%20of%20the%20point%20to%20test%0A%20*%20%40return%20%7Bboolean%7D%20Whether%20the%20x%2Fy%20coords%20are%20within%20this%20ellipse%0A%20*%2F%0AEllipse.prototype.contains%20%3D%20function%20(x%2C%20y)%0A%7B%0A%20%20%20%20if%20(this.width%20%3C%3D%200%20%7C%7C%20this.height%20%3C%3D%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2Fnormalize%20the%20coords%20to%20an%20ellipse%20with%20center%200%2C0%0A%20%20%20%20var%20normx%20%3D%20((x%20-%20this.x)%20%2F%20this.width)%2C%0A%20%20%20%20%20%20%20%20normy%20%3D%20((y%20-%20this.y)%20%2F%20this.height)%3B%0A%0A%20%20%20%20normx%20*%3D%20normx%3B%0A%20%20%20%20normy%20*%3D%20normy%3B%0A%0A%20%20%20%20return%20(normx%20%2B%20normy%20%3C%3D%201)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Returns%20the%20framing%20rectangle%20of%20the%20ellipse%20as%20a%20Rectangle%20object%0A%20*%0A%20*%20%40return%20%7BPIXI.Rectangle%7D%20the%20framing%20rectangle%0A%20*%2F%0AEllipse.prototype.getBounds%20%3D%20function%20()%0A%7B%0A%20%20%20%20return%20new%20Rectangle(this.x%20-%20this.width%2C%20this.y%20-%20this.height%2C%20this.width%2C%20this.height)%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2F..%2Fconst%22%3A13%2C%22.%2FRectangle%22%3A27%7D%5D%2C26%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20Point%20%3D%20require('..%2FPoint')%2C%0A%20%20%20%20CONST%20%3D%20require('..%2F..%2Fconst')%3B%0A%0A%2F**%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20points%20%7BPIXI.Point%5B%5D%7Cnumber%5B%5D%7C...PIXI.Point%7C...number%7D%20This%20can%20be%20an%20array%20of%20Points%20that%20form%20the%20polygon%2C%0A%20*%20%20%20%20%20%20a%20flat%20array%20of%20numbers%20that%20will%20be%20interpreted%20as%20%5Bx%2Cy%2C%20x%2Cy%2C%20...%5D%2C%20or%20the%20arguments%20passed%20can%20be%0A%20*%20%20%20%20%20%20all%20the%20points%20of%20the%20polygon%20e.g.%20%60new%20PIXI.Polygon(new%20PIXI.Point()%2C%20new%20PIXI.Point()%2C%20...)%60%2C%20or%20the%0A%20*%20%20%20%20%20%20arguments%20passed%20can%20be%20flat%20x%2Cy%20values%20e.g.%20%60new%20Polygon(x%2Cy%2C%20x%2Cy%2C%20x%2Cy%2C%20...)%60%20where%20%60x%60%20and%20%60y%60%20are%0A%20*%20%20%20%20%20%20Numbers.%0A%20*%2F%0Afunction%20Polygon(points_)%0A%7B%0A%20%20%20%20%2F%2F%20prevents%20an%20argument%20assignment%20deopt%0A%20%20%20%20%2F%2F%20see%20section%203.1%3A%20https%3A%2F%2Fgithub.com%2Fpetkaantonov%2Fbluebird%2Fwiki%2FOptimization-killers%233-managing-arguments%0A%20%20%20%20var%20points%20%3D%20points_%3B%0A%0A%20%20%20%20%2F%2Fif%20points%20isn't%20an%20array%2C%20use%20arguments%20as%20the%20array%0A%20%20%20%20if%20(!Array.isArray(points))%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20prevents%20an%20argument%20leak%20deopt%0A%20%20%20%20%20%20%20%20%2F%2F%20see%20section%203.2%3A%20https%3A%2F%2Fgithub.com%2Fpetkaantonov%2Fbluebird%2Fwiki%2FOptimization-killers%233-managing-arguments%0A%20%20%20%20%20%20%20%20points%20%3D%20new%20Array(arguments.length)%3B%0A%0A%20%20%20%20%20%20%20%20for%20(var%20a%20%3D%200%3B%20a%20%3C%20points.length%3B%20%2B%2Ba)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%5Ba%5D%20%3D%20arguments%5Ba%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20if%20this%20is%20an%20array%20of%20points%2C%20convert%20it%20to%20a%20flat%20array%20of%20numbers%0A%20%20%20%20if%20(points%5B0%5D%20instanceof%20Point)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20p%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%200%2C%20il%20%3D%20points.length%3B%20i%20%3C%20il%3B%20i%2B%2B)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20p.push(points%5Bi%5D.x%2C%20points%5Bi%5D.y)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20points%20%3D%20p%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.closed%20%3D%20true%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20An%20array%20of%20the%20points%20of%20this%20polygon%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%5B%5D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.points%20%3D%20points%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20type%20of%20the%20object%2C%20mainly%20used%20to%20avoid%20%60instanceof%60%20checks%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.type%20%3D%20CONST.SHAPES.POLY%3B%0A%7D%0A%0APolygon.prototype.constructor%20%3D%20Polygon%3B%0Amodule.exports%20%3D%20Polygon%3B%0A%0A%2F**%0A%20*%20Creates%20a%20clone%20of%20this%20polygon%0A%20*%0A%20*%20%40return%20%7BPIXI.Polygon%7D%20a%20copy%20of%20the%20polygon%0A%20*%2F%0APolygon.prototype.clone%20%3D%20function%20()%0A%7B%0A%20%20%20%20return%20new%20Polygon(this.points.slice())%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Checks%20whether%20the%20x%20and%20y%20coordinates%20passed%20to%20this%20function%20are%20contained%20within%20this%20polygon%0A%20*%0A%20*%20%40param%20x%20%7Bnumber%7D%20The%20X%20coordinate%20of%20the%20point%20to%20test%0A%20*%20%40param%20y%20%7Bnumber%7D%20The%20Y%20coordinate%20of%20the%20point%20to%20test%0A%20*%20%40return%20%7Bboolean%7D%20Whether%20the%20x%2Fy%20coordinates%20are%20within%20this%20polygon%0A%20*%2F%0APolygon.prototype.contains%20%3D%20function%20(x%2C%20y)%0A%7B%0A%20%20%20%20var%20inside%20%3D%20false%3B%0A%0A%20%20%20%20%2F%2F%20use%20some%20raycasting%20to%20test%20hits%0A%20%20%20%20%2F%2F%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fpoint-in-polygon%2Fblob%2Fmaster%2Findex.js%0A%20%20%20%20var%20length%20%3D%20this.points.length%20%2F%202%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%2C%20j%20%3D%20length%20-%201%3B%20i%20%3C%20length%3B%20j%20%3D%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20xi%20%3D%20this.points%5Bi%20*%202%5D%2C%20yi%20%3D%20this.points%5Bi%20*%202%20%2B%201%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20xj%20%3D%20this.points%5Bj%20*%202%5D%2C%20yj%20%3D%20this.points%5Bj%20*%202%20%2B%201%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20intersect%20%3D%20((yi%20%3E%20y)%20!%3D%3D%20(yj%20%3E%20y))%20%26%26%20(x%20%3C%20(xj%20-%20xi)%20*%20(y%20-%20yi)%20%2F%20(yj%20-%20yi)%20%2B%20xi)%3B%0A%0A%20%20%20%20%20%20%20%20if%20(intersect)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20inside%20%3D%20!inside%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20inside%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2F..%2Fconst%22%3A13%2C%22..%2FPoint%22%3A22%7D%5D%2C27%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20CONST%20%3D%20require('..%2F..%2Fconst')%3B%0A%0A%2F**%0A%20*%20the%20Rectangle%20object%20is%20an%20area%20defined%20by%20its%20position%2C%20as%20indicated%20by%20its%20top-left%20corner%20point%20(x%2C%20y)%20and%20by%20its%20width%20and%20its%20height.%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20x%20%7Bnumber%7D%20The%20X%20coordinate%20of%20the%20upper-left%20corner%20of%20the%20rectangle%0A%20*%20%40param%20y%20%7Bnumber%7D%20The%20Y%20coordinate%20of%20the%20upper-left%20corner%20of%20the%20rectangle%0A%20*%20%40param%20width%20%7Bnumber%7D%20The%20overall%20width%20of%20this%20rectangle%0A%20*%20%40param%20height%20%7Bnumber%7D%20The%20overall%20height%20of%20this%20rectangle%0A%20*%2F%0Afunction%20Rectangle(x%2C%20y%2C%20width%2C%20height)%0A%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.x%20%3D%20x%20%7C%7C%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.y%20%3D%20y%20%7C%7C%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.width%20%3D%20width%20%7C%7C%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.height%20%3D%20height%20%7C%7C%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20type%20of%20the%20object%2C%20mainly%20used%20to%20avoid%20%60instanceof%60%20checks%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.type%20%3D%20CONST.SHAPES.RECT%3B%0A%7D%0A%0ARectangle.prototype.constructor%20%3D%20Rectangle%3B%0Amodule.exports%20%3D%20Rectangle%3B%0A%0A%2F**%0A%20*%20A%20constant%20empty%20rectangle.%0A%20*%0A%20*%20%40static%0A%20*%20%40constant%0A%20*%2F%0ARectangle.EMPTY%20%3D%20new%20Rectangle(0%2C%200%2C%200%2C%200)%3B%0A%0A%0A%2F**%0A%20*%20Creates%20a%20clone%20of%20this%20Rectangle%0A%20*%0A%20*%20%40return%20%7BPIXI.Rectangle%7D%20a%20copy%20of%20the%20rectangle%0A%20*%2F%0ARectangle.prototype.clone%20%3D%20function%20()%0A%7B%0A%20%20%20%20return%20new%20Rectangle(this.x%2C%20this.y%2C%20this.width%2C%20this.height)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Checks%20whether%20the%20x%20and%20y%20coordinates%20given%20are%20contained%20within%20this%20Rectangle%0A%20*%0A%20*%20%40param%20x%20%7Bnumber%7D%20The%20X%20coordinate%20of%20the%20point%20to%20test%0A%20*%20%40param%20y%20%7Bnumber%7D%20The%20Y%20coordinate%20of%20the%20point%20to%20test%0A%20*%20%40return%20%7Bboolean%7D%20Whether%20the%20x%2Fy%20coordinates%20are%20within%20this%20Rectangle%0A%20*%2F%0ARectangle.prototype.contains%20%3D%20function%20(x%2C%20y)%0A%7B%0A%20%20%20%20if%20(this.width%20%3C%3D%200%20%7C%7C%20this.height%20%3C%3D%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(x%20%3E%3D%20this.x%20%26%26%20x%20%3C%20this.x%20%2B%20this.width)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(y%20%3E%3D%20this.y%20%26%26%20y%20%3C%20this.y%20%2B%20this.height)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20false%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2F..%2Fconst%22%3A13%7D%5D%2C28%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20CONST%20%3D%20require('..%2F..%2Fconst')%3B%0A%0A%2F**%0A%20*%20The%20Rounded%20Rectangle%20object%20is%20an%20area%20that%20has%20nice%20rounded%20corners%2C%20as%20indicated%20by%20its%20top-left%20corner%20point%20(x%2C%20y)%20and%20by%20its%20width%20and%20its%20height%20and%20its%20radius.%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20x%20%7Bnumber%7D%20The%20X%20coordinate%20of%20the%20upper-left%20corner%20of%20the%20rounded%20rectangle%0A%20*%20%40param%20y%20%7Bnumber%7D%20The%20Y%20coordinate%20of%20the%20upper-left%20corner%20of%20the%20rounded%20rectangle%0A%20*%20%40param%20width%20%7Bnumber%7D%20The%20overall%20width%20of%20this%20rounded%20rectangle%0A%20*%20%40param%20height%20%7Bnumber%7D%20The%20overall%20height%20of%20this%20rounded%20rectangle%0A%20*%20%40param%20radius%20%7Bnumber%7D%20Controls%20the%20radius%20of%20the%20rounded%20corners%0A%20*%2F%0Afunction%20RoundedRectangle(x%2C%20y%2C%20width%2C%20height%2C%20radius)%0A%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.x%20%3D%20x%20%7C%7C%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.y%20%3D%20y%20%7C%7C%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.width%20%3D%20width%20%7C%7C%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.height%20%3D%20height%20%7C%7C%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%2020%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.radius%20%3D%20radius%20%7C%7C%2020%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20type%20of%20the%20object%2C%20mainly%20used%20to%20avoid%20%60instanceof%60%20checks%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.type%20%3D%20CONST.SHAPES.RREC%3B%0A%7D%0A%0ARoundedRectangle.prototype.constructor%20%3D%20RoundedRectangle%3B%0Amodule.exports%20%3D%20RoundedRectangle%3B%0A%0A%2F**%0A%20*%20Creates%20a%20clone%20of%20this%20Rounded%20Rectangle%0A%20*%0A%20*%20%40return%20%7BPIXI.RoundedRectangle%7D%20a%20copy%20of%20the%20rounded%20rectangle%0A%20*%2F%0ARoundedRectangle.prototype.clone%20%3D%20function%20()%0A%7B%0A%20%20%20%20return%20new%20RoundedRectangle(this.x%2C%20this.y%2C%20this.width%2C%20this.height%2C%20this.radius)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Checks%20whether%20the%20x%20and%20y%20coordinates%20given%20are%20contained%20within%20this%20Rounded%20Rectangle%0A%20*%0A%20*%20%40param%20x%20%7Bnumber%7D%20The%20X%20coordinate%20of%20the%20point%20to%20test%0A%20*%20%40param%20y%20%7Bnumber%7D%20The%20Y%20coordinate%20of%20the%20point%20to%20test%0A%20*%20%40return%20%7Bboolean%7D%20Whether%20the%20x%2Fy%20coordinates%20are%20within%20this%20Rounded%20Rectangle%0A%20*%2F%0ARoundedRectangle.prototype.contains%20%3D%20function%20(x%2C%20y)%0A%7B%0A%20%20%20%20if%20(this.width%20%3C%3D%200%20%7C%7C%20this.height%20%3C%3D%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(x%20%3E%3D%20this.x%20%26%26%20x%20%3C%3D%20this.x%20%2B%20this.width)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(y%20%3E%3D%20this.y%20%26%26%20y%20%3C%3D%20this.y%20%2B%20this.height)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20false%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2F..%2Fconst%22%3A13%7D%5D%2C29%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20Container%20%3D%20require('..%2Fdisplay%2FContainer')%2C%0A%20%20%20%20CONST%20%3D%20require('..%2Fconst')%3B%0A%0A%2F**%0A%20*%20The%20ParticleContainer%20class%20is%20a%20really%20fast%20version%20of%20the%20Container%20built%20solely%20for%20speed%2C%0A%20*%20so%20use%20when%20you%20need%20a%20lot%20of%20sprites%20or%20particles.%20The%20tradeoff%20of%20the%20ParticleContainer%20is%20that%20advanced%0A%20*%20functionality%20will%20not%20work.%20ParticleContainer%20implements%20only%20the%20basic%20object%20transform%20(position%2C%20scale%2C%20rotation).%0A%20*%20Any%20other%20functionality%20like%20tinting%2C%20masking%2C%20etc%20will%20not%20work%20on%20sprites%20in%20this%20batch.%0A%20*%0A%20*%20It's%20extremely%20easy%20to%20use%20%3A%0A%20*%0A%20*%20%60%60%60js%0A%20*%20var%20container%20%3D%20new%20ParticleContainer()%3B%0A%20*%0A%20*%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20100%3B%20%2B%2Bi)%0A%20*%20%7B%0A%20*%20%20%20%20%20var%20sprite%20%3D%20new%20PIXI.Sprite.fromImage(%22myImage.png%22)%3B%0A%20*%20%20%20%20%20container.addChild(sprite)%3B%0A%20*%20%7D%0A%20*%20%60%60%60%0A%20*%0A%20*%20And%20here%20you%20have%20a%20hundred%20sprites%20that%20will%20be%20renderer%20at%20the%20speed%20of%20light.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.Container%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20%5BmaxSize%3D15000%5D%20%7Bnumber%7D%20The%20maximum%20number%20of%20particles%20that%20can%20be%20renderer%20by%20the%20container.%0A%20*%20%40param%20%5Bproperties%5D%20%7Bobject%7D%20The%20properties%20of%20children%20that%20should%20be%20uploaded%20to%20the%20gpu%20and%20applied.%0A%20*%20%40param%20%5Bproperties.scale%3Dfalse%5D%20%7Bboolean%7D%20When%20true%2C%20scale%20be%20uploaded%20and%20applied.%0A%20*%20%40param%20%5Bproperties.position%3Dtrue%5D%20%7Bboolean%7D%20When%20true%2C%20position%20be%20uploaded%20and%20applied.%0A%20*%20%40param%20%5Bproperties.rotation%3Dfalse%5D%20%7Bboolean%7D%20When%20true%2C%20rotation%20be%20uploaded%20and%20applied.%0A%20*%20%40param%20%5Bproperties.uvs%3Dfalse%5D%20%7Bboolean%7D%20When%20true%2C%20uvs%20be%20uploaded%20and%20applied.%0A%20*%20%40param%20%5Bproperties.alpha%3Dfalse%5D%20%7Bboolean%7D%20When%20true%2C%20alpha%20be%20uploaded%20and%20applied.%0A%20*%20%40param%20%5BbatchSize%3D15000%5D%20%7Bnumber%7D%20Number%20of%20particles%20per%20batch.%0A%20*%2F%0Afunction%20ParticleContainer(maxSize%2C%20properties%2C%20batchSize)%0A%7B%0A%20%20%20%20Container.call(this)%3B%0A%0A%20%20%20%20batchSize%20%3D%20batchSize%20%7C%7C%2015000%3B%20%2F%2FCONST.SPRITE_BATCH_SIZE%3B%20%2F%2F%202000%20is%20a%20nice%20balance%20between%20mobile%20%2F%20desktop%0A%20%20%20%20maxSize%20%3D%20maxSize%20%7C%7C%2015000%3B%0A%0A%20%20%20%20%2F%2F%20Making%20sure%20the%20batch%20size%20is%20valid%0A%20%20%20%20%2F%2F%2065535%20is%20max%20vertex%20index%20in%20the%20index%20buffer%20(see%20ParticleRenderer)%0A%20%20%20%20%2F%2F%20so%20max%20number%20of%20particles%20is%2065536%20%2F%204%20%3D%2016384%0A%20%20%20%20var%20maxBatchSize%20%3D%2016384%3B%0A%20%20%20%20if%20(batchSize%20%3E%20maxBatchSize)%20%7B%0A%20%20%20%20%20%20%20%20batchSize%20%3D%20maxBatchSize%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(batchSize%20%3E%20maxSize)%20%7B%0A%20%20%20%20%20%20%20%20batchSize%20%3D%20maxSize%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Set%20properties%20to%20be%20dynamic%20(true)%20%2F%20static%20(false)%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%5B%5D%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._properties%20%3D%20%5Bfalse%2C%20true%2C%20false%2C%20false%2C%20false%5D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._maxSize%20%3D%20maxSize%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._batchSize%20%3D%20batchSize%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7BWebGLBuffer%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._buffers%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._bufferToUpdate%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.interactiveChildren%20%3D%20false%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20blend%20mode%20to%20be%20applied%20to%20the%20sprite.%20Apply%20a%20value%20of%20%60PIXI.BLEND_MODES.NORMAL%60%20to%20reset%20the%20blend%20mode.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%20PIXI.BLEND_MODES.NORMAL%0A%20%20%20%20%20*%20%40see%20PIXI.BLEND_MODES%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.blendMode%20%3D%20CONST.BLEND_MODES.NORMAL%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Used%20for%20canvas%20renderering.%20If%20true%20then%20the%20elements%20will%20be%20positioned%20at%20the%20nearest%20pixel.%20This%20provides%20a%20nice%20speed%20boost.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40default%20true%3B%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.roundPixels%20%3D%20true%3B%0A%0A%20%20%20%20this.setProperties(properties)%3B%0A%7D%0A%0AParticleContainer.prototype%20%3D%20Object.create(Container.prototype)%3B%0AParticleContainer.prototype.constructor%20%3D%20ParticleContainer%3B%0Amodule.exports%20%3D%20ParticleContainer%3B%0A%0A%2F**%0A%20*%20Sets%20the%20private%20properties%20array%20to%20dynamic%20%2F%20static%20based%20on%20the%20passed%20properties%20object%0A%20*%0A%20*%20%40param%20properties%20%7Bobject%7D%20The%20properties%20to%20be%20uploaded%0A%20*%2F%0AParticleContainer.prototype.setProperties%20%3D%20function(properties)%0A%7B%0A%20%20%20%20if%20(%20properties%20)%20%7B%0A%20%20%20%20%20%20%20%20this._properties%5B0%5D%20%3D%20'scale'%20in%20properties%20%3F%20!!properties.scale%20%3A%20this._properties%5B0%5D%3B%0A%20%20%20%20%20%20%20%20this._properties%5B1%5D%20%3D%20'position'%20in%20properties%20%3F%20!!properties.position%20%3A%20this._properties%5B1%5D%3B%0A%20%20%20%20%20%20%20%20this._properties%5B2%5D%20%3D%20'rotation'%20in%20properties%20%3F%20!!properties.rotation%20%3A%20this._properties%5B2%5D%3B%0A%20%20%20%20%20%20%20%20this._properties%5B3%5D%20%3D%20'uvs'%20in%20properties%20%3F%20!!properties.uvs%20%3A%20this._properties%5B3%5D%3B%0A%20%20%20%20%20%20%20%20this._properties%5B4%5D%20%3D%20'alpha'%20in%20properties%20%3F%20!!properties.alpha%20%3A%20this._properties%5B4%5D%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Updates%20the%20object%20transform%20for%20rendering%0A%20*%0A%20*%20%40private%0A%20*%2F%0AParticleContainer.prototype.updateTransform%20%3D%20function%20()%0A%7B%0A%0A%20%20%20%20%2F%2F%20TODO%20don't%20need%20to!%0A%20%20%20%20this.displayObjectUpdateTransform()%3B%0A%20%20%20%20%2F%2F%20%20PIXI.Container.prototype.updateTransform.call(%20this%20)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Renders%20the%20container%20using%20the%20WebGL%20renderer%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20The%20webgl%20renderer%0A%20*%20%40private%0A%20*%2F%0AParticleContainer.prototype.renderWebGL%20%3D%20function%20(renderer)%0A%7B%0A%20%20%20%20if%20(!this.visible%20%7C%7C%20this.worldAlpha%20%3C%3D%200%20%7C%7C%20!this.children.length%20%7C%7C%20!this.renderable)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20renderer.setObjectRenderer(%20renderer.plugins.particle%20)%3B%0A%20%20%20%20renderer.plugins.particle.render(%20this%20)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Set%20the%20flag%20that%20static%20data%20should%20be%20updated%20to%20true%0A%20*%0A%20*%20%40private%0A%20*%2F%0AParticleContainer.prototype.onChildrenChange%20%3D%20function%20(smallestChildIndex)%0A%7B%0A%20%20%20%20var%20bufferIndex%20%3D%20Math.floor(smallestChildIndex%20%2F%20this._batchSize)%3B%0A%20%20%20%20if%20(bufferIndex%20%3C%20this._bufferToUpdate)%20%7B%0A%20%20%20%20%20%20%20%20this._bufferToUpdate%20%3D%20bufferIndex%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Renders%20the%20object%20using%20the%20Canvas%20renderer%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.CanvasRenderer%7D%20The%20canvas%20renderer%0A%20*%20%40private%0A%20*%2F%0AParticleContainer.prototype.renderCanvas%20%3D%20function%20(renderer)%0A%7B%0A%20%20%20%20if%20(!this.visible%20%7C%7C%20this.worldAlpha%20%3C%3D%200%20%7C%7C%20!this.children.length%20%7C%7C%20!this.renderable)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20context%20%3D%20renderer.context%3B%0A%20%20%20%20var%20transform%20%3D%20this.worldTransform%3B%0A%20%20%20%20var%20isRotated%20%3D%20true%3B%0A%0A%20%20%20%20var%20positionX%20%3D%200%3B%0A%20%20%20%20var%20positionY%20%3D%200%3B%0A%0A%20%20%20%20var%20finalWidth%20%3D%200%3B%0A%20%20%20%20var%20finalHeight%20%3D%200%3B%0A%0A%20%20%20%20context.globalAlpha%20%3D%20this.worldAlpha%3B%0A%0A%20%20%20%20this.displayObjectUpdateTransform()%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20this.children.length%3B%20%2B%2Bi)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20child%20%3D%20this.children%5Bi%5D%3B%0A%0A%20%20%20%20%20%20%20%20if%20(!child.visible)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20var%20frame%20%3D%20child.texture.frame%3B%0A%0A%20%20%20%20%20%20%20%20context.globalAlpha%20%3D%20this.worldAlpha%20*%20child.alpha%3B%0A%0A%20%20%20%20%20%20%20%20if%20(child.rotation%20%25%20(Math.PI%20*%202)%20%3D%3D%3D%200)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20this%20is%20the%20fastest%20%20way%20to%20optimise!%20-%20if%20rotation%20is%200%20then%20we%20can%20avoid%20any%20kind%20of%20setTransform%20call%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(isRotated)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.setTransform(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20transform.a%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20transform.b%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20transform.c%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20transform.d%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20transform.tx%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20transform.ty%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20isRotated%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20positionX%20%3D%20((child.anchor.x)%20*%20(-frame.width%20*%20child.scale.x)%20%2B%20child.position.x%20%20%2B%200.5)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20positionY%20%3D%20((child.anchor.y)%20*%20(-frame.height%20*%20child.scale.y)%20%2B%20child.position.y%20%20%2B%200.5)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20finalWidth%20%3D%20frame.width%20*%20child.scale.x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20finalHeight%20%3D%20frame.height%20*%20child.scale.y%3B%0A%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!isRotated)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20isRotated%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20child.displayObjectUpdateTransform()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20childTransform%20%3D%20child.worldTransform%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(renderer.roundPixels)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.setTransform(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20childTransform.a%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20childTransform.b%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20childTransform.c%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20childTransform.d%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20childTransform.tx%20%7C%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20childTransform.ty%20%7C%200%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.setTransform(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20childTransform.a%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20childTransform.b%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20childTransform.c%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20childTransform.d%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20childTransform.tx%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20childTransform.ty%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20positionX%20%3D%20((child.anchor.x)%20*%20(-frame.width)%20%2B%200.5)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20positionY%20%3D%20((child.anchor.y)%20*%20(-frame.height)%20%2B%200.5)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20finalWidth%20%3D%20frame.width%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20finalHeight%20%3D%20frame.height%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20context.drawImage(%0A%20%20%20%20%20%20%20%20%20%20%20%20child.texture.baseTexture.source%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20frame.x%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20frame.y%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20frame.width%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20frame.height%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20positionX%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20positionY%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20finalWidth%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20finalHeight%0A%20%20%20%20%20%20%20%20)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20the%20container%0A%20*%0A%20*%20%40param%20%5BdestroyChildren%3Dfalse%5D%20%7Bboolean%7D%20if%20set%20to%20true%2C%20all%20the%20children%20will%20have%20their%20destroy%20method%20called%20as%20well%0A%20*%2F%0AParticleContainer.prototype.destroy%20%3D%20function%20()%20%7B%0A%20%20%20%20Container.prototype.destroy.apply(this%2C%20arguments)%3B%0A%0A%20%20%20%20if%20(this._buffers)%20%7B%0A%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20this._buffers.length%3B%20%2B%2Bi)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._buffers%5Bi%5D.destroy()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20this._properties%20%3D%20null%3B%0A%20%20%20%20this._buffers%20%3D%20null%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fconst%22%3A13%2C%22..%2Fdisplay%2FContainer%22%3A14%7D%5D%2C30%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%0A%2F**%0A%20*%20%40author%20Mat%20Groves%0A%20*%0A%20*%20Big%20thanks%20to%20the%20very%20clever%20Matt%20DesLauriers%20%3Cmattdesl%3E%20https%3A%2F%2Fgithub.com%2Fmattdesl%2F%0A%20*%20for%20creating%20the%20original%20pixi%20version!%0A%20*%20Also%20a%20thanks%20to%20https%3A%2F%2Fgithub.com%2Fbchevalier%20for%20tweaking%20the%20tint%20and%20alpha%20so%20that%20they%20now%20share%204%20bytes%20on%20the%20vertex%20buffer%0A%20*%0A%20*%20Heavily%20inspired%20by%20LibGDX's%20ParticleBuffer%3A%0A%20*%20https%3A%2F%2Fgithub.com%2Flibgdx%2Flibgdx%2Fblob%2Fmaster%2Fgdx%2Fsrc%2Fcom%2Fbadlogic%2Fgdx%2Fgraphics%2Fg2d%2FParticleBuffer.java%0A%20*%2F%0A%0A%2F**%0A%20*%20The%20particle%20buffer%20manages%20the%20static%20and%20dynamic%20buffers%20for%20a%20particle%20container.%0A%20*%0A%20*%20%40class%0A%20*%20%40private%0A%20*%20%40memberof%20PIXI%0A%20*%2F%0Afunction%20ParticleBuffer(gl%2C%20properties%2C%20dynamicPropertyFlags%2C%20size)%0A%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20current%20WebGL%20drawing%20context.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BWebGLRenderingContext%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.gl%20%3D%20gl%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Size%20of%20a%20single%20vertex.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.vertSize%20%3D%202%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Size%20of%20a%20single%20vertex%20in%20bytes.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.vertByteSize%20%3D%20this.vertSize%20*%204%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20number%20of%20particles%20the%20buffer%20can%20hold%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.size%20%3D%20size%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20A%20list%20of%20the%20properties%20that%20are%20dynamic.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bobject%5B%5D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.dynamicProperties%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20A%20list%20of%20the%20properties%20that%20are%20static.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bobject%5B%5D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.staticProperties%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20properties.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20property%20%3D%20properties%5Bi%5D%3B%0A%0A%20%20%20%20%20%20%20%20if(dynamicPropertyFlags%5Bi%5D)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.dynamicProperties.push(property)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.staticProperties.push(property)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.staticStride%20%3D%200%3B%0A%20%20%20%20this.staticBuffer%20%3D%20null%3B%0A%20%20%20%20this.staticData%20%3D%20null%3B%0A%0A%20%20%20%20this.dynamicStride%20%3D%200%3B%0A%20%20%20%20this.dynamicBuffer%20%3D%20null%3B%0A%20%20%20%20this.dynamicData%20%3D%20null%3B%0A%0A%20%20%20%20this.initBuffers()%3B%0A%0A%7D%0A%0AParticleBuffer.prototype.constructor%20%3D%20ParticleBuffer%3B%0Amodule.exports%20%3D%20ParticleBuffer%3B%0A%0A%2F**%0A%20*%20Sets%20up%20the%20renderer%20context%20and%20necessary%20buffers.%0A%20*%0A%20*%20%40private%0A%20*%2F%0AParticleBuffer.prototype.initBuffers%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.gl%3B%0A%20%20%20%20var%20i%3B%0A%20%20%20%20var%20property%3B%0A%0A%20%20%20%20var%20dynamicOffset%20%3D%200%3B%0A%20%20%20%20this.dynamicStride%20%3D%200%3B%0A%0A%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20this.dynamicProperties.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20property%20%3D%20this.dynamicProperties%5Bi%5D%3B%0A%0A%20%20%20%20%20%20%20%20property.offset%20%3D%20dynamicOffset%3B%0A%20%20%20%20%20%20%20%20dynamicOffset%20%2B%3D%20property.size%3B%0A%20%20%20%20%20%20%20%20this.dynamicStride%20%2B%3D%20property.size%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.dynamicData%20%3D%20new%20Float32Array(%20this.size%20*%20this.dynamicStride%20*%204)%3B%0A%20%20%20%20this.dynamicBuffer%20%3D%20gl.createBuffer()%3B%0A%0A%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20this.dynamicBuffer)%3B%0A%20%20%20%20gl.bufferData(gl.ARRAY_BUFFER%2C%20this.dynamicData%2C%20gl.DYNAMIC_DRAW)%3B%0A%0A%0A%20%20%20%20%2F%2F%20static%20%2F%2F%0A%20%20%20%20var%20staticOffset%20%3D%200%3B%0A%20%20%20%20this.staticStride%20%3D%200%3B%0A%0A%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20this.staticProperties.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20property%20%3D%20this.staticProperties%5Bi%5D%3B%0A%0A%20%20%20%20%20%20%20%20property.offset%20%3D%20staticOffset%3B%0A%20%20%20%20%20%20%20%20staticOffset%20%2B%3D%20property.size%3B%0A%20%20%20%20%20%20%20%20this.staticStride%20%2B%3D%20property.size%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.staticData%20%3D%20new%20Float32Array(%20this.size%20*%20this.staticStride%20*%204)%3B%0A%20%20%20%20this.staticBuffer%20%3D%20gl.createBuffer()%3B%0A%0A%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20this.staticBuffer)%3B%0A%20%20%20%20gl.bufferData(gl.ARRAY_BUFFER%2C%20this.staticData%2C%20gl.DYNAMIC_DRAW)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Uploads%20the%20dynamic%20properties.%0A%20*%0A%20*%2F%0AParticleBuffer.prototype.uploadDynamic%20%3D%20function(children%2C%20startIndex%2C%20amount)%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.gl%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20this.dynamicProperties.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20property%20%3D%20this.dynamicProperties%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20property.uploadFunction(children%2C%20startIndex%2C%20amount%2C%20this.dynamicData%2C%20this.dynamicStride%2C%20property.offset)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20this.dynamicBuffer)%3B%0A%20%20%20%20gl.bufferSubData(gl.ARRAY_BUFFER%2C%200%2C%20this.dynamicData)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Uploads%20the%20static%20properties.%0A%20*%0A%20*%2F%0AParticleBuffer.prototype.uploadStatic%20%3D%20function(children%2C%20startIndex%2C%20amount)%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.gl%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20this.staticProperties.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20property%20%3D%20this.staticProperties%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20property.uploadFunction(children%2C%20startIndex%2C%20amount%2C%20this.staticData%2C%20this.staticStride%2C%20property.offset)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20this.staticBuffer)%3B%0A%20%20%20%20gl.bufferSubData(gl.ARRAY_BUFFER%2C%200%2C%20this.staticData)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Binds%20the%20buffers%20to%20the%20GPU%0A%20*%0A%20*%2F%0AParticleBuffer.prototype.bind%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.gl%3B%0A%20%20%20%20var%20i%2C%20property%3B%0A%0A%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20this.dynamicBuffer)%3B%0A%0A%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20this.dynamicProperties.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20property%20%3D%20this.dynamicProperties%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20gl.vertexAttribPointer(property.attribute%2C%20property.size%2C%20gl.FLOAT%2C%20false%2C%20this.dynamicStride%20*%204%2C%20property.offset%20*%204)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20this.staticBuffer)%3B%0A%0A%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20this.staticProperties.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20property%20%3D%20this.staticProperties%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20gl.vertexAttribPointer(property.attribute%2C%20property.size%2C%20gl.FLOAT%2C%20false%2C%20this.staticStride%20*%204%2C%20property.offset%20*%204)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20the%20ParticleBuffer.%0A%20*%0A%20*%2F%0AParticleBuffer.prototype.destroy%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.dynamicProperties%20%3D%20null%3B%0A%20%20%20%20this.dynamicData%20%3D%20null%3B%0A%20%20%20%20this.gl.deleteBuffer(this.dynamicBuffer)%3B%0A%0A%20%20%20%20this.staticProperties%20%3D%20null%3B%0A%20%20%20%20this.staticData%20%3D%20null%3B%0A%20%20%20%20this.gl.deleteBuffer(this.staticBuffer)%3B%0A%7D%3B%0A%0A%7D%2C%7B%7D%5D%2C31%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20ObjectRenderer%20%3D%20require('..%2F..%2Frenderers%2Fwebgl%2Futils%2FObjectRenderer')%2C%0A%20%20%20%20WebGLRenderer%20%3D%20require('..%2F..%2Frenderers%2Fwebgl%2FWebGLRenderer')%2C%0A%20%20%20%20ParticleShader%20%3D%20require('.%2FParticleShader')%2C%0A%20%20%20%20ParticleBuffer%20%3D%20require('.%2FParticleBuffer')%2C%0A%20%20%20%20math%20%20%20%20%20%20%20%20%20%20%20%20%3D%20require('..%2F..%2Fmath')%3B%0A%0A%2F**%0A%20*%20%40author%20Mat%20Groves%0A%20*%0A%20*%20Big%20thanks%20to%20the%20very%20clever%20Matt%20DesLauriers%20%3Cmattdesl%3E%20https%3A%2F%2Fgithub.com%2Fmattdesl%2F%0A%20*%20for%20creating%20the%20original%20pixi%20version!%0A%20*%20Also%20a%20thanks%20to%20https%3A%2F%2Fgithub.com%2Fbchevalier%20for%20tweaking%20the%20tint%20and%20alpha%20so%20that%20they%20now%20share%204%20bytes%20on%20the%20vertex%20buffer%0A%20*%0A%20*%20Heavily%20inspired%20by%20LibGDX's%20ParticleRenderer%3A%0A%20*%20https%3A%2F%2Fgithub.com%2Flibgdx%2Flibgdx%2Fblob%2Fmaster%2Fgdx%2Fsrc%2Fcom%2Fbadlogic%2Fgdx%2Fgraphics%2Fg2d%2FParticleRenderer.java%0A%20*%2F%0A%0A%2F**%0A%20*%0A%20*%20%40class%0A%20*%20%40private%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20The%20renderer%20this%20sprite%20batch%20works%20for.%0A%20*%2F%0Afunction%20ParticleRenderer(renderer)%0A%7B%0A%20%20%20%20ObjectRenderer.call(this%2C%20renderer)%3B%0A%0A%20%20%20%20%2F%2F%2065535%20is%20max%20vertex%20index%20in%20the%20index%20buffer%20(see%20ParticleRenderer)%0A%20%20%20%20%2F%2F%20so%20max%20number%20of%20particles%20is%2065536%20%2F%204%20%3D%2016384%0A%20%20%20%20%2F%2F%20and%20max%20number%20of%20element%20in%20the%20index%20buffer%20is%2016384%20*%206%20%3D%2098304%0A%20%20%20%20%2F%2F%20Creating%20a%20full%20index%20buffer%2C%20overhead%20is%2098304%20*%202%20%3D%20196Ko%0A%20%20%20%20var%20numIndices%20%3D%2098304%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Holds%20the%20indices%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BUint16Array%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.indices%20%3D%20new%20Uint16Array(numIndices)%3B%0A%0A%20%20%20%20for%20(var%20i%3D0%2C%20j%3D0%3B%20i%20%3C%20numIndices%3B%20i%20%2B%3D%206%2C%20j%20%2B%3D%204)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.indices%5Bi%20%2B%200%5D%20%3D%20j%20%2B%200%3B%0A%20%20%20%20%20%20%20%20this.indices%5Bi%20%2B%201%5D%20%3D%20j%20%2B%201%3B%0A%20%20%20%20%20%20%20%20this.indices%5Bi%20%2B%202%5D%20%3D%20j%20%2B%202%3B%0A%20%20%20%20%20%20%20%20this.indices%5Bi%20%2B%203%5D%20%3D%20j%20%2B%200%3B%0A%20%20%20%20%20%20%20%20this.indices%5Bi%20%2B%204%5D%20%3D%20j%20%2B%202%3B%0A%20%20%20%20%20%20%20%20this.indices%5Bi%20%2B%205%5D%20%3D%20j%20%2B%203%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20default%20shader%20that%20is%20used%20if%20a%20sprite%20doesn't%20have%20a%20more%20specific%20one.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Shader%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.shader%20%3D%20null%3B%0A%0A%20%20%20%20this.indexBuffer%20%3D%20null%3B%0A%0A%20%20%20%20this.properties%20%3D%20null%3B%0A%0A%20%20%20%20this.tempMatrix%20%3D%20new%20math.Matrix()%3B%0A%7D%0A%0AParticleRenderer.prototype%20%3D%20Object.create(ObjectRenderer.prototype)%3B%0AParticleRenderer.prototype.constructor%20%3D%20ParticleRenderer%3B%0Amodule.exports%20%3D%20ParticleRenderer%3B%0A%0AWebGLRenderer.registerPlugin('particle'%2C%20ParticleRenderer)%3B%0A%0A%2F**%0A%20*%20When%20there%20is%20a%20WebGL%20context%20change%0A%20*%0A%20*%20%40private%0A%20*%2F%0AParticleRenderer.prototype.onContextChange%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%0A%20%20%20%20%2F%2F%20setup%20default%20shader%0A%20%20%20%20this.shader%20%3D%20new%20ParticleShader(this.renderer.shaderManager)%3B%0A%0A%20%20%20%20this.indexBuffer%20%3D%20gl.createBuffer()%3B%0A%0A%20%20%20%20%2F%2F%2065535%20is%20max%20index%2C%20so%2065535%20%2F%206%20%3D%2010922.%0A%0A%20%20%20%20%2F%2Fupload%20the%20index%20data%0A%20%20%20%20gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER%2C%20this.indexBuffer)%3B%0A%20%20%20%20gl.bufferData(gl.ELEMENT_ARRAY_BUFFER%2C%20this.indices%2C%20gl.STATIC_DRAW)%3B%0A%0A%20%20%20%20this.properties%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%2F%2F%20verticesData%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20attribute%3Athis.shader.attributes.aVertexPosition%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20size%3A2%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20uploadFunction%3Athis.uploadVertices%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20offset%3A0%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20positionData%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20attribute%3Athis.shader.attributes.aPositionCoord%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20size%3A2%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20uploadFunction%3Athis.uploadPosition%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20offset%3A0%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20rotationData%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20attribute%3Athis.shader.attributes.aRotation%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20size%3A1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20uploadFunction%3Athis.uploadRotation%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20offset%3A0%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20uvsData%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20attribute%3Athis.shader.attributes.aTextureCoord%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20size%3A2%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20uploadFunction%3Athis.uploadUvs%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20offset%3A0%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20alphaData%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20attribute%3Athis.shader.attributes.aColor%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20size%3A1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20uploadFunction%3Athis.uploadAlpha%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20offset%3A0%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%5D%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Starts%20a%20new%20particle%20batch.%0A%20*%0A%20*%2F%0AParticleRenderer.prototype.start%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%0A%20%20%20%20%2F%2F%20bind%20the%20main%20texture%0A%20%20%20%20gl.activeTexture(gl.TEXTURE0)%3B%0A%0A%20%20%20%20%2F%2F%20bind%20the%20buffers%0A%0A%20%20%20%20gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER%2C%20this.indexBuffer)%3B%0A%0A%20%20%20%20var%20shader%20%3D%20this.shader%3B%0A%0A%20%20%20%20this.renderer.shaderManager.setShader(shader)%3B%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Renders%20the%20particle%20container%20object.%0A%20*%0A%20*%20%40param%20container%20%7BPIXI.ParticleContainer%7D%20The%20container%20to%20render%20using%20this%20ParticleRenderer%0A%20*%2F%0AParticleRenderer.prototype.render%20%3D%20function%20(container)%0A%7B%0A%20%20%20%20var%20children%20%3D%20container.children%2C%0A%20%20%20%20%20%20%20%20totalChildren%20%3D%20children.length%2C%0A%20%20%20%20%20%20%20%20maxSize%20%3D%20container._maxSize%2C%0A%20%20%20%20%20%20%20%20batchSize%20%3D%20container._batchSize%3B%0A%0A%20%20%20%20if(totalChildren%20%3D%3D%3D%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%20if(totalChildren%20%3E%20maxSize)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20totalChildren%20%3D%20maxSize%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!container._buffers)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20container._buffers%20%3D%20this.generateBuffers(%20container%20)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20if%20the%20uvs%20have%20not%20updated%20then%20no%20point%20rendering%20just%20yet!%0A%20%20%20%20this.renderer.blendModeManager.setBlendMode(container.blendMode)%3B%0A%0A%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%0A%20%20%20%20var%20m%20%3D%20%20container.worldTransform.copy(%20this.tempMatrix%20)%3B%0A%20%20%20%20m.prepend(%20this.renderer.currentRenderTarget.projectionMatrix%20)%3B%0A%20%20%20%20gl.uniformMatrix3fv(this.shader.uniforms.projectionMatrix._location%2C%20false%2C%20m.toArray(true))%3B%0A%20%20%20%20gl.uniform1f(this.shader.uniforms.uAlpha._location%2C%20container.worldAlpha)%3B%0A%0A%0A%20%20%20%20%2F%2F%20make%20sure%20the%20texture%20is%20bound..%0A%20%20%20%20var%20baseTexture%20%3D%20children%5B0%5D._texture.baseTexture%3B%0A%0A%20%20%20%20if%20(!baseTexture._glTextures%5Bgl.id%5D)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20if%20the%20texture%20has%20not%20updated%20then%20lets%20not%20upload%20any%20static%20properties%0A%20%20%20%20%20%20%20%20if(!this.renderer.updateTexture(baseTexture))%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if(!container._properties%5B0%5D%20%7C%7C%20!container._properties%5B3%5D)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20container._bufferToUpdate%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20gl.bindTexture(gl.TEXTURE_2D%2C%20baseTexture._glTextures%5Bgl.id%5D)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20now%20lets%20upload%20and%20render%20the%20buffers..%0A%20%20%20%20for%20(var%20i%20%3D%200%2C%20j%20%3D%200%3B%20i%20%3C%20totalChildren%3B%20i%20%2B%3D%20batchSize%2C%20j%20%2B%3D%201)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20amount%20%3D%20(%20totalChildren%20-%20i)%3B%0A%20%20%20%20%20%20%20%20if(amount%20%3E%20batchSize)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20amount%20%3D%20batchSize%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20var%20buffer%20%3D%20container._buffers%5Bj%5D%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20we%20always%20upload%20the%20dynamic%0A%20%20%20%20%20%20%20%20buffer.uploadDynamic(children%2C%20i%2C%20amount)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20we%20only%20upload%20the%20static%20content%20when%20we%20have%20to!%0A%20%20%20%20%20%20%20%20if(container._bufferToUpdate%20%3D%3D%3D%20j)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20buffer.uploadStatic(children%2C%20i%2C%20amount)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20container._bufferToUpdate%20%3D%20j%20%2B%201%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20bind%20the%20buffer%0A%20%20%20%20%20%20%20%20buffer.bind(%20this.shader%20)%3B%0A%0A%20%20%20%20%20%20%20%20%20%2F%2F%20now%20draw%20those%20suckas!%0A%20%20%20%20%20%20%20%20gl.drawElements(gl.TRIANGLES%2C%20amount%20*%206%2C%20gl.UNSIGNED_SHORT%2C%200)%3B%0A%20%20%20%20%20%20%20%20this.renderer.drawCount%2B%2B%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Creates%20one%20particle%20buffer%20for%20each%20child%20in%20the%20container%20we%20want%20to%20render%20and%20updates%20internal%20properties%0A%20*%0A%20*%20%40param%20container%20%7BPIXI.ParticleContainer%7D%20The%20container%20to%20render%20using%20this%20ParticleRenderer%0A%20*%2F%0AParticleRenderer.prototype.generateBuffers%20%3D%20function%20(container)%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.renderer.gl%2C%0A%20%20%20%20%20%20%20%20buffers%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20size%20%3D%20container._maxSize%2C%0A%20%20%20%20%20%20%20%20batchSize%20%3D%20container._batchSize%2C%0A%20%20%20%20%20%20%20%20dynamicPropertyFlags%20%3D%20container._properties%2C%0A%20%20%20%20%20%20%20%20i%3B%0A%0A%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20size%3B%20i%20%2B%3D%20batchSize)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20buffers.push(new%20ParticleBuffer(gl%2C%20this.properties%2C%20dynamicPropertyFlags%2C%20batchSize))%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20buffers%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Uploads%20the%20verticies.%0A%20*%0A%20*%20%40param%20children%20%7BPIXI.DisplayObject%5B%5D%7D%20the%20array%20of%20display%20objects%20to%20render%0A%20*%20%40param%20startIndex%20%7Bnumber%7D%20the%20index%20to%20start%20from%20in%20the%20children%20array%0A%20*%20%40param%20amount%20%7Bnumber%7D%20the%20amount%20of%20children%20that%20will%20have%20their%20vertices%20uploaded%0A%20*%20%40param%20array%20%7Bnumber%5B%5D%7D%0A%20*%20%40param%20stride%20%7Bnumber%7D%0A%20*%20%40param%20offset%20%7Bnumber%7D%0A%20*%2F%0AParticleRenderer.prototype.uploadVertices%20%3D%20function%20(children%2C%20startIndex%2C%20amount%2C%20array%2C%20stride%2C%20offset)%0A%7B%0A%20%20%20%20var%20sprite%2C%0A%20%20%20%20%20%20%20%20texture%2C%0A%20%20%20%20%20%20%20%20trim%2C%0A%20%20%20%20%20%20%20%20sx%2C%0A%20%20%20%20%20%20%20%20sy%2C%0A%20%20%20%20%20%20%20%20w0%2C%20w1%2C%20h0%2C%20h1%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20amount%3B%20i%2B%2B)%20%7B%0A%0A%20%20%20%20%20%20%20%20sprite%20%3D%20children%5BstartIndex%20%2B%20i%5D%3B%0A%20%20%20%20%20%20%20%20texture%20%3D%20sprite._texture%3B%0A%20%20%20%20%20%20%20%20sx%20%3D%20sprite.scale.x%3B%0A%20%20%20%20%20%20%20%20sy%20%3D%20sprite.scale.y%3B%0A%0A%20%20%20%20%20%20%20%20if%20(texture.trim)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20if%20the%20sprite%20is%20trimmed%20then%20we%20need%20to%20add%20the%20extra%20space%20before%20transforming%20the%20sprite%20coords..%0A%20%20%20%20%20%20%20%20%20%20%20%20trim%20%3D%20texture.trim%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20w1%20%3D%20trim.x%20-%20sprite.anchor.x%20*%20trim.width%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20w0%20%3D%20w1%20%2B%20texture.crop.width%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20h1%20%3D%20trim.y%20-%20sprite.anchor.y%20*%20trim.height%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20h0%20%3D%20h1%20%2B%20texture.crop.height%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20w0%20%3D%20(texture._frame.width%20)%20*%20(1-sprite.anchor.x)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20w1%20%3D%20(texture._frame.width%20)%20*%20-sprite.anchor.x%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20h0%20%3D%20texture._frame.height%20*%20(1-sprite.anchor.y)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20h1%20%3D%20texture._frame.height%20*%20-sprite.anchor.y%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20array%5Boffset%5D%20%3D%20w1%20*%20sx%3B%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%20h1%20*%20sy%3B%0A%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%5D%20%3D%20w0%20*%20sx%3B%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20%2B%201%5D%20%3D%20h1%20*%20sy%3B%0A%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%202%5D%20%3D%20w0%20*%20sx%3B%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%202%20%2B%201%5D%20%3D%20h0%20*%20sy%3B%0A%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%203%5D%20%3D%20w1%20*%20sx%3B%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%203%20%2B%201%5D%20%3D%20h0%20*%20sy%3B%0A%0A%20%20%20%20%20%20%20%20offset%20%2B%3D%20stride%20*%204%3B%0A%20%20%20%20%7D%0A%0A%7D%3B%0A%0A%2F**%0A%20*%0A%20*%20%40param%20children%20%7BPIXI.DisplayObject%5B%5D%7D%20the%20array%20of%20display%20objects%20to%20render%0A%20*%20%40param%20startIndex%20%7Bnumber%7D%20the%20index%20to%20start%20from%20in%20the%20children%20array%0A%20*%20%40param%20amount%20%7Bnumber%7D%20the%20amount%20of%20children%20that%20will%20have%20their%20positions%20uploaded%0A%20*%20%40param%20array%20%7Bnumber%5B%5D%7D%0A%20*%20%40param%20stride%20%7Bnumber%7D%0A%20*%20%40param%20offset%20%7Bnumber%7D%0A%20*%2F%0AParticleRenderer.prototype.uploadPosition%20%3D%20function%20(children%2CstartIndex%2C%20amount%2C%20array%2C%20stride%2C%20offset)%0A%7B%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20amount%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20spritePosition%20%3D%20children%5BstartIndex%20%2B%20i%5D.position%3B%0A%0A%20%20%20%20%20%20%20%20array%5Boffset%5D%20%3D%20spritePosition.x%3B%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%20spritePosition.y%3B%0A%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%5D%20%3D%20spritePosition.x%3B%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20%2B%201%5D%20%3D%20spritePosition.y%3B%0A%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%202%5D%20%3D%20spritePosition.x%3B%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%202%20%2B%201%5D%20%3D%20spritePosition.y%3B%0A%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%203%5D%20%3D%20spritePosition.x%3B%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%203%20%2B%201%5D%20%3D%20spritePosition.y%3B%0A%0A%20%20%20%20%20%20%20%20offset%20%2B%3D%20stride%20*%204%3B%0A%20%20%20%20%7D%0A%0A%7D%3B%0A%0A%2F**%0A%20*%0A%20*%20%40param%20children%20%7BPIXI.DisplayObject%5B%5D%7D%20the%20array%20of%20display%20objects%20to%20render%0A%20*%20%40param%20startIndex%20%7Bnumber%7D%20the%20index%20to%20start%20from%20in%20the%20children%20array%0A%20*%20%40param%20amount%20%7Bnumber%7D%20the%20amount%20of%20children%20that%20will%20have%20their%20rotation%20uploaded%0A%20*%20%40param%20array%20%7Bnumber%5B%5D%7D%0A%20*%20%40param%20stride%20%7Bnumber%7D%0A%20*%20%40param%20offset%20%7Bnumber%7D%0A%20*%2F%0AParticleRenderer.prototype.uploadRotation%20%3D%20function%20(children%2CstartIndex%2C%20amount%2C%20array%2C%20stride%2C%20offset)%0A%7B%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20amount%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20spriteRotation%20%3D%20children%5BstartIndex%20%2B%20i%5D.rotation%3B%0A%0A%0A%20%20%20%20%20%20%20%20array%5Boffset%5D%20%3D%20spriteRotation%3B%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%5D%20%3D%20spriteRotation%3B%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%202%5D%20%3D%20spriteRotation%3B%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%203%5D%20%3D%20spriteRotation%3B%0A%0A%20%20%20%20%20%20%20%20offset%20%2B%3D%20stride%20*%204%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%0A%20*%20%40param%20children%20%7BPIXI.DisplayObject%5B%5D%7D%20the%20array%20of%20display%20objects%20to%20render%0A%20*%20%40param%20startIndex%20%7Bnumber%7D%20the%20index%20to%20start%20from%20in%20the%20children%20array%0A%20*%20%40param%20amount%20%7Bnumber%7D%20the%20amount%20of%20children%20that%20will%20have%20their%20Uvs%20uploaded%0A%20*%20%40param%20array%20%7Bnumber%5B%5D%7D%0A%20*%20%40param%20stride%20%7Bnumber%7D%0A%20*%20%40param%20offset%20%7Bnumber%7D%0A%20*%2F%0AParticleRenderer.prototype.uploadUvs%20%3D%20function%20(children%2CstartIndex%2C%20amount%2C%20array%2C%20stride%2C%20offset)%0A%7B%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20amount%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20textureUvs%20%3D%20children%5BstartIndex%20%2B%20i%5D._texture._uvs%3B%0A%0A%20%20%20%20%20%20%20%20if%20(textureUvs)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20array%5Boffset%5D%20%3D%20textureUvs.x0%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%20textureUvs.y0%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%5D%20%3D%20textureUvs.x1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20%2B%201%5D%20%3D%20textureUvs.y1%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%202%5D%20%3D%20textureUvs.x2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%202%20%2B%201%5D%20%3D%20textureUvs.y2%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%203%5D%20%3D%20textureUvs.x3%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%203%20%2B%201%5D%20%3D%20textureUvs.y3%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20offset%20%2B%3D%20stride%20*%204%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2FTODO%20you%20know%20this%20can%20be%20easier!%0A%20%20%20%20%20%20%20%20%20%20%20%20array%5Boffset%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%200%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20%2B%201%5D%20%3D%200%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%202%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%202%20%2B%201%5D%20%3D%200%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%203%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%203%20%2B%201%5D%20%3D%200%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20offset%20%2B%3D%20stride%20*%204%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%0A%20*%20%40param%20children%20%7BPIXI.DisplayObject%5B%5D%7D%20the%20array%20of%20display%20objects%20to%20render%0A%20*%20%40param%20startIndex%20%7Bnumber%7D%20the%20index%20to%20start%20from%20in%20the%20children%20array%0A%20*%20%40param%20amount%20%7Bnumber%7D%20the%20amount%20of%20children%20that%20will%20have%20their%20alpha%20uploaded%0A%20*%20%40param%20array%20%7Bnumber%5B%5D%7D%0A%20*%20%40param%20stride%20%7Bnumber%7D%0A%20*%20%40param%20offset%20%7Bnumber%7D%0A%20*%2F%0AParticleRenderer.prototype.uploadAlpha%20%3D%20function%20(children%2CstartIndex%2C%20amount%2C%20array%2C%20stride%2C%20offset)%0A%7B%0A%20%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20amount%3B%20i%2B%2B)%0A%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20spriteAlpha%20%3D%20children%5BstartIndex%20%2B%20i%5D.alpha%3B%0A%0A%20%20%20%20%20%20%20%20array%5Boffset%5D%20%3D%20spriteAlpha%3B%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%5D%20%3D%20spriteAlpha%3B%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%202%5D%20%3D%20spriteAlpha%3B%0A%20%20%20%20%20%20%20%20array%5Boffset%20%2B%20stride%20*%203%5D%20%3D%20spriteAlpha%3B%0A%0A%20%20%20%20%20%20%20%20offset%20%2B%3D%20stride%20*%204%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Destroys%20the%20ParticleRenderer.%0A%20*%0A%20*%2F%0AParticleRenderer.prototype.destroy%20%3D%20function%20()%0A%7B%0A%20%20%20%20if%20(this.renderer.gl)%20%7B%0A%20%20%20%20%20%20%20%20this.renderer.gl.deleteBuffer(this.indexBuffer)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20ObjectRenderer.prototype.destroy.apply(this%2C%20arguments)%3B%0A%0A%20%20%20%20this.shader.destroy()%3B%0A%0A%20%20%20%20this.indices%20%3D%20null%3B%0A%20%20%20%20this.tempMatrix%20%3D%20null%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2F..%2Fmath%22%3A23%2C%22..%2F..%2Frenderers%2Fwebgl%2FWebGLRenderer%22%3A39%2C%22..%2F..%2Frenderers%2Fwebgl%2Futils%2FObjectRenderer%22%3A53%2C%22.%2FParticleBuffer%22%3A30%2C%22.%2FParticleShader%22%3A32%7D%5D%2C32%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20TextureShader%20%3D%20require('..%2F..%2Frenderers%2Fwebgl%2Fshaders%2FTextureShader')%3B%0A%0A%2F**%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.TextureShader%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20shaderManager%20%7BShaderManager%7D%20The%20webgl%20shader%20manager%20this%20shader%20works%20for.%0A%20*%2F%0Afunction%20ParticleShader(shaderManager)%0A%7B%0A%20%20%20%20TextureShader.call(this%2C%0A%20%20%20%20%20%20%20%20shaderManager%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20'attribute%20vec2%20aVertexPosition%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'attribute%20vec2%20aTextureCoord%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'attribute%20float%20aColor%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'attribute%20vec2%20aPositionCoord%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'attribute%20vec2%20aScale%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'attribute%20float%20aRotation%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'uniform%20mat3%20projectionMatrix%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'varying%20vec2%20vTextureCoord%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'varying%20float%20vColor%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'void%20main(void)%7B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%20%20vec2%20v%20%3D%20aVertexPosition%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%20%20v.x%20%3D%20(aVertexPosition.x)%20*%20cos(aRotation)%20-%20(aVertexPosition.y)%20*%20sin(aRotation)%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%20%20v.y%20%3D%20(aVertexPosition.x)%20*%20sin(aRotation)%20%2B%20(aVertexPosition.y)%20*%20cos(aRotation)%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%20%20v%20%3D%20v%20%2B%20aPositionCoord%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%20%20gl_Position%20%3D%20vec4((projectionMatrix%20*%20vec3(v%2C%201.0)).xy%2C%200.0%2C%201.0)%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%20%20vTextureCoord%20%3D%20aTextureCoord%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%20%20vColor%20%3D%20aColor%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%7D'%0A%20%20%20%20%20%20%20%20%5D.join('%5Cn')%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20hello%0A%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20'precision%20lowp%20float%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'varying%20vec2%20vTextureCoord%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'varying%20float%20vColor%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'uniform%20sampler2D%20uSampler%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'uniform%20float%20uAlpha%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'void%20main(void)%7B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%20vec4%20color%20%3D%20texture2D(uSampler%2C%20vTextureCoord)%20*%20vColor%20*%20uAlpha%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%20if%20(color.a%20%3D%3D%200.0)%20discard%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%20gl_FragColor%20%3D%20color%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%7D'%0A%20%20%20%20%20%20%20%20%5D.join('%5Cn')%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20uAlpha%3A%20%20%7B%20type%3A%20'1f'%2C%20value%3A%201%20%7D%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20attributes%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20aPositionCoord%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20aScale%3A%20%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20aRotation%3A%20%20%20%20%20%200%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%0A%20%20%20%20%2F%2F%20TEMP%20HACK%0A%0A%7D%0A%0AParticleShader.prototype%20%3D%20Object.create(TextureShader.prototype)%3B%0AParticleShader.prototype.constructor%20%3D%20ParticleShader%3B%0A%0Amodule.exports%20%3D%20ParticleShader%3B%0A%0A%7D%2C%7B%22..%2F..%2Frenderers%2Fwebgl%2Fshaders%2FTextureShader%22%3A52%7D%5D%2C33%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20utils%20%3D%20require('..%2Futils')%2C%0A%20%20%20%20math%20%3D%20require('..%2Fmath')%2C%0A%20%20%20%20CONST%20%3D%20require('..%2Fconst')%2C%0A%20%20%20%20EventEmitter%20%3D%20require('eventemitter3')%3B%0A%0A%2F**%0A%20*%20The%20CanvasRenderer%20draws%20the%20scene%20and%20all%20its%20content%20onto%20a%202d%20canvas.%20This%20renderer%20should%20be%20used%20for%20browsers%20that%20do%20not%20support%20webGL.%0A%20*%20Don't%20forget%20to%20add%20the%20CanvasRenderer.view%20to%20your%20DOM%20or%20you%20will%20not%20see%20anything%20%3A)%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20system%20%7Bstring%7D%20The%20name%20of%20the%20system%20this%20renderer%20is%20for.%0A%20*%20%40param%20%5Bwidth%3D800%5D%20%7Bnumber%7D%20the%20width%20of%20the%20canvas%20view%0A%20*%20%40param%20%5Bheight%3D600%5D%20%7Bnumber%7D%20the%20height%20of%20the%20canvas%20view%0A%20*%20%40param%20%5Boptions%5D%20%7Bobject%7D%20The%20optional%20renderer%20parameters%0A%20*%20%40param%20%5Boptions.view%5D%20%7BHTMLCanvasElement%7D%20the%20canvas%20to%20use%20as%20a%20view%2C%20optional%0A%20*%20%40param%20%5Boptions.transparent%3Dfalse%5D%20%7Bboolean%7D%20If%20the%20render%20view%20is%20transparent%2C%20default%20false%0A%20*%20%40param%20%5Boptions.autoResize%3Dfalse%5D%20%7Bboolean%7D%20If%20the%20render%20view%20is%20automatically%20resized%2C%20default%20false%0A%20*%20%40param%20%5Boptions.antialias%3Dfalse%5D%20%7Bboolean%7D%20sets%20antialias%20(only%20applicable%20in%20chrome%20at%20the%20moment)%0A%20*%20%40param%20%5Boptions.resolution%3D1%5D%20%7Bnumber%7D%20the%20resolution%20of%20the%20renderer%20retina%20would%20be%202%0A%20*%20%40param%20%5Boptions.clearBeforeRender%3Dtrue%5D%20%7Bboolean%7D%20This%20sets%20if%20the%20CanvasRenderer%20will%20clear%20the%20canvas%20or%0A%20*%20%20%20%20%20%20not%20before%20the%20new%20render%20pass.%0A%20*%20%40param%20%5Boptions.backgroundColor%3D0x000000%5D%20%7Bnumber%7D%20The%20background%20color%20of%20the%20rendered%20area%20(shown%20if%20not%20transparent).%0A%20*%20%40param%20%5Boptions.roundPixels%3Dfalse%5D%20%7Bboolean%7D%20If%20true%20Pixi%20will%20Math.floor()%20x%2Fy%20values%20when%20rendering%2C%20stopping%20pixel%20interpolation.%0A%20*%2F%0Afunction%20SystemRenderer(system%2C%20width%2C%20height%2C%20options)%0A%7B%0A%20%20%20%20EventEmitter.call(this)%3B%0A%0A%20%20%20%20utils.sayHello(system)%3B%0A%0A%20%20%20%20%2F%2F%20prepare%20options%0A%20%20%20%20if%20(options)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20for%20(var%20i%20in%20CONST.DEFAULT_RENDER_OPTIONS)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(typeof%20options%5Bi%5D%20%3D%3D%3D%20'undefined')%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20options%5Bi%5D%20%3D%20CONST.DEFAULT_RENDER_OPTIONS%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20options%20%3D%20CONST.DEFAULT_RENDER_OPTIONS%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20type%20of%20the%20renderer.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%20PIXI.RENDERER_TYPE.UNKNOWN%0A%20%20%20%20%20*%20%40see%20PIXI.RENDERER_TYPE%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.type%20%3D%20CONST.RENDERER_TYPE.UNKNOWN%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20width%20of%20the%20canvas%20view%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%20800%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.width%20%3D%20width%20%7C%7C%20800%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20height%20of%20the%20canvas%20view%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%20600%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.height%20%3D%20height%20%7C%7C%20600%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20canvas%20element%20that%20everything%20is%20drawn%20to%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BHTMLCanvasElement%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.view%20%3D%20options.view%20%7C%7C%20document.createElement('canvas')%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20resolution%20of%20the%20renderer%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%201%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.resolution%20%3D%20options.resolution%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Whether%20the%20render%20view%20is%20transparent%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.transparent%20%3D%20options.transparent%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Whether%20the%20render%20view%20should%20be%20resized%20automatically%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.autoResize%20%3D%20options.autoResize%20%7C%7C%20false%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Tracks%20the%20blend%20modes%20useful%20for%20this%20renderer.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bobject%3Cstring%2C%20mixed%3E%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.blendModes%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20value%20of%20the%20preserveDrawingBuffer%20flag%20affects%20whether%20or%20not%20the%20contents%20of%20the%20stencil%20buffer%20is%20retained%20after%20rendering.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.preserveDrawingBuffer%20%3D%20options.preserveDrawingBuffer%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20This%20sets%20if%20the%20CanvasRenderer%20will%20clear%20the%20canvas%20or%20not%20before%20the%20new%20render%20pass.%0A%20%20%20%20%20*%20If%20the%20scene%20is%20NOT%20transparent%20Pixi%20will%20use%20a%20canvas%20sized%20fillRect%20operation%20every%20frame%20to%20set%20the%20canvas%20background%20color.%0A%20%20%20%20%20*%20If%20the%20scene%20is%20transparent%20Pixi%20will%20use%20clearRect%20to%20clear%20the%20canvas%20every%20frame.%0A%20%20%20%20%20*%20Disable%20this%20by%20setting%20this%20to%20false.%20For%20example%20if%20your%20game%20has%20a%20canvas%20filling%20background%20image%20you%20often%20don't%20need%20this%20set.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40default%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.clearBeforeRender%20%3D%20options.clearBeforeRender%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20If%20true%20Pixi%20will%20Math.floor()%20x%2Fy%20values%20when%20rendering%2C%20stopping%20pixel%20interpolation.%0A%20%20%20%20%20*%20Handy%20for%20crisp%20pixel%20art%20and%20speed%20on%20legacy%20devices.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.roundPixels%20%3D%20options.roundPixels%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20background%20color%20as%20a%20number.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._backgroundColor%20%3D%200x000000%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20background%20color%20as%20an%20%5BR%2C%20G%2C%20B%5D%20array.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%5B%5D%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._backgroundColorRgb%20%3D%20%5B0%2C%200%2C%200%5D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20background%20color%20as%20a%20string.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bstring%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._backgroundColorString%20%3D%20'%23000000'%3B%0A%0A%20%20%20%20this.backgroundColor%20%3D%20options.backgroundColor%20%7C%7C%20this._backgroundColor%3B%20%2F%2F%20run%20bg%20color%20setter%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20This%20temporary%20display%20object%20used%20as%20the%20parent%20of%20the%20currently%20being%20rendered%20item%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.DisplayObject%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._tempDisplayObjectParent%20%3D%20%7BworldTransform%3Anew%20math.Matrix()%2C%20worldAlpha%3A1%2C%20children%3A%5B%5D%7D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20last%20root%20object%20that%20the%20renderer%20tried%20to%20render.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.DisplayObject%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._lastObjectRendered%20%3D%20this._tempDisplayObjectParent%3B%0A%7D%0A%0A%2F%2F%20constructor%0ASystemRenderer.prototype%20%3D%20Object.create(EventEmitter.prototype)%3B%0ASystemRenderer.prototype.constructor%20%3D%20SystemRenderer%3B%0Amodule.exports%20%3D%20SystemRenderer%3B%0A%0AObject.defineProperties(SystemRenderer.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20background%20color%20to%20fill%20if%20not%20transparent%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.SystemRenderer%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20backgroundColor%3A%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this._backgroundColor%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(val)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._backgroundColor%20%3D%20val%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._backgroundColorString%20%3D%20utils.hex2string(val)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20utils.hex2rgb(val%2C%20this._backgroundColorRgb)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%2F**%0A%20*%20Resizes%20the%20canvas%20view%20to%20the%20specified%20width%20and%20height%0A%20*%0A%20*%20%40param%20width%20%7Bnumber%7D%20the%20new%20width%20of%20the%20canvas%20view%0A%20*%20%40param%20height%20%7Bnumber%7D%20the%20new%20height%20of%20the%20canvas%20view%0A%20*%2F%0ASystemRenderer.prototype.resize%20%3D%20function%20(width%2C%20height)%20%7B%0A%20%20%20%20this.width%20%3D%20width%20*%20this.resolution%3B%0A%20%20%20%20this.height%20%3D%20height%20*%20this.resolution%3B%0A%0A%20%20%20%20this.view.width%20%3D%20this.width%3B%0A%20%20%20%20this.view.height%20%3D%20this.height%3B%0A%0A%20%20%20%20if%20(this.autoResize)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.view.style.width%20%3D%20this.width%20%2F%20this.resolution%20%2B%20'px'%3B%0A%20%20%20%20%20%20%20%20this.view.style.height%20%3D%20this.height%20%2F%20this.resolution%20%2B%20'px'%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Removes%20everything%20from%20the%20renderer%20and%20optionally%20removes%20the%20Canvas%20DOM%20element.%0A%20*%0A%20*%20%40param%20%5BremoveView%3Dfalse%5D%20%7Bboolean%7D%20Removes%20the%20Canvas%20element%20from%20the%20DOM.%0A%20*%2F%0ASystemRenderer.prototype.destroy%20%3D%20function%20(removeView)%20%7B%0A%20%20%20%20if%20(removeView%20%26%26%20this.view.parentNode)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.view.parentNode.removeChild(this.view)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.type%20%3D%20CONST.RENDERER_TYPE.UNKNOWN%3B%0A%0A%20%20%20%20this.width%20%3D%200%3B%0A%20%20%20%20this.height%20%3D%200%3B%0A%0A%20%20%20%20this.view%20%3D%20null%3B%0A%0A%20%20%20%20this.resolution%20%3D%200%3B%0A%0A%20%20%20%20this.transparent%20%3D%20false%3B%0A%0A%20%20%20%20this.autoResize%20%3D%20false%3B%0A%0A%20%20%20%20this.blendModes%20%3D%20null%3B%0A%0A%20%20%20%20this.preserveDrawingBuffer%20%3D%20false%3B%0A%20%20%20%20this.clearBeforeRender%20%3D%20false%3B%0A%0A%20%20%20%20this.roundPixels%20%3D%20false%3B%0A%0A%20%20%20%20this._backgroundColor%20%3D%200%3B%0A%20%20%20%20this._backgroundColorRgb%20%3D%20null%3B%0A%20%20%20%20this._backgroundColorString%20%3D%20null%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fconst%22%3A13%2C%22..%2Fmath%22%3A23%2C%22..%2Futils%22%3A67%2C%22eventemitter3%22%3A10%7D%5D%2C34%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20SystemRenderer%20%3D%20require('..%2FSystemRenderer')%2C%0A%20%20%20%20CanvasMaskManager%20%3D%20require('.%2Futils%2FCanvasMaskManager')%2C%0A%20%20%20%20utils%20%3D%20require('..%2F..%2Futils')%2C%0A%20%20%20%20math%20%3D%20require('..%2F..%2Fmath')%2C%0A%20%20%20%20CONST%20%3D%20require('..%2F..%2Fconst')%3B%0A%0A%2F**%0A%20*%20The%20CanvasRenderer%20draws%20the%20scene%20and%20all%20its%20content%20onto%20a%202d%20canvas.%20This%20renderer%20should%20be%20used%20for%20browsers%20that%20do%20not%20support%20webGL.%0A%20*%20Don't%20forget%20to%20add%20the%20CanvasRenderer.view%20to%20your%20DOM%20or%20you%20will%20not%20see%20anything%20%3A)%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40extends%20PIXI.SystemRenderer%0A%20*%20%40param%20%5Bwidth%3D800%5D%20%7Bnumber%7D%20the%20width%20of%20the%20canvas%20view%0A%20*%20%40param%20%5Bheight%3D600%5D%20%7Bnumber%7D%20the%20height%20of%20the%20canvas%20view%0A%20*%20%40param%20%5Boptions%5D%20%7Bobject%7D%20The%20optional%20renderer%20parameters%0A%20*%20%40param%20%5Boptions.view%5D%20%7BHTMLCanvasElement%7D%20the%20canvas%20to%20use%20as%20a%20view%2C%20optional%0A%20*%20%40param%20%5Boptions.transparent%3Dfalse%5D%20%7Bboolean%7D%20If%20the%20render%20view%20is%20transparent%2C%20default%20false%0A%20*%20%40param%20%5Boptions.autoResize%3Dfalse%5D%20%7Bboolean%7D%20If%20the%20render%20view%20is%20automatically%20resized%2C%20default%20false%0A%20*%20%40param%20%5Boptions.antialias%3Dfalse%5D%20%7Bboolean%7D%20sets%20antialias%20(only%20applicable%20in%20chrome%20at%20the%20moment)%0A%20*%20%40param%20%5Boptions.resolution%3D1%5D%20%7Bnumber%7D%20the%20resolution%20of%20the%20renderer%20retina%20would%20be%202%0A%20*%20%40param%20%5Boptions.clearBeforeRender%3Dtrue%5D%20%7Bboolean%7D%20This%20sets%20if%20the%20CanvasRenderer%20will%20clear%20the%20canvas%20or%0A%20*%20%20%20%20%20%20not%20before%20the%20new%20render%20pass.%0A%20*%20%40param%20%5Boptions.roundPixels%3Dfalse%5D%20%7Bboolean%7D%20If%20true%20Pixi%20will%20Math.floor()%20x%2Fy%20values%20when%20rendering%2C%20stopping%20pixel%20interpolation.%0A%20*%2F%0Afunction%20CanvasRenderer(width%2C%20height%2C%20options)%0A%7B%0A%20%20%20%20options%20%3D%20options%20%7C%7C%20%7B%7D%3B%0A%0A%20%20%20%20SystemRenderer.call(this%2C%20'Canvas'%2C%20width%2C%20height%2C%20options)%3B%0A%0A%20%20%20%20this.type%20%3D%20CONST.RENDERER_TYPE.CANVAS%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20canvas%202d%20context%20that%20everything%20is%20drawn%20with.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BCanvasRenderingContext2D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.context%20%3D%20this.view.getContext('2d'%2C%20%7B%20alpha%3A%20this.transparent%20%7D)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Boolean%20flag%20controlling%20canvas%20refresh.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.refresh%20%3D%20true%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Instance%20of%20a%20CanvasMaskManager%2C%20handles%20masking%20when%20using%20the%20canvas%20renderer.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.CanvasMaskManager%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.maskManager%20%3D%20new%20CanvasMaskManager()%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20canvas%20property%20used%20to%20set%20the%20canvas%20smoothing%20property.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bstring%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.smoothProperty%20%3D%20'imageSmoothingEnabled'%3B%0A%0A%20%20%20%20if%20(!this.context.imageSmoothingEnabled)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(this.context.webkitImageSmoothingEnabled)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.smoothProperty%20%3D%20'webkitImageSmoothingEnabled'%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20if%20(this.context.mozImageSmoothingEnabled)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.smoothProperty%20%3D%20'mozImageSmoothingEnabled'%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20if%20(this.context.oImageSmoothingEnabled)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.smoothProperty%20%3D%20'oImageSmoothingEnabled'%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20if%20(this.context.msImageSmoothingEnabled)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.smoothProperty%20%3D%20'msImageSmoothingEnabled'%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.initPlugins()%3B%0A%0A%20%20%20%20this._mapBlendModes()%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20This%20temporary%20display%20object%20used%20as%20the%20parent%20of%20the%20currently%20being%20rendered%20item%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.DisplayObject%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._tempDisplayObjectParent%20%3D%20%7B%0A%20%20%20%20%20%20%20%20worldTransform%3A%20new%20math.Matrix()%2C%0A%20%20%20%20%20%20%20%20worldAlpha%3A%201%0A%20%20%20%20%7D%3B%0A%0A%0A%20%20%20%20this.resize(width%2C%20height)%3B%0A%7D%0A%0A%2F%2F%20constructor%0ACanvasRenderer.prototype%20%3D%20Object.create(SystemRenderer.prototype)%3B%0ACanvasRenderer.prototype.constructor%20%3D%20CanvasRenderer%3B%0Amodule.exports%20%3D%20CanvasRenderer%3B%0Autils.pluginTarget.mixin(CanvasRenderer)%3B%0A%0A%2F**%0A%20*%20Renders%20the%20object%20to%20this%20canvas%20view%0A%20*%0A%20*%20%40param%20object%20%7BPIXI.DisplayObject%7D%20the%20object%20to%20be%20rendered%0A%20*%2F%0ACanvasRenderer.prototype.render%20%3D%20function%20(object)%0A%7B%0A%20%20%20%20var%20cacheParent%20%3D%20object.parent%3B%0A%0A%20%20%20%20this._lastObjectRendered%20%3D%20object%3B%0A%0A%20%20%20%20object.parent%20%3D%20this._tempDisplayObjectParent%3B%0A%0A%20%20%20%20%2F%2F%20update%20the%20scene%20graph%0A%20%20%20%20object.updateTransform()%3B%0A%0A%20%20%20%20object.parent%20%3D%20cacheParent%3B%0A%0A%20%20%20%20this.context.setTransform(1%2C%200%2C%200%2C%201%2C%200%2C%200)%3B%0A%0A%20%20%20%20this.context.globalAlpha%20%3D%201%3B%0A%0A%20%20%20%20this.context.globalCompositeOperation%20%3D%20this.blendModes%5BCONST.BLEND_MODES.NORMAL%5D%3B%0A%0A%20%20%20%20if%20(navigator.isCocoonJS%20%26%26%20this.view.screencanvas)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.context.fillStyle%20%3D%20'black'%3B%0A%20%20%20%20%20%20%20%20this.context.clear()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(this.clearBeforeRender)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(this.transparent)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.context.clearRect(0%2C%200%2C%20this.width%2C%20this.height)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.context.fillStyle%20%3D%20this._backgroundColorString%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.context.fillRect(0%2C%200%2C%20this.width%20%2C%20this.height)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.renderDisplayObject(object%2C%20this.context)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Removes%20everything%20from%20the%20renderer%20and%20optionally%20removes%20the%20Canvas%20DOM%20element.%0A%20*%0A%20*%20%40param%20%5BremoveView%3Dfalse%5D%20%7Bboolean%7D%20Removes%20the%20Canvas%20element%20from%20the%20DOM.%0A%20*%2F%0ACanvasRenderer.prototype.destroy%20%3D%20function%20(removeView)%0A%7B%0A%20%20%20%20this.destroyPlugins()%3B%0A%0A%20%20%20%20%2F%2F%20call%20the%20base%20destroy%0A%20%20%20%20SystemRenderer.prototype.destroy.call(this%2C%20removeView)%3B%0A%0A%20%20%20%20this.context%20%3D%20null%3B%0A%0A%20%20%20%20this.refresh%20%3D%20true%3B%0A%0A%20%20%20%20this.maskManager.destroy()%3B%0A%20%20%20%20this.maskManager%20%3D%20null%3B%0A%0A%20%20%20%20this.smoothProperty%20%3D%20null%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Renders%20a%20display%20object%0A%20*%0A%20*%20%40param%20displayObject%20%7BPIXI.DisplayObject%7D%20The%20displayObject%20to%20render%0A%20*%20%40private%0A%20*%2F%0ACanvasRenderer.prototype.renderDisplayObject%20%3D%20function%20(displayObject%2C%20context)%0A%7B%0A%20%20%20%20var%20tempContext%20%3D%20this.context%3B%0A%0A%20%20%20%20this.context%20%3D%20context%3B%0A%20%20%20%20displayObject.renderCanvas(this)%3B%0A%20%20%20%20this.context%20%3D%20tempContext%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20%40extends%20PIXI.SystemRenderer%23resize%0A%20*%0A%20*%20%40param%20%7Bnumber%7D%20w%0A%20*%20%40param%20%7Bnumber%7D%20h%0A%20*%2F%0ACanvasRenderer.prototype.resize%20%3D%20function%20(w%2C%20h)%0A%7B%0A%20%20%20%20SystemRenderer.prototype.resize.call(this%2C%20w%2C%20h)%3B%0A%0A%20%20%20%20%2F%2Freset%20the%20scale%20mode..%20oddly%20this%20seems%20to%20be%20reset%20when%20the%20canvas%20is%20resized.%0A%20%20%20%20%2F%2Fsurely%20a%20browser%20bug%3F%3F%20Let%20pixi%20fix%20that%20for%20you..%0A%20%20%20%20if(this.smoothProperty)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.context%5Bthis.smoothProperty%5D%20%3D%20(CONST.SCALE_MODES.DEFAULT%20%3D%3D%3D%20CONST.SCALE_MODES.LINEAR)%3B%0A%20%20%20%20%7D%0A%0A%7D%3B%0A%0A%2F**%0A%20*%20Maps%20Pixi%20blend%20modes%20to%20canvas%20blend%20modes.%0A%20*%0A%20*%20%40private%0A%20*%2F%0ACanvasRenderer.prototype._mapBlendModes%20%3D%20function%20()%0A%7B%0A%20%20%20%20if%20(!this.blendModes)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.blendModes%20%3D%20%7B%7D%3B%0A%0A%20%20%20%20%20%20%20%20if%20(utils.canUseNewCanvasBlendModes())%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.NORMAL%5D%20%20%20%20%20%20%20%20%3D%20'source-over'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.ADD%5D%20%20%20%20%20%20%20%20%20%20%20%3D%20'lighter'%3B%20%2F%2FIS%20THIS%20OK%3F%3F%3F%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.MULTIPLY%5D%20%20%20%20%20%20%3D%20'multiply'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.SCREEN%5D%20%20%20%20%20%20%20%20%3D%20'screen'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.OVERLAY%5D%20%20%20%20%20%20%20%3D%20'overlay'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.DARKEN%5D%20%20%20%20%20%20%20%20%3D%20'darken'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.LIGHTEN%5D%20%20%20%20%20%20%20%3D%20'lighten'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.COLOR_DODGE%5D%20%20%20%3D%20'color-dodge'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.COLOR_BURN%5D%20%20%20%20%3D%20'color-burn'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.HARD_LIGHT%5D%20%20%20%20%3D%20'hard-light'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.SOFT_LIGHT%5D%20%20%20%20%3D%20'soft-light'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.DIFFERENCE%5D%20%20%20%20%3D%20'difference'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.EXCLUSION%5D%20%20%20%20%20%3D%20'exclusion'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.HUE%5D%20%20%20%20%20%20%20%20%20%20%20%3D%20'hue'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.SATURATION%5D%20%20%20%20%3D%20'saturate'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.COLOR%5D%20%20%20%20%20%20%20%20%20%3D%20'color'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.LUMINOSITY%5D%20%20%20%20%3D%20'luminosity'%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20this%20means%20that%20the%20browser%20does%20not%20support%20the%20cool%20new%20blend%20modes%20in%20canvas%20'cough'%20ie%20'cough'%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.NORMAL%5D%20%20%20%20%20%20%20%20%3D%20'source-over'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.ADD%5D%20%20%20%20%20%20%20%20%20%20%20%3D%20'lighter'%3B%20%2F%2FIS%20THIS%20OK%3F%3F%3F%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.MULTIPLY%5D%20%20%20%20%20%20%3D%20'source-over'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.SCREEN%5D%20%20%20%20%20%20%20%20%3D%20'source-over'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.OVERLAY%5D%20%20%20%20%20%20%20%3D%20'source-over'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.DARKEN%5D%20%20%20%20%20%20%20%20%3D%20'source-over'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.LIGHTEN%5D%20%20%20%20%20%20%20%3D%20'source-over'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.COLOR_DODGE%5D%20%20%20%3D%20'source-over'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.COLOR_BURN%5D%20%20%20%20%3D%20'source-over'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.HARD_LIGHT%5D%20%20%20%20%3D%20'source-over'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.SOFT_LIGHT%5D%20%20%20%20%3D%20'source-over'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.DIFFERENCE%5D%20%20%20%20%3D%20'source-over'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.EXCLUSION%5D%20%20%20%20%20%3D%20'source-over'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.HUE%5D%20%20%20%20%20%20%20%20%20%20%20%3D%20'source-over'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.SATURATION%5D%20%20%20%20%3D%20'source-over'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.COLOR%5D%20%20%20%20%20%20%20%20%20%3D%20'source-over'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.LUMINOSITY%5D%20%20%20%20%3D%20'source-over'%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%7D%2C%7B%22..%2F..%2Fconst%22%3A13%2C%22..%2F..%2Fmath%22%3A23%2C%22..%2F..%2Futils%22%3A67%2C%22..%2FSystemRenderer%22%3A33%2C%22.%2Futils%2FCanvasMaskManager%22%3A37%7D%5D%2C35%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F**%0A%20*%20Creates%20a%20Canvas%20element%20of%20the%20given%20size.%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20width%20%7Bnumber%7D%20the%20width%20for%20the%20newly%20created%20canvas%0A%20*%20%40param%20height%20%7Bnumber%7D%20the%20height%20for%20the%20newly%20created%20canvas%0A%20*%2F%0Afunction%20CanvasBuffer(width%2C%20height)%0A%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20Canvas%20object%20that%20belongs%20to%20this%20CanvasBuffer.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BHTMLCanvasElement%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.canvas%20%3D%20document.createElement('canvas')%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20A%20CanvasRenderingContext2D%20object%20representing%20a%20two-dimensional%20rendering%20context.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BCanvasRenderingContext2D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.context%20%3D%20this.canvas.getContext('2d')%3B%0A%0A%20%20%20%20this.canvas.width%20%3D%20width%3B%0A%20%20%20%20this.canvas.height%20%3D%20height%3B%0A%7D%0A%0ACanvasBuffer.prototype.constructor%20%3D%20CanvasBuffer%3B%0Amodule.exports%20%3D%20CanvasBuffer%3B%0A%0AObject.defineProperties(CanvasBuffer.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20width%20of%20the%20canvas%20buffer%20in%20pixels.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.CanvasBuffer%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20width%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.canvas.width%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(val)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.canvas.width%20%3D%20val%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20height%20of%20the%20canvas%20buffer%20in%20pixels.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.CanvasBuffer%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20height%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.canvas.height%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(val)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.canvas.height%20%3D%20val%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%2F**%0A%20*%20Clears%20the%20canvas%20that%20was%20created%20by%20the%20CanvasBuffer%20class.%0A%20*%0A%20*%20%40private%0A%20*%2F%0ACanvasBuffer.prototype.clear%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.context.setTransform(1%2C%200%2C%200%2C%201%2C%200%2C%200)%3B%0A%20%20%20%20this.context.clearRect(0%2C0%2C%20this.canvas.width%2C%20this.canvas.height)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Resizes%20the%20canvas%20to%20the%20specified%20width%20and%20height.%0A%20*%0A%20*%20%40param%20width%20%7Bnumber%7D%20the%20new%20width%20of%20the%20canvas%0A%20*%20%40param%20height%20%7Bnumber%7D%20the%20new%20height%20of%20the%20canvas%0A%20*%2F%0ACanvasBuffer.prototype.resize%20%3D%20function%20(width%2C%20height)%0A%7B%0A%20%20%20%20this.canvas.width%20%3D%20width%3B%0A%20%20%20%20this.canvas.height%20%3D%20height%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20this%20canvas.%0A%20*%0A%20*%2F%0ACanvasBuffer.prototype.destroy%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.context%20%3D%20null%3B%0A%20%20%20%20this.canvas%20%3D%20null%3B%0A%7D%3B%0A%0A%7D%2C%7B%7D%5D%2C36%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20CONST%20%3D%20require('..%2F..%2F..%2Fconst')%3B%0A%0A%2F**%0A%20*%20A%20set%20of%20functions%20used%20by%20the%20canvas%20renderer%20to%20draw%20the%20primitive%20graphics%20data.%0A%20*%20%40static%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%2F%0Avar%20CanvasGraphics%20%3D%20%7B%7D%3B%0Amodule.exports%20%3D%20CanvasGraphics%3B%0A%0A%2F*%0A%20*%20Renders%20a%20Graphics%20object%20to%20a%20canvas.%0A%20*%0A%20*%20%40param%20graphics%20%7BPIXI.Graphics%7D%20the%20actual%20graphics%20object%20to%20render%0A%20*%20%40param%20context%20%7BCanvasRenderingContext2D%7D%20the%202d%20drawing%20method%20of%20the%20canvas%0A%20*%2F%0ACanvasGraphics.renderGraphics%20%3D%20function%20(graphics%2C%20context)%0A%7B%0A%20%20%20%20var%20worldAlpha%20%3D%20graphics.worldAlpha%3B%0A%0A%20%20%20%20if%20(graphics.dirty)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.updateGraphicsTint(graphics)%3B%0A%20%20%20%20%20%20%20%20graphics.dirty%20%3D%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20graphics.graphicsData.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20data%20%3D%20graphics.graphicsData%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20var%20shape%20%3D%20data.shape%3B%0A%0A%20%20%20%20%20%20%20%20var%20fillColor%20%3D%20data._fillTint%3B%0A%20%20%20%20%20%20%20%20var%20lineColor%20%3D%20data._lineTint%3B%0A%0A%20%20%20%20%20%20%20%20context.lineWidth%20%3D%20data.lineWidth%3B%0A%0A%20%20%20%20%20%20%20%20if%20(data.type%20%3D%3D%3D%20CONST.SHAPES.POLY)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.beginPath()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20points%20%3D%20shape.points%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20context.moveTo(points%5B0%5D%2C%20points%5B1%5D)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(var%20j%3D1%3B%20j%20%3C%20points.length%2F2%3B%20j%2B%2B)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.lineTo(points%5Bj%20*%202%5D%2C%20points%5Bj%20*%202%20%2B%201%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(shape.closed)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.lineTo(points%5B0%5D%2C%20points%5B1%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20if%20the%20first%20and%20last%20point%20are%20the%20same%20close%20the%20path%20-%20much%20neater%20%3A)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(points%5B0%5D%20%3D%3D%3D%20points%5Bpoints.length-2%5D%20%26%26%20points%5B1%5D%20%3D%3D%3D%20points%5Bpoints.length-1%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.closePath()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.fill)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.globalAlpha%20%3D%20data.fillAlpha%20*%20worldAlpha%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.fillStyle%20%3D%20'%23'%20%2B%20('00000'%20%2B%20(%20fillColor%20%7C%200).toString(16)).substr(-6)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.fill()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.lineWidth)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.globalAlpha%20%3D%20data.lineAlpha%20*%20worldAlpha%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.strokeStyle%20%3D%20'%23'%20%2B%20('00000'%20%2B%20(%20lineColor%20%7C%200).toString(16)).substr(-6)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.stroke()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20if%20(data.type%20%3D%3D%3D%20CONST.SHAPES.RECT)%0A%20%20%20%20%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.fillColor%20%7C%7C%20data.fillColor%20%3D%3D%3D%200)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.globalAlpha%20%3D%20data.fillAlpha%20*%20worldAlpha%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.fillStyle%20%3D%20'%23'%20%2B%20('00000'%20%2B%20(%20fillColor%20%7C%200).toString(16)).substr(-6)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.fillRect(shape.x%2C%20shape.y%2C%20shape.width%2C%20shape.height)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.lineWidth)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.globalAlpha%20%3D%20data.lineAlpha%20*%20worldAlpha%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.strokeStyle%20%3D%20'%23'%20%2B%20('00000'%20%2B%20(%20lineColor%20%7C%200).toString(16)).substr(-6)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.strokeRect(shape.x%2C%20shape.y%2C%20shape.width%2C%20shape.height)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20if%20(data.type%20%3D%3D%3D%20CONST.SHAPES.CIRC)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20TODO%20-%20need%20to%20be%20Undefined!%0A%20%20%20%20%20%20%20%20%20%20%20%20context.beginPath()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.arc(shape.x%2C%20shape.y%2C%20shape.radius%2C0%2C2*Math.PI)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.closePath()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.fill)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.globalAlpha%20%3D%20data.fillAlpha%20*%20worldAlpha%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.fillStyle%20%3D%20'%23'%20%2B%20('00000'%20%2B%20(%20fillColor%20%7C%200).toString(16)).substr(-6)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.fill()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.lineWidth)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.globalAlpha%20%3D%20data.lineAlpha%20*%20worldAlpha%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.strokeStyle%20%3D%20'%23'%20%2B%20('00000'%20%2B%20(%20lineColor%20%7C%200).toString(16)).substr(-6)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.stroke()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20if%20(data.type%20%3D%3D%3D%20CONST.SHAPES.ELIP)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20ellipse%20code%20taken%20from%3A%20http%3A%2F%2Fstackoverflow.com%2Fquestions%2F2172798%2Fhow-to-draw-an-oval-in-html5-canvas%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20w%20%3D%20shape.width%20*%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20h%20%3D%20shape.height%20*%202%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20x%20%3D%20shape.x%20-%20w%2F2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20y%20%3D%20shape.y%20-%20h%2F2%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20context.beginPath()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20kappa%20%3D%200.5522848%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ox%20%3D%20(w%20%2F%202)%20*%20kappa%2C%20%2F%2F%20control%20point%20offset%20horizontal%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20oy%20%3D%20(h%20%2F%202)%20*%20kappa%2C%20%2F%2F%20control%20point%20offset%20vertical%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xe%20%3D%20x%20%2B%20w%2C%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20x-end%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ye%20%3D%20y%20%2B%20h%2C%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20y-end%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xm%20%3D%20x%20%2B%20w%20%2F%202%2C%20%20%20%20%20%20%20%2F%2F%20x-middle%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ym%20%3D%20y%20%2B%20h%20%2F%202%3B%20%20%20%20%20%20%20%2F%2F%20y-middle%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20context.moveTo(x%2C%20ym)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.bezierCurveTo(x%2C%20ym%20-%20oy%2C%20xm%20-%20ox%2C%20y%2C%20xm%2C%20y)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.bezierCurveTo(xm%20%2B%20ox%2C%20y%2C%20xe%2C%20ym%20-%20oy%2C%20xe%2C%20ym)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.bezierCurveTo(xe%2C%20ym%20%2B%20oy%2C%20xm%20%2B%20ox%2C%20ye%2C%20xm%2C%20ye)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.bezierCurveTo(xm%20-%20ox%2C%20ye%2C%20x%2C%20ym%20%2B%20oy%2C%20x%2C%20ym)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20context.closePath()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.fill)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.globalAlpha%20%3D%20data.fillAlpha%20*%20worldAlpha%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.fillStyle%20%3D%20'%23'%20%2B%20('00000'%20%2B%20(%20fillColor%20%7C%200).toString(16)).substr(-6)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.fill()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.lineWidth)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.globalAlpha%20%3D%20data.lineAlpha%20*%20worldAlpha%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.strokeStyle%20%3D%20'%23'%20%2B%20('00000'%20%2B%20(%20lineColor%20%7C%200).toString(16)).substr(-6)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.stroke()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20if%20(data.type%20%3D%3D%3D%20CONST.SHAPES.RREC)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20rx%20%3D%20shape.x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20ry%20%3D%20shape.y%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20width%20%3D%20shape.width%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20height%20%3D%20shape.height%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20radius%20%3D%20shape.radius%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxRadius%20%3D%20Math.min(width%2C%20height)%20%2F%202%20%7C%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20radius%20%3D%20radius%20%3E%20maxRadius%20%3F%20maxRadius%20%3A%20radius%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20context.beginPath()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.moveTo(rx%2C%20ry%20%2B%20radius)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.lineTo(rx%2C%20ry%20%2B%20height%20-%20radius)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.quadraticCurveTo(rx%2C%20ry%20%2B%20height%2C%20rx%20%2B%20radius%2C%20ry%20%2B%20height)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.lineTo(rx%20%2B%20width%20-%20radius%2C%20ry%20%2B%20height)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.quadraticCurveTo(rx%20%2B%20width%2C%20ry%20%2B%20height%2C%20rx%20%2B%20width%2C%20ry%20%2B%20height%20-%20radius)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.lineTo(rx%20%2B%20width%2C%20ry%20%2B%20radius)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.quadraticCurveTo(rx%20%2B%20width%2C%20ry%2C%20rx%20%2B%20width%20-%20radius%2C%20ry)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.lineTo(rx%20%2B%20radius%2C%20ry)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.quadraticCurveTo(rx%2C%20ry%2C%20rx%2C%20ry%20%2B%20radius)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.closePath()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.fillColor%20%7C%7C%20data.fillColor%20%3D%3D%3D%200)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.globalAlpha%20%3D%20data.fillAlpha%20*%20worldAlpha%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.fillStyle%20%3D%20'%23'%20%2B%20('00000'%20%2B%20(%20fillColor%20%7C%200).toString(16)).substr(-6)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.fill()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.lineWidth)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.globalAlpha%20%3D%20data.lineAlpha%20*%20worldAlpha%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.strokeStyle%20%3D%20'%23'%20%2B%20('00000'%20%2B%20(%20lineColor%20%7C%200).toString(16)).substr(-6)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.stroke()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F*%0A%20*%20Renders%20a%20graphics%20mask%0A%20*%0A%20*%20%40private%0A%20*%20%40param%20graphics%20%7BPIXI.Graphics%7D%20the%20graphics%20which%20will%20be%20used%20as%20a%20mask%0A%20*%20%40param%20context%20%7BCanvasRenderingContext2D%7D%20the%20context%202d%20method%20of%20the%20canvas%0A%20*%2F%0ACanvasGraphics.renderGraphicsMask%20%3D%20function%20(graphics%2C%20context)%0A%7B%0A%20%20%20%20var%20len%20%3D%20graphics.graphicsData.length%3B%0A%0A%20%20%20%20if%20(len%20%3D%3D%3D%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20context.beginPath()%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20len%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20data%20%3D%20graphics.graphicsData%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20var%20shape%20%3D%20data.shape%3B%0A%0A%20%20%20%20%20%20%20%20if%20(data.type%20%3D%3D%3D%20CONST.SHAPES.POLY)%0A%20%20%20%20%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20points%20%3D%20shape.points%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20context.moveTo(points%5B0%5D%2C%20points%5B1%5D)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(var%20j%3D1%3B%20j%20%3C%20points.length%2F2%3B%20j%2B%2B)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.lineTo(points%5Bj%20*%202%5D%2C%20points%5Bj%20*%202%20%2B%201%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20if%20the%20first%20and%20last%20point%20are%20the%20same%20close%20the%20path%20-%20much%20neater%20%3A)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(points%5B0%5D%20%3D%3D%3D%20points%5Bpoints.length-2%5D%20%26%26%20points%5B1%5D%20%3D%3D%3D%20points%5Bpoints.length-1%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20context.closePath()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20if%20(data.type%20%3D%3D%3D%20CONST.SHAPES.RECT)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.rect(shape.x%2C%20shape.y%2C%20shape.width%2C%20shape.height)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.closePath()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20if%20(data.type%20%3D%3D%3D%20CONST.SHAPES.CIRC)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20TODO%20-%20need%20to%20be%20Undefined!%0A%20%20%20%20%20%20%20%20%20%20%20%20context.arc(shape.x%2C%20shape.y%2C%20shape.radius%2C%200%2C%202%20*%20Math.PI)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.closePath()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20if%20(data.type%20%3D%3D%3D%20CONST.SHAPES.ELIP)%0A%20%20%20%20%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20ellipse%20code%20taken%20from%3A%20http%3A%2F%2Fstackoverflow.com%2Fquestions%2F2172798%2Fhow-to-draw-an-oval-in-html5-canvas%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20w%20%3D%20shape.width%20*%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20h%20%3D%20shape.height%20*%202%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20x%20%3D%20shape.x%20-%20w%2F2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20y%20%3D%20shape.y%20-%20h%2F2%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20kappa%20%3D%200.5522848%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ox%20%3D%20(w%20%2F%202)%20*%20kappa%2C%20%2F%2F%20control%20point%20offset%20horizontal%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20oy%20%3D%20(h%20%2F%202)%20*%20kappa%2C%20%2F%2F%20control%20point%20offset%20vertical%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xe%20%3D%20x%20%2B%20w%2C%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20x-end%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ye%20%3D%20y%20%2B%20h%2C%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20y-end%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xm%20%3D%20x%20%2B%20w%20%2F%202%2C%20%20%20%20%20%20%20%2F%2F%20x-middle%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ym%20%3D%20y%20%2B%20h%20%2F%202%3B%20%20%20%20%20%20%20%2F%2F%20y-middle%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20context.moveTo(x%2C%20ym)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.bezierCurveTo(x%2C%20ym%20-%20oy%2C%20xm%20-%20ox%2C%20y%2C%20xm%2C%20y)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.bezierCurveTo(xm%20%2B%20ox%2C%20y%2C%20xe%2C%20ym%20-%20oy%2C%20xe%2C%20ym)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.bezierCurveTo(xe%2C%20ym%20%2B%20oy%2C%20xm%20%2B%20ox%2C%20ye%2C%20xm%2C%20ye)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.bezierCurveTo(xm%20-%20ox%2C%20ye%2C%20x%2C%20ym%20%2B%20oy%2C%20x%2C%20ym)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.closePath()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20if%20(data.type%20%3D%3D%3D%20CONST.SHAPES.RREC)%0A%20%20%20%20%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20rx%20%3D%20shape.x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20ry%20%3D%20shape.y%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20width%20%3D%20shape.width%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20height%20%3D%20shape.height%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20radius%20%3D%20shape.radius%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20maxRadius%20%3D%20Math.min(width%2C%20height)%20%2F%202%20%7C%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20radius%20%3D%20radius%20%3E%20maxRadius%20%3F%20maxRadius%20%3A%20radius%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20context.moveTo(rx%2C%20ry%20%2B%20radius)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.lineTo(rx%2C%20ry%20%2B%20height%20-%20radius)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.quadraticCurveTo(rx%2C%20ry%20%2B%20height%2C%20rx%20%2B%20radius%2C%20ry%20%2B%20height)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.lineTo(rx%20%2B%20width%20-%20radius%2C%20ry%20%2B%20height)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.quadraticCurveTo(rx%20%2B%20width%2C%20ry%20%2B%20height%2C%20rx%20%2B%20width%2C%20ry%20%2B%20height%20-%20radius)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.lineTo(rx%20%2B%20width%2C%20ry%20%2B%20radius)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.quadraticCurveTo(rx%20%2B%20width%2C%20ry%2C%20rx%20%2B%20width%20-%20radius%2C%20ry)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.lineTo(rx%20%2B%20radius%2C%20ry)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.quadraticCurveTo(rx%2C%20ry%2C%20rx%2C%20ry%20%2B%20radius)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20context.closePath()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F*%0A%20*%20Updates%20the%20tint%20of%20a%20graphics%20object%0A%20*%0A%20*%20%40private%0A%20*%20%40param%20graphics%20%7BPIXI.Graphics%7D%20the%20graphics%20that%20will%20have%20its%20tint%20updated%0A%20*%0A%20*%2F%0ACanvasGraphics.updateGraphicsTint%20%3D%20function%20(graphics)%0A%7B%0A%20%20%20%20if%20(graphics.tint%20%3D%3D%3D%200xFFFFFF%20%26%26%20graphics._prevTint%20%3D%3D%3D%20graphics.tint)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20graphics._prevTint%20%3D%20graphics.tint%3B%0A%0A%20%20%20%20var%20tintR%20%3D%20(graphics.tint%20%3E%3E%2016%20%26%200xFF)%20%2F%20255%3B%0A%20%20%20%20var%20tintG%20%3D%20(graphics.tint%20%3E%3E%208%20%26%200xFF)%20%2F%20255%3B%0A%20%20%20%20var%20tintB%20%3D%20(graphics.tint%20%26%200xFF)%2F%20255%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20graphics.graphicsData.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20data%20%3D%20graphics.graphicsData%5Bi%5D%3B%0A%0A%20%20%20%20%20%20%20%20var%20fillColor%20%3D%20data.fillColor%20%7C%200%3B%0A%20%20%20%20%20%20%20%20var%20lineColor%20%3D%20data.lineColor%20%7C%200%3B%0A%0A%20%20%20%20%20%20%20%20%2F*%0A%20%20%20%20%20%20%20%20var%20colorR%20%3D%20(fillColor%20%3E%3E%2016%20%26%200xFF)%20%2F%20255%3B%0A%20%20%20%20%20%20%20%20var%20colorG%20%3D%20(fillColor%20%3E%3E%208%20%26%200xFF)%20%2F%20255%3B%0A%20%20%20%20%20%20%20%20var%20colorB%20%3D%20(fillColor%20%26%200xFF)%20%2F%20255%3B%0A%0A%20%20%20%20%20%20%20%20colorR%20*%3D%20tintR%3B%0A%20%20%20%20%20%20%20%20colorG%20*%3D%20tintG%3B%0A%20%20%20%20%20%20%20%20colorB%20*%3D%20tintB%3B%0A%0A%20%20%20%20%20%20%20%20fillColor%20%3D%20((colorR*255%20%3C%3C%2016)%20%2B%20(colorG*255%20%3C%3C%208)%20%2B%20colorB*255)%3B%0A%0A%20%20%20%20%20%20%20%20colorR%20%3D%20(lineColor%20%3E%3E%2016%20%26%200xFF)%20%2F%20255%3B%0A%20%20%20%20%20%20%20%20colorG%20%3D%20(lineColor%20%3E%3E%208%20%26%200xFF)%20%2F%20255%3B%0A%20%20%20%20%20%20%20%20colorB%20%3D%20(lineColor%20%26%200xFF)%20%2F%20255%3B%0A%0A%20%20%20%20%20%20%20%20colorR%20*%3D%20tintR%3B%0A%20%20%20%20%20%20%20%20colorG%20*%3D%20tintG%3B%0A%20%20%20%20%20%20%20%20colorB%20*%3D%20tintB%3B%0A%0A%20%20%20%20%20%20%20%20lineColor%20%3D%20((colorR*255%20%3C%3C%2016)%20%2B%20(colorG*255%20%3C%3C%208)%20%2B%20colorB*255)%3B%0A%20%20%20%20%20%20%20%20*%2F%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20super%20inline%20cos%20im%20an%20optimization%20NAZI%20%3A)%0A%20%20%20%20%20%20%20%20data._fillTint%20%3D%20(((fillColor%20%3E%3E%2016%20%26%200xFF)%20%2F%20255%20*%20tintR*255%20%3C%3C%2016)%20%2B%20((fillColor%20%3E%3E%208%20%26%200xFF)%20%2F%20255%20*%20tintG*255%20%3C%3C%208)%20%2B%20%20(fillColor%20%26%200xFF)%20%2F%20255%20*%20tintB*255)%3B%0A%20%20%20%20%20%20%20%20data._lineTint%20%3D%20(((lineColor%20%3E%3E%2016%20%26%200xFF)%20%2F%20255%20*%20tintR*255%20%3C%3C%2016)%20%2B%20((lineColor%20%3E%3E%208%20%26%200xFF)%20%2F%20255%20*%20tintG*255%20%3C%3C%208)%20%2B%20%20(lineColor%20%26%200xFF)%20%2F%20255%20*%20tintB*255)%3B%0A%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%0A%7D%2C%7B%22..%2F..%2F..%2Fconst%22%3A13%7D%5D%2C37%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20CanvasGraphics%20%3D%20require('.%2FCanvasGraphics')%3B%0A%0A%2F**%0A%20*%20A%20set%20of%20functions%20used%20to%20handle%20masking.%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%2F%0Afunction%20CanvasMaskManager()%0A%7B%7D%0A%0ACanvasMaskManager.prototype.constructor%20%3D%20CanvasMaskManager%3B%0Amodule.exports%20%3D%20CanvasMaskManager%3B%0A%0A%2F**%0A%20*%20This%20method%20adds%20it%20to%20the%20current%20stack%20of%20masks.%0A%20*%0A%20*%20%40param%20maskData%20%7Bobject%7D%20the%20maskData%20that%20will%20be%20pushed%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7CPIXI.CanvasRenderer%7D%20The%20renderer%20context%20to%20use.%0A%20*%2F%0ACanvasMaskManager.prototype.pushMask%20%3D%20function%20(maskData%2C%20renderer)%0A%7B%0A%0A%20%20%20%20renderer.context.save()%3B%0A%0A%20%20%20%20var%20cacheAlpha%20%3D%20maskData.alpha%3B%0A%20%20%20%20var%20transform%20%3D%20maskData.worldTransform%3B%0A%20%20%20%20var%20resolution%20%3D%20renderer.resolution%3B%0A%0A%20%20%20%20renderer.context.setTransform(%0A%20%20%20%20%20%20%20%20transform.a%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20transform.b%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20transform.c%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20transform.d%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20transform.tx%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20transform.ty%20*%20resolution%0A%20%20%20%20)%3B%0A%0A%20%20%20%20%2F%2FTODO%20suport%20sprite%20alpha%20masks%3F%3F%0A%20%20%20%20%2F%2Flots%20of%20effort%20required.%20If%20demand%20is%20great%20enough..%0A%20%20%20%20if(!maskData.texture)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20CanvasGraphics.renderGraphicsMask(maskData%2C%20renderer.context)%3B%0A%20%20%20%20%20%20%20%20renderer.context.clip()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20maskData.worldAlpha%20%3D%20cacheAlpha%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Restores%20the%20current%20drawing%20context%20to%20the%20state%20it%20was%20before%20the%20mask%20was%20applied.%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7CPIXI.CanvasRenderer%7D%20The%20renderer%20context%20to%20use.%0A%20*%2F%0ACanvasMaskManager.prototype.popMask%20%3D%20function%20(renderer)%0A%7B%0A%20%20%20%20renderer.context.restore()%3B%0A%7D%3B%0A%0ACanvasMaskManager.prototype.destroy%20%3D%20function%20()%20%7B%7D%3B%0A%0A%7D%2C%7B%22.%2FCanvasGraphics%22%3A36%7D%5D%2C38%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20utils%20%3D%20require('..%2F..%2F..%2Futils')%3B%0A%0A%2F**%0A%20*%20Utility%20methods%20for%20Sprite%2FTexture%20tinting.%0A%20*%20%40static%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%2F%0Avar%20CanvasTinter%20%3D%20%7B%7D%3B%0Amodule.exports%20%3D%20CanvasTinter%3B%0A%0A%2F**%0A%20*%20Basically%20this%20method%20just%20needs%20a%20sprite%20and%20a%20color%20and%20tints%20the%20sprite%20with%20the%20given%20color.%0A%20*%0A%20*%20%40param%20sprite%20%7BPIXI.Sprite%7D%20the%20sprite%20to%20tint%0A%20*%20%40param%20color%20%7Bnumber%7D%20the%20color%20to%20use%20to%20tint%20the%20sprite%20with%0A%20*%20%40return%20%7BHTMLCanvasElement%7D%20The%20tinted%20canvas%0A%20*%2F%0ACanvasTinter.getTintedTexture%20%3D%20function%20(sprite%2C%20color)%0A%7B%0A%20%20%20%20var%20texture%20%3D%20sprite.texture%3B%0A%0A%20%20%20%20color%20%3D%20CanvasTinter.roundColor(color)%3B%0A%0A%20%20%20%20var%20stringColor%20%3D%20'%23'%20%2B%20('00000'%20%2B%20(%20color%20%7C%200).toString(16)).substr(-6)%3B%0A%0A%20%20%20%20texture.tintCache%20%3D%20texture.tintCache%20%7C%7C%20%7B%7D%3B%0A%0A%20%20%20%20if%20(texture.tintCache%5BstringColor%5D)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20texture.tintCache%5BstringColor%5D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%20%2F%2F%20clone%20texture..%0A%20%20%20%20var%20canvas%20%3D%20CanvasTinter.canvas%20%7C%7C%20document.createElement('canvas')%3B%0A%0A%20%20%20%20%2F%2FCanvasTinter.tintWithPerPixel(texture%2C%20stringColor%2C%20canvas)%3B%0A%20%20%20%20CanvasTinter.tintMethod(texture%2C%20color%2C%20canvas)%3B%0A%0A%20%20%20%20if%20(CanvasTinter.convertTintToImage)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20is%20this%20better%3F%0A%20%20%20%20%20%20%20%20var%20tintImage%20%3D%20new%20Image()%3B%0A%20%20%20%20%20%20%20%20tintImage.src%20%3D%20canvas.toDataURL()%3B%0A%0A%20%20%20%20%20%20%20%20texture.tintCache%5BstringColor%5D%20%3D%20tintImage%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20texture.tintCache%5BstringColor%5D%20%3D%20canvas%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20if%20we%20are%20not%20converting%20the%20texture%20to%20an%20image%20then%20we%20need%20to%20lose%20the%20reference%20to%20the%20canvas%0A%20%20%20%20%20%20%20%20CanvasTinter.canvas%20%3D%20null%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20canvas%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Tint%20a%20texture%20using%20the%20'multiply'%20operation.%0A%20*%0A%20*%20%40param%20texture%20%7BPIXI.Texture%7D%20the%20texture%20to%20tint%0A%20*%20%40param%20color%20%7Bnumber%7D%20the%20color%20to%20use%20to%20tint%20the%20sprite%20with%0A%20*%20%40param%20canvas%20%7BHTMLCanvasElement%7D%20the%20current%20canvas%0A%20*%2F%0ACanvasTinter.tintWithMultiply%20%3D%20function%20(texture%2C%20color%2C%20canvas)%0A%7B%0A%20%20%20%20var%20context%20%3D%20canvas.getContext(%20'2d'%20)%3B%0A%0A%20%20%20%20var%20resolution%20%3D%20texture.baseTexture.resolution%3B%0A%0A%20%20%20%20var%20crop%20%3D%20texture.crop.clone()%3B%0A%20%20%20%20crop.x%20*%3D%20resolution%3B%0A%20%20%20%20crop.y%20*%3D%20resolution%3B%0A%20%20%20%20crop.width%20*%3D%20resolution%3B%0A%20%20%20%20crop.height%20*%3D%20resolution%3B%0A%0A%20%20%20%20canvas.width%20%3D%20crop.width%3B%0A%20%20%20%20canvas.height%20%3D%20crop.height%3B%0A%0A%20%20%20%20context.fillStyle%20%3D%20'%23'%20%2B%20('00000'%20%2B%20(%20color%20%7C%200).toString(16)).substr(-6)%3B%0A%0A%20%20%20%20context.fillRect(0%2C%200%2C%20crop.width%2C%20crop.height)%3B%0A%0A%20%20%20%20context.globalCompositeOperation%20%3D%20'multiply'%3B%0A%0A%20%20%20%20context.drawImage(%0A%20%20%20%20%20%20%20%20texture.baseTexture.source%2C%0A%20%20%20%20%20%20%20%20crop.x%2C%0A%20%20%20%20%20%20%20%20crop.y%2C%0A%20%20%20%20%20%20%20%20crop.width%2C%0A%20%20%20%20%20%20%20%20crop.height%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20crop.width%2C%0A%20%20%20%20%20%20%20%20crop.height%0A%20%20%20%20)%3B%0A%0A%20%20%20%20context.globalCompositeOperation%20%3D%20'destination-atop'%3B%0A%0A%20%20%20%20context.drawImage(%0A%20%20%20%20%20%20%20%20texture.baseTexture.source%2C%0A%20%20%20%20%20%20%20%20crop.x%2C%0A%20%20%20%20%20%20%20%20crop.y%2C%0A%20%20%20%20%20%20%20%20crop.width%2C%0A%20%20%20%20%20%20%20%20crop.height%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20crop.width%2C%0A%20%20%20%20%20%20%20%20crop.height%0A%20%20%20%20)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Tint%20a%20texture%20using%20the%20'overlay'%20operation.%0A%20*%0A%20*%20%40param%20texture%20%7BPIXI.Texture%7D%20the%20texture%20to%20tint%0A%20*%20%40param%20color%20%7Bnumber%7D%20the%20color%20to%20use%20to%20tint%20the%20sprite%20with%0A%20*%20%40param%20canvas%20%7BHTMLCanvasElement%7D%20the%20current%20canvas%0A%20*%2F%0ACanvasTinter.tintWithOverlay%20%3D%20function%20(texture%2C%20color%2C%20canvas)%0A%7B%0A%20%20%20%20var%20context%20%3D%20canvas.getContext(%20'2d'%20)%3B%0A%0A%20%20%20%20var%20resolution%20%3D%20texture.baseTexture.resolution%3B%0A%0A%20%20%20%20var%20crop%20%3D%20texture.crop.clone()%3B%0A%20%20%20%20crop.x%20*%3D%20resolution%3B%0A%20%20%20%20crop.y%20*%3D%20resolution%3B%0A%20%20%20%20crop.width%20*%3D%20resolution%3B%0A%20%20%20%20crop.height%20*%3D%20resolution%3B%0A%0A%20%20%20%20canvas.width%20%3D%20crop.width%3B%0A%20%20%20%20canvas.height%20%3D%20crop.height%3B%0A%0A%20%20%20%20context.globalCompositeOperation%20%3D%20'copy'%3B%0A%20%20%20%20context.fillStyle%20%3D%20'%23'%20%2B%20('00000'%20%2B%20(%20color%20%7C%200).toString(16)).substr(-6)%3B%0A%20%20%20%20context.fillRect(0%2C%200%2C%20crop.width%2C%20crop.height)%3B%0A%0A%20%20%20%20context.globalCompositeOperation%20%3D%20'destination-atop'%3B%0A%20%20%20%20context.drawImage(%0A%20%20%20%20%20%20%20%20texture.baseTexture.source%2C%0A%20%20%20%20%20%20%20%20crop.x%2C%0A%20%20%20%20%20%20%20%20crop.y%2C%0A%20%20%20%20%20%20%20%20crop.width%2C%0A%20%20%20%20%20%20%20%20crop.height%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20crop.width%2C%0A%20%20%20%20%20%20%20%20crop.height%0A%20%20%20%20)%3B%0A%0A%20%20%20%20%2F%2F%20context.globalCompositeOperation%20%3D%20'copy'%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Tint%20a%20texture%20pixel%20per%20pixel.%0A%20*%0A%20*%20%40param%20texture%20%7BPIXI.Texture%7D%20the%20texture%20to%20tint%0A%20*%20%40param%20color%20%7Bnumber%7D%20the%20color%20to%20use%20to%20tint%20the%20sprite%20with%0A%20*%20%40param%20canvas%20%7BHTMLCanvasElement%7D%20the%20current%20canvas%0A%20*%2F%0ACanvasTinter.tintWithPerPixel%20%3D%20function%20(texture%2C%20color%2C%20canvas)%0A%7B%0A%20%20%20%20var%20context%20%3D%20canvas.getContext(%20'2d'%20)%3B%0A%0A%20%20%20%20var%20resolution%20%3D%20texture.baseTexture.resolution%3B%0A%0A%20%20%20%20var%20crop%20%3D%20texture.crop.clone()%3B%0A%20%20%20%20crop.x%20*%3D%20resolution%3B%0A%20%20%20%20crop.y%20*%3D%20resolution%3B%0A%20%20%20%20crop.width%20*%3D%20resolution%3B%0A%20%20%20%20crop.height%20*%3D%20resolution%3B%0A%0A%20%20%20%20canvas.width%20%3D%20crop.width%3B%0A%20%20%20%20canvas.height%20%3D%20crop.height%3B%0A%0A%20%20%20%20context.globalCompositeOperation%20%3D%20'copy'%3B%0A%20%20%20%20context.drawImage(%0A%20%20%20%20%20%20%20%20texture.baseTexture.source%2C%0A%20%20%20%20%20%20%20%20crop.x%2C%0A%20%20%20%20%20%20%20%20crop.y%2C%0A%20%20%20%20%20%20%20%20crop.width%2C%0A%20%20%20%20%20%20%20%20crop.height%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20crop.width%2C%0A%20%20%20%20%20%20%20%20crop.height%0A%20%20%20%20)%3B%0A%0A%20%20%20%20var%20rgbValues%20%3D%20utils.hex2rgb(color)%3B%0A%20%20%20%20var%20r%20%3D%20rgbValues%5B0%5D%2C%20g%20%3D%20rgbValues%5B1%5D%2C%20b%20%3D%20rgbValues%5B2%5D%3B%0A%0A%20%20%20%20var%20pixelData%20%3D%20context.getImageData(0%2C%200%2C%20crop.width%2C%20crop.height)%3B%0A%0A%20%20%20%20var%20pixels%20%3D%20pixelData.data%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20pixels.length%3B%20i%20%2B%3D%204)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20pixels%5Bi%2B0%5D%20*%3D%20r%3B%0A%20%20%20%20%20%20%20%20pixels%5Bi%2B1%5D%20*%3D%20g%3B%0A%20%20%20%20%20%20%20%20pixels%5Bi%2B2%5D%20*%3D%20b%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20context.putImageData(pixelData%2C%200%2C%200)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Rounds%20the%20specified%20color%20according%20to%20the%20CanvasTinter.cacheStepsPerColorChannel.%0A%20*%0A%20*%20%40param%20color%20%7Bnumber%7D%20the%20color%20to%20round%2C%20should%20be%20a%20hex%20color%0A%20*%2F%0ACanvasTinter.roundColor%20%3D%20function%20(color)%0A%7B%0A%20%20%20%20var%20step%20%3D%20CanvasTinter.cacheStepsPerColorChannel%3B%0A%0A%20%20%20%20var%20rgbValues%20%3D%20utils.hex2rgb(color)%3B%0A%0A%20%20%20%20rgbValues%5B0%5D%20%3D%20Math.min(255%2C%20(rgbValues%5B0%5D%20%2F%20step)%20*%20step)%3B%0A%20%20%20%20rgbValues%5B1%5D%20%3D%20Math.min(255%2C%20(rgbValues%5B1%5D%20%2F%20step)%20*%20step)%3B%0A%20%20%20%20rgbValues%5B2%5D%20%3D%20Math.min(255%2C%20(rgbValues%5B2%5D%20%2F%20step)%20*%20step)%3B%0A%0A%20%20%20%20return%20utils.rgb2hex(rgbValues)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Number%20of%20steps%20which%20will%20be%20used%20as%20a%20cap%20when%20rounding%20colors.%0A%20*%0A%20*%20%40member%0A%20*%2F%0ACanvasTinter.cacheStepsPerColorChannel%20%3D%208%3B%0A%0A%2F**%0A%20*%20Tint%20cache%20boolean%20flag.%0A%20*%0A%20*%20%40member%0A%20*%2F%0ACanvasTinter.convertTintToImage%20%3D%20false%3B%0A%0A%2F**%0A%20*%20Whether%20or%20not%20the%20Canvas%20BlendModes%20are%20supported%2C%20consequently%20the%20ability%20to%20tint%20using%20the%20multiply%20method.%0A%20*%0A%20*%20%40member%0A%20*%2F%0ACanvasTinter.canUseMultiply%20%3D%20utils.canUseNewCanvasBlendModes()%3B%0A%0A%2F**%0A%20*%20The%20tinting%20method%20that%20will%20be%20used.%0A%20*%0A%20*%2F%0ACanvasTinter.tintMethod%20%3D%20CanvasTinter.canUseMultiply%20%3F%20CanvasTinter.tintWithMultiply%20%3A%20%20CanvasTinter.tintWithPerPixel%3B%0A%0A%7D%2C%7B%22..%2F..%2F..%2Futils%22%3A67%7D%5D%2C39%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20SystemRenderer%20%3D%20require('..%2FSystemRenderer')%2C%0A%20%20%20%20ShaderManager%20%3D%20require('.%2Fmanagers%2FShaderManager')%2C%0A%20%20%20%20MaskManager%20%3D%20require('.%2Fmanagers%2FMaskManager')%2C%0A%20%20%20%20StencilManager%20%3D%20require('.%2Fmanagers%2FStencilManager')%2C%0A%20%20%20%20FilterManager%20%3D%20require('.%2Fmanagers%2FFilterManager')%2C%0A%20%20%20%20BlendModeManager%20%3D%20require('.%2Fmanagers%2FBlendModeManager')%2C%0A%20%20%20%20RenderTarget%20%3D%20require('.%2Futils%2FRenderTarget')%2C%0A%20%20%20%20ObjectRenderer%20%3D%20require('.%2Futils%2FObjectRenderer')%2C%0A%20%20%20%20FXAAFilter%20%3D%20require('.%2Ffilters%2FFXAAFilter')%2C%0A%20%20%20%20utils%20%3D%20require('..%2F..%2Futils')%2C%0A%20%20%20%20CONST%20%3D%20require('..%2F..%2Fconst')%3B%0A%0A%2F**%0A%20*%20The%20WebGLRenderer%20draws%20the%20scene%20and%20all%20its%20content%20onto%20a%20webGL%20enabled%20canvas.%20This%20renderer%0A%20*%20should%20be%20used%20for%20browsers%20that%20support%20webGL.%20This%20Render%20works%20by%20automatically%20managing%20webGLBatchs.%0A%20*%20So%20no%20need%20for%20Sprite%20Batches%20or%20Sprite%20Clouds.%0A%20*%20Don't%20forget%20to%20add%20the%20view%20to%20your%20DOM%20or%20you%20will%20not%20see%20anything%20%3A)%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40extends%20PIXI.SystemRenderer%0A%20*%20%40param%20%5Bwidth%3D0%5D%20%7Bnumber%7D%20the%20width%20of%20the%20canvas%20view%0A%20*%20%40param%20%5Bheight%3D0%5D%20%7Bnumber%7D%20the%20height%20of%20the%20canvas%20view%0A%20*%20%40param%20%5Boptions%5D%20%7Bobject%7D%20The%20optional%20renderer%20parameters%0A%20*%20%40param%20%5Boptions.view%5D%20%7BHTMLCanvasElement%7D%20the%20canvas%20to%20use%20as%20a%20view%2C%20optional%0A%20*%20%40param%20%5Boptions.transparent%3Dfalse%5D%20%7Bboolean%7D%20If%20the%20render%20view%20is%20transparent%2C%20default%20false%0A%20*%20%40param%20%5Boptions.autoResize%3Dfalse%5D%20%7Bboolean%7D%20If%20the%20render%20view%20is%20automatically%20resized%2C%20default%20false%0A%20*%20%40param%20%5Boptions.antialias%3Dfalse%5D%20%7Bboolean%7D%20sets%20antialias.%20If%20not%20available%20natively%20then%20FXAA%20antialiasing%20is%20used%0A%20*%20%40param%20%5Boptions.forceFXAA%3Dfalse%5D%20%7Bboolean%7D%20forces%20FXAA%20antialiasing%20to%20be%20used%20over%20native.%20FXAA%20is%20faster%2C%20but%20may%20not%20always%20look%20as%20great%0A%20*%20%40param%20%5Boptions.resolution%3D1%5D%20%7Bnumber%7D%20the%20resolution%20of%20the%20renderer%20retina%20would%20be%202%0A%20*%20%40param%20%5Boptions.clearBeforeRender%3Dtrue%5D%20%7Bboolean%7D%20This%20sets%20if%20the%20CanvasRenderer%20will%20clear%20the%20canvas%20or%0A%20*%20%20%20%20%20%20not%20before%20the%20new%20render%20pass.%20If%20you%20wish%20to%20set%20this%20to%20false%2C%20you%20*must*%20set%20preserveDrawingBuffer%20to%20%60true%60.%0A%20*%20%40param%20%5Boptions.preserveDrawingBuffer%3Dfalse%5D%20%7Bboolean%7D%20enables%20drawing%20buffer%20preservation%2C%20enable%20this%20if%0A%20*%20%20%20%20%20%20you%20need%20to%20call%20toDataUrl%20on%20the%20webgl%20context.%0A%20*%20%40param%20%5Boptions.roundPixels%3Dfalse%5D%20%7Bboolean%7D%20If%20true%20Pixi%20will%20Math.floor()%20x%2Fy%20values%20when%20rendering%2C%20stopping%20pixel%20interpolation.%0A%20*%2F%0Afunction%20WebGLRenderer(width%2C%20height%2C%20options)%0A%7B%0A%20%20%20%20options%20%3D%20options%20%7C%7C%20%7B%7D%3B%0A%0A%20%20%20%20SystemRenderer.call(this%2C%20'WebGL'%2C%20width%2C%20height%2C%20options)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20type%20of%20this%20renderer%20as%20a%20standardised%20const%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.type%20%3D%20CONST.RENDERER_TYPE.WEBGL%3B%0A%0A%20%20%20%20this.handleContextLost%20%3D%20this.handleContextLost.bind(this)%3B%0A%20%20%20%20this.handleContextRestored%20%3D%20this.handleContextRestored.bind(this)%3B%0A%0A%20%20%20%20this.view.addEventListener('webglcontextlost'%2C%20this.handleContextLost%2C%20false)%3B%0A%20%20%20%20this.view.addEventListener('webglcontextrestored'%2C%20this.handleContextRestored%2C%20false)%3B%0A%0A%20%20%20%20%2F%2FTODO%20possibility%20to%20force%20FXAA%20as%20it%20may%20offer%20better%20performance%3F%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Does%20it%20use%20FXAA%20%3F%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._useFXAA%20%3D%20!!options.forceFXAA%20%26%26%20options.antialias%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20fxaa%20filter%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.FXAAFilter%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._FXAAFilter%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20options%20passed%20in%20to%20create%20a%20new%20webgl%20context.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bobject%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._contextOptions%20%3D%20%7B%0A%20%20%20%20%20%20%20%20alpha%3A%20this.transparent%2C%0A%20%20%20%20%20%20%20%20antialias%3A%20options.antialias%2C%0A%20%20%20%20%20%20%20%20premultipliedAlpha%3A%20this.transparent%20%26%26%20this.transparent%20!%3D%3D%20'notMultiplied'%2C%0A%20%20%20%20%20%20%20%20stencil%3A%20true%2C%0A%20%20%20%20%20%20%20%20preserveDrawingBuffer%3A%20options.preserveDrawingBuffer%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Counter%20for%20the%20number%20of%20draws%20made%20each%20frame%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.drawCount%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Deals%20with%20managing%20the%20shader%20programs%20and%20their%20attribs.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.ShaderManager%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.shaderManager%20%3D%20new%20ShaderManager(this)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Manages%20the%20masks%20using%20the%20stencil%20buffer.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.MaskManager%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.maskManager%20%3D%20new%20MaskManager(this)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Manages%20the%20stencil%20buffer.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.StencilManager%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.stencilManager%20%3D%20new%20StencilManager(this)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Manages%20the%20filters.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.FilterManager%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.filterManager%20%3D%20new%20FilterManager(this)%3B%0A%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Manages%20the%20blendModes%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.BlendModeManager%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.blendModeManager%20%3D%20new%20BlendModeManager(this)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Holds%20the%20current%20render%20target%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.RenderTarget%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.currentRenderTarget%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20currently%20active%20ObjectRenderer.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.ObjectRenderer%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.currentRenderer%20%3D%20new%20ObjectRenderer(this)%3B%0A%0A%20%20%20%20this.initPlugins()%3B%0A%0A%20%20%20%20%2F%2F%20initialize%20the%20context%20so%20it%20is%20ready%20for%20the%20managers.%0A%20%20%20%20this._createContext()%3B%0A%20%20%20%20this._initContext()%3B%0A%0A%20%20%20%20%2F%2F%20map%20some%20webGL%20blend%20modes..%0A%20%20%20%20this._mapGlModes()%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20An%20array%20of%20render%20targets%0A%20%20%20%20%20*%20%40member%20%7BPIXI.RenderTarget%5B%5D%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._renderTargetStack%20%3D%20%5B%5D%3B%0A%7D%0A%0A%2F%2F%20constructor%0AWebGLRenderer.prototype%20%3D%20Object.create(SystemRenderer.prototype)%3B%0AWebGLRenderer.prototype.constructor%20%3D%20WebGLRenderer%3B%0Amodule.exports%20%3D%20WebGLRenderer%3B%0Autils.pluginTarget.mixin(WebGLRenderer)%3B%0A%0AWebGLRenderer.glContextId%20%3D%200%3B%0A%0A%2F**%0A%20*%20Creates%20the%20gl%20context.%0A%20*%0A%20*%20%40private%0A%20*%2F%0AWebGLRenderer.prototype._createContext%20%3D%20function%20()%20%7B%0A%20%20%20%20var%20gl%20%3D%20this.view.getContext('webgl'%2C%20this._contextOptions)%20%7C%7C%20this.view.getContext('experimental-webgl'%2C%20this._contextOptions)%3B%0A%20%20%20%20this.gl%20%3D%20gl%3B%0A%0A%20%20%20%20if%20(!gl)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20fail%2C%20not%20able%20to%20get%20a%20context%0A%20%20%20%20%20%20%20%20throw%20new%20Error('This%20browser%20does%20not%20support%20webGL.%20Try%20using%20the%20canvas%20renderer')%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.glContextId%20%3D%20WebGLRenderer.glContextId%2B%2B%3B%0A%20%20%20%20gl.id%20%3D%20this.glContextId%3B%0A%20%20%20%20gl.renderer%20%3D%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Creates%20the%20WebGL%20context%0A%20*%0A%20*%20%40private%0A%20*%2F%0AWebGLRenderer.prototype._initContext%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.gl%3B%0A%0A%20%20%20%20%2F%2F%20set%20up%20the%20default%20pixi%20settings..%0A%20%20%20%20gl.disable(gl.DEPTH_TEST)%3B%0A%20%20%20%20gl.disable(gl.CULL_FACE)%3B%0A%20%20%20%20gl.enable(gl.BLEND)%3B%0A%0A%20%20%20%20this.renderTarget%20%3D%20new%20RenderTarget(gl%2C%20this.width%2C%20this.height%2C%20null%2C%20this.resolution%2C%20true)%3B%0A%0A%20%20%20%20this.setRenderTarget(this.renderTarget)%3B%0A%0A%20%20%20%20this.emit('context'%2C%20gl)%3B%0A%0A%20%20%20%20%2F%2F%20setup%20the%20width%2Fheight%20properties%20and%20gl%20viewport%0A%20%20%20%20this.resize(this.width%2C%20this.height)%3B%0A%0A%20%20%20%20if(!this._useFXAA)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this._useFXAA%20%3D%20(this._contextOptions.antialias%20%26%26%20!%20gl.getContextAttributes().antialias)%3B%0A%20%20%20%20%7D%0A%0A%0A%20%20%20%20if(this._useFXAA)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20window.console.warn('FXAA%20antialiasing%20being%20used%20instead%20of%20native%20antialiasing')%3B%0A%20%20%20%20%20%20%20%20this._FXAAFilter%20%3D%20%5Bnew%20FXAAFilter()%5D%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Renders%20the%20object%20to%20its%20webGL%20view%0A%20*%0A%20*%20%40param%20object%20%7BPIXI.DisplayObject%7D%20the%20object%20to%20be%20rendered%0A%20*%2F%0AWebGLRenderer.prototype.render%20%3D%20function%20(object)%0A%7B%0A%20%20%20%20%2F%2F%20no%20point%20rendering%20if%20our%20context%20has%20been%20blown%20up!%0A%20%20%20%20if%20(this.gl.isContextLost())%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.drawCount%20%3D%200%3B%0A%0A%20%20%20%20this._lastObjectRendered%20%3D%20object%3B%0A%0A%20%20%20%20if(this._useFXAA)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this._FXAAFilter%5B0%5D.uniforms.resolution.value.x%20%3D%20this.width%3B%0A%20%20%20%20%20%20%20%20this._FXAAFilter%5B0%5D.uniforms.resolution.value.y%20%3D%20this.height%3B%0A%20%20%20%20%20%20%20%20object.filterArea%20%3D%20this.renderTarget.size%3B%0A%20%20%20%20%20%20%20%20object.filters%20%3D%20this._FXAAFilter%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20cacheParent%20%3D%20object.parent%3B%0A%20%20%20%20object.parent%20%3D%20this._tempDisplayObjectParent%3B%0A%0A%20%20%20%20%2F%2F%20update%20the%20scene%20graph%0A%20%20%20%20object.updateTransform()%3B%0A%0A%20%20%20%20object.parent%20%3D%20cacheParent%3B%0A%0A%20%20%20%20var%20gl%20%3D%20this.gl%3B%0A%0A%20%20%20%20%2F%2F%20make%20sure%20we%20are%20bound%20to%20the%20main%20frame%20buffer%0A%20%20%20%20this.setRenderTarget(this.renderTarget)%3B%0A%0A%20%20%20%20if%20(this.clearBeforeRender)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(this.transparent)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.clearColor(0%2C%200%2C%200%2C%200)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.clearColor(this._backgroundColorRgb%5B0%5D%2C%20this._backgroundColorRgb%5B1%5D%2C%20this._backgroundColorRgb%5B2%5D%2C%201)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20gl.clear(gl.COLOR_BUFFER_BIT)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.renderDisplayObject(object%2C%20this.renderTarget)%3B%2F%2Fthis.projection)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Renders%20a%20Display%20Object.%0A%20*%0A%20*%20%40param%20displayObject%20%7BPIXI.DisplayObject%7D%20The%20DisplayObject%20to%20render%0A%20*%20%40param%20renderTarget%20%7BPIXI.RenderTarget%7D%20The%20render%20target%20to%20use%20to%20render%20this%20display%20object%0A%20*%0A%20*%2F%0AWebGLRenderer.prototype.renderDisplayObject%20%3D%20function%20(displayObject%2C%20renderTarget%2C%20clear)%2F%2Fprojection%2C%20buffer)%0A%7B%0A%20%20%20%20%2F%2F%20TODO%20is%20this%20needed...%0A%20%20%20%20%2F%2Fthis.blendModeManager.setBlendMode(CONST.BLEND_MODES.NORMAL)%3B%0A%20%20%20%20this.setRenderTarget(renderTarget)%3B%0A%0A%20%20%20%20if(clear)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20renderTarget.clear()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20start%20the%20filter%20manager%0A%20%20%20%20this.filterManager.setFilterStack(%20renderTarget.filterStack%20)%3B%0A%0A%20%20%20%20%2F%2F%20render%20the%20scene!%0A%20%20%20%20displayObject.renderWebGL(this)%3B%0A%0A%20%20%20%20%2F%2F%20finish%20the%20current%20renderer..%0A%20%20%20%20this.currentRenderer.flush()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Changes%20the%20current%20renderer%20to%20the%20one%20given%20in%20parameter%0A%20*%0A%20*%20%40param%20objectRenderer%20%7BPIXI.ObjectRenderer%7D%20The%20object%20renderer%20to%20use.%0A%20*%2F%0AWebGLRenderer.prototype.setObjectRenderer%20%3D%20function%20(objectRenderer)%0A%7B%0A%20%20%20%20if%20(this.currentRenderer%20%3D%3D%3D%20objectRenderer)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.currentRenderer.stop()%3B%0A%20%20%20%20this.currentRenderer%20%3D%20objectRenderer%3B%0A%20%20%20%20this.currentRenderer.start()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Changes%20the%20current%20render%20target%20to%20the%20one%20given%20in%20parameter%0A%20*%0A%20*%20%40param%20renderTarget%20%7BPIXI.RenderTarget%7D%20the%20new%20render%20target%0A%20*%2F%0AWebGLRenderer.prototype.setRenderTarget%20%3D%20function%20(renderTarget)%0A%7B%0A%20%20%20%20if(%20this.currentRenderTarget%20%3D%3D%3D%20renderTarget)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20%2F%2F%20TODO%20-%20maybe%20down%20the%20line%20this%20should%20be%20a%20push%20pos%20thing%3F%20Leaving%20for%20now%20though.%0A%20%20%20%20this.currentRenderTarget%20%3D%20renderTarget%3B%0A%20%20%20%20this.currentRenderTarget.activate()%3B%0A%20%20%20%20this.stencilManager.setMaskStack(%20renderTarget.stencilMaskStack%20)%3B%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Resizes%20the%20webGL%20view%20to%20the%20specified%20width%20and%20height.%0A%20*%0A%20*%20%40param%20width%20%7Bnumber%7D%20the%20new%20width%20of%20the%20webGL%20view%0A%20*%20%40param%20height%20%7Bnumber%7D%20the%20new%20height%20of%20the%20webGL%20view%0A%20*%2F%0AWebGLRenderer.prototype.resize%20%3D%20function%20(width%2C%20height)%0A%7B%0A%20%20%20%20SystemRenderer.prototype.resize.call(this%2C%20width%2C%20height)%3B%0A%0A%20%20%20%20this.filterManager.resize(width%2C%20height)%3B%0A%20%20%20%20this.renderTarget.resize(width%2C%20height)%3B%0A%0A%20%20%20%20if(this.currentRenderTarget%20%3D%3D%3D%20this.renderTarget)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.renderTarget.activate()%3B%0A%20%20%20%20%20%20%20%20this.gl.viewport(0%2C%200%2C%20this.width%2C%20this.height)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Updates%20and%2For%20Creates%20a%20WebGL%20texture%20for%20the%20renderer's%20context.%0A%20*%0A%20*%20%40param%20texture%20%7BPIXI.BaseTexture%7CPIXI.Texture%7D%20the%20texture%20to%20update%0A%20*%2F%0AWebGLRenderer.prototype.updateTexture%20%3D%20function%20(texture)%0A%7B%0A%20%20%20%20texture%20%3D%20texture.baseTexture%20%7C%7C%20texture%3B%0A%0A%20%20%20%20if%20(!texture.hasLoaded)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20gl%20%3D%20this.gl%3B%0A%0A%20%20%20%20if%20(!texture._glTextures%5Bgl.id%5D)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20texture._glTextures%5Bgl.id%5D%20%3D%20gl.createTexture()%3B%0A%20%20%20%20%20%20%20%20texture.on('update'%2C%20this.updateTexture%2C%20this)%3B%0A%20%20%20%20%20%20%20%20texture.on('dispose'%2C%20this.destroyTexture%2C%20this)%3B%0A%20%20%20%20%7D%0A%0A%0A%20%20%20%20gl.bindTexture(gl.TEXTURE_2D%2C%20texture._glTextures%5Bgl.id%5D)%3B%0A%0A%20%20%20%20gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL%2C%20texture.premultipliedAlpha)%3B%0A%20%20%20%20gl.texImage2D(gl.TEXTURE_2D%2C%200%2C%20gl.RGBA%2C%20gl.RGBA%2C%20gl.UNSIGNED_BYTE%2C%20texture.source)%3B%0A%0A%20%20%20%20gl.texParameteri(gl.TEXTURE_2D%2C%20gl.TEXTURE_MAG_FILTER%2C%20texture.scaleMode%20%3D%3D%3D%20CONST.SCALE_MODES.LINEAR%20%3F%20gl.LINEAR%20%3A%20gl.NEAREST)%3B%0A%0A%0A%20%20%20%20if%20(texture.mipmap%20%26%26%20texture.isPowerOfTwo)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20gl.texParameteri(gl.TEXTURE_2D%2C%20gl.TEXTURE_MIN_FILTER%2C%20texture.scaleMode%20%3D%3D%3D%20CONST.SCALE_MODES.LINEAR%20%3F%20gl.LINEAR_MIPMAP_LINEAR%20%3A%20gl.NEAREST_MIPMAP_NEAREST)%3B%0A%20%20%20%20%20%20%20%20gl.generateMipmap(gl.TEXTURE_2D)%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20gl.texParameteri(gl.TEXTURE_2D%2C%20gl.TEXTURE_MIN_FILTER%2C%20texture.scaleMode%20%3D%3D%3D%20CONST.SCALE_MODES.LINEAR%20%3F%20gl.LINEAR%20%3A%20gl.NEAREST)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(!texture.isPowerOfTwo)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20gl.texParameteri(gl.TEXTURE_2D%2C%20gl.TEXTURE_WRAP_S%2C%20gl.CLAMP_TO_EDGE)%3B%0A%20%20%20%20%20%20%20%20gl.texParameteri(gl.TEXTURE_2D%2C%20gl.TEXTURE_WRAP_T%2C%20gl.CLAMP_TO_EDGE)%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20gl.texParameteri(gl.TEXTURE_2D%2C%20gl.TEXTURE_WRAP_S%2C%20gl.REPEAT)%3B%0A%20%20%20%20%20%20%20%20gl.texParameteri(gl.TEXTURE_2D%2C%20gl.TEXTURE_WRAP_T%2C%20gl.REPEAT)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20%20texture._glTextures%5Bgl.id%5D%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Deletes%20the%20texture%20from%20WebGL%0A%20*%0A%20*%20%40param%20texture%20%7BPIXI.BaseTexture%7CPIXI.Texture%7D%20the%20texture%20to%20destroy%0A%20*%2F%0AWebGLRenderer.prototype.destroyTexture%20%3D%20function%20(texture)%0A%7B%0A%20%20%20%20texture%20%3D%20texture.baseTexture%20%7C%7C%20texture%3B%0A%0A%20%20%20%20if%20(!texture.hasLoaded)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(texture._glTextures%5Bthis.gl.id%5D)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.gl.deleteTexture(texture._glTextures%5Bthis.gl.id%5D)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Handles%20a%20lost%20webgl%20context%0A%20*%0A%20*%20%40private%0A%20*%2F%0AWebGLRenderer.prototype.handleContextLost%20%3D%20function%20(event)%0A%7B%0A%20%20%20%20event.preventDefault()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Handles%20a%20restored%20webgl%20context%0A%20*%0A%20*%20%40private%0A%20*%2F%0AWebGLRenderer.prototype.handleContextRestored%20%3D%20function%20()%0A%7B%0A%20%20%20%20this._initContext()%3B%0A%0A%20%20%20%20%2F%2F%20empty%20all%20the%20old%20gl%20textures%20as%20they%20are%20useless%20now%0A%20%20%20%20for%20(var%20key%20in%20utils.BaseTextureCache)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20utils.BaseTextureCache%5Bkey%5D._glTextures.length%20%3D%200%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Removes%20everything%20from%20the%20renderer%20(event%20listeners%2C%20spritebatch%2C%20etc...)%0A%20*%0A%20*%20%40param%20%5BremoveView%3Dfalse%5D%20%7Bboolean%7D%20Removes%20the%20Canvas%20element%20from%20the%20DOM.%0A%20*%2F%0AWebGLRenderer.prototype.destroy%20%3D%20function%20(removeView)%0A%7B%0A%20%20%20%20this.destroyPlugins()%3B%0A%0A%20%20%20%20%2F%2F%20remove%20listeners%0A%20%20%20%20this.view.removeEventListener('webglcontextlost'%2C%20this.handleContextLost)%3B%0A%20%20%20%20this.view.removeEventListener('webglcontextrestored'%2C%20this.handleContextRestored)%3B%0A%0A%20%20%20%20for%20(var%20key%20in%20utils.BaseTextureCache)%20%7B%0A%20%20%20%20%20%20%20%20var%20texture%20%3D%20utils.BaseTextureCache%5Bkey%5D%3B%0A%20%20%20%20%20%20%20%20texture.off('update'%2C%20this.updateTexture%2C%20this)%3B%0A%20%20%20%20%20%20%20%20texture.off('dispose'%2C%20this.destroyTexture%2C%20this)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20call%20base%20destroy%0A%20%20%20%20SystemRenderer.prototype.destroy.call(this%2C%20removeView)%3B%0A%0A%20%20%20%20this.uid%20%3D%200%3B%0A%0A%20%20%20%20%2F%2F%20destroy%20the%20managers%0A%20%20%20%20this.shaderManager.destroy()%3B%0A%20%20%20%20this.maskManager.destroy()%3B%0A%20%20%20%20this.stencilManager.destroy()%3B%0A%20%20%20%20this.filterManager.destroy()%3B%0A%20%20%20%20this.blendModeManager.destroy()%3B%0A%0A%20%20%20%20this.shaderManager%20%3D%20null%3B%0A%20%20%20%20this.maskManager%20%3D%20null%3B%0A%20%20%20%20this.filterManager%20%3D%20null%3B%0A%20%20%20%20this.blendModeManager%20%3D%20null%3B%0A%20%20%20%20this.currentRenderer%20%3D%20null%3B%0A%0A%20%20%20%20this.handleContextLost%20%3D%20null%3B%0A%20%20%20%20this.handleContextRestored%20%3D%20null%3B%0A%0A%20%20%20%20this._contextOptions%20%3D%20null%3B%0A%0A%20%20%20%20this.drawCount%20%3D%200%3B%0A%0A%20%20%20%20this.gl.useProgram(null)%3B%0A%0A%20%20%20%20this.gl%20%3D%20null%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Maps%20Pixi%20blend%20modes%20to%20WebGL%20blend%20modes.%0A%20*%0A%20*%20%40private%0A%20*%2F%0AWebGLRenderer.prototype._mapGlModes%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.gl%3B%0A%0A%20%20%20%20if%20(!this.blendModes)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.blendModes%20%3D%20%7B%7D%3B%0A%0A%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.NORMAL%5D%20%20%20%20%20%20%20%20%3D%20%5Bgl.ONE%2C%20%20%20%20%20%20%20gl.ONE_MINUS_SRC_ALPHA%5D%3B%0A%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.ADD%5D%20%20%20%20%20%20%20%20%20%20%20%3D%20%5Bgl.SRC_ALPHA%2C%20gl.DST_ALPHA%5D%3B%0A%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.MULTIPLY%5D%20%20%20%20%20%20%3D%20%5Bgl.DST_COLOR%2C%20gl.ONE_MINUS_SRC_ALPHA%5D%3B%0A%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.SCREEN%5D%20%20%20%20%20%20%20%20%3D%20%5Bgl.SRC_ALPHA%2C%20gl.ONE%5D%3B%0A%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.OVERLAY%5D%20%20%20%20%20%20%20%3D%20%5Bgl.ONE%2C%20%20%20%20%20%20%20gl.ONE_MINUS_SRC_ALPHA%5D%3B%0A%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.DARKEN%5D%20%20%20%20%20%20%20%20%3D%20%5Bgl.ONE%2C%20%20%20%20%20%20%20gl.ONE_MINUS_SRC_ALPHA%5D%3B%0A%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.LIGHTEN%5D%20%20%20%20%20%20%20%3D%20%5Bgl.ONE%2C%20%20%20%20%20%20%20gl.ONE_MINUS_SRC_ALPHA%5D%3B%0A%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.COLOR_DODGE%5D%20%20%20%3D%20%5Bgl.ONE%2C%20%20%20%20%20%20%20gl.ONE_MINUS_SRC_ALPHA%5D%3B%0A%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.COLOR_BURN%5D%20%20%20%20%3D%20%5Bgl.ONE%2C%20%20%20%20%20%20%20gl.ONE_MINUS_SRC_ALPHA%5D%3B%0A%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.HARD_LIGHT%5D%20%20%20%20%3D%20%5Bgl.ONE%2C%20%20%20%20%20%20%20gl.ONE_MINUS_SRC_ALPHA%5D%3B%0A%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.SOFT_LIGHT%5D%20%20%20%20%3D%20%5Bgl.ONE%2C%20%20%20%20%20%20%20gl.ONE_MINUS_SRC_ALPHA%5D%3B%0A%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.DIFFERENCE%5D%20%20%20%20%3D%20%5Bgl.ONE%2C%20%20%20%20%20%20%20gl.ONE_MINUS_SRC_ALPHA%5D%3B%0A%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.EXCLUSION%5D%20%20%20%20%20%3D%20%5Bgl.ONE%2C%20%20%20%20%20%20%20gl.ONE_MINUS_SRC_ALPHA%5D%3B%0A%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.HUE%5D%20%20%20%20%20%20%20%20%20%20%20%3D%20%5Bgl.ONE%2C%20%20%20%20%20%20%20gl.ONE_MINUS_SRC_ALPHA%5D%3B%0A%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.SATURATION%5D%20%20%20%20%3D%20%5Bgl.ONE%2C%20%20%20%20%20%20%20gl.ONE_MINUS_SRC_ALPHA%5D%3B%0A%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.COLOR%5D%20%20%20%20%20%20%20%20%20%3D%20%5Bgl.ONE%2C%20%20%20%20%20%20%20gl.ONE_MINUS_SRC_ALPHA%5D%3B%0A%20%20%20%20%20%20%20%20this.blendModes%5BCONST.BLEND_MODES.LUMINOSITY%5D%20%20%20%20%3D%20%5Bgl.ONE%2C%20%20%20%20%20%20%20gl.ONE_MINUS_SRC_ALPHA%5D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(!this.drawModes)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.drawModes%20%3D%20%7B%7D%3B%0A%0A%20%20%20%20%20%20%20%20this.drawModes%5BCONST.DRAW_MODES.POINTS%5D%20%20%20%20%20%20%20%20%20%3D%20gl.POINTS%3B%0A%20%20%20%20%20%20%20%20this.drawModes%5BCONST.DRAW_MODES.LINES%5D%20%20%20%20%20%20%20%20%20%20%3D%20gl.LINES%3B%0A%20%20%20%20%20%20%20%20this.drawModes%5BCONST.DRAW_MODES.LINE_LOOP%5D%20%20%20%20%20%20%3D%20gl.LINE_LOOP%3B%0A%20%20%20%20%20%20%20%20this.drawModes%5BCONST.DRAW_MODES.LINE_STRIP%5D%20%20%20%20%20%3D%20gl.LINE_STRIP%3B%0A%20%20%20%20%20%20%20%20this.drawModes%5BCONST.DRAW_MODES.TRIANGLES%5D%20%20%20%20%20%20%3D%20gl.TRIANGLES%3B%0A%20%20%20%20%20%20%20%20this.drawModes%5BCONST.DRAW_MODES.TRIANGLE_STRIP%5D%20%3D%20gl.TRIANGLE_STRIP%3B%0A%20%20%20%20%20%20%20%20this.drawModes%5BCONST.DRAW_MODES.TRIANGLE_FAN%5D%20%20%20%3D%20gl.TRIANGLE_FAN%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%7D%2C%7B%22..%2F..%2Fconst%22%3A13%2C%22..%2F..%2Futils%22%3A67%2C%22..%2FSystemRenderer%22%3A33%2C%22.%2Ffilters%2FFXAAFilter%22%3A41%2C%22.%2Fmanagers%2FBlendModeManager%22%3A43%2C%22.%2Fmanagers%2FFilterManager%22%3A44%2C%22.%2Fmanagers%2FMaskManager%22%3A45%2C%22.%2Fmanagers%2FShaderManager%22%3A46%2C%22.%2Fmanagers%2FStencilManager%22%3A47%2C%22.%2Futils%2FObjectRenderer%22%3A53%2C%22.%2Futils%2FRenderTarget%22%3A55%7D%5D%2C40%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20DefaultShader%20%3D%20require('..%2Fshaders%2FTextureShader')%3B%0A%0A%2F**%0A%20*%20This%20is%20the%20base%20class%20for%20creating%20a%20PIXI%20filter.%20Currently%20only%20WebGL%20supports%20filters.%0A%20*%20If%20you%20want%20to%20make%20a%20custom%20filter%20this%20should%20be%20your%20base%20class.%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20vertexSrc%20%7Bstring%7Cstring%5B%5D%7D%20The%20vertex%20shader%20source%20as%20an%20array%20of%20strings.%0A%20*%20%40param%20fragmentSrc%20%7Bstring%7Cstring%5B%5D%7D%20The%20fragment%20shader%20source%20as%20an%20array%20of%20strings.%0A%20*%20%40param%20uniforms%20%7Bobject%7D%20An%20object%20containing%20the%20uniforms%20for%20this%20filter.%0A%20*%2F%0Afunction%20AbstractFilter(vertexSrc%2C%20fragmentSrc%2C%20uniforms)%0A%7B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20An%20array%20of%20shaders%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Shader%5B%5D%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.shaders%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20extra%20padding%20that%20the%20filter%20might%20need%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.padding%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20uniforms%20as%20an%20object%0A%20%20%20%20%20*%20%40member%20%7Bobject%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.uniforms%20%3D%20uniforms%20%7C%7C%20%7B%7D%3B%0A%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20code%20of%20the%20vertex%20shader%0A%20%20%20%20%20*%20%40member%20%7Bstring%5B%5D%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.vertexSrc%20%3D%20vertexSrc%20%7C%7C%20DefaultShader.defaultVertexSrc%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20code%20of%20the%20frament%20shader%0A%20%20%20%20%20*%20%40member%20%7Bstring%5B%5D%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.fragmentSrc%20%3D%20fragmentSrc%20%7C%7C%20DefaultShader.defaultFragmentSrc%3B%0A%0A%20%20%20%20%2F%2FTODO%20a%20reminder%20-%20would%20be%20cool%20to%20have%20lower%20res%20filters%20as%20this%20would%20give%20better%20performance.%0A%0A%20%20%20%20%2F%2Ftypeof%20fragmentSrc%20%3D%3D%3D%20'string'%20%3F%20fragmentSrc.split('')%20%3A%20(fragmentSrc%20%7C%7C%20%5B%5D)%3B%0A%0A%7D%0A%0AAbstractFilter.prototype.constructor%20%3D%20AbstractFilter%3B%0Amodule.exports%20%3D%20AbstractFilter%3B%0A%0A%2F**%0A%20*%20Grabs%20a%20shader%20from%20the%20current%20renderer%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20The%20renderer%20to%20retrieve%20the%20shader%20from%0A%20*%2F%0AAbstractFilter.prototype.getShader%20%3D%20function%20(renderer)%0A%7B%0A%20%20%20%20var%20gl%20%3D%20renderer.gl%3B%0A%0A%20%20%20%20var%20shader%20%3D%20this.shaders%5Bgl.id%5D%3B%0A%0A%20%20%20%20if%20(!shader)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20shader%20%3D%20new%20DefaultShader(renderer.shaderManager%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20this.vertexSrc%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20this.fragmentSrc%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20this.attributes%0A%20%20%20%20%20%20%20%20)%3B%0A%0A%20%20%20%20%20%20%20%20this.shaders%5Bgl.id%5D%20%3D%20shader%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20shader%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Applies%20the%20filter%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20The%20renderer%20to%20retrieve%20the%20filter%20from%0A%20*%20%40param%20input%20%7BPIXI.RenderTarget%7D%0A%20*%20%40param%20output%20%7BPIXI.RenderTarget%7D%0A%20*%20%40param%20clear%20%7Bboolean%7D%20Whether%20or%20not%20we%20want%20to%20clear%20the%20outputTarget%0A%20*%2F%0AAbstractFilter.prototype.applyFilter%20%3D%20function%20(renderer%2C%20input%2C%20output%2C%20clear)%0A%7B%0A%20%20%20%20var%20shader%20%3D%20this.getShader(renderer)%3B%0A%0A%20%20%20%20renderer.filterManager.applyFilter(shader%2C%20input%2C%20output%2C%20clear)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Syncs%20a%20uniform%20between%20the%20class%20object%20and%20the%20shaders.%0A%20*%0A%20*%2F%0AAbstractFilter.prototype.syncUniform%20%3D%20function%20(uniform)%0A%7B%0A%20%20%20%20for%20(var%20i%20%3D%200%2C%20j%20%3D%20this.shaders.length%3B%20i%20%3C%20j%3B%20%2B%2Bi)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.shaders%5Bi%5D.syncUniform(uniform)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fshaders%2FTextureShader%22%3A52%7D%5D%2C41%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20AbstractFilter%20%3D%20require('.%2FAbstractFilter')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%0A%20*%20Basic%20FXAA%20implementation%20based%20on%20the%20code%20on%20geeks3d.com%20with%20the%0A%20*%20modification%20that%20the%20texture2DLod%20stuff%20was%20removed%20since%20it's%0A%20*%20unsupported%20by%20WebGL.%0A%20*%0A%20*%20--%0A%20*%20From%3A%0A%20*%20https%3A%2F%2Fgithub.com%2Fmitsuhiko%2Fwebgl-meincraft%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI%0A%20*%0A%20*%2F%0Afunction%20FXAAFilter()%0A%7B%0A%20%20%20%20AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20%22%5Cnprecision%20mediump%20float%3B%5Cn%5Cnattribute%20vec2%20aVertexPosition%3B%5Cnattribute%20vec2%20aTextureCoord%3B%5Cnattribute%20vec4%20aColor%3B%5Cn%5Cnuniform%20mat3%20projectionMatrix%3B%5Cnuniform%20vec2%20resolution%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cnvarying%20vec4%20vColor%3B%5Cn%5Cnvarying%20vec2%20vResolution%3B%5Cn%5Cn%2F%2Ftexcoords%20computed%20in%20vertex%20step%5Cn%2F%2Fto%20avoid%20dependent%20texture%20reads%5Cnvarying%20vec2%20v_rgbNW%3B%5Cnvarying%20vec2%20v_rgbNE%3B%5Cnvarying%20vec2%20v_rgbSW%3B%5Cnvarying%20vec2%20v_rgbSE%3B%5Cnvarying%20vec2%20v_rgbM%3B%5Cn%5Cn%5Cnvoid%20texcoords(vec2%20fragCoord%2C%20vec2%20resolution%2C%5Cn%20%20%20%20%20%20%20%20%20%20%20%20out%20vec2%20v_rgbNW%2C%20out%20vec2%20v_rgbNE%2C%5Cn%20%20%20%20%20%20%20%20%20%20%20%20out%20vec2%20v_rgbSW%2C%20out%20vec2%20v_rgbSE%2C%5Cn%20%20%20%20%20%20%20%20%20%20%20%20out%20vec2%20v_rgbM)%20%7B%5Cn%20%20%20%20vec2%20inverseVP%20%3D%201.0%20%2F%20resolution.xy%3B%5Cn%20%20%20%20v_rgbNW%20%3D%20(fragCoord%20%2B%20vec2(-1.0%2C%20-1.0))%20*%20inverseVP%3B%5Cn%20%20%20%20v_rgbNE%20%3D%20(fragCoord%20%2B%20vec2(1.0%2C%20-1.0))%20*%20inverseVP%3B%5Cn%20%20%20%20v_rgbSW%20%3D%20(fragCoord%20%2B%20vec2(-1.0%2C%201.0))%20*%20inverseVP%3B%5Cn%20%20%20%20v_rgbSE%20%3D%20(fragCoord%20%2B%20vec2(1.0%2C%201.0))%20*%20inverseVP%3B%5Cn%20%20%20%20v_rgbM%20%3D%20vec2(fragCoord%20*%20inverseVP)%3B%5Cn%7D%5Cn%5Cnvoid%20main(void)%7B%5Cn%20%20%20gl_Position%20%3D%20vec4((projectionMatrix%20*%20vec3(aVertexPosition%2C%201.0)).xy%2C%200.0%2C%201.0)%3B%5Cn%20%20%20vTextureCoord%20%3D%20aTextureCoord%3B%5Cn%20%20%20vColor%20%3D%20vec4(aColor.rgb%20*%20aColor.a%2C%20aColor.a)%3B%5Cn%20%20%20vResolution%20%3D%20resolution%3B%5Cn%5Cn%20%20%20%2F%2Fcompute%20the%20texture%20coords%20and%20send%20them%20to%20varyings%5Cn%20%20%20texcoords(aTextureCoord%20*%20resolution%2C%20resolution%2C%20v_rgbNW%2C%20v_rgbNE%2C%20v_rgbSW%2C%20v_rgbSE%2C%20v_rgbM)%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20lowp%20float%3B%5Cn%5Cn%5Cn%2F**%5CnBasic%20FXAA%20implementation%20based%20on%20the%20code%20on%20geeks3d.com%20with%20the%5Cnmodification%20that%20the%20texture2DLod%20stuff%20was%20removed%20since%20it's%5Cnunsupported%20by%20WebGL.%5Cn%5Cn--%5Cn%5CnFrom%3A%5Cnhttps%3A%2F%2Fgithub.com%2Fmitsuhiko%2Fwebgl-meincraft%5Cn%5CnCopyright%20(c)%202011%20by%20Armin%20Ronacher.%5Cn%5CnSome%20rights%20reserved.%5Cn%5CnRedistribution%20and%20use%20in%20source%20and%20binary%20forms%2C%20with%20or%20without%5Cnmodification%2C%20are%20permitted%20provided%20that%20the%20following%20conditions%20are%5Cnmet%3A%5Cn%5Cn%20%20%20%20*%20Redistributions%20of%20source%20code%20must%20retain%20the%20above%20copyright%5Cn%20%20%20%20%20%20notice%2C%20this%20list%20of%20conditions%20and%20the%20following%20disclaimer.%5Cn%5Cn%20%20%20%20*%20Redistributions%20in%20binary%20form%20must%20reproduce%20the%20above%5Cn%20%20%20%20%20%20copyright%20notice%2C%20this%20list%20of%20conditions%20and%20the%20following%5Cn%20%20%20%20%20%20disclaimer%20in%20the%20documentation%20and%2For%20other%20materials%20provided%5Cn%20%20%20%20%20%20with%20the%20distribution.%5Cn%5Cn%20%20%20%20*%20The%20names%20of%20the%20contributors%20may%20not%20be%20used%20to%20endorse%20or%5Cn%20%20%20%20%20%20promote%20products%20derived%20from%20this%20software%20without%20specific%5Cn%20%20%20%20%20%20prior%20written%20permission.%5Cn%5CnTHIS%20SOFTWARE%20IS%20PROVIDED%20BY%20THE%20COPYRIGHT%20HOLDERS%20AND%20CONTRIBUTORS%5Cn%5C%22AS%20IS%5C%22%20AND%20ANY%20EXPRESS%20OR%20IMPLIED%20WARRANTIES%2C%20INCLUDING%2C%20BUT%20NOT%5CnLIMITED%20TO%2C%20THE%20IMPLIED%20WARRANTIES%20OF%20MERCHANTABILITY%20AND%20FITNESS%20FOR%5CnA%20PARTICULAR%20PURPOSE%20ARE%20DISCLAIMED.%20IN%20NO%20EVENT%20SHALL%20THE%20COPYRIGHT%5CnOWNER%20OR%20CONTRIBUTORS%20BE%20LIABLE%20FOR%20ANY%20DIRECT%2C%20INDIRECT%2C%20INCIDENTAL%2C%5CnSPECIAL%2C%20EXEMPLARY%2C%20OR%20CONSEQUENTIAL%20DAMAGES%20(INCLUDING%2C%20BUT%20NOT%5CnLIMITED%20TO%2C%20PROCUREMENT%20OF%20SUBSTITUTE%20GOODS%20OR%20SERVICES%3B%20LOSS%20OF%20USE%2C%5CnDATA%2C%20OR%20PROFITS%3B%20OR%20BUSINESS%20INTERRUPTION)%20HOWEVER%20CAUSED%20AND%20ON%20ANY%5CnTHEORY%20OF%20LIABILITY%2C%20WHETHER%20IN%20CONTRACT%2C%20STRICT%20LIABILITY%2C%20OR%20TORT%5Cn(INCLUDING%20NEGLIGENCE%20OR%20OTHERWISE)%20ARISING%20IN%20ANY%20WAY%20OUT%20OF%20THE%20USE%5CnOF%20THIS%20SOFTWARE%2C%20EVEN%20IF%20ADVISED%20OF%20THE%20POSSIBILITY%20OF%20SUCH%20DAMAGE.%5Cn*%2F%5Cn%5Cn%23ifndef%20FXAA_REDUCE_MIN%5Cn%20%20%20%20%23define%20FXAA_REDUCE_MIN%20%20%20(1.0%2F%20128.0)%5Cn%23endif%5Cn%23ifndef%20FXAA_REDUCE_MUL%5Cn%20%20%20%20%23define%20FXAA_REDUCE_MUL%20%20%20(1.0%20%2F%208.0)%5Cn%23endif%5Cn%23ifndef%20FXAA_SPAN_MAX%5Cn%20%20%20%20%23define%20FXAA_SPAN_MAX%20%20%20%20%208.0%5Cn%23endif%5Cn%5Cn%2F%2Foptimized%20version%20for%20mobile%2C%20where%20dependent%5Cn%2F%2Ftexture%20reads%20can%20be%20a%20bottleneck%5Cnvec4%20fxaa(sampler2D%20tex%2C%20vec2%20fragCoord%2C%20vec2%20resolution%2C%5Cn%20%20%20%20%20%20%20%20%20%20%20%20vec2%20v_rgbNW%2C%20vec2%20v_rgbNE%2C%5Cn%20%20%20%20%20%20%20%20%20%20%20%20vec2%20v_rgbSW%2C%20vec2%20v_rgbSE%2C%5Cn%20%20%20%20%20%20%20%20%20%20%20%20vec2%20v_rgbM)%20%7B%5Cn%20%20%20%20vec4%20color%3B%5Cn%20%20%20%20mediump%20vec2%20inverseVP%20%3D%20vec2(1.0%20%2F%20resolution.x%2C%201.0%20%2F%20resolution.y)%3B%5Cn%20%20%20%20vec3%20rgbNW%20%3D%20texture2D(tex%2C%20v_rgbNW).xyz%3B%5Cn%20%20%20%20vec3%20rgbNE%20%3D%20texture2D(tex%2C%20v_rgbNE).xyz%3B%5Cn%20%20%20%20vec3%20rgbSW%20%3D%20texture2D(tex%2C%20v_rgbSW).xyz%3B%5Cn%20%20%20%20vec3%20rgbSE%20%3D%20texture2D(tex%2C%20v_rgbSE).xyz%3B%5Cn%20%20%20%20vec4%20texColor%20%3D%20texture2D(tex%2C%20v_rgbM)%3B%5Cn%20%20%20%20vec3%20rgbM%20%20%3D%20texColor.xyz%3B%5Cn%20%20%20%20vec3%20luma%20%3D%20vec3(0.299%2C%200.587%2C%200.114)%3B%5Cn%20%20%20%20float%20lumaNW%20%3D%20dot(rgbNW%2C%20luma)%3B%5Cn%20%20%20%20float%20lumaNE%20%3D%20dot(rgbNE%2C%20luma)%3B%5Cn%20%20%20%20float%20lumaSW%20%3D%20dot(rgbSW%2C%20luma)%3B%5Cn%20%20%20%20float%20lumaSE%20%3D%20dot(rgbSE%2C%20luma)%3B%5Cn%20%20%20%20float%20lumaM%20%20%3D%20dot(rgbM%2C%20%20luma)%3B%5Cn%20%20%20%20float%20lumaMin%20%3D%20min(lumaM%2C%20min(min(lumaNW%2C%20lumaNE)%2C%20min(lumaSW%2C%20lumaSE)))%3B%5Cn%20%20%20%20float%20lumaMax%20%3D%20max(lumaM%2C%20max(max(lumaNW%2C%20lumaNE)%2C%20max(lumaSW%2C%20lumaSE)))%3B%5Cn%5Cn%20%20%20%20mediump%20vec2%20dir%3B%5Cn%20%20%20%20dir.x%20%3D%20-((lumaNW%20%2B%20lumaNE)%20-%20(lumaSW%20%2B%20lumaSE))%3B%5Cn%20%20%20%20dir.y%20%3D%20%20((lumaNW%20%2B%20lumaSW)%20-%20(lumaNE%20%2B%20lumaSE))%3B%5Cn%5Cn%20%20%20%20float%20dirReduce%20%3D%20max((lumaNW%20%2B%20lumaNE%20%2B%20lumaSW%20%2B%20lumaSE)%20*%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(0.25%20*%20FXAA_REDUCE_MUL)%2C%20FXAA_REDUCE_MIN)%3B%5Cn%5Cn%20%20%20%20float%20rcpDirMin%20%3D%201.0%20%2F%20(min(abs(dir.x)%2C%20abs(dir.y))%20%2B%20dirReduce)%3B%5Cn%20%20%20%20dir%20%3D%20min(vec2(FXAA_SPAN_MAX%2C%20FXAA_SPAN_MAX)%2C%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20max(vec2(-FXAA_SPAN_MAX%2C%20-FXAA_SPAN_MAX)%2C%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20dir%20*%20rcpDirMin))%20*%20inverseVP%3B%5Cn%5Cn%20%20%20%20vec3%20rgbA%20%3D%200.5%20*%20(%5Cn%20%20%20%20%20%20%20%20texture2D(tex%2C%20fragCoord%20*%20inverseVP%20%2B%20dir%20*%20(1.0%20%2F%203.0%20-%200.5)).xyz%20%2B%5Cn%20%20%20%20%20%20%20%20texture2D(tex%2C%20fragCoord%20*%20inverseVP%20%2B%20dir%20*%20(2.0%20%2F%203.0%20-%200.5)).xyz)%3B%5Cn%20%20%20%20vec3%20rgbB%20%3D%20rgbA%20*%200.5%20%2B%200.25%20*%20(%5Cn%20%20%20%20%20%20%20%20texture2D(tex%2C%20fragCoord%20*%20inverseVP%20%2B%20dir%20*%20-0.5).xyz%20%2B%5Cn%20%20%20%20%20%20%20%20texture2D(tex%2C%20fragCoord%20*%20inverseVP%20%2B%20dir%20*%200.5).xyz)%3B%5Cn%5Cn%20%20%20%20float%20lumaB%20%3D%20dot(rgbB%2C%20luma)%3B%5Cn%20%20%20%20if%20((lumaB%20%3C%20lumaMin)%20%7C%7C%20(lumaB%20%3E%20lumaMax))%5Cn%20%20%20%20%20%20%20%20color%20%3D%20vec4(rgbA%2C%20texColor.a)%3B%5Cn%20%20%20%20else%5Cn%20%20%20%20%20%20%20%20color%20%3D%20vec4(rgbB%2C%20texColor.a)%3B%5Cn%20%20%20%20return%20color%3B%5Cn%7D%5Cn%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cnvarying%20vec4%20vColor%3B%5Cnvarying%20vec2%20vResolution%3B%5Cn%5Cn%2F%2Ftexcoords%20computed%20in%20vertex%20step%5Cn%2F%2Fto%20avoid%20dependent%20texture%20reads%5Cnvarying%20vec2%20v_rgbNW%3B%5Cnvarying%20vec2%20v_rgbNE%3B%5Cnvarying%20vec2%20v_rgbSW%3B%5Cnvarying%20vec2%20v_rgbSE%3B%5Cnvarying%20vec2%20v_rgbM%3B%5Cn%5Cnuniform%20sampler2D%20uSampler%3B%5Cn%5Cn%5Cnvoid%20main(void)%7B%5Cn%5Cn%20%20%20%20gl_FragColor%20%3D%20fxaa(uSampler%2C%20vTextureCoord%20*%20vResolution%2C%20vResolution%2C%20v_rgbNW%2C%20v_rgbNE%2C%20v_rgbSW%2C%20v_rgbSE%2C%20v_rgbM)%3B%5Cn%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20resolution%3A%20%7B%20type%3A%20'v2'%2C%20value%3A%20%7B%20x%3A%201%2C%20y%3A%201%20%7D%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%0A%7D%0A%0AFXAAFilter.prototype%20%3D%20Object.create(AbstractFilter.prototype)%3B%0AFXAAFilter.prototype.constructor%20%3D%20FXAAFilter%3B%0Amodule.exports%20%3D%20FXAAFilter%3B%0A%0A%2F**%0A%20*%20Applies%20the%20filter%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20The%20renderer%20to%20retrieve%20the%20filter%20from%0A%20*%20%40param%20input%20%7BPIXI.RenderTarget%7D%0A%20*%20%40param%20output%20%7BPIXI.RenderTarget%7D%0A%20*%2F%0AFXAAFilter.prototype.applyFilter%20%3D%20function%20(renderer%2C%20input%2C%20output)%0A%7B%0A%20%20%20%20var%20filterManager%20%3D%20renderer.filterManager%3B%0A%0A%20%20%20%20var%20shader%20%3D%20this.getShader(%20renderer%20)%3B%0A%20%20%20%20%20%2F%2F%20draw%20the%20filter...%0A%20%20%20%20filterManager.applyFilter(shader%2C%20input%2C%20output)%3B%0A%7D%3B%0A%0A%7D%2C%7B%22.%2FAbstractFilter%22%3A40%7D%5D%2C42%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20AbstractFilter%20%3D%20require('.%2FAbstractFilter')%2C%0A%20%20%20%20math%20%3D%20%20require('..%2F..%2F..%2Fmath')%3B%0A%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20The%20SpriteMaskFilter%20class%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20sprite%20%7BPIXI.Sprite%7D%20the%20target%20sprite%0A%20*%2F%0Afunction%20SpriteMaskFilter(sprite)%0A%7B%0A%20%20%20%20var%20maskMatrix%20%3D%20new%20math.Matrix()%3B%0A%0A%20%20%20%20AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%22attribute%20vec2%20aVertexPosition%3B%5Cnattribute%20vec2%20aTextureCoord%3B%5Cnattribute%20vec4%20aColor%3B%5Cn%5Cnuniform%20mat3%20projectionMatrix%3B%5Cnuniform%20mat3%20otherMatrix%3B%5Cn%5Cnvarying%20vec2%20vMaskCoord%3B%5Cnvarying%20vec2%20vTextureCoord%3B%5Cnvarying%20vec4%20vColor%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20%20gl_Position%20%3D%20vec4((projectionMatrix%20*%20vec3(aVertexPosition%2C%201.0)).xy%2C%200.0%2C%201.0)%3B%5Cn%20%20%20%20vTextureCoord%20%3D%20aTextureCoord%3B%5Cn%20%20%20%20vMaskCoord%20%3D%20(%20otherMatrix%20*%20vec3(%20aTextureCoord%2C%201.0)%20%20).xy%3B%5Cn%20%20%20%20vColor%20%3D%20vec4(aColor.rgb%20*%20aColor.a%2C%20aColor.a)%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%22precision%20lowp%20float%3B%5Cn%5Cnvarying%20vec2%20vMaskCoord%3B%5Cnvarying%20vec2%20vTextureCoord%3B%5Cnvarying%20vec4%20vColor%3B%5Cn%5Cnuniform%20sampler2D%20uSampler%3B%5Cnuniform%20float%20alpha%3B%5Cnuniform%20sampler2D%20mask%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20%20%2F%2F%20check%20clip!%20this%20will%20stop%20the%20mask%20bleeding%20out%20from%20the%20edges%5Cn%20%20%20%20vec2%20text%20%3D%20abs(%20vMaskCoord%20-%200.5%20)%3B%5Cn%20%20%20%20text%20%3D%20step(0.5%2C%20text)%3B%5Cn%20%20%20%20float%20clip%20%3D%201.0%20-%20max(text.y%2C%20text.x)%3B%5Cn%20%20%20%20vec4%20original%20%3D%20texture2D(uSampler%2C%20vTextureCoord)%3B%5Cn%20%20%20%20vec4%20masky%20%3D%20texture2D(mask%2C%20vMaskCoord)%3B%5Cn%20%20%20%20original%20*%3D%20(masky.r%20*%20masky.a%20*%20alpha%20*%20clip)%3B%5Cn%20%20%20%20gl_FragColor%20%3D%20original%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20mask%3A%20%20%20%20%20%20%20%20%20%20%20%7B%20type%3A%20'sampler2D'%2C%20value%3A%20sprite._texture%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alpha%3A%20%20%20%20%20%20%20%20%20%20%7B%20type%3A%20'f'%2C%20value%3A%201%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20otherMatrix%3A%20%20%20%20%7B%20type%3A%20'mat3'%2C%20value%3A%20maskMatrix.toArray(true)%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%0A%20%20%20%20this.maskSprite%20%3D%20sprite%3B%0A%20%20%20%20this.maskMatrix%20%3D%20maskMatrix%3B%0A%7D%0A%0ASpriteMaskFilter.prototype%20%3D%20Object.create(AbstractFilter.prototype)%3B%0ASpriteMaskFilter.prototype.constructor%20%3D%20SpriteMaskFilter%3B%0Amodule.exports%20%3D%20SpriteMaskFilter%3B%0A%0A%2F**%0A%20*%20Applies%20the%20filter%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20The%20renderer%20to%20retrieve%20the%20filter%20from%0A%20*%20%40param%20input%20%7BPIXI.RenderTarget%7D%0A%20*%20%40param%20output%20%7BPIXI.RenderTarget%7D%0A%20*%2F%0ASpriteMaskFilter.prototype.applyFilter%20%3D%20function%20(renderer%2C%20input%2C%20output)%0A%7B%0A%20%20%20%20var%20filterManager%20%3D%20renderer.filterManager%3B%0A%0A%20%20%20%20this.uniforms.mask.value%20%3D%20this.maskSprite._texture%3B%0A%0A%20%20%20%20filterManager.calculateMappedMatrix(input.frame%2C%20this.maskSprite%2C%20this.maskMatrix)%3B%0A%0A%20%20%20%20this.uniforms.otherMatrix.value%20%3D%20this.maskMatrix.toArray(true)%3B%0A%20%20%20%20this.uniforms.alpha.value%20%3D%20this.maskSprite.worldAlpha%3B%0A%0A%20%20%20%20var%20shader%20%3D%20this.getShader(renderer)%3B%0A%20%20%20%20%20%2F%2F%20draw%20the%20filter...%0A%20%20%20%20filterManager.applyFilter(shader%2C%20input%2C%20output)%3B%0A%7D%3B%0A%0A%0AObject.defineProperties(SpriteMaskFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20texture%20used%20for%20the%20displacement%20map.%20Must%20be%20power%20of%202%20sized%20texture.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Texture%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.SpriteMaskFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20map%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.mask.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.mask.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20offset%20used%20to%20move%20the%20displacement%20map.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Point%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.SpriteMaskFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20offset%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.offset.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.offset.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2F..%2Fmath%22%3A23%2C%22.%2FAbstractFilter%22%3A40%7D%5D%2C43%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20WebGLManager%20%3D%20require('.%2FWebGLManager')%3B%0A%0A%2F**%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40extends%20PIXI.WebGlManager%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20The%20renderer%20this%20manager%20works%20for.%0A%20*%2F%0Afunction%20BlendModeManager(renderer)%0A%7B%0A%20%20%20%20WebGLManager.call(this%2C%20renderer)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.currentBlendMode%20%3D%2099999%3B%0A%7D%0A%0ABlendModeManager.prototype%20%3D%20Object.create(WebGLManager.prototype)%3B%0ABlendModeManager.prototype.constructor%20%3D%20BlendModeManager%3B%0Amodule.exports%20%3D%20BlendModeManager%3B%0A%0A%2F**%0A%20*%20Sets-up%20the%20given%20blendMode%20from%20WebGL's%20point%20of%20view.%0A%20*%0A%20*%20%40param%20blendMode%20%7Bnumber%7D%20the%20blendMode%2C%20should%20be%20a%20Pixi%20const%2C%20such%20as%20%60PIXI.BLEND_MODES.ADD%60.%20See%0A%20*%20%20%7B%40link%20PIXI.BLEND_MODES%7D%20for%20possible%20values.%0A%20*%2F%0ABlendModeManager.prototype.setBlendMode%20%3D%20function%20(blendMode)%0A%7B%0A%20%20%20%20if%20(this.currentBlendMode%20%3D%3D%3D%20blendMode)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.currentBlendMode%20%3D%20blendMode%3B%0A%0A%20%20%20%20var%20mode%20%3D%20this.renderer.blendModes%5Bthis.currentBlendMode%5D%3B%0A%20%20%20%20this.renderer.gl.blendFunc(mode%5B0%5D%2C%20mode%5B1%5D)%3B%0A%0A%20%20%20%20return%20true%3B%0A%7D%3B%0A%0A%7D%2C%7B%22.%2FWebGLManager%22%3A48%7D%5D%2C44%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20WebGLManager%20%3D%20require('.%2FWebGLManager')%2C%0A%20%20%20%20RenderTarget%20%3D%20require('..%2Futils%2FRenderTarget')%2C%0A%20%20%20%20CONST%20%3D%20require('..%2F..%2F..%2Fconst')%2C%0A%20%20%20%20Quad%20%3D%20require('..%2Futils%2FQuad')%2C%0A%20%20%20%20math%20%3D%20%20require('..%2F..%2F..%2Fmath')%3B%0A%0A%2F**%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40extends%20PIXI.WebGLManager%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20The%20renderer%20this%20manager%20works%20for.%0A%20*%2F%0Afunction%20FilterManager(renderer)%0A%7B%0A%20%20%20%20WebGLManager.call(this%2C%20renderer)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bobject%5B%5D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.filterStack%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20this.filterStack.push(%7B%0A%20%20%20%20%20%20%20%20renderTarget%3Arenderer.currentRenderTarget%2C%0A%20%20%20%20%20%20%20%20filter%3A%5B%5D%2C%0A%20%20%20%20%20%20%20%20bounds%3Anull%0A%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7BPIXI.RenderTarget%5B%5D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.texturePool%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20size%20of%20the%20texture%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Rectangle%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20%2F%2F%20listen%20for%20context%20and%20update%20necessary%20buffers%0A%20%20%20%20%2F%2FTODO%20make%20this%20dynamic!%0A%20%20%20%20%2F%2FTODO%20test%20this%20out%20by%20forces%20power%20of%20two%3F%0A%20%20%20%20this.textureSize%20%3D%20new%20math.Rectangle(0%2C%200%2C%20renderer.width%2C%20renderer.height)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20current%20frame%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Rectangle%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.currentFrame%20%3D%20null%3B%0A%7D%0A%0AFilterManager.prototype%20%3D%20Object.create(WebGLManager.prototype)%3B%0AFilterManager.prototype.constructor%20%3D%20FilterManager%3B%0Amodule.exports%20%3D%20FilterManager%3B%0A%0A%0A%2F**%0A%20*%20Called%20when%20there%20is%20a%20WebGL%20context%20change.%0A%20*%0A%20*%2F%0AFilterManager.prototype.onContextChange%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.texturePool.length%20%3D%200%3B%0A%0A%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%20%20%20%20this.quad%20%3D%20new%20Quad(gl)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%0A%20*%20%40param%20buffer%20%7BArrayBuffer%7D%0A%20*%2F%0AFilterManager.prototype.setFilterStack%20%3D%20function%20(%20filterStack%20)%0A%7B%0A%20%20%20%20this.filterStack%20%3D%20filterStack%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Applies%20the%20filter%20and%20adds%20it%20to%20the%20current%20filter%20stack.%0A%20*%0A%20*%20%40param%20target%20%7BPIXI.DisplayObject%7D%0A%20*%20%40param%20filters%20%7BPIXI.AbstractFiler%5B%5D%7D%20the%20filters%20that%20will%20be%20pushed%20to%20the%20current%20filter%20stack%0A%20*%2F%0AFilterManager.prototype.pushFilter%20%3D%20function%20(target%2C%20filters)%0A%7B%0A%20%20%20%20%2F%2F%20get%20the%20bounds%20of%20the%20object..%0A%20%20%20%20%2F%2F%20TODO%20replace%20clone%20with%20a%20copy%20to%20save%20object%20creation%0A%20%20%20%20var%20bounds%20%3D%20target.filterArea%20%3F%20target.filterArea.clone()%20%3A%20target.getBounds()%3B%0A%0A%20%20%20%20%2F%2Fbounds%20%3D%20bounds.clone()%3B%0A%0A%20%20%20%20%2F%2F%20round%20off%20the%20rectangle%20to%20get%20a%20nice%20smoooooooth%20filter%20%3A)%0A%20%20%20%20bounds.x%20%3D%20bounds.x%20%7C%200%3B%0A%20%20%20%20bounds.y%20%3D%20bounds.y%20%7C%200%3B%0A%20%20%20%20bounds.width%20%3D%20bounds.width%20%7C%200%3B%0A%20%20%20%20bounds.height%20%3D%20bounds.height%20%7C%200%3B%0A%0A%0A%20%20%20%20%2F%2F%20padding!%0A%20%20%20%20var%20padding%20%3D%20filters%5B0%5D.padding%20%7C%200%3B%0A%20%20%20%20bounds.x%20-%3D%20padding%3B%0A%20%20%20%20bounds.y%20-%3D%20padding%3B%0A%20%20%20%20bounds.width%20%2B%3D%20padding%20*%202%3B%0A%20%20%20%20bounds.height%20%2B%3D%20padding%20*%202%3B%0A%0A%0A%20%20%20%20if(this.renderer.currentRenderTarget.transform)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2FTODO%20this%20will%20break%20if%20the%20renderTexture%20transform%20is%20anything%20other%20than%20a%20translation.%0A%20%20%20%20%20%20%20%20%2F%2FWill%20need%20to%20take%20the%20full%20matrix%20transform%20into%20acount..%0A%20%20%20%20%20%20%20%20var%20transform%20%3D%20this.renderer.currentRenderTarget.transform%3B%0A%0A%20%20%20%20%20%20%20%20bounds.x%20%2B%3D%20transform.tx%3B%0A%20%20%20%20%20%20%20%20bounds.y%20%2B%3D%20transform.ty%3B%0A%0A%20%20%20%20%20%20%20%20this.capFilterArea(%20bounds%20)%3B%0A%0A%20%20%20%20%20%20%20%20bounds.x%20-%3D%20transform.tx%3B%0A%20%20%20%20%20%20%20%20bounds.y%20-%3D%20transform.ty%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20this.capFilterArea(%20bounds%20)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(bounds.width%20%3E%200%20%26%26%20bounds.height%20%3E%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.currentFrame%20%3D%20bounds%3B%0A%0A%20%20%20%20%20%20%20%20var%20texture%20%3D%20this.getRenderTarget()%3B%0A%0A%20%20%20%20%20%20%20%20this.renderer.setRenderTarget(texture)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20clear%20the%20texture..%0A%20%20%20%20%20%20%20%20texture.clear()%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20TODO%20get%20rid%20of%20object%20creation!%0A%20%20%20%20%20%20%20%20this.filterStack.push(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderTarget%3A%20texture%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20filter%3A%20filters%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20push%20somthing%20on%20to%20the%20stack%20that%20is%20empty%0A%20%20%20%20%20%20%20%20this.filterStack.push(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderTarget%3A%20null%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20filter%3A%20filters%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Removes%20the%20last%20filter%20from%20the%20filter%20stack%20and%20returns%20it.%0A%20*%0A%20*%2F%0AFilterManager.prototype.popFilter%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20filterData%20%3D%20this.filterStack.pop()%3B%0A%20%20%20%20var%20previousFilterData%20%3D%20this.filterStack%5Bthis.filterStack.length-1%5D%3B%0A%0A%20%20%20%20var%20input%20%3D%20filterData.renderTarget%3B%0A%0A%20%20%20%20%2F%2F%20if%20the%20renderTarget%20is%20null%20then%20we%20don't%20apply%20the%20filter%20as%20its%20offscreen%0A%20%20%20%20if(!filterData.renderTarget)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20output%20%3D%20previousFilterData.renderTarget%3B%0A%0A%20%20%20%20%2F%2F%20use%20program%0A%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%0A%0A%20%20%20%20this.currentFrame%20%3D%20input.frame%3B%0A%0A%20%20%20%20this.quad.map(this.textureSize%2C%20input.frame)%3B%0A%0A%0A%20%20%20%20%2F%2F%20TODO..%20this%20probably%20only%20needs%20to%20be%20done%20once!%0A%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20this.quad.vertexBuffer)%3B%0A%20%20%20%20gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER%2C%20this.quad.indexBuffer)%3B%0A%0A%20%20%20%20var%20filters%20%3D%20filterData.filter%3B%0A%0A%20%20%20%20%2F%2F%20assuming%20all%20filters%20follow%20the%20correct%20format%3F%3F%0A%20%20%20%20gl.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aVertexPosition%2C%202%2C%20gl.FLOAT%2C%20false%2C%200%2C%200)%3B%0A%20%20%20%20gl.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aTextureCoord%2C%202%2C%20gl.FLOAT%2C%20false%2C%200%2C%202%20*%204%20*%204)%3B%0A%20%20%20%20gl.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aColor%2C%204%2C%20gl.FLOAT%2C%20false%2C%200%2C%204%20*%204%20*%204)%3B%0A%0A%20%20%20%20%2F%2F%20restore%20the%20normal%20blendmode!%0A%20%20%20%20this.renderer.blendModeManager.setBlendMode(CONST.BLEND_MODES.NORMAL)%3B%0A%0A%20%20%20%20if%20(filters.length%20%3D%3D%3D%201)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20TODO%20(cengler)%20-%20There%20has%20to%20be%20a%20better%20way%20then%20setting%20this%20each%20time%3F%0A%20%20%20%20%20%20%20%20if%20(filters%5B0%5D.uniforms.dimensions)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20filters%5B0%5D.uniforms.dimensions.value%5B0%5D%20%3D%20this.renderer.width%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20filters%5B0%5D.uniforms.dimensions.value%5B1%5D%20%3D%20this.renderer.height%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20filters%5B0%5D.uniforms.dimensions.value%5B2%5D%20%3D%20this.quad.vertices%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20filters%5B0%5D.uniforms.dimensions.value%5B3%5D%20%3D%20this.quad.vertices%5B5%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20filters%5B0%5D.applyFilter(%20this.renderer%2C%20input%2C%20output%20)%3B%0A%20%20%20%20%20%20%20%20this.returnRenderTarget(%20input%20)%3B%0A%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20flipTexture%20%3D%20input%3B%0A%20%20%20%20%20%20%20%20var%20flopTexture%20%3D%20this.getRenderTarget(true)%3B%0A%0A%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20filters.length-1%3B%20i%2B%2B)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20filter%20%3D%20filters%5Bi%5D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20TODO%20(cengler)%20-%20There%20has%20to%20be%20a%20better%20way%20then%20setting%20this%20each%20time%3F%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(filter.uniforms.dimensions)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20filter.uniforms.dimensions.value%5B0%5D%20%3D%20this.renderer.width%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20filter.uniforms.dimensions.value%5B1%5D%20%3D%20this.renderer.height%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20filter.uniforms.dimensions.value%5B2%5D%20%3D%20this.quad.vertices%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20filter.uniforms.dimensions.value%5B3%5D%20%3D%20this.quad.vertices%5B5%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20filter.applyFilter(%20this.renderer%2C%20flipTexture%2C%20flopTexture%20)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20temp%20%3D%20flipTexture%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20flipTexture%20%3D%20flopTexture%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20flopTexture%20%3D%20temp%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20filters%5Bfilters.length-1%5D.applyFilter(%20this.renderer%2C%20flipTexture%2C%20output%20)%3B%0A%0A%20%20%20%20%20%20%20%20this.returnRenderTarget(%20flipTexture%20)%3B%0A%20%20%20%20%20%20%20%20this.returnRenderTarget(%20flopTexture%20)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20filterData.filter%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Grabs%20an%20render%20target%20from%20the%20internal%20pool%0A%20*%0A%20*%20%40param%20clear%20%7Bboolean%7D%20Whether%20or%20not%20we%20need%20to%20clear%20the%20RenderTarget%0A%20*%20%40return%20%7BRenderTarget%7D%0A%20*%2F%0AFilterManager.prototype.getRenderTarget%20%3D%20function%20(%20clear%20)%0A%7B%0A%20%20%20%20var%20renderTarget%20%3D%20this.texturePool.pop()%20%7C%7C%20new%20RenderTarget(this.renderer.gl%2C%20this.textureSize.width%2C%20this.textureSize.height%2C%20CONST.SCALE_MODES.LINEAR%2C%20this.renderer.resolution%20*%20CONST.FILTER_RESOLUTION)%3B%0A%20%20%20%20renderTarget.frame%20%3D%20this.currentFrame%3B%0A%0A%20%20%20%20if%20(clear)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20renderTarget.clear(true)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20renderTarget%3B%0A%7D%3B%0A%0A%2F*%0A%20*%20Returns%20a%20RenderTarget%20to%20the%20internal%20pool%0A%20*%20%40param%20renderTarget%20%7BRenderTarget%7D%20The%20RenderTarget%20we%20want%20to%20return%20to%20the%20pool%0A%20*%2F%0AFilterManager.prototype.returnRenderTarget%20%3D%20function%20(renderTarget)%0A%7B%0A%20%20%20%20this.texturePool.push(%20renderTarget%20)%3B%0A%7D%3B%0A%0A%2F*%0A%20*%20Applies%20the%20filter%0A%20*%20%40param%20shader%20%7BShader%7D%20The%20shader%20to%20upload%0A%20*%20%40param%20inputTarget%20%7BRenderTarget%7D%0A%20*%20%40param%20outputTarget%20%7BRenderTarget%7D%0A%20*%20%40param%20clear%20%7Bboolean%7D%20Whether%20or%20not%20we%20want%20to%20clear%20the%20outputTarget%0A%20*%2F%0AFilterManager.prototype.applyFilter%20%3D%20function%20(shader%2C%20inputTarget%2C%20outputTarget%2C%20clear)%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%0A%20%20%20%20this.renderer.setRenderTarget(outputTarget)%3B%0A%0A%20%20%20%20if%20(clear)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20outputTarget.clear()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20set%20the%20shader%0A%20%20%20%20this.renderer.shaderManager.setShader(shader)%3B%0A%0A%20%20%20%20%2F%2F%20TODO%20(cengler)%20-%20Can%20this%20be%20cached%20and%20not%20%60toArray%60ed%20each%20frame%3F%0A%20%20%20%20shader.uniforms.projectionMatrix.value%20%3D%20this.renderer.currentRenderTarget.projectionMatrix.toArray(true)%3B%0A%0A%20%20%20%20%2F%2FTODO%20can%20this%20be%20optimised%3F%0A%20%20%20%20shader.syncUniforms()%3B%0A%2F*%0A%20%20%20%20gl.vertexAttribPointer(shader.attributes.aVertexPosition%2C%202%2C%20gl.FLOAT%2C%20false%2C%200%2C%200)%3B%0A%20%20%20%20gl.vertexAttribPointer(shader.attributes.aTextureCoord%2C%202%2C%20gl.FLOAT%2C%20false%2C%200%2C%202%20*%204%20*%204)%3B%0A%20%20%20%20gl.vertexAttribPointer(shader.attributes.aColor%2C%204%2C%20gl.FLOAT%2C%20false%2C%200%2C%204%20*%204%20*%204)%3B%0A*%2F%0A%0A%20%20%20%20gl.activeTexture(gl.TEXTURE0)%3B%0A%20%20%20%20gl.bindTexture(gl.TEXTURE_2D%2C%20inputTarget.texture)%3B%0A%0A%20%20%20%20gl.drawElements(gl.TRIANGLES%2C%206%2C%20gl.UNSIGNED_SHORT%2C%200%20)%3B%0A%20%20%20%20this.renderer.drawCount%2B%2B%3B%0A%7D%3B%0A%0A%2F*%0A%20*%20Calculates%20the%20mapped%20matrix%0A%20*%20%40param%20filterArea%20%7BRectangle%7D%20The%20filter%20area%0A%20*%20%40param%20sprite%20%7BSprite%7D%20the%20target%20sprite%0A%20*%20%40param%20outputMatrix%20%7BMatrix%7D%20%40alvin%0A%20*%2F%0A%2F%2F%20TODO%20playing%20around%20here..%20this%20is%20temporary%20-%20(will%20end%20up%20in%20the%20shader)%0AFilterManager.prototype.calculateMappedMatrix%20%3D%20function%20(filterArea%2C%20sprite%2C%20outputMatrix)%0A%7B%0A%20%20%20%20var%20worldTransform%20%3D%20sprite.worldTransform.copy(math.Matrix.TEMP_MATRIX)%2C%0A%20%20%20%20texture%20%3D%20sprite._texture.baseTexture%3B%0A%0A%20%20%20%20var%20mappedMatrix%20%3D%20outputMatrix.identity()%3B%0A%0A%20%20%20%20%2F%2F%20scale..%0A%20%20%20%20var%20ratio%20%3D%20this.textureSize.height%20%2F%20this.textureSize.width%3B%0A%0A%20%20%20%20mappedMatrix.translate(filterArea.x%20%2F%20this.textureSize.width%2C%20filterArea.y%20%2F%20this.textureSize.height%20)%3B%0A%0A%20%20%20%20mappedMatrix.scale(1%20%2C%20ratio)%3B%0A%0A%20%20%20%20var%20translateScaleX%20%3D%20(this.textureSize.width%20%2F%20texture.width)%3B%0A%20%20%20%20var%20translateScaleY%20%3D%20(this.textureSize.height%20%2F%20texture.height)%3B%0A%0A%20%20%20%20worldTransform.tx%20%2F%3D%20texture.width%20*%20translateScaleX%3B%0A%20%20%20%20worldTransform.ty%20%2F%3D%20texture.width%20*%20translateScaleX%3B%0A%0A%20%20%20%20worldTransform.invert()%3B%0A%0A%20%20%20%20mappedMatrix.prepend(worldTransform)%3B%0A%0A%20%20%20%20%2F%2F%20apply%20inverse%20scale..%0A%20%20%20%20mappedMatrix.scale(1%20%2C%201%2Fratio)%3B%0A%0A%20%20%20%20mappedMatrix.scale(%20translateScaleX%20%2C%20translateScaleY%20)%3B%0A%0A%20%20%20%20mappedMatrix.translate(sprite.anchor.x%2C%20sprite.anchor.y)%3B%0A%0A%20%20%20%20return%20mappedMatrix%3B%0A%0A%20%20%20%20%2F%2F%20Keeping%20the%20orginal%20as%20a%20reminder%20to%20me%20on%20how%20this%20works!%0A%20%20%20%20%2F%2F%0A%20%20%20%20%2F%2F%20var%20m%20%3D%20new%20math.Matrix()%3B%0A%0A%20%20%20%20%2F%2F%20%2F%2F%20scale..%0A%20%20%20%20%2F%2F%20var%20ratio%20%3D%20this.textureSize.height%20%2F%20this.textureSize.width%3B%0A%0A%20%20%20%20%2F%2F%20m.translate(filterArea.x%20%2F%20this.textureSize.width%2C%20filterArea.y%20%2F%20this.textureSize.height)%3B%0A%0A%0A%20%20%20%20%2F%2F%20m.scale(1%20%2C%20ratio)%3B%0A%0A%0A%20%20%20%20%2F%2F%20var%20transform%20%3D%20wt.clone()%3B%0A%0A%20%20%20%20%2F%2F%20var%20translateScaleX%20%3D%20(this.textureSize.width%20%2F%20620)%3B%0A%20%20%20%20%2F%2F%20var%20translateScaleY%20%3D%20(this.textureSize.height%20%2F%20380)%3B%0A%0A%20%20%20%20%2F%2F%20transform.tx%20%2F%3D%20620%20*%20translateScaleX%3B%0A%20%20%20%20%2F%2F%20transform.ty%20%2F%3D%20620%20*%20translateScaleX%3B%0A%0A%20%20%20%20%2F%2F%20transform.invert()%3B%0A%0A%20%20%20%20%2F%2F%20transform.append(m)%3B%0A%0A%20%20%20%20%2F%2F%20%2F%2F%20apply%20inverse%20scale..%0A%20%20%20%20%2F%2F%20transform.scale(1%20%2C%201%2Fratio)%3B%0A%0A%20%20%20%20%2F%2F%20transform.scale(%20translateScaleX%20%2C%20translateScaleY%20)%3B%0A%0A%20%20%20%20%2F%2F%20return%20transform%3B%0A%7D%3B%0A%0A%2F*%0A%20*%20Constrains%20the%20filter%20area%20to%20the%20texture%20size%0A%20*%20%40param%20filterArea%20%7BRectangle%7D%20The%20filter%20area%20we%20want%20to%20cap%0A%20*%2F%0AFilterManager.prototype.capFilterArea%20%3D%20function%20(filterArea)%0A%7B%0A%20%20%20%20if%20(filterArea.x%20%3C%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20filterArea.width%20%2B%3D%20filterArea.x%3B%0A%20%20%20%20%20%20%20%20filterArea.x%20%3D%200%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(filterArea.y%20%3C%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20filterArea.height%20%2B%3D%20filterArea.y%3B%0A%20%20%20%20%20%20%20%20filterArea.y%20%3D%200%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(%20filterArea.x%20%2B%20filterArea.width%20%3E%20this.textureSize.width%20)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20filterArea.width%20%3D%20this.textureSize.width%20-%20filterArea.x%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(%20filterArea.y%20%2B%20filterArea.height%20%3E%20this.textureSize.height%20)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20filterArea.height%20%3D%20this.textureSize.height%20-%20filterArea.y%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F*%0A%20*%20Resizes%20all%20the%20render%20targets%20in%20the%20pool%0A%20*%20%40param%20width%20%7Bnumber%7D%20the%20new%20width%0A%20*%20%40param%20height%20%7Bnumber%7D%20the%20new%20height%0A%20*%2F%0AFilterManager.prototype.resize%20%3D%20function%20(%20width%2C%20height%20)%0A%7B%0A%20%20%20%20this.textureSize.width%20%3D%20width%3B%0A%20%20%20%20this.textureSize.height%20%3D%20height%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20this.texturePool.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.texturePool%5Bi%5D.resize(%20width%2C%20height%20)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20the%20filter%20and%20removes%20it%20from%20the%20filter%20stack.%0A%20*%0A%20*%2F%0AFilterManager.prototype.destroy%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.quad.destroy()%3B%0A%20%20%20%20%0A%20%20%20%20WebGLManager.prototype.destroy.call(this)%3B%0A%20%20%20%20%0A%20%20%20%20this.filterStack%20%3D%20null%3B%0A%20%20%20%20this.offsetY%20%3D%200%3B%0A%0A%20%20%20%20%2F%2F%20destroy%20textures%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20this.texturePool.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.texturePool%5Bi%5D.destroy()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.texturePool%20%3D%20null%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2F..%2F..%2Fconst%22%3A13%2C%22..%2F..%2F..%2Fmath%22%3A23%2C%22..%2Futils%2FQuad%22%3A54%2C%22..%2Futils%2FRenderTarget%22%3A55%2C%22.%2FWebGLManager%22%3A48%7D%5D%2C45%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20WebGLManager%20%3D%20require('.%2FWebGLManager')%2C%0A%20%20%20%20AlphaMaskFilter%20%3D%20require('..%2Ffilters%2FSpriteMaskFilter')%3B%0A%0A%2F**%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20The%20renderer%20this%20manager%20works%20for.%0A%20*%2F%0Afunction%20MaskManager(renderer)%0A%7B%0A%20%20%20%20WebGLManager.call(this%2C%20renderer)%3B%0A%0A%20%20%20%20this.stencilStack%20%3D%20%5B%5D%3B%0A%20%20%20%20this.reverse%20%3D%20true%3B%0A%20%20%20%20this.count%20%3D%200%3B%0A%0A%20%20%20%20this.alphaMaskPool%20%3D%20%5B%5D%3B%0A%7D%0A%0AMaskManager.prototype%20%3D%20Object.create(WebGLManager.prototype)%3B%0AMaskManager.prototype.constructor%20%3D%20MaskManager%3B%0Amodule.exports%20%3D%20MaskManager%3B%0A%0A%2F**%0A%20*%20Applies%20the%20Mask%20and%20adds%20it%20to%20the%20current%20filter%20stack.%0A%20*%0A%20*%20%40param%20graphics%20%7BPIXI.Graphics%7D%0A%20*%20%40param%20webGLData%20%7Bany%5B%5D%7D%0A%20*%2F%0AMaskManager.prototype.pushMask%20%3D%20function%20(target%2C%20maskData)%0A%7B%0A%20%20%20%20if%20(maskData.texture)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.pushSpriteMask(target%2C%20maskData)%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.pushStencilMask(target%2C%20maskData)%3B%0A%20%20%20%20%7D%0A%0A%7D%3B%0A%0A%2F**%0A%20*%20Removes%20the%20last%20mask%20from%20the%20mask%20stack%20and%20doesn't%20return%20it.%0A%20*%0A%20*%20%40param%20target%20%7BPIXI.RenderTarget%7D%0A%20*%20%40param%20maskData%20%7Bany%5B%5D%7D%0A%20*%2F%0AMaskManager.prototype.popMask%20%3D%20function%20(target%2C%20maskData)%0A%7B%0A%20%20%20%20if%20(maskData.texture)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.popSpriteMask(target%2C%20maskData)%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.popStencilMask(target%2C%20maskData)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Applies%20the%20Mask%20and%20adds%20it%20to%20the%20current%20filter%20stack.%0A%20*%0A%20*%20%40param%20target%20%7BPIXI.RenderTarget%7D%0A%20*%20%40param%20maskData%20%7Bany%5B%5D%7D%0A%20*%2F%0AMaskManager.prototype.pushSpriteMask%20%3D%20function%20(target%2C%20maskData)%0A%7B%0A%20%20%20%20var%20alphaMaskFilter%20%3D%20this.alphaMaskPool.pop()%3B%0A%0A%20%20%20%20if%20(!alphaMaskFilter)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20alphaMaskFilter%20%3D%20%5Bnew%20AlphaMaskFilter(maskData)%5D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20alphaMaskFilter%5B0%5D.maskSprite%20%3D%20maskData%3B%0A%20%20%20%20this.renderer.filterManager.pushFilter(target%2C%20alphaMaskFilter)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Removes%20the%20last%20filter%20from%20the%20filter%20stack%20and%20doesn't%20return%20it.%0A%20*%0A%20*%2F%0AMaskManager.prototype.popSpriteMask%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20filters%20%3D%20this.renderer.filterManager.popFilter()%3B%0A%0A%20%20%20%20this.alphaMaskPool.push(filters)%3B%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Applies%20the%20Mask%20and%20adds%20it%20to%20the%20current%20filter%20stack.%0A%20*%0A%20*%20%40param%20target%20%7BPIXI.RenderTarget%7D%0A%20*%20%40param%20maskData%20%7Bany%5B%5D%7D%0A%20*%2F%0AMaskManager.prototype.pushStencilMask%20%3D%20function%20(target%2C%20maskData)%0A%7B%0A%20%20%20%20this.renderer.stencilManager.pushMask(maskData)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Removes%20the%20last%20filter%20from%20the%20filter%20stack%20and%20doesn't%20return%20it.%0A%20*%0A%20*%20%40param%20target%20%7BPIXI.RenderTarget%7D%0A%20*%20%40param%20maskData%20%7Bany%5B%5D%7D%0A%20*%2F%0AMaskManager.prototype.popStencilMask%20%3D%20function%20(target%2C%20maskData)%0A%7B%0A%20%20%20%20this.renderer.stencilManager.popMask(maskData)%3B%0A%7D%3B%0A%0A%0A%7D%2C%7B%22..%2Ffilters%2FSpriteMaskFilter%22%3A42%2C%22.%2FWebGLManager%22%3A48%7D%5D%2C46%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20WebGLManager%20%3D%20require('.%2FWebGLManager')%2C%0A%20%20%20%20TextureShader%20%3D%20require('..%2Fshaders%2FTextureShader')%2C%0A%20%20%20%20ComplexPrimitiveShader%20%3D%20require('..%2Fshaders%2FComplexPrimitiveShader')%2C%0A%20%20%20%20PrimitiveShader%20%3D%20require('..%2Fshaders%2FPrimitiveShader')%2C%0A%20%20%20%20utils%20%3D%20require('..%2F..%2F..%2Futils')%3B%0A%0A%2F**%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40extends%20PIXI.WebGLManager%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20The%20renderer%20this%20manager%20works%20for.%0A%20*%2F%0Afunction%20ShaderManager(renderer)%0A%7B%0A%20%20%20%20WebGLManager.call(this%2C%20renderer)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.maxAttibs%20%3D%2010%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bany%5B%5D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.attribState%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bany%5B%5D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.tempAttribState%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20this.maxAttibs%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.attribState%5Bi%5D%20%3D%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bany%5B%5D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.stack%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._currentId%20%3D%20-1%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Shader%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.currentShader%20%3D%20null%3B%0A%0A%2F%2F%20%20%20%20this.initPlugins()%3B%0A%7D%0A%0AShaderManager.prototype%20%3D%20Object.create(WebGLManager.prototype)%3B%0AShaderManager.prototype.constructor%20%3D%20ShaderManager%3B%0Autils.pluginTarget.mixin(ShaderManager)%3B%0A%0Amodule.exports%20%3D%20ShaderManager%3B%0A%0A%2F**%0A%20*%20Called%20when%20there%20is%20a%20WebGL%20context%20change.%0A%20*%0A%20*%2F%0AShaderManager.prototype.onContextChange%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.initPlugins()%3B%0A%0A%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%0A%20%20%20%20%2F%2F%20get%20the%20maximum%20number%20of%20attribute%20correctly%20as%20this%20tends%20to%20vary%0A%20%20%20%20this.maxAttibs%20%3D%20gl.getParameter(gl.MAX_VERTEX_ATTRIBS)%3B%0A%0A%20%20%20%20this.attribState%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20this.maxAttibs%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.attribState%5Bi%5D%20%3D%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20TODO%20-%20Why%20are%20these%20not%20plugins%3F%20We%20can't%20decouple%20primitives%20unless%20they%20are....%0A%20%20%20%20this.defaultShader%20%3D%20new%20TextureShader(this)%3B%0A%20%20%20%20this.primitiveShader%20%3D%20new%20PrimitiveShader(this)%3B%0A%20%20%20%20this.complexPrimitiveShader%20%3D%20new%20ComplexPrimitiveShader(this)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Takes%20the%20attributes%20given%20in%20parameters%20and%20uploads%20them.%0A%20*%0A%20*%20%40param%20attribs%20%7Bany%5B%5D%7D%20attribs%0A%20*%2F%0AShaderManager.prototype.setAttribs%20%3D%20function%20(attribs)%0A%7B%0A%20%20%20%20%2F%2F%20reset%20temp%20state%0A%20%20%20%20var%20i%3B%0A%0A%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20this.tempAttribState.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.tempAttribState%5Bi%5D%20%3D%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20set%20the%20new%20attribs%0A%20%20%20%20for%20(var%20a%20in%20attribs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.tempAttribState%5Battribs%5Ba%5D%5D%20%3D%20true%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%0A%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20this.attribState.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(this.attribState%5Bi%5D%20!%3D%3D%20this.tempAttribState%5Bi%5D)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.attribState%5Bi%5D%20%3D%20this.tempAttribState%5Bi%5D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.attribState%5Bi%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.enableVertexAttribArray(i)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.disableVertexAttribArray(i)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Sets%20the%20current%20shader.%0A%20*%0A%20*%20%40param%20shader%20%7BPIXI.Shader%7D%20the%20shader%20to%20upload%0A%20*%2F%0AShaderManager.prototype.setShader%20%3D%20function%20(shader)%0A%7B%0A%20%20%20%20if%20(this._currentId%20%3D%3D%3D%20shader.uid)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this._currentId%20%3D%20shader.uid%3B%0A%0A%20%20%20%20this.currentShader%20%3D%20shader%3B%0A%0A%20%20%20%20this.renderer.gl.useProgram(shader.program)%3B%0A%20%20%20%20this.setAttribs(shader.attributes)%3B%0A%0A%20%20%20%20return%20true%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20this%20object.%0A%20*%0A%20*%2F%0AShaderManager.prototype.destroy%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.primitiveShader.destroy()%3B%0A%20%20%20%20this.complexPrimitiveShader.destroy()%3B%0A%20%20%20%20WebGLManager.prototype.destroy.call(this)%3B%0A%0A%20%20%20%20this.destroyPlugins()%3B%0A%0A%20%20%20%20this.attribState%20%3D%20null%3B%0A%0A%20%20%20%20this.tempAttribState%20%3D%20null%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2F..%2F..%2Futils%22%3A67%2C%22..%2Fshaders%2FComplexPrimitiveShader%22%3A49%2C%22..%2Fshaders%2FPrimitiveShader%22%3A50%2C%22..%2Fshaders%2FTextureShader%22%3A52%2C%22.%2FWebGLManager%22%3A48%7D%5D%2C47%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20WebGLManager%20%3D%20require('.%2FWebGLManager')%2C%0A%20%20%20%20utils%20%3D%20require('..%2F..%2F..%2Futils')%3B%0A%0A%2F**%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20The%20renderer%20this%20manager%20works%20for.%0A%20*%2F%0Afunction%20WebGLMaskManager(renderer)%0A%7B%0A%20%20%20%20WebGLManager.call(this%2C%20renderer)%3B%0A%20%20%20%20this.stencilMaskStack%20%3D%20null%3B%0A%7D%0A%0AWebGLMaskManager.prototype%20%3D%20Object.create(WebGLManager.prototype)%3B%0AWebGLMaskManager.prototype.constructor%20%3D%20WebGLMaskManager%3B%0Amodule.exports%20%3D%20WebGLMaskManager%3B%0A%0A%2F**%0A%20*%20Changes%20the%20mask%20stack%20that%20is%20used%20by%20this%20manager.%0A%20*%0A%20*%20%40param%20stencilMaskStack%20%7BPIXI.StencilMaskStack%7D%20The%20mask%20stack%0A%20*%2F%0AWebGLMaskManager.prototype.setMaskStack%20%3D%20function%20(%20stencilMaskStack%20)%0A%7B%0A%20%20%20%20this.stencilMaskStack%20%3D%20stencilMaskStack%3B%0A%0A%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%0A%20%20%20%20if%20(stencilMaskStack.stencilStack.length%20%3D%3D%3D%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20gl.disable(gl.STENCIL_TEST)%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20gl.enable(gl.STENCIL_TEST)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Applies%20the%20Mask%20and%20adds%20it%20to%20the%20current%20filter%20stack.%20%40alvin%0A%20*%0A%20*%20%40param%20graphics%20%7BPIXI.Graphics%7D%0A%20*%20%40param%20webGLData%20%7Bany%5B%5D%7D%0A%20*%2F%0AWebGLMaskManager.prototype.pushStencil%20%3D%20function%20(graphics%2C%20webGLData)%0A%7B%0A%20%20%20%20this.renderer.currentRenderTarget.attachStencilBuffer()%3B%0A%0A%20%20%20%20var%20gl%20%3D%20this.renderer.gl%2C%0A%20%20%20%20%20%20%20%20sms%20%3D%20this.stencilMaskStack%3B%0A%0A%20%20%20%20this.bindGraphics(graphics%2C%20webGLData)%3B%0A%0A%20%20%20%20if%20(sms.stencilStack.length%20%3D%3D%3D%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20gl.enable(gl.STENCIL_TEST)%3B%0A%20%20%20%20%20%20%20%20gl.clear(gl.STENCIL_BUFFER_BIT)%3B%0A%20%20%20%20%20%20%20%20sms.reverse%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20sms.count%20%3D%200%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20sms.stencilStack.push(webGLData)%3B%0A%0A%20%20%20%20var%20level%20%3D%20sms.count%3B%0A%0A%20%20%20%20gl.colorMask(false%2C%20false%2C%20false%2C%20false)%3B%0A%0A%20%20%20%20gl.stencilFunc(gl.ALWAYS%2C0%2C0xFF)%3B%0A%20%20%20%20gl.stencilOp(gl.KEEP%2Cgl.KEEP%2Cgl.INVERT)%3B%0A%0A%20%20%20%20%2F%2F%20draw%20the%20triangle%20strip!%0A%0A%20%20%20%20if%20(webGLData.mode%20%3D%3D%3D%201)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20gl.drawElements(gl.TRIANGLE_FAN%2C%20%20webGLData.indices.length%20-%204%2C%20gl.UNSIGNED_SHORT%2C%200%20)%3B%0A%0A%20%20%20%20%20%20%20%20if%20(sms.reverse)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilFunc(gl.EQUAL%2C%200xFF%20-%20level%2C%200xFF)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilOp(gl.KEEP%2Cgl.KEEP%2Cgl.DECR)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilFunc(gl.EQUAL%2Clevel%2C%200xFF)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilOp(gl.KEEP%2Cgl.KEEP%2Cgl.INCR)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20draw%20a%20quad%20to%20increment..%0A%20%20%20%20%20%20%20%20gl.drawElements(gl.TRIANGLE_FAN%2C%204%2C%20gl.UNSIGNED_SHORT%2C%20(%20webGLData.indices.length%20-%204%20)%20*%202%20)%3B%0A%0A%20%20%20%20%20%20%20%20if%20(sms.reverse)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilFunc(gl.EQUAL%2C0xFF-(level%2B1)%2C%200xFF)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilFunc(gl.EQUAL%2Clevel%2B1%2C%200xFF)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20sms.reverse%20%3D%20!sms.reverse%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(!sms.reverse)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilFunc(gl.EQUAL%2C%200xFF%20-%20level%2C%200xFF)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilOp(gl.KEEP%2Cgl.KEEP%2Cgl.DECR)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilFunc(gl.EQUAL%2Clevel%2C%200xFF)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilOp(gl.KEEP%2Cgl.KEEP%2Cgl.INCR)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20gl.drawElements(gl.TRIANGLE_STRIP%2C%20%20webGLData.indices.length%2C%20gl.UNSIGNED_SHORT%2C%200%20)%3B%0A%0A%20%20%20%20%20%20%20%20if%20(!sms.reverse)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilFunc(gl.EQUAL%2C0xFF-(level%2B1)%2C%200xFF)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilFunc(gl.EQUAL%2Clevel%2B1%2C%200xFF)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20gl.colorMask(true%2C%20true%2C%20true%2C%20true)%3B%0A%20%20%20%20gl.stencilOp(gl.KEEP%2Cgl.KEEP%2Cgl.KEEP)%3B%0A%0A%20%20%20%20sms.count%2B%2B%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20TODO%20this%20does%20not%20belong%20here!%0A%20*%0A%20*%20%40param%20graphics%20%7BPIXI.Graphics%7D%0A%20*%20%40param%20webGLData%20%7Bany%5B%5D%7D%0A%20*%2F%0AWebGLMaskManager.prototype.bindGraphics%20%3D%20function%20(graphics%2C%20webGLData)%0A%7B%0A%20%20%20%20%2F%2Fif%20(this._currentGraphics%20%3D%3D%3D%20graphics)return%3B%0A%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%0A%20%20%20%20%20%2F%2F%20bind%20the%20graphics%20object..%0A%20%20%20%20var%20shader%3B%2F%2F%20%3D%20this.renderer.shaderManager.plugins.primitiveShader%3B%0A%0A%20%20%20%20if%20(webGLData.mode%20%3D%3D%3D%201)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20shader%20%3D%20this.renderer.shaderManager.complexPrimitiveShader%3B%0A%0A%20%20%20%20%20%20%20%20this.renderer.shaderManager.setShader(shader)%3B%0A%0A%20%20%20%20%20%20%20%20gl.uniformMatrix3fv(shader.uniforms.translationMatrix._location%2C%20false%2C%20graphics.worldTransform.toArray(true))%3B%0A%0A%20%20%20%20%20%20%20%20gl.uniformMatrix3fv(shader.uniforms.projectionMatrix._location%2C%20false%2C%20this.renderer.currentRenderTarget.projectionMatrix.toArray(true))%3B%0A%0A%20%20%20%20%20%20%20%20gl.uniform3fv(shader.uniforms.tint._location%2C%20utils.hex2rgb(graphics.tint))%3B%0A%0A%20%20%20%20%20%20%20%20gl.uniform3fv(shader.uniforms.color._location%2C%20webGLData.color)%3B%0A%0A%20%20%20%20%20%20%20%20gl.uniform1f(shader.uniforms.alpha._location%2C%20graphics.worldAlpha)%3B%0A%0A%20%20%20%20%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20webGLData.buffer)%3B%0A%0A%20%20%20%20%20%20%20%20gl.vertexAttribPointer(shader.attributes.aVertexPosition%2C%202%2C%20gl.FLOAT%2C%20false%2C%204%20*%202%2C%200)%3B%0A%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20now%20do%20the%20rest..%0A%20%20%20%20%20%20%20%20%2F%2F%20set%20the%20index%20buffer!%0A%20%20%20%20%20%20%20%20gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER%2C%20webGLData.indexBuffer)%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2Fthis.renderer.shaderManager.activatePrimitiveShader()%3B%0A%20%20%20%20%20%20%20%20shader%20%3D%20this.renderer.shaderManager.primitiveShader%3B%0A%0A%20%20%20%20%20%20%20%20this.renderer.shaderManager.setShader(shader)%3B%0A%0A%20%20%20%20%20%20%20%20gl.uniformMatrix3fv(shader.uniforms.translationMatrix._location%2C%20false%2C%20graphics.worldTransform.toArray(true))%3B%0A%0A%20%20%20%20%20%20%20%20gl.uniformMatrix3fv(shader.uniforms.projectionMatrix._location%2C%20false%2C%20this.renderer.currentRenderTarget.projectionMatrix.toArray(true))%3B%0A%0A%20%20%20%20%20%20%20%20gl.uniform3fv(shader.uniforms.tint._location%2C%20utils.hex2rgb(graphics.tint))%3B%0A%0A%20%20%20%20%20%20%20%20gl.uniform1f(shader.uniforms.alpha._location%2C%20graphics.worldAlpha)%3B%0A%0A%20%20%20%20%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20webGLData.buffer)%3B%0A%0A%20%20%20%20%20%20%20%20gl.vertexAttribPointer(shader.attributes.aVertexPosition%2C%202%2C%20gl.FLOAT%2C%20false%2C%204%20*%206%2C%200)%3B%0A%20%20%20%20%20%20%20%20gl.vertexAttribPointer(shader.attributes.aColor%2C%204%2C%20gl.FLOAT%2C%20false%2C4%20*%206%2C%202%20*%204)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20set%20the%20index%20buffer!%0A%20%20%20%20%20%20%20%20gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER%2C%20webGLData.indexBuffer)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20TODO%20%40alvin%0A%20*%20%40param%20graphics%20%7BPIXI.Graphics%7D%0A%20*%20%40param%20webGLData%20%7Bany%5B%5D%7D%0A%20*%2F%0AWebGLMaskManager.prototype.popStencil%20%3D%20function%20(graphics%2C%20webGLData)%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.renderer.gl%2C%0A%20%20%20%20%20%20%20%20sms%20%3D%20this.stencilMaskStack%3B%0A%0A%20%20%20%20sms.stencilStack.pop()%3B%0A%0A%20%20%20%20sms.count--%3B%0A%0A%20%20%20%20if%20(sms.stencilStack.length%20%3D%3D%3D%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20the%20stack%20is%20empty!%0A%20%20%20%20%20%20%20%20gl.disable(gl.STENCIL_TEST)%3B%0A%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20var%20level%20%3D%20sms.count%3B%0A%0A%20%20%20%20%20%20%20%20this.bindGraphics(graphics%2C%20webGLData)%3B%0A%0A%20%20%20%20%20%20%20%20gl.colorMask(false%2C%20false%2C%20false%2C%20false)%3B%0A%0A%20%20%20%20%20%20%20%20if%20(webGLData.mode%20%3D%3D%3D%201)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20sms.reverse%20%3D%20!sms.reverse%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(sms.reverse)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilFunc(gl.EQUAL%2C%200xFF%20-%20(level%2B1)%2C%200xFF)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilOp(gl.KEEP%2Cgl.KEEP%2Cgl.INCR)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilFunc(gl.EQUAL%2Clevel%2B1%2C%200xFF)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilOp(gl.KEEP%2Cgl.KEEP%2Cgl.DECR)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20draw%20a%20quad%20to%20increment..%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.drawElements(gl.TRIANGLE_FAN%2C%204%2C%20gl.UNSIGNED_SHORT%2C%20(%20webGLData.indices.length%20-%204%20)%20*%202%20)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilFunc(gl.ALWAYS%2C0%2C0xFF)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilOp(gl.KEEP%2Cgl.KEEP%2Cgl.INVERT)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20draw%20the%20triangle%20strip!%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.drawElements(gl.TRIANGLE_FAN%2C%20%20webGLData.indices.length%20-%204%2C%20gl.UNSIGNED_SHORT%2C%200%20)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20this.renderer.drawCount%20%2B%3D%202%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!sms.reverse)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilFunc(gl.EQUAL%2C0xFF-(level)%2C%200xFF)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilFunc(gl.EQUAL%2Clevel%2C%200xFF)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20%20console.log(%22%3C%3C%3E%3E%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!sms.reverse)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilFunc(gl.EQUAL%2C%200xFF%20-%20(level%2B1)%2C%200xFF)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilOp(gl.KEEP%2Cgl.KEEP%2Cgl.INCR)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilFunc(gl.EQUAL%2Clevel%2B1%2C%200xFF)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilOp(gl.KEEP%2Cgl.KEEP%2Cgl.DECR)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.drawElements(gl.TRIANGLE_STRIP%2C%20%20webGLData.indices.length%2C%20gl.UNSIGNED_SHORT%2C%200%20)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20this.renderer.drawCount%2B%2B%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!sms.reverse)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilFunc(gl.EQUAL%2C0xFF-(level)%2C%200xFF)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.stencilFunc(gl.EQUAL%2Clevel%2C%200xFF)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20gl.colorMask(true%2C%20true%2C%20true%2C%20true)%3B%0A%20%20%20%20%20%20%20%20gl.stencilOp(gl.KEEP%2Cgl.KEEP%2Cgl.KEEP)%3B%0A%0A%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20the%20mask%20stack.%0A%20*%0A%20*%2F%0AWebGLMaskManager.prototype.destroy%20%3D%20function%20()%0A%7B%0A%20%20%20%20WebGLManager.prototype.destroy.call(this)%3B%0A%0A%20%20%20%20this.stencilMaskStack.stencilStack%20%3D%20null%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Applies%20the%20Mask%20and%20adds%20it%20to%20the%20current%20filter%20stack.%0A%20*%0A%20*%20%40param%20maskData%20%7Bany%5B%5D%7D%20The%20mask%20data%20structure%20to%20use%0A%20*%2F%0AWebGLMaskManager.prototype.pushMask%20%3D%20function%20(maskData)%0A%7B%0A%0A%0A%20%20%20%20this.renderer.setObjectRenderer(this.renderer.plugins.graphics)%3B%0A%0A%20%20%20%20if%20(maskData.dirty)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.renderer.plugins.graphics.updateGraphics(maskData%2C%20this.renderer.gl)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(!maskData._webGL%5Bthis.renderer.gl.id%5D.data.length)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.pushStencil(maskData%2C%20maskData._webGL%5Bthis.renderer.gl.id%5D.data%5B0%5D)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Removes%20the%20last%20filter%20from%20the%20filter%20stack%20and%20doesn't%20return%20it.%0A%20*%0A%20*%20%40param%20maskData%20%7Bany%5B%5D%7D%0A%20*%2F%0AWebGLMaskManager.prototype.popMask%20%3D%20function%20(maskData)%0A%7B%0A%20%20%20%20this.renderer.setObjectRenderer(this.renderer.plugins.graphics)%3B%0A%0A%20%20%20%20this.popStencil(maskData%2C%20maskData._webGL%5Bthis.renderer.gl.id%5D.data%5B0%5D)%3B%0A%7D%3B%0A%0A%0A%7D%2C%7B%22..%2F..%2F..%2Futils%22%3A67%2C%22.%2FWebGLManager%22%3A48%7D%5D%2C48%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F**%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20The%20renderer%20this%20manager%20works%20for.%0A%20*%2F%0Afunction%20WebGLManager(renderer)%0A%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20renderer%20this%20manager%20works%20for.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.WebGLRenderer%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.renderer%20%3D%20renderer%3B%0A%0A%20%20%20%20this.renderer.on('context'%2C%20this.onContextChange%2C%20this)%3B%0A%7D%0A%0AWebGLManager.prototype.constructor%20%3D%20WebGLManager%3B%0Amodule.exports%20%3D%20WebGLManager%3B%0A%0A%2F**%0A%20*%20Generic%20method%20called%20when%20there%20is%20a%20WebGL%20context%20change.%0A%20*%0A%20*%2F%0AWebGLManager.prototype.onContextChange%20%3D%20function%20()%0A%7B%0A%09%2F%2F%20do%20some%20codes%20init!%0A%7D%3B%0A%0A%2F**%0A%20*%20Generic%20destroy%20methods%20to%20be%20overridden%20by%20the%20subclass%0A%20*%0A%20*%2F%0AWebGLManager.prototype.destroy%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.renderer.off('context'%2C%20this.onContextChange%2C%20this)%3B%0A%0A%20%20%20%20this.renderer%20%3D%20null%3B%0A%7D%3B%0A%0A%7D%2C%7B%7D%5D%2C49%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20Shader%20%3D%20require('.%2FShader')%3B%0A%0A%2F**%0A%20*%20This%20shader%20is%20used%20to%20draw%20complex%20primitive%20shapes%20for%20%7B%40link%20PIXI.Graphics%7D.%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40extends%20PIXI.Shader%0A%20*%20%40param%20shaderManager%20%7BPIXI.ShaderManager%7D%20The%20webgl%20shader%20manager%20this%20shader%20works%20for.%0A%20*%2F%0Afunction%20ComplexPrimitiveShader(shaderManager)%0A%7B%0A%20%20%20%20Shader.call(this%2C%0A%20%20%20%20%20%20%20%20shaderManager%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20'attribute%20vec2%20aVertexPosition%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'uniform%20mat3%20translationMatrix%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'uniform%20mat3%20projectionMatrix%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'uniform%20vec3%20tint%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'uniform%20float%20alpha%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'uniform%20vec3%20color%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'varying%20vec4%20vColor%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'void%20main(void)%7B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%20%20gl_Position%20%3D%20vec4((projectionMatrix%20*%20translationMatrix%20*%20vec3(aVertexPosition%2C%201.0)).xy%2C%200.0%2C%201.0)%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%20%20vColor%20%3D%20vec4(color%20*%20alpha%20*%20tint%2C%20alpha)%3B'%2C%2F%2F%22%20*%20vec4(tint%20*%20alpha%2C%20alpha)%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%7D'%0A%20%20%20%20%20%20%20%20%5D.join('%5Cn')%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20'precision%20mediump%20float%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'varying%20vec4%20vColor%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'void%20main(void)%7B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%20%20gl_FragColor%20%3D%20vColor%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%7D'%0A%20%20%20%20%20%20%20%20%5D.join('%5Cn')%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20tint%3A%20%20%20%7B%20type%3A%20'3f'%2C%20value%3A%20%5B0%2C%200%2C%200%5D%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alpha%3A%20%20%7B%20type%3A%20'1f'%2C%20value%3A%200%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20%20%7B%20type%3A%20'3f'%2C%20value%3A%20%5B0%2C0%2C0%5D%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20translationMatrix%3A%20%7B%20type%3A%20'mat3'%2C%20value%3A%20new%20Float32Array(9)%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20projectionMatrix%3A%20%7B%20type%3A%20'mat3'%2C%20value%3A%20new%20Float32Array(9)%20%7D%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20attributes%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20aVertexPosition%3A0%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%7D%0A%0AComplexPrimitiveShader.prototype%20%3D%20Object.create(Shader.prototype)%3B%0AComplexPrimitiveShader.prototype.constructor%20%3D%20ComplexPrimitiveShader%3B%0Amodule.exports%20%3D%20ComplexPrimitiveShader%3B%0A%0A%7D%2C%7B%22.%2FShader%22%3A51%7D%5D%2C50%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20Shader%20%3D%20require('.%2FShader')%3B%0A%0A%2F**%0A%20*%20This%20shader%20is%20used%20to%20draw%20simple%20primitive%20shapes%20for%20%7B%40link%20PIXI.Graphics%7D.%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40extends%20PIXI.Shader%0A%20*%20%40param%20shaderManager%20%7BShaderManager%7D%20The%20webgl%20shader%20manager%20this%20shader%20works%20for.%0A%20*%2F%0Afunction%20PrimitiveShader(shaderManager)%0A%7B%0A%20%20%20%20Shader.call(this%2C%0A%20%20%20%20%20%20%20%20shaderManager%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20'attribute%20vec2%20aVertexPosition%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'attribute%20vec4%20aColor%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'uniform%20mat3%20translationMatrix%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'uniform%20mat3%20projectionMatrix%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'uniform%20float%20alpha%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'uniform%20float%20flipY%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'uniform%20vec3%20tint%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'varying%20vec4%20vColor%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'void%20main(void)%7B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%20%20gl_Position%20%3D%20vec4((projectionMatrix%20*%20translationMatrix%20*%20vec3(aVertexPosition%2C%201.0)).xy%2C%200.0%2C%201.0)%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%20%20vColor%20%3D%20aColor%20*%20vec4(tint%20*%20alpha%2C%20alpha)%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%7D'%0A%20%20%20%20%20%20%20%20%5D.join('%5Cn')%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20'precision%20mediump%20float%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'varying%20vec4%20vColor%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'void%20main(void)%7B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%20%20gl_FragColor%20%3D%20vColor%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%7D'%0A%20%20%20%20%20%20%20%20%5D.join('%5Cn')%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20tint%3A%20%20%20%7B%20type%3A%20'3f'%2C%20value%3A%20%5B0%2C%200%2C%200%5D%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alpha%3A%20%20%7B%20type%3A%20'1f'%2C%20value%3A%200%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20translationMatrix%3A%20%7B%20type%3A%20'mat3'%2C%20value%3A%20new%20Float32Array(9)%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20projectionMatrix%3A%20%7B%20type%3A%20'mat3'%2C%20value%3A%20new%20Float32Array(9)%20%7D%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20attributes%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20aVertexPosition%3A0%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20aColor%3A0%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%7D%0A%0APrimitiveShader.prototype%20%3D%20Object.create(Shader.prototype)%3B%0APrimitiveShader.prototype.constructor%20%3D%20PrimitiveShader%3B%0Amodule.exports%20%3D%20PrimitiveShader%3B%0A%0A%7D%2C%7B%22.%2FShader%22%3A51%7D%5D%2C51%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F*global%20console%20*%2F%0Avar%20utils%20%3D%20require('..%2F..%2F..%2Futils')%3B%0A%0A%2F**%0A%20*%20Base%20shader%20class%20for%20PIXI%20managed%20shaders.%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20shaderManager%20%7BPIXI.ShaderManager%7D%20The%20webgl%20shader%20manager%20this%20shader%20works%20for.%0A%20*%20%40param%20%5BvertexSrc%5D%20%7Bstring%7D%20The%20source%20of%20the%20vertex%20shader.%0A%20*%20%40param%20%5BfragmentSrc%5D%20%7Bstring%7D%20The%20source%20of%20the%20fragment%20shader.%0A%20*%20%40param%20%5Buniforms%5D%20%7Bobject%7D%20Uniforms%20for%20this%20shader.%0A%20*%20%40param%20%5Battributes%5D%20%7Bobject%7D%20Attributes%20for%20this%20shader.%0A%20*%2F%0Afunction%20Shader(shaderManager%2C%20vertexSrc%2C%20fragmentSrc%2C%20uniforms%2C%20attributes)%0A%7B%0A%20%20%20%20if%20(!vertexSrc%20%7C%7C%20!fragmentSrc)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20throw%20new%20Error('Pixi.js%20Error.%20Shader%20requires%20vertexSrc%20and%20fragmentSrc')%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20A%20unique%20id%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40readonly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.uid%20%3D%20utils.uid()%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20current%20WebGL%20drawing%20context%0A%20%20%20%20%20*%20%40member%20%7BWebGLRenderingContext%7D%0A%20%20%20%20%20*%20%40readonly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.gl%20%3D%20shaderManager.renderer.gl%3B%0A%0A%20%20%20%20%2F%2FTODO%20maybe%20we%20should%20pass%20renderer%20rather%20than%20shader%20manger%3F%3F%20food%20for%20thought..%0A%20%20%20%20this.shaderManager%20%3D%20shaderManager%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20WebGL%20program.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BWebGLProgram%7D%0A%20%20%20%20%20*%20%40readonly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.program%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20uniforms%20as%20an%20object%0A%20%20%20%20%20*%20%40member%20%7Bobject%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.uniforms%20%3D%20uniforms%20%7C%7C%20%7B%7D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20attributes%20as%20an%20object%0A%20%20%20%20%20*%20%40member%20%7Bobject%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.attributes%20%3D%20attributes%20%7C%7C%20%7B%7D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Internal%20texture%20counter%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.textureCount%20%3D%201%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20vertex%20shader%20as%20an%20array%20of%20strings%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bstring%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.vertexSrc%20%3D%20vertexSrc%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20fragment%20shader%20as%20an%20array%20of%20strings%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bstring%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.fragmentSrc%20%3D%20fragmentSrc%3B%0A%0A%20%20%20%20this.init()%3B%0A%7D%0A%0AShader.prototype.constructor%20%3D%20Shader%3B%0Amodule.exports%20%3D%20Shader%3B%0A%0A%2F**%0A%20*%20Creates%20the%20shader%20and%20uses%20it%0A%20*%0A%20*%2F%0AShader.prototype.init%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.compile()%3B%0A%0A%20%20%20%20this.gl.useProgram(this.program)%3B%0A%0A%20%20%20%20this.cacheUniformLocations(Object.keys(this.uniforms))%3B%0A%20%20%20%20this.cacheAttributeLocations(Object.keys(this.attributes))%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Caches%20the%20locations%20of%20the%20uniform%20for%20reuse.%0A%20*%0A%20*%20%40param%20keys%20%7Bstring%7D%20the%20uniforms%20to%20cache%0A%20*%2F%0AShader.prototype.cacheUniformLocations%20%3D%20function%20(keys)%0A%7B%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20keys.length%3B%20%2B%2Bi)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.uniforms%5Bkeys%5Bi%5D%5D._location%20%3D%20this.gl.getUniformLocation(this.program%2C%20keys%5Bi%5D)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Caches%20the%20locations%20of%20the%20attribute%20for%20reuse.%0A%20*%0A%20*%20%40param%20keys%20%7Bstring%7D%20the%20attributes%20to%20cache%0A%20*%2F%0AShader.prototype.cacheAttributeLocations%20%3D%20function%20(keys)%0A%7B%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20keys.length%3B%20%2B%2Bi)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.attributes%5Bkeys%5Bi%5D%5D%20%3D%20this.gl.getAttribLocation(this.program%2C%20keys%5Bi%5D)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20TODO%3A%20Check%20if%20this%20is%20needed%20anymore...%0A%0A%20%20%20%20%2F%2F%20Begin%20worst%20hack%20eva%20%2F%2F%0A%0A%20%20%20%20%2F%2F%20WHY%3F%3F%3F%20ONLY%20on%20my%20chrome%20pixel%20the%20line%20above%20returns%20-1%20when%20using%20filters%3F%0A%20%20%20%20%2F%2F%20maybe%20its%20something%20to%20do%20with%20the%20current%20state%20of%20the%20gl%20context.%0A%20%20%20%20%2F%2F%20I'm%20convinced%20this%20is%20a%20bug%20in%20the%20chrome%20browser%20as%20there%20is%20NO%20reason%20why%20this%20should%20be%20returning%20-1%20especially%20as%20it%20only%20manifests%20on%20my%20chrome%20pixel%0A%20%20%20%20%2F%2F%20If%20theres%20any%20webGL%20people%20that%20know%20why%20could%20happen%20please%20help%20%3A)%0A%20%20%20%20%2F%2F%20if%20(this.attributes.aColor%20%3D%3D%3D%20-1)%7B%0A%20%20%20%20%2F%2F%20%20%20%20%20this.attributes.aColor%20%3D%202%3B%0A%20%20%20%20%2F%2F%20%7D%0A%0A%20%20%20%20%2F%2F%20End%20worst%20hack%20eva%20%2F%2F%0A%7D%3B%0A%0A%2F**%0A%20*%20Attaches%20the%20shaders%20and%20creates%20the%20program.%0A%20*%0A%20*%20%40return%20%7BWebGLProgram%7D%0A%20*%2F%0AShader.prototype.compile%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.gl%3B%0A%0A%20%20%20%20var%20glVertShader%20%3D%20this._glCompile(gl.VERTEX_SHADER%2C%20this.vertexSrc)%3B%0A%20%20%20%20var%20glFragShader%20%3D%20this._glCompile(gl.FRAGMENT_SHADER%2C%20this.fragmentSrc)%3B%0A%0A%20%20%20%20var%20program%20%3D%20gl.createProgram()%3B%0A%0A%20%20%20%20gl.attachShader(program%2C%20glVertShader)%3B%0A%20%20%20%20gl.attachShader(program%2C%20glFragShader)%3B%0A%20%20%20%20gl.linkProgram(program)%3B%0A%0A%20%20%20%20%2F%2F%20if%20linking%20fails%2C%20then%20log%20and%20cleanup%0A%20%20%20%20if%20(!gl.getProgramParameter(program%2C%20gl.LINK_STATUS))%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20console.error('Pixi.js%20Error%3A%20Could%20not%20initialize%20shader.')%3B%0A%20%20%20%20%20%20%20%20console.error('gl.VALIDATE_STATUS'%2C%20gl.getProgramParameter(program%2C%20gl.VALIDATE_STATUS))%3B%0A%20%20%20%20%20%20%20%20console.error('gl.getError()'%2C%20gl.getError())%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20if%20there%20is%20a%20program%20info%20log%2C%20log%20it%0A%20%20%20%20%20%20%20%20if%20(gl.getProgramInfoLog(program)%20!%3D%3D%20'')%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.warn('Pixi.js%20Warning%3A%20gl.getProgramInfoLog()'%2C%20gl.getProgramInfoLog(program))%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20gl.deleteProgram(program)%3B%0A%20%20%20%20%20%20%20%20program%20%3D%20null%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20clean%20up%20some%20shaders%0A%20%20%20%20gl.deleteShader(glVertShader)%3B%0A%20%20%20%20gl.deleteShader(glFragShader)%3B%0A%0A%20%20%20%20return%20(this.program%20%3D%20program)%3B%0A%7D%3B%0A%0A%2F*%0AShader.prototype.buildSync%20%3D%20function%20()%0A%7B%0A%20%20%20%2F%2F%20var%20str%20%3D%20%22%22%0A%0A%20%20%20%2F%2F%20str%20%3D%20%20%22Shader.prototype.syncUniforms%20%3D%20function()%22%3B%0A%20%20%20%2F%2F%20str%20%2B%3D%20%22%7B%5Cn%22%3B%0A%0A%20%20%20%20for%20(var%20key%20in%20this.uniforms)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20uniform%20%3D%20this.uniforms%5Bkey%5D%3B%0A%0A%20%20%20%20%20%20%20%20Object.defineProperty(this%2C%20key%2C%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20uniform.value%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.setUniform(uniform%2C%20value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20%20%20console.log(%20makePropSetter(%20key%2C%20%22%20bloop%22%2C%20uniform.type%20)%20%20)%0A%20%20%2F%2F%20%20%20%20%20%20Object.def%0A%20%20%20%20%20%20%20%20%2F%2F%20%20%20%20location%20%3D%20uniform._location%2C%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20%20value%20%3D%20uniform.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2Fi%2C%20il%3B%0A%0A%20%20%20%20%2F%2F%20%20%20%20str%20%2B%3D%20%22gl.uniform1i(this.uniforms.%22%2B%20key%20%2B%22._location%2C%20this.uniforms.%22%20%2B%20key%20%2B%20%22.value%20)%3B%5Cn%22%0A%0A%20%20%20%20%7D%0A%0A%7D*%2F%0A%0A%2F**%0A*%20Adds%20a%20new%20uniform%0A*%0A*%20%40param%20uniform%20%7Bobject%7D%20the%20new%20uniform%20to%20attach%0A*%2F%0AShader.prototype.syncUniform%20%3D%20function%20(uniform)%0A%7B%0A%20%20%20%20var%20location%20%3D%20uniform._location%2C%0A%20%20%20%20%20%20%20%20value%20%3D%20uniform.value%2C%0A%20%20%20%20%20%20%20%20gl%20%3D%20this.gl%2C%0A%20%20%20%20%20%20%20%20i%2C%20il%3B%0A%0A%20%20%20%20switch%20(uniform.type)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20case%20'b'%3A%0A%20%20%20%20%20%20%20%20case%20'bool'%3A%0A%20%20%20%20%20%20%20%20case%20'boolean'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform1i(location%2C%20value%20%3F%201%20%3A%200)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20single%20int%20value%0A%20%20%20%20%20%20%20%20case%20'i'%3A%0A%20%20%20%20%20%20%20%20case%20'1i'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform1i(location%2C%20value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20single%20float%20value%0A%20%20%20%20%20%20%20%20case%20'f'%3A%0A%20%20%20%20%20%20%20%20case%20'1f'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform1f(location%2C%20value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Float32Array(2)%20or%20JS%20Arrray%0A%20%20%20%20%20%20%20%20case%20'2f'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform2f(location%2C%20value%5B0%5D%2C%20value%5B1%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Float32Array(3)%20or%20JS%20Arrray%0A%20%20%20%20%20%20%20%20case%20'3f'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform3f(location%2C%20value%5B0%5D%2C%20value%5B1%5D%2C%20value%5B2%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Float32Array(4)%20or%20JS%20Arrray%0A%20%20%20%20%20%20%20%20case%20'4f'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform4f(location%2C%20value%5B0%5D%2C%20value%5B1%5D%2C%20value%5B2%5D%2C%20value%5B3%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20a%202D%20Point%20object%0A%20%20%20%20%20%20%20%20case%20'v2'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform2f(location%2C%20value.x%2C%20value.y)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20a%203D%20Point%20object%0A%20%20%20%20%20%20%20%20case%20'v3'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform3f(location%2C%20value.x%2C%20value.y%2C%20value.z)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20a%204D%20Point%20object%0A%20%20%20%20%20%20%20%20case%20'v4'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform4f(location%2C%20value.x%2C%20value.y%2C%20value.z%2C%20value.w)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Int32Array%20or%20JS%20Array%0A%20%20%20%20%20%20%20%20case%20'1iv'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform1iv(location%2C%20value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Int32Array%20or%20JS%20Array%0A%20%20%20%20%20%20%20%20case%20'2iv'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform2iv(location%2C%20value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Int32Array%20or%20JS%20Array%0A%20%20%20%20%20%20%20%20case%20'3iv'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform3iv(location%2C%20value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Int32Array%20or%20JS%20Array%0A%20%20%20%20%20%20%20%20case%20'4iv'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform4iv(location%2C%20value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Float32Array%20or%20JS%20Array%0A%20%20%20%20%20%20%20%20case%20'1fv'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform1fv(location%2C%20value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Float32Array%20or%20JS%20Array%0A%20%20%20%20%20%20%20%20case%20'2fv'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform2fv(location%2C%20value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Float32Array%20or%20JS%20Array%0A%20%20%20%20%20%20%20%20case%20'3fv'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform3fv(location%2C%20value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Float32Array%20or%20JS%20Array%0A%20%20%20%20%20%20%20%20case%20'4fv'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform4fv(location%2C%20value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Float32Array%20or%20JS%20Array%0A%20%20%20%20%20%20%20%20case%20'm2'%3A%0A%20%20%20%20%20%20%20%20case%20'mat2'%3A%0A%20%20%20%20%20%20%20%20case%20'Matrix2fv'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniformMatrix2fv(location%2C%20uniform.transpose%2C%20value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Float32Array%20or%20JS%20Array%0A%20%20%20%20%20%20%20%20case%20'm3'%3A%0A%20%20%20%20%20%20%20%20case%20'mat3'%3A%0A%20%20%20%20%20%20%20%20case%20'Matrix3fv'%3A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniformMatrix3fv(location%2C%20uniform.transpose%2C%20value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Float32Array%20or%20JS%20Array%0A%20%20%20%20%20%20%20%20case%20'm4'%3A%0A%20%20%20%20%20%20%20%20case%20'mat4'%3A%0A%20%20%20%20%20%20%20%20case%20'Matrix4fv'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniformMatrix4fv(location%2C%20uniform.transpose%2C%20value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20a%20Color%20Value%0A%20%20%20%20%20%20%20%20case%20'c'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(typeof%20value%20%3D%3D%3D%20'number')%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20value%20%3D%20utils.hex2rgb(value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform3f(location%2C%20value%5B0%5D%2C%20value%5B1%5D%2C%20value%5B2%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20flat%20array%20of%20integers%20(JS%20or%20typed%20array)%0A%20%20%20%20%20%20%20%20case%20'iv1'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform1iv(location%2C%20value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20flat%20array%20of%20integers%20with%203%20x%20N%20size%20(JS%20or%20typed%20array)%0A%20%20%20%20%20%20%20%20case%20'iv'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform3iv(location%2C%20value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20flat%20array%20of%20floats%20(JS%20or%20typed%20array)%0A%20%20%20%20%20%20%20%20case%20'fv1'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform1fv(location%2C%20value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20flat%20array%20of%20floats%20with%203%20x%20N%20size%20(JS%20or%20typed%20array)%0A%20%20%20%20%20%20%20%20case%20'fv'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform3fv(location%2C%20value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20array%20of%202D%20Point%20objects%0A%20%20%20%20%20%20%20%20case%20'v2v'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!uniform._array)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform._array%20%3D%20new%20Float32Array(2%20*%20value.length)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(i%20%3D%200%2C%20il%20%3D%20value.length%3B%20i%20%3C%20il%3B%20%2B%2Bi)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform._array%5Bi%20*%202%5D%20%20%20%20%20%20%20%3D%20value%5Bi%5D.x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform._array%5Bi%20*%202%20%2B%201%5D%20%20%20%3D%20value%5Bi%5D.y%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform2fv(location%2C%20uniform._array)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20array%20of%203D%20Point%20objects%0A%20%20%20%20%20%20%20%20case%20'v3v'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!uniform._array)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform._array%20%3D%20new%20Float32Array(3%20*%20value.length)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(i%20%3D%200%2C%20il%20%3D%20value.length%3B%20i%20%3C%20il%3B%20%2B%2Bi)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform._array%5Bi%20*%203%5D%20%20%20%20%20%20%20%3D%20value%5Bi%5D.x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform._array%5Bi%20*%203%20%2B%201%5D%20%20%20%3D%20value%5Bi%5D.y%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform._array%5Bi%20*%203%20%2B%202%5D%20%20%20%3D%20value%5Bi%5D.z%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform3fv(location%2C%20uniform._array)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20array%20of%204D%20Point%20objects%0A%20%20%20%20%20%20%20%20case%20'v4v'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!uniform._array)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform._array%20%3D%20new%20Float32Array(4%20*%20value.length)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(i%20%3D%200%2C%20il%20%3D%20value.length%3B%20i%20%3C%20il%3B%20%2B%2Bi)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform._array%5Bi%20*%204%5D%20%20%20%20%20%20%20%3D%20value%5Bi%5D.x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform._array%5Bi%20*%204%20%2B%201%5D%20%20%20%3D%20value%5Bi%5D.y%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform._array%5Bi%20*%204%20%2B%202%5D%20%20%20%3D%20value%5Bi%5D.z%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform._array%5Bi%20*%204%20%2B%203%5D%20%20%20%3D%20value%5Bi%5D.w%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform4fv(location%2C%20uniform._array)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20PIXI.Texture%0A%20%20%20%20%20%20%20%20case%20't'%3A%0A%20%20%20%20%20%20%20%20case%20'sampler2D'%3A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!uniform.value%20%7C%7C%20!uniform.value.baseTexture.hasLoaded)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20activate%20this%20texture%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.activeTexture(gl%5B'TEXTURE'%20%2B%20this.textureCount%5D)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20texture%20%3D%20uniform.value.baseTexture._glTextures%5Bgl.id%5D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!texture)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.initSampler2D(uniform)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20set%20the%20textur%20to%20the%20newly%20created%20one..%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20texture%20%3D%20uniform.value.baseTexture._glTextures%5Bgl.id%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20bind%20the%20texture%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.bindTexture(gl.TEXTURE_2D%2C%20texture)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20set%20uniform%20to%20texture%20index%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.uniform1i(uniform._location%2C%20this.textureCount)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20increment%20next%20texture%20id%0A%20%20%20%20%20%20%20%20%20%20%20%20this.textureCount%2B%2B%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20console.warn('Pixi.js%20Shader%20Warning%3A%20Unknown%20uniform%20type%3A%20'%20%2B%20uniform.type)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Updates%20the%20shader%20uniform%20values.%0A%20*%0A%20*%2F%0AShader.prototype.syncUniforms%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.textureCount%20%3D%201%3B%0A%0A%20%20%20%20for%20(var%20key%20in%20this.uniforms)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.syncUniform(this.uniforms%5Bkey%5D)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Initialises%20a%20Sampler2D%20uniform%20(which%20may%20only%20be%20available%20later%20on%20after%20initUniforms%20once%20the%20texture%20has%20loaded)%0A%20*%0A%20*%2F%0AShader.prototype.initSampler2D%20%3D%20function%20(uniform)%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.gl%3B%0A%0A%20%20%20%20var%20texture%20%3D%20uniform.value.baseTexture%3B%0A%0A%20%20%20%20if(!texture.hasLoaded)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%0A%0A%20%20%20%20if%20(uniform.textureData)%0A%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20%2F%2FTODO%20move%20this...%0A%20%20%20%20%20%20%20%20var%20data%20%3D%20uniform.textureData%3B%0A%0A%20%20%20%20%20%20%20%20texture._glTextures%5Bgl.id%5D%20%3D%20gl.createTexture()%3B%0A%0A%20%20%20%20%20%20%20%20gl.bindTexture(gl.TEXTURE_2D%2C%20texture._glTextures%5Bgl.id%5D)%3B%0A%0A%20%20%20%20%20%20%20%20gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL%2C%20texture.premultipliedAlpha)%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20GLTexture%20%3D%20mag%20linear%2C%20min%20linear_mipmap_linear%2C%20wrap%20repeat%20%2B%20gl.generateMipmap(gl.TEXTURE_2D)%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20GLTextureLinear%20%3D%20mag%2Fmin%20linear%2C%20wrap%20clamp%0A%20%20%20%20%20%20%20%20%2F%2F%20GLTextureNearestRepeat%20%3D%20mag%2Fmin%20NEAREST%2C%20wrap%20repeat%0A%20%20%20%20%20%20%20%20%2F%2F%20GLTextureNearest%20%3D%20mag%2Fmin%20nearest%2C%20wrap%20clamp%0A%20%20%20%20%20%20%20%20%2F%2F%20AudioTexture%20%3D%20whatever%20%2B%20luminance%20%2B%20width%20512%2C%20height%202%2C%20border%200%0A%20%20%20%20%20%20%20%20%2F%2F%20KeyTexture%20%3D%20whatever%20%2B%20luminance%20%2B%20width%20256%2C%20height%202%2C%20border%200%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20%20magFilter%20can%20be%3A%20gl.LINEAR%2C%20gl.LINEAR_MIPMAP_LINEAR%20or%20gl.NEAREST%0A%20%20%20%20%20%20%20%20%2F%2F%20%20wrapS%2FT%20can%20be%3A%20gl.CLAMP_TO_EDGE%20or%20gl.REPEAT%0A%0A%20%20%20%20%20%20%20%20gl.texImage2D(gl.TEXTURE_2D%2C%200%2C%20data.luminance%20%3F%20gl.LUMINANCE%20%3A%20gl.RGBA%2C%20gl.RGBA%2C%20gl.UNSIGNED_BYTE%2C%20texture.source)%3B%0A%0A%20%20%20%20%20%20%20%20gl.texParameteri(gl.TEXTURE_2D%2C%20gl.TEXTURE_MAG_FILTER%2C%20data.magFilter%20%3F%20data.magFilter%20%3A%20gl.LINEAR%20)%3B%0A%20%20%20%20%20%20%20%20gl.texParameteri(gl.TEXTURE_2D%2C%20gl.TEXTURE_MIN_FILTER%2C%20data.wrapS%20%3F%20data.wrapS%20%3A%20gl.CLAMP_TO_EDGE%20)%3B%0A%0A%20%20%20%20%20%20%20%20gl.texParameteri(gl.TEXTURE_2D%2C%20gl.TEXTURE_WRAP_T%2C%20data.wrapS%20%3F%20data.wrapS%20%3A%20gl.CLAMP_TO_EDGE)%3B%0A%20%20%20%20%20%20%20%20gl.texParameteri(gl.TEXTURE_2D%2C%20gl.TEXTURE_WRAP_S%2C%20data.wrapT%20%3F%20data.wrapT%20%3A%20gl.CLAMP_TO_EDGE)%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.shaderManager.renderer.updateTexture(texture)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20the%20shader.%0A%20*%0A%20*%2F%0AShader.prototype.destroy%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.gl.deleteProgram(this.program)%3B%0A%0A%20%20%20%20this.gl%20%3D%20null%3B%0A%20%20%20%20this.uniforms%20%3D%20null%3B%0A%20%20%20%20this.attributes%20%3D%20null%3B%0A%0A%20%20%20%20this.vertexSrc%20%3D%20null%3B%0A%20%20%20%20this.fragmentSrc%20%3D%20null%3B%0A%7D%3B%0A%0AShader.prototype._glCompile%20%3D%20function%20(type%2C%20src)%0A%7B%0A%20%20%20%20var%20shader%20%3D%20this.gl.createShader(type)%3B%0A%0A%20%20%20%20this.gl.shaderSource(shader%2C%20src)%3B%0A%20%20%20%20this.gl.compileShader(shader)%3B%0A%0A%20%20%20%20if%20(!this.gl.getShaderParameter(shader%2C%20this.gl.COMPILE_STATUS))%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20console.log(this.gl.getShaderInfoLog(shader))%3B%0A%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20shader%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2F..%2F..%2Futils%22%3A67%7D%5D%2C52%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20Shader%20%3D%20require('.%2FShader')%3B%0A%0A%2F**%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40extends%20PIXI.Shader%0A%20*%20%40param%20shaderManager%20%7BPIXI.ShaderManager%7D%20The%20webgl%20shader%20manager%20this%20shader%20works%20for.%0A%20*%20%40param%20%5BvertexSrc%5D%20%7Bstring%7D%20The%20source%20of%20the%20vertex%20shader.%0A%20*%20%40param%20%5BfragmentSrc%5D%20%7Bstring%7D%20The%20source%20of%20the%20fragment%20shader.%0A%20*%20%40param%20%5BcustomUniforms%5D%20%7Bobject%7D%20Custom%20uniforms%20to%20use%20to%20augment%20the%20built-in%20ones.%0A%20*%20%40param%20%5BfragmentSrc%5D%20%7Bstring%7D%20The%20source%20of%20the%20fragment%20shader.%0A%20*%2F%0Afunction%20TextureShader(shaderManager%2C%20vertexSrc%2C%20fragmentSrc%2C%20customUniforms%2C%20customAttributes)%0A%7B%0A%20%20%20%20var%20uniforms%20%3D%20%7B%0A%0A%20%20%20%20%20%20%20%20uSampler%3A%20%20%20%20%20%20%20%20%20%20%20%7B%20type%3A%20'sampler2D'%2C%20value%3A%200%20%7D%2C%0A%20%20%20%20%20%20%20%20projectionMatrix%3A%20%20%20%7B%20type%3A%20'mat3'%2C%20value%3A%20new%20Float32Array(%5B1%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%200%2C%201%2C%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%200%2C%200%2C%201%5D)%20%7D%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20if%20(customUniforms)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20for%20(var%20u%20in%20customUniforms)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20uniforms%5Bu%5D%20%3D%20customUniforms%5Bu%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%0A%20%20%20%20var%20attributes%20%3D%20%7B%0A%20%20%20%20%20%20%20%20aVertexPosition%3A%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20aTextureCoord%3A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20aColor%3A%20%20%20%20%20%20%20%20%20%20%20%20%200%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20if%20(customAttributes)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20for%20(var%20a%20in%20customAttributes)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20attributes%5Ba%5D%20%3D%20customAttributes%5Ba%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20vertex%20shader.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bstring%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20vertexSrc%20%3D%20vertexSrc%20%7C%7C%20TextureShader.defaultVertexSrc%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20fragment%20shader.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bstring%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20fragmentSrc%20%3D%20fragmentSrc%20%7C%7C%20TextureShader.defaultFragmentSrc%3B%0A%0A%20%20%20%20Shader.call(this%2C%20shaderManager%2C%20vertexSrc%2C%20fragmentSrc%2C%20uniforms%2C%20attributes)%3B%0A%7D%0A%0A%2F%2F%20constructor%0ATextureShader.prototype%20%3D%20Object.create(Shader.prototype)%3B%0ATextureShader.prototype.constructor%20%3D%20TextureShader%3B%0Amodule.exports%20%3D%20TextureShader%3B%0A%0A%2F**%0A%20*%20The%20default%20vertex%20shader%20source%0A%20*%0A%20*%20%40static%0A%20*%20%40constant%0A%20*%2F%0ATextureShader.defaultVertexSrc%20%3D%20%5B%0A%20%20%20%20'precision%20lowp%20float%3B'%2C%0A%20%20%20%20'attribute%20vec2%20aVertexPosition%3B'%2C%0A%20%20%20%20'attribute%20vec2%20aTextureCoord%3B'%2C%0A%20%20%20%20'attribute%20vec4%20aColor%3B'%2C%0A%0A%20%20%20%20'uniform%20mat3%20projectionMatrix%3B'%2C%0A%0A%20%20%20%20'varying%20vec2%20vTextureCoord%3B'%2C%0A%20%20%20%20'varying%20vec4%20vColor%3B'%2C%0A%0A%20%20%20%20'void%20main(void)%7B'%2C%0A%20%20%20%20'%20%20%20gl_Position%20%3D%20vec4((projectionMatrix%20*%20vec3(aVertexPosition%2C%201.0)).xy%2C%200.0%2C%201.0)%3B'%2C%0A%20%20%20%20'%20%20%20vTextureCoord%20%3D%20aTextureCoord%3B'%2C%0A%20%20%20%20'%20%20%20vColor%20%3D%20vec4(aColor.rgb%20*%20aColor.a%2C%20aColor.a)%3B'%2C%0A%20%20%20%20'%7D'%0A%5D.join('%5Cn')%3B%0A%0A%2F**%0A%20*%20The%20default%20fragment%20shader%20source%0A%20*%0A%20*%20%40static%0A%20*%20%40constant%0A%20*%2F%0ATextureShader.defaultFragmentSrc%20%3D%20%5B%0A%20%20%20%20'precision%20lowp%20float%3B'%2C%0A%0A%20%20%20%20'varying%20vec2%20vTextureCoord%3B'%2C%0A%20%20%20%20'varying%20vec4%20vColor%3B'%2C%0A%0A%20%20%20%20'uniform%20sampler2D%20uSampler%3B'%2C%0A%0A%20%20%20%20'void%20main(void)%7B'%2C%0A%20%20%20%20'%20%20%20gl_FragColor%20%3D%20texture2D(uSampler%2C%20vTextureCoord)%20*%20vColor%20%3B'%2C%0A%20%20%20%20'%7D'%0A%5D.join('%5Cn')%3B%0A%0A%7D%2C%7B%22.%2FShader%22%3A51%7D%5D%2C53%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20WebGLManager%20%3D%20require('..%2Fmanagers%2FWebGLManager')%3B%0A%0A%2F**%0A%20*%20Base%20for%20a%20common%20object%20renderer%20that%20can%20be%20used%20as%20a%20system%20renderer%20plugin.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.WebGLManager%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20The%20renderer%20this%20object%20renderer%20works%20for.%0A%20*%2F%0Afunction%20ObjectRenderer(renderer)%0A%7B%0A%20%20%20%20WebGLManager.call(this%2C%20renderer)%3B%0A%7D%0A%0A%0AObjectRenderer.prototype%20%3D%20Object.create(WebGLManager.prototype)%3B%0AObjectRenderer.prototype.constructor%20%3D%20ObjectRenderer%3B%0Amodule.exports%20%3D%20ObjectRenderer%3B%0A%0A%2F**%0A%20*%20Starts%20the%20renderer%20and%20sets%20the%20shader%0A%20*%0A%20*%2F%0AObjectRenderer.prototype.start%20%3D%20function%20()%0A%7B%0A%20%20%20%20%2F%2F%20set%20the%20shader..%0A%7D%3B%0A%0A%2F**%0A%20*%20Stops%20the%20renderer%0A%20*%0A%20*%2F%0AObjectRenderer.prototype.stop%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.flush()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20flushes%0A%20*%0A%20*%2F%0AObjectRenderer.prototype.flush%20%3D%20function%20()%0A%7B%0A%20%20%20%20%2F%2F%20flush!%0A%7D%3B%0A%0A%2F**%0A%20*%20Renders%20an%20object%0A%20*%0A%20*%20%40param%20object%20%7BPIXI.DisplayObject%7D%20The%20object%20to%20render.%0A%20*%2F%0AObjectRenderer.prototype.render%20%3D%20function%20(object)%20%2F%2F%20jshint%20unused%3Afalse%0A%7B%0A%20%20%20%20%2F%2F%20render%20the%20object%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fmanagers%2FWebGLManager%22%3A48%7D%5D%2C54%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F**%0A%20*%20Helper%20class%20to%20create%20a%20quad%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20gl%20%7BWebGLRenderingContext%7D%20The%20gl%20context%20for%20this%20quad%20to%20use.%0A%20*%2F%0Afunction%20Quad(gl)%0A%7B%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20the%20current%20WebGL%20drawing%20context%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BWebGLRenderingContext%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.gl%20%3D%20gl%3B%0A%0A%2F%2F%20%20%20%20this.textures%20%3D%20new%20TextureUvs()%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20An%20array%20of%20vertices%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BFloat32Array%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.vertices%20%3D%20new%20Float32Array(%5B%0A%20%20%20%20%20%20%20%200%2C0%2C%0A%20%20%20%20%20%20%20%20200%2C0%2C%0A%20%20%20%20%20%20%20%20200%2C200%2C%0A%20%20%20%20%20%20%20%200%2C200%0A%20%20%20%20%5D)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20Uvs%20of%20the%20quad%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BFloat32Array%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.uvs%20%3D%20new%20Float32Array(%5B%0A%20%20%20%20%20%20%20%200%2C0%2C%0A%20%20%20%20%20%20%20%201%2C0%2C%0A%20%20%20%20%20%20%20%201%2C1%2C%0A%20%20%20%20%20%20%20%200%2C1%0A%20%20%20%20%5D)%3B%0A%0A%2F%2F%20%20%20%20var%20white%20%3D%20(0xFFFFFF%20%3E%3E%2016)%20%2B%20(0xFFFFFF%20%26%200xff00)%20%2B%20((0xFFFFFF%20%26%200xff)%20%3C%3C%2016)%20%2B%20(1%20*%20255%20%3C%3C%2024)%3B%0A%20%20%20%20%2F%2FTODO%20convert%20this%20to%20a%2032%20unsigned%20int%20array%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20color%20components%20of%20the%20triangles%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BFloat32Array%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.colors%20%3D%20new%20Float32Array(%5B%0A%20%20%20%20%20%20%20%201%2C1%2C1%2C1%2C%0A%20%20%20%20%20%20%20%201%2C1%2C1%2C1%2C%0A%20%20%20%20%20%20%20%201%2C1%2C1%2C1%2C%0A%20%20%20%20%20%20%20%201%2C1%2C1%2C1%0A%20%20%20%20%5D)%3B%0A%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20%40member%20%7BUint16Array%7D%20An%20array%20containing%20the%20indices%20of%20the%20vertices%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.indices%20%3D%20new%20Uint16Array(%5B%0A%20%20%20%20%20%20%20%200%2C%201%2C%202%2C%200%2C%203%2C%202%0A%20%20%20%20%5D)%3B%0A%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20%40member%20%7BWebGLBuffer%7D%20The%20vertex%20buffer%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.vertexBuffer%20%3D%20gl.createBuffer()%3B%0A%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20%40member%20%7BWebGLBuffer%7D%20The%20index%20buffer%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.indexBuffer%20%3D%20gl.createBuffer()%3B%0A%0A%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20this.vertexBuffer)%3B%0A%20%20%20%20gl.bufferData(gl.ARRAY_BUFFER%2C%20(8%20%2B%208%20%2B%2016)%20*%204%2C%20gl.DYNAMIC_DRAW)%3B%0A%0A%20%20%20%20gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER%2C%20this.indexBuffer)%3B%0A%20%20%20%20gl.bufferData(gl.ELEMENT_ARRAY_BUFFER%2C%20this.indices%2C%20gl.STATIC_DRAW)%3B%0A%0A%20%20%20%20this.upload()%3B%0A%7D%0A%0AQuad.prototype.constructor%20%3D%20Quad%3B%0A%0A%2F**%0A%20*%20Maps%20two%20Rectangle%20to%20the%20quad%0A%20*%20%40param%20rect%20%7BPIXI.Rectangle%7D%20the%20first%20rectangle%0A%20*%20%40param%20rect2%20%7BPIXI.Rectangle%7D%20the%20second%20rectangle%0A%20*%2F%0AQuad.prototype.map%20%3D%20function(rect%2C%20rect2)%0A%7B%0A%20%20%20%20var%20x%20%3D%200%3B%20%2F%2Frect2.x%20%2F%20rect.width%3B%0A%20%20%20%20var%20y%20%3D%200%3B%20%2F%2Frect2.y%20%2F%20rect.height%3B%0A%0A%20%20%20%20this.uvs%5B0%5D%20%3D%20x%3B%0A%20%20%20%20this.uvs%5B1%5D%20%3D%20y%3B%0A%0A%20%20%20%20this.uvs%5B2%5D%20%3D%20x%20%2B%20rect2.width%20%2F%20rect.width%3B%0A%20%20%20%20this.uvs%5B3%5D%20%3D%20y%3B%0A%0A%20%20%20%20this.uvs%5B4%5D%20%3D%20x%20%2B%20rect2.width%20%2F%20rect.width%3B%0A%20%20%20%20this.uvs%5B5%5D%20%3D%20y%20%2B%20rect2.height%20%2F%20rect.height%3B%0A%0A%20%20%20%20this.uvs%5B6%5D%20%3D%20x%3B%0A%20%20%20%20this.uvs%5B7%5D%20%3D%20y%20%2B%20rect2.height%20%2F%20rect.height%3B%0A%0A%20%20%20%20%2F%2F%2F%20-----%0A%20%20%20%20x%20%3D%20rect2.x%3B%0A%20%20%20%20y%20%3D%20rect2.y%3B%0A%0A%20%20%20%20this.vertices%5B0%5D%20%3D%20x%3B%0A%20%20%20%20this.vertices%5B1%5D%20%3D%20y%3B%0A%0A%20%20%20%20this.vertices%5B2%5D%20%3D%20x%20%2B%20rect2.width%3B%0A%20%20%20%20this.vertices%5B3%5D%20%3D%20y%3B%0A%0A%20%20%20%20this.vertices%5B4%5D%20%3D%20x%20%2B%20rect2.width%3B%0A%20%20%20%20this.vertices%5B5%5D%20%3D%20y%20%2B%20rect2.height%3B%0A%0A%20%20%20%20this.vertices%5B6%5D%20%3D%20x%3B%0A%20%20%20%20this.vertices%5B7%5D%20%3D%20y%20%2B%20rect2.height%3B%0A%0A%20%20%20%20this.upload()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Binds%20the%20buffer%20and%20uploads%20the%20data%0A%20*%2F%0AQuad.prototype.upload%20%3D%20function()%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.gl%3B%0A%0A%20%20%20%20%2F%2F%20TODO%20could%20probably%20be%20pushed%20into%20one%20upload!%0A%20%20%20%20gl.bindBuffer(%20gl.ARRAY_BUFFER%2C%20this.vertexBuffer%20)%3B%0A%0A%20%20%20%20gl.bufferSubData(gl.ARRAY_BUFFER%2C%200%2C%20this.vertices)%3B%0A%0A%20%20%20%20gl.bufferSubData(gl.ARRAY_BUFFER%2C%208%20*%204%2C%20this.uvs)%3B%0A%0A%20%20%20%20gl.bufferSubData(gl.ARRAY_BUFFER%2C%20(8%20%2B%208)%20*%204%2C%20this.colors)%3B%0A%7D%3B%0A%0AQuad.prototype.destroy%20%3D%20function()%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.gl%3B%0A%20%20%20%20%0A%20%20%20%20%20gl.deleteBuffer(this.vertexBuffer)%3B%0A%20%20%20%20%20gl.deleteBuffer(this.indexBuffer)%3B%0A%7D%3B%0A%0Amodule.exports%20%3D%20Quad%3B%0A%0A%0A%0A%7D%2C%7B%7D%5D%2C55%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20math%20%3D%20require('..%2F..%2F..%2Fmath')%2C%0A%20%20%20%20utils%20%3D%20require('..%2F..%2F..%2Futils')%2C%0A%20%20%20%20CONST%20%3D%20require('..%2F..%2F..%2Fconst')%2C%0A%20%20%20%20%2F%2FStencilManager%20%3D%20require('..%2Fmanagers%2FStencilManager')%2C%0A%20%20%20%20StencilMaskStack%20%3D%20require('.%2FStencilMaskStack')%3B%0A%0A%2F**%0A%20*%20%40author%20Mat%20Groves%20http%3A%2F%2Fmatgroves.com%2F%20%40Doormat23%0A%20*%2F%0A%0A%2F**%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20gl%20%7BWebGLRenderingContext%7D%20the%20current%20WebGL%20drawing%20context%0A%20*%20%40param%20width%20%7Bnumber%7D%20the%20horizontal%20range%20of%20the%20filter%0A%20*%20%40param%20height%20%7Bnumber%7D%20the%20vertical%20range%20of%20the%20filter%0A%20*%20%40param%20scaleMode%20%7Bnumber%7D%20See%20%7B%40link%20PIXI.SCALE_MODES%7D%20for%20possible%20values%0A%20*%20%40param%20resolution%20%7Bnumber%7D%20the%20current%20resolution%0A%20*%20%40param%20root%20%7Bboolean%7D%20Whether%20this%20object%20is%20the%20root%20element%20or%20not%0A%20*%2F%0Avar%20RenderTarget%20%3D%20function(gl%2C%20width%2C%20height%2C%20scaleMode%2C%20resolution%2C%20root)%0A%7B%0A%20%20%20%20%2F%2FTODO%20Resolution%20could%20go%20here%20(%20eg%20low%20res%20blurs%20)%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20current%20WebGL%20drawing%20context.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BWebGLRenderingContext%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.gl%20%3D%20gl%3B%0A%0A%20%20%20%20%2F%2F%20next%20time%20to%20create%20a%20frame%20buffer%20and%20texture%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20A%20frame%20buffer%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BWebGLFrameBuffer%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.frameBuffer%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20texture%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Texture%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.texture%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20size%20of%20the%20object%20as%20a%20rectangle%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Rectangle%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.size%20%3D%20new%20math.Rectangle(0%2C%200%2C%201%2C%201)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20current%20resolution%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.resolution%20%3D%20resolution%20%7C%7C%20CONST.RESOLUTION%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20projection%20matrix%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Matrix%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.projectionMatrix%20%3D%20new%20math.Matrix()%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20object's%20transform%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Matrix%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.transform%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20frame.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Rectangle%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.frame%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20stencil%20buffer%20stores%20masking%20data%20for%20the%20render%20target%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BWebGLRenderBuffer%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.stencilBuffer%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20data%20structure%20for%20the%20stencil%20masks%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.StencilMaskStack%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.stencilMaskStack%20%3D%20new%20StencilMaskStack()%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Stores%20filter%20data%20for%20the%20render%20target%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bobject%5B%5D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.filterStack%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderTarget%3Athis%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20filter%3A%5B%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20bounds%3Athis.size%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%5D%3B%0A%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20scale%20mode.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%20PIXI.SCALE_MODES.DEFAULT%0A%20%20%20%20%20*%20%40see%20PIXI.SCALE_MODES%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.scaleMode%20%3D%20scaleMode%20%7C%7C%20CONST.SCALE_MODES.DEFAULT%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Whether%20this%20object%20is%20the%20root%20element%20or%20not%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.root%20%3D%20root%3B%0A%0A%20%20%20%20if%20(!this.root)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%2F%2F%20this.flipY%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20this.frameBuffer%20%3D%20gl.createFramebuffer()%3B%0A%0A%20%20%20%20%20%20%20%20%2F*%0A%20%20%20%20%20%20%20%20%20%20%20%20A%20frame%20buffer%20needs%20a%20target%20to%20render%20to..%0A%20%20%20%20%20%20%20%20%20%20%20%20create%20a%20texture%20and%20bind%20it%20attach%20it%20to%20the%20framebuffer..%0A%20%20%20%20%20%20%20%20%20*%2F%0A%0A%20%20%20%20%20%20%20%20this.texture%20%3D%20gl.createTexture()%3B%0A%0A%20%20%20%20%20%20%20%20gl.bindTexture(gl.TEXTURE_2D%2C%20%20this.texture)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20set%20the%20scale%20properties%20of%20the%20texture..%0A%20%20%20%20%20%20%20%20gl.texParameteri(gl.TEXTURE_2D%2C%20gl.TEXTURE_MAG_FILTER%2C%20scaleMode%20%3D%3D%3D%20CONST.SCALE_MODES.LINEAR%20%3F%20gl.LINEAR%20%3A%20gl.NEAREST)%3B%0A%20%20%20%20%20%20%20%20gl.texParameteri(gl.TEXTURE_2D%2C%20gl.TEXTURE_MIN_FILTER%2C%20scaleMode%20%3D%3D%3D%20CONST.SCALE_MODES.LINEAR%20%3F%20gl.LINEAR%20%3A%20gl.NEAREST)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20check%20to%20see%20if%20the%20texture%20is%20a%20power%20of%20two!%0A%20%20%20%20%20%20%20%20var%20isPowerOfTwo%20%3D%20utils.isPowerOfTwo(width%2C%20height)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2FTODO%20for%2099%25%20of%20use%20cases%20if%20a%20texture%20is%20power%20of%20two%20we%20should%20tile%20the%20texture...%0A%20%20%20%20%20%20%20%20%20if%20(!isPowerOfTwo)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.texParameteri(gl.TEXTURE_2D%2C%20gl.TEXTURE_WRAP_S%2C%20gl.CLAMP_TO_EDGE)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.texParameteri(gl.TEXTURE_2D%2C%20gl.TEXTURE_WRAP_T%2C%20gl.CLAMP_TO_EDGE)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.texParameteri(gl.TEXTURE_2D%2C%20gl.TEXTURE_WRAP_S%2C%20gl.REPEAT)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.texParameteri(gl.TEXTURE_2D%2C%20gl.TEXTURE_WRAP_T%2C%20gl.REPEAT)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20gl.bindFramebuffer(gl.FRAMEBUFFER%2C%20this.frameBuffer%20)%3B%0A%20%20%20%20%20%20%20%20gl.framebufferTexture2D(gl.FRAMEBUFFER%2C%20gl.COLOR_ATTACHMENT0%2C%20gl.TEXTURE_2D%2C%20this.texture%2C%200)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.resize(width%2C%20height)%3B%0A%7D%3B%0A%0ARenderTarget.prototype.constructor%20%3D%20RenderTarget%3B%0Amodule.exports%20%3D%20RenderTarget%3B%0A%0A%2F**%0A%20*%20Clears%20the%20filter%20texture.%0A%20*%0A%20*%20%40param%20%5Bbind%3Dfalse%5D%20%7Bboolean%7D%20Should%20we%20bind%20our%20framebuffer%20before%20clearing%3F%0A%20*%2F%0ARenderTarget.prototype.clear%20%3D%20function(bind)%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.gl%3B%0A%20%20%20%20if(bind)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20gl.bindFramebuffer(gl.FRAMEBUFFER%2C%20this.frameBuffer)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20gl.clearColor(0%2C0%2C0%2C0)%3B%0A%20%20%20%20gl.clear(gl.COLOR_BUFFER_BIT)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Binds%20the%20stencil%20buffer.%0A%20*%0A%20*%2F%0ARenderTarget.prototype.attachStencilBuffer%20%3D%20function()%0A%7B%0A%0A%20%20%20%20if%20(this.stencilBuffer)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20stencil%20buffer%20is%20used%20for%20masking%20in%20pixi%0A%20%20%20%20%20*%20lets%20create%20one%20and%20then%20add%20attach%20it%20to%20the%20framebuffer..%0A%20%20%20%20%20*%2F%0A%20%20%20%20if%20(!this.root)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20gl%20%3D%20this.gl%3B%0A%0A%20%20%20%20%20%20%20%20this.stencilBuffer%20%3D%20gl.createRenderbuffer()%3B%0A%20%20%20%20%20%20%20%20gl.bindRenderbuffer(gl.RENDERBUFFER%2C%20this.stencilBuffer)%3B%0A%20%20%20%20%20%20%20%20gl.framebufferRenderbuffer(gl.FRAMEBUFFER%2C%20gl.DEPTH_STENCIL_ATTACHMENT%2C%20gl.RENDERBUFFER%2C%20this.stencilBuffer)%3B%0A%20%20%20%20%20%20%20%20gl.renderbufferStorage(gl.RENDERBUFFER%2C%20gl.DEPTH_STENCIL%2C%20%20this.size.width%20*%20this.resolution%20%20%2C%20this.size.height%20*%20this.resolution%20)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Binds%20the%20buffers%20and%20initialises%20the%20viewport.%0A%20*%0A%20*%2F%0ARenderTarget.prototype.activate%20%3D%20function()%0A%7B%0A%20%20%20%20%2F%2FTOOD%20refactor%20usage%20of%20frame..%0A%20%20%20%20var%20gl%20%3D%20this.gl%3B%0A%0A%20%20%20%20gl.bindFramebuffer(gl.FRAMEBUFFER%2C%20this.frameBuffer)%3B%0A%0A%20%20%20%20var%20projectionFrame%20%3D%20this.frame%20%7C%7C%20this.size%3B%0A%0A%20%20%20%20%2F%2F%20TODO%20add%20a%20dirty%20flag%20to%20this%20of%20a%20setter%20for%20the%20frame%3F%0A%20%20%20%20this.calculateProjection(%20projectionFrame%20)%3B%0A%0A%20%20%20%20if(this.transform)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.projectionMatrix.append(this.transform)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20gl.viewport(0%2C0%2C%20projectionFrame.width%20*%20this.resolution%2C%20projectionFrame.height%20*%20this.resolution)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Updates%20the%20projection%20matrix%20based%20on%20a%20projection%20frame%20(which%20is%20a%20rectangle)%0A%20*%0A%20*%2F%0ARenderTarget.prototype.calculateProjection%20%3D%20function%20(projectionFrame)%0A%7B%0A%20%20%20%20var%20pm%20%3D%20this.projectionMatrix%3B%0A%0A%20%20%20%20pm.identity()%3B%0A%0A%20%20%20%20if%20(!this.root)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20pm.a%20%3D%201%20%2F%20projectionFrame.width*2%3B%0A%20%20%20%20%20%20%20%20pm.d%20%3D%201%20%2F%20projectionFrame.height*2%3B%0A%0A%20%20%20%20%20%20%20%20pm.tx%20%3D%20-1%20-%20projectionFrame.x%20*%20pm.a%3B%0A%20%20%20%20%20%20%20%20pm.ty%20%3D%20-1%20-%20projectionFrame.y%20*%20pm.d%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20pm.a%20%3D%201%20%2F%20projectionFrame.width*2%3B%0A%20%20%20%20%20%20%20%20pm.d%20%3D%20-1%20%2F%20projectionFrame.height*2%3B%0A%0A%20%20%20%20%20%20%20%20pm.tx%20%3D%20-1%20-%20projectionFrame.x%20*%20pm.a%3B%0A%20%20%20%20%20%20%20%20pm.ty%20%3D%201%20-%20projectionFrame.y%20*%20pm.d%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Resizes%20the%20texture%20to%20the%20specified%20width%20and%20height%0A%20*%0A%20*%20%40param%20width%20%7BNumber%7D%20the%20new%20width%20of%20the%20texture%0A%20*%20%40param%20height%20%7BNumber%7D%20the%20new%20height%20of%20the%20texture%0A%20*%2F%0ARenderTarget.prototype.resize%20%3D%20function%20(width%2C%20height)%0A%7B%0A%20%20%20%20width%20%3D%20width%20%7C%200%3B%0A%20%20%20%20height%20%3D%20height%20%7C%200%3B%0A%0A%20%20%20%20if%20(this.size.width%20%3D%3D%3D%20width%20%26%26%20this.size.height%20%3D%3D%3D%20height)%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.size.width%20%3D%20width%3B%0A%20%20%20%20this.size.height%20%3D%20height%3B%0A%0A%20%20%20%20if%20(!this.root)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20gl%20%3D%20this.gl%3B%0A%0A%20%20%20%20%20%20%20%20gl.bindTexture(gl.TEXTURE_2D%2C%20%20this.texture)%3B%0A%0A%20%20%20%20%20%20%20%20gl.texImage2D(gl.TEXTURE_2D%2C%200%2C%20gl.RGBA%2C%20%20width%20*%20this.resolution%2C%20height%20*%20this.resolution%20%2C%200%2C%20gl.RGBA%2C%20gl.UNSIGNED_BYTE%2C%20null)%3B%0A%0A%20%20%20%20%20%20%20%20if%20(this.stencilBuffer%20)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20update%20the%20stencil%20buffer%20width%20and%20height%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.bindRenderbuffer(gl.RENDERBUFFER%2C%20this.stencilBuffer)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.renderbufferStorage(gl.RENDERBUFFER%2C%20gl.DEPTH_STENCIL%2C%20%20width%20*%20this.resolution%2C%20height%20*%20this.resolution%20)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20projectionFrame%20%3D%20this.frame%20%7C%7C%20this.size%3B%0A%0A%20%20%20%20this.calculateProjection(%20projectionFrame%20)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20the%20render%20target.%0A%20*%0A%20*%2F%0ARenderTarget.prototype.destroy%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.gl%3B%0A%20%20%20%20gl.deleteRenderbuffer(%20this.stencilBuffer%20)%3B%0A%20%20%20%20gl.deleteFramebuffer(%20this.frameBuffer%20)%3B%0A%20%20%20%20gl.deleteTexture(%20this.texture%20)%3B%0A%0A%20%20%20%20this.frameBuffer%20%3D%20null%3B%0A%20%20%20%20this.texture%20%3D%20null%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2F..%2F..%2Fconst%22%3A13%2C%22..%2F..%2F..%2Fmath%22%3A23%2C%22..%2F..%2F..%2Futils%22%3A67%2C%22.%2FStencilMaskStack%22%3A56%7D%5D%2C56%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F**%0A%20*%20Generic%20Mask%20Stack%20data%20structure%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%2F%0Afunction%20StencilMaskStack()%0A%7B%0A%09%2F**%0A%20%20%20%20%20*%20The%20actual%20stack%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bany%5B%5D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.stencilStack%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20TODO%20%40alvin%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.reverse%20%3D%20true%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Internal%20count%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.count%20%3D%200%3B%0A%7D%0A%0AStencilMaskStack.prototype.constructor%20%3D%20StencilMaskStack%3B%0Amodule.exports%20%3D%20StencilMaskStack%3B%0A%0A%7D%2C%7B%7D%5D%2C57%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20math%20%3D%20require('..%2Fmath')%2C%0A%20%20%20%20Texture%20%3D%20require('..%2Ftextures%2FTexture')%2C%0A%20%20%20%20Container%20%3D%20require('..%2Fdisplay%2FContainer')%2C%0A%20%20%20%20CanvasTinter%20%3D%20require('..%2Frenderers%2Fcanvas%2Futils%2FCanvasTinter')%2C%0A%20%20%20%20utils%20%3D%20require('..%2Futils')%2C%0A%20%20%20%20CONST%20%3D%20require('..%2Fconst')%2C%0A%20%20%20%20tempPoint%20%3D%20new%20math.Point()%3B%0A%0A%2F**%0A%20*%20The%20Sprite%20object%20is%20the%20base%20for%20all%20textured%20objects%20that%20are%20rendered%20to%20the%20screen%0A%20*%0A%20*%20A%20sprite%20can%20be%20created%20directly%20from%20an%20image%20like%20this%3A%0A%20*%0A%20*%20%60%60%60js%0A%20*%20var%20sprite%20%3D%20new%20PIXI.Sprite.fromImage('assets%2Fimage.png')%3B%0A%20*%20%60%60%60%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.Container%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20texture%20%7BPIXI.Texture%7D%20The%20texture%20for%20this%20sprite%0A%20*%2F%0Afunction%20Sprite(texture)%0A%7B%0A%20%20%20%20Container.call(this)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20anchor%20sets%20the%20origin%20point%20of%20the%20texture.%0A%20%20%20%20%20*%20The%20default%20is%200%2C0%20this%20means%20the%20texture's%20origin%20is%20the%20top%20left%0A%20%20%20%20%20*%20Setting%20the%20anchor%20to%200.5%2C0.5%20means%20the%20texture's%20origin%20is%20centered%0A%20%20%20%20%20*%20Setting%20the%20anchor%20to%201%2C1%20would%20mean%20the%20texture's%20origin%20point%20will%20be%20the%20bottom%20right%20corner%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Point%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.anchor%20%3D%20new%20math.Point()%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20texture%20that%20the%20sprite%20is%20using%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Texture%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._texture%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20width%20of%20the%20sprite%20(this%20is%20initially%20set%20by%20the%20texture)%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._width%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20height%20of%20the%20sprite%20(this%20is%20initially%20set%20by%20the%20texture)%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._height%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20tint%20applied%20to%20the%20sprite.%20This%20is%20a%20hex%20value.%20A%20value%20of%200xFFFFFF%20will%20remove%20any%20tint%20effect.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200xFFFFFF%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.tint%20%3D%200xFFFFFF%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20blend%20mode%20to%20be%20applied%20to%20the%20sprite.%20Apply%20a%20value%20of%20%60PIXI.BLEND_MODES.NORMAL%60%20to%20reset%20the%20blend%20mode.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%20PIXI.BLEND_MODES.NORMAL%0A%20%20%20%20%20*%20%40see%20PIXI.BLEND_MODES%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.blendMode%20%3D%20CONST.BLEND_MODES.NORMAL%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20shader%20that%20will%20be%20used%20to%20render%20the%20sprite.%20Set%20to%20null%20to%20remove%20a%20current%20shader.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.AbstractFilter%7CPIXI.Shader%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.shader%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20An%20internal%20cached%20value%20of%20the%20tint.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200xFFFFFF%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.cachedTint%20%3D%200xFFFFFF%3B%0A%0A%20%20%20%20%2F%2F%20call%20texture%20setter%0A%20%20%20%20this.texture%20%3D%20texture%20%7C%7C%20Texture.EMPTY%3B%0A%7D%0A%0A%2F%2F%20constructor%0ASprite.prototype%20%3D%20Object.create(Container.prototype)%3B%0ASprite.prototype.constructor%20%3D%20Sprite%3B%0Amodule.exports%20%3D%20Sprite%3B%0A%0AObject.defineProperties(Sprite.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20width%20of%20the%20sprite%2C%20setting%20this%20will%20actually%20modify%20the%20scale%20to%20achieve%20the%20value%20set%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.Sprite%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20width%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20Math.abs(this.scale.x)%20*%20this.texture._frame.width%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.scale.x%20%3D%20utils.sign(this.scale.x)%20*%20value%20%2F%20this.texture._frame.width%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._width%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20height%20of%20the%20sprite%2C%20setting%20this%20will%20actually%20modify%20the%20scale%20to%20achieve%20the%20value%20set%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.Sprite%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20height%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%20Math.abs(this.scale.y)%20*%20this.texture._frame.height%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.scale.y%20%3D%20utils.sign(this.scale.y)%20*%20value%20%2F%20this.texture._frame.height%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._height%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20texture%20that%20the%20sprite%20is%20using%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Texture%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.Sprite%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20texture%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%20this._texture%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(this._texture%20%3D%3D%3D%20value)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20this._texture%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.cachedTint%20%3D%200xFFFFFF%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(value)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20wait%20for%20the%20texture%20to%20load%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(value.baseTexture.hasLoaded)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._onTextureUpdate()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20value.once('update'%2C%20this._onTextureUpdate%2C%20this)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%2F**%0A%20*%20When%20the%20texture%20is%20updated%2C%20this%20event%20will%20fire%20to%20update%20the%20scale%20and%20frame%0A%20*%0A%20*%20%40private%0A%20*%2F%0ASprite.prototype._onTextureUpdate%20%3D%20function%20()%0A%7B%0A%20%20%20%20%2F%2F%20so%20if%20_width%20is%200%20then%20width%20was%20not%20set..%0A%20%20%20%20if%20(this._width)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.scale.x%20%3D%20utils.sign(this.scale.x)%20*%20this._width%20%2F%20this.texture.frame.width%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(this._height)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.scale.y%20%3D%20utils.sign(this.scale.y)%20*%20this._height%20%2F%20this.texture.frame.height%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A*%0A*%20Renders%20the%20object%20using%20the%20WebGL%20renderer%0A*%0A*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%0A*%20%40private%0A*%2F%0ASprite.prototype._renderWebGL%20%3D%20function%20(renderer)%0A%7B%0A%20%20%20%20renderer.setObjectRenderer(renderer.plugins.sprite)%3B%0A%20%20%20%20renderer.plugins.sprite.render(this)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Returns%20the%20bounds%20of%20the%20Sprite%20as%20a%20rectangle.%20The%20bounds%20calculation%20takes%20the%20worldTransform%20into%20account.%0A%20*%0A%20*%20%40param%20matrix%20%7BPIXI.Matrix%7D%20the%20transformation%20matrix%20of%20the%20sprite%0A%20*%20%40return%20%7BPIXI.Rectangle%7D%20the%20framing%20rectangle%0A%20*%2F%0ASprite.prototype.getBounds%20%3D%20function%20(matrix)%0A%7B%0A%20%20%20%20if(!this._currentBounds)%0A%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20var%20width%20%3D%20this._texture._frame.width%3B%0A%20%20%20%20%20%20%20%20var%20height%20%3D%20this._texture._frame.height%3B%0A%0A%20%20%20%20%20%20%20%20var%20w0%20%3D%20width%20*%20(1-this.anchor.x)%3B%0A%20%20%20%20%20%20%20%20var%20w1%20%3D%20width%20*%20-this.anchor.x%3B%0A%0A%20%20%20%20%20%20%20%20var%20h0%20%3D%20height%20*%20(1-this.anchor.y)%3B%0A%20%20%20%20%20%20%20%20var%20h1%20%3D%20height%20*%20-this.anchor.y%3B%0A%0A%20%20%20%20%20%20%20%20var%20worldTransform%20%3D%20matrix%20%7C%7C%20this.worldTransform%20%3B%0A%0A%20%20%20%20%20%20%20%20var%20a%20%3D%20worldTransform.a%3B%0A%20%20%20%20%20%20%20%20var%20b%20%3D%20worldTransform.b%3B%0A%20%20%20%20%20%20%20%20var%20c%20%3D%20worldTransform.c%3B%0A%20%20%20%20%20%20%20%20var%20d%20%3D%20worldTransform.d%3B%0A%20%20%20%20%20%20%20%20var%20tx%20%3D%20worldTransform.tx%3B%0A%20%20%20%20%20%20%20%20var%20ty%20%3D%20worldTransform.ty%3B%0A%0A%20%20%20%20%20%20%20%20var%20minX%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20maxX%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20minY%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20maxY%3B%0A%0A%0A%20%20%20%20%20%20%20%20if%20(b%20%3D%3D%3D%200%20%26%26%20c%20%3D%3D%3D%200)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20scale%20may%20be%20negative!%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(a%20%3C%200)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20a%20*%3D%20-1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(d%20%3C%200)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20d%20*%3D%20-1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20this%20means%20there%20is%20no%20rotation%20going%20on%20right%3F%20RIGHT%3F%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20if%20thats%20the%20case%20then%20we%20can%20avoid%20checking%20the%20bound%20values!%20yay%0A%20%20%20%20%20%20%20%20%20%20%20%20minX%20%3D%20a%20*%20w1%20%2B%20tx%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20maxX%20%3D%20a%20*%20w0%20%2B%20tx%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20minY%20%3D%20d%20*%20h1%20%2B%20ty%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20maxY%20%3D%20d%20*%20h0%20%2B%20ty%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20x1%20%3D%20a%20*%20w1%20%2B%20c%20*%20h1%20%2B%20tx%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20y1%20%3D%20d%20*%20h1%20%2B%20b%20*%20w1%20%2B%20ty%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20x2%20%3D%20a%20*%20w0%20%2B%20c%20*%20h1%20%2B%20tx%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20y2%20%3D%20d%20*%20h1%20%2B%20b%20*%20w0%20%2B%20ty%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20x3%20%3D%20a%20*%20w0%20%2B%20c%20*%20h0%20%2B%20tx%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20y3%20%3D%20d%20*%20h0%20%2B%20b%20*%20w0%20%2B%20ty%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20x4%20%3D%20%20a%20*%20w1%20%2B%20c%20*%20h0%20%2B%20tx%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20y4%20%3D%20%20d%20*%20h0%20%2B%20b%20*%20w1%20%2B%20ty%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20minX%20%3D%20x1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20minX%20%3D%20x2%20%3C%20minX%20%3F%20x2%20%3A%20minX%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20minX%20%3D%20x3%20%3C%20minX%20%3F%20x3%20%3A%20minX%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20minX%20%3D%20x4%20%3C%20minX%20%3F%20x4%20%3A%20minX%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20minY%20%3D%20y1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20minY%20%3D%20y2%20%3C%20minY%20%3F%20y2%20%3A%20minY%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20minY%20%3D%20y3%20%3C%20minY%20%3F%20y3%20%3A%20minY%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20minY%20%3D%20y4%20%3C%20minY%20%3F%20y4%20%3A%20minY%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20maxX%20%3D%20x1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20maxX%20%3D%20x2%20%3E%20maxX%20%3F%20x2%20%3A%20maxX%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20maxX%20%3D%20x3%20%3E%20maxX%20%3F%20x3%20%3A%20maxX%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20maxX%20%3D%20x4%20%3E%20maxX%20%3F%20x4%20%3A%20maxX%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20maxY%20%3D%20y1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20maxY%20%3D%20y2%20%3E%20maxY%20%3F%20y2%20%3A%20maxY%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20maxY%20%3D%20y3%20%3E%20maxY%20%3F%20y3%20%3A%20maxY%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20maxY%20%3D%20y4%20%3E%20maxY%20%3F%20y4%20%3A%20maxY%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20check%20for%20children%0A%20%20%20%20%20%20%20%20if(this.children.length)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20childBounds%20%3D%20this.containerGetBounds()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20w0%20%3D%20childBounds.x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20w1%20%3D%20childBounds.x%20%2B%20childBounds.width%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20h0%20%3D%20childBounds.y%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20h1%20%3D%20childBounds.y%20%2B%20childBounds.height%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20minX%20%3D%20(minX%20%3C%20w0)%20%3F%20minX%20%3A%20w0%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20minY%20%3D%20(minY%20%3C%20h0)%20%3F%20minY%20%3A%20h0%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20maxX%20%3D%20(maxX%20%3E%20w1)%20%3F%20maxX%20%3A%20w1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20maxY%20%3D%20(maxY%20%3E%20h1)%20%3F%20maxY%20%3A%20h1%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20var%20bounds%20%3D%20this._bounds%3B%0A%0A%20%20%20%20%20%20%20%20bounds.x%20%3D%20minX%3B%0A%20%20%20%20%20%20%20%20bounds.width%20%3D%20maxX%20-%20minX%3B%0A%0A%20%20%20%20%20%20%20%20bounds.y%20%3D%20minY%3B%0A%20%20%20%20%20%20%20%20bounds.height%20%3D%20maxY%20-%20minY%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20store%20a%20reference%20so%20that%20if%20this%20function%20gets%20called%20again%20in%20the%20render%20cycle%20we%20do%20not%20have%20to%20recalculate%0A%20%20%20%20%20%20%20%20this._currentBounds%20%3D%20bounds%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20this._currentBounds%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Gets%20the%20local%20bounds%20of%20the%20sprite%20object.%0A%20*%0A%20*%2F%0ASprite.prototype.getLocalBounds%20%3D%20function%20()%0A%7B%0A%20%20%20%20this._bounds.x%20%3D%20-this._texture._frame.width%20*%20this.anchor.x%3B%0A%20%20%20%20this._bounds.y%20%3D%20-this._texture._frame.height%20*%20this.anchor.y%3B%0A%20%20%20%20this._bounds.width%20%3D%20this._texture._frame.width%3B%0A%20%20%20%20this._bounds.height%20%3D%20this._texture._frame.height%3B%0A%20%20%20%20return%20this._bounds%3B%0A%7D%3B%0A%0A%2F**%0A*%20Tests%20if%20a%20point%20is%20inside%20this%20sprite%0A*%0A*%20%40param%20point%20%7BPIXI.Point%7D%20the%20point%20to%20test%0A*%20%40return%20%7Bboolean%7D%20the%20result%20of%20the%20test%0A*%2F%0ASprite.prototype.containsPoint%20%3D%20function(%20point%20)%0A%7B%0A%20%20%20%20this.worldTransform.applyInverse(point%2C%20%20tempPoint)%3B%0A%0A%20%20%20%20var%20width%20%3D%20this._texture._frame.width%3B%0A%20%20%20%20var%20height%20%3D%20this._texture._frame.height%3B%0A%20%20%20%20var%20x1%20%3D%20-width%20*%20this.anchor.x%3B%0A%20%20%20%20var%20y1%3B%0A%0A%20%20%20%20if%20(%20tempPoint.x%20%3E%20x1%20%26%26%20tempPoint.x%20%3C%20x1%20%2B%20width%20)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20y1%20%3D%20-height%20*%20this.anchor.y%3B%0A%0A%20%20%20%20%20%20%20%20if%20(%20tempPoint.y%20%3E%20y1%20%26%26%20tempPoint.y%20%3C%20y1%20%2B%20height%20)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20false%3B%0A%7D%3B%0A%0A%2F**%0A*%20Renders%20the%20object%20using%20the%20Canvas%20renderer%0A*%0A*%20%40param%20renderer%20%7BPIXI.CanvasRenderer%7D%20The%20renderer%0A*%20%40private%0A*%2F%0ASprite.prototype._renderCanvas%20%3D%20function%20(renderer)%0A%7B%0A%20%20%20%20if%20(this.texture.crop.width%20%3C%3D%200%20%7C%7C%20this.texture.crop.height%20%3C%3D%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20compositeOperation%20%3D%20renderer.blendModes%5Bthis.blendMode%5D%3B%0A%20%20%20%20if%20(compositeOperation%20!%3D%3D%20renderer.context.globalCompositeOperation)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20renderer.context.globalCompositeOperation%20%3D%20compositeOperation%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20%20Ignore%20null%20sources%0A%20%20%20%20if%20(this.texture.valid)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20texture%20%3D%20this._texture%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20wt%20%3D%20this.worldTransform%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20dx%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20dy%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20width%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3B%0A%0A%20%20%20%20%20%20%20%20renderer.context.globalAlpha%20%3D%20this.worldAlpha%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20If%20smoothingEnabled%20is%20supported%20and%20we%20need%20to%20change%20the%20smoothing%20property%20for%20this%20texture%0A%20%20%20%20%20%20%20%20var%20smoothingEnabled%20%3D%20texture.baseTexture.scaleMode%20%3D%3D%3D%20CONST.SCALE_MODES.LINEAR%3B%0A%20%20%20%20%20%20%20%20if%20(renderer.smoothProperty%20%26%26%20renderer.context%5Brenderer.smoothProperty%5D%20!%3D%3D%20smoothingEnabled)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderer.context%5Brenderer.smoothProperty%5D%20%3D%20smoothingEnabled%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20If%20the%20texture%20is%20trimmed%20we%20offset%20by%20the%20trim%20x%2Fy%2C%20otherwise%20we%20use%20the%20frame%20dimensions%0A%0A%20%20%20%20%20%20%20%20if(texture.rotate)%0A%20%20%20%20%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20cheeky%20rotation!%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20a%20%3D%20wt.a%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20b%20%3D%20wt.b%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20wt.a%20%20%3D%20-wt.c%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20wt.b%20%20%3D%20-wt.d%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20wt.c%20%20%3D%20%20a%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20wt.d%20%20%3D%20%20b%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20width%20%3D%20texture.crop.height%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20height%20%3D%20texture.crop.width%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20dx%20%3D%20(texture.trim)%20%3F%20texture.trim.y%20-%20this.anchor.y%20*%20texture.trim.height%20%3A%20this.anchor.y%20*%20-texture._frame.height%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20dy%20%3D%20(texture.trim)%20%3F%20texture.trim.x%20-%20this.anchor.x%20*%20texture.trim.width%20%3A%20this.anchor.x%20*%20-texture._frame.width%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20width%20%3D%20texture.crop.width%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20height%20%3D%20texture.crop.height%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20dx%20%3D%20(texture.trim)%20%3F%20texture.trim.x%20-%20this.anchor.x%20*%20texture.trim.width%20%3A%20this.anchor.x%20*%20-texture._frame.width%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20dy%20%3D%20(texture.trim)%20%3F%20texture.trim.y%20-%20this.anchor.y%20*%20texture.trim.height%20%3A%20this.anchor.y%20*%20-texture._frame.height%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Allow%20for%20pixel%20rounding%0A%20%20%20%20%20%20%20%20if%20(renderer.roundPixels)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderer.context.setTransform(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wt.a%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wt.b%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wt.c%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wt.d%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(wt.tx%20*%20renderer.resolution)%20%7C%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(wt.ty%20*%20renderer.resolution)%20%7C%200%0A%20%20%20%20%20%20%20%20%20%20%20%20)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20dx%20%3D%20dx%20%7C%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20dy%20%3D%20dy%20%7C%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20renderer.context.setTransform(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wt.a%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wt.b%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wt.c%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wt.d%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wt.tx%20*%20renderer.resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wt.ty%20*%20renderer.resolution%0A%20%20%20%20%20%20%20%20%20%20%20%20)%3B%0A%0A%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20var%20resolution%20%3D%20texture.baseTexture.resolution%3B%0A%0A%20%20%20%20%20%20%20%20if%20(this.tint%20!%3D%3D%200xFFFFFF)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.cachedTint%20!%3D%3D%20this.tint)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.cachedTint%20%3D%20this.tint%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20TODO%20clean%20up%20caching%20-%20how%20to%20clean%20up%20the%20caches%3F%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.tintedTexture%20%3D%20CanvasTinter.getTintedTexture(this%2C%20this.tint)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20renderer.context.drawImage(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.tintedTexture%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20width%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20height%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dx%20*%20renderer.resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dy%20*%20renderer.resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20width%20*%20renderer.resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20height%20*%20renderer.resolution%0A%20%20%20%20%20%20%20%20%20%20%20%20)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderer.context.drawImage(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20texture.baseTexture.source%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20texture.crop.x%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20texture.crop.y%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20width%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20height%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dx%20%20*%20renderer.resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dy%20%20*%20renderer.resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20width%20*%20renderer.resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20height%20*%20renderer.resolution%0A%20%20%20%20%20%20%20%20%20%20%20%20)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20this%20sprite%20and%20optionally%20its%20texture%0A%20*%0A%20*%20%40param%20%5BdestroyTexture%3Dfalse%5D%20%7Bboolean%7D%20Should%20it%20destroy%20the%20current%20texture%20of%20the%20sprite%20as%20well%0A%20*%20%40param%20%5BdestroyBaseTexture%3Dfalse%5D%20%7Bboolean%7D%20Should%20it%20destroy%20the%20base%20texture%20of%20the%20sprite%20as%20well%0A%20*%2F%0ASprite.prototype.destroy%20%3D%20function%20(destroyTexture%2C%20destroyBaseTexture)%0A%7B%0A%20%20%20%20Container.prototype.destroy.call(this)%3B%0A%0A%20%20%20%20this.anchor%20%3D%20null%3B%0A%0A%20%20%20%20if%20(destroyTexture)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this._texture.destroy(destroyBaseTexture)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this._texture%20%3D%20null%3B%0A%20%20%20%20this.shader%20%3D%20null%3B%0A%7D%3B%0A%0A%2F%2F%20some%20helper%20functions..%0A%0A%2F**%0A%20*%20Helper%20function%20that%20creates%20a%20sprite%20that%20will%20contain%20a%20texture%20from%20the%20TextureCache%20based%20on%20the%20frameId%0A%20*%20The%20frame%20ids%20are%20created%20when%20a%20Texture%20packer%20file%20has%20been%20loaded%0A%20*%0A%20*%20%40static%0A%20*%20%40param%20frameId%20%7Bstring%7D%20The%20frame%20Id%20of%20the%20texture%20in%20the%20cache%0A%20*%20%40param%20%5Bcrossorigin%3D(auto)%5D%20%7Bboolean%7D%20if%20you%20want%20to%20specify%20the%20cross-origin%20parameter%0A%20*%20%40param%20%5BscaleMode%3DPIXI.SCALE_MODES.DEFAULT%5D%20%7Bnumber%7D%20if%20you%20want%20to%20specify%20the%20scale%20mode%2C%20see%20%7B%40link%20PIXI.SCALE_MODES%7D%20for%20possible%20values%0A%20*%20%40return%20%7BPIXI.Sprite%7D%20A%20new%20Sprite%20using%20a%20texture%20from%20the%20texture%20cache%20matching%20the%20frameId%0A%20*%2F%0ASprite.fromFrame%20%3D%20function%20(frameId)%0A%7B%0A%20%20%20%20var%20texture%20%3D%20utils.TextureCache%5BframeId%5D%3B%0A%0A%20%20%20%20if%20(!texture)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error('The%20frameId%20%22'%20%2B%20frameId%20%2B%20'%22%20does%20not%20exist%20in%20the%20texture%20cache')%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20new%20Sprite(texture)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Helper%20function%20that%20creates%20a%20sprite%20that%20will%20contain%20a%20texture%20based%20on%20an%20image%20url%0A%20*%20If%20the%20image%20is%20not%20in%20the%20texture%20cache%20it%20will%20be%20loaded%0A%20*%0A%20*%20%40static%0A%20*%20%40param%20imageId%20%7Bstring%7D%20The%20image%20url%20of%20the%20texture%0A%20*%20%40return%20%7BPIXI.Sprite%7D%20A%20new%20Sprite%20using%20a%20texture%20from%20the%20texture%20cache%20matching%20the%20image%20id%0A%20*%2F%0ASprite.fromImage%20%3D%20function%20(imageId%2C%20crossorigin%2C%20scaleMode)%0A%7B%0A%20%20%20%20return%20new%20Sprite(Texture.fromImage(imageId%2C%20crossorigin%2C%20scaleMode))%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fconst%22%3A13%2C%22..%2Fdisplay%2FContainer%22%3A14%2C%22..%2Fmath%22%3A23%2C%22..%2Frenderers%2Fcanvas%2Futils%2FCanvasTinter%22%3A38%2C%22..%2Ftextures%2FTexture%22%3A62%2C%22..%2Futils%22%3A67%7D%5D%2C58%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20ObjectRenderer%20%3D%20require('..%2F..%2Frenderers%2Fwebgl%2Futils%2FObjectRenderer')%2C%0A%20%20%20%20WebGLRenderer%20%3D%20require('..%2F..%2Frenderers%2Fwebgl%2FWebGLRenderer')%2C%0A%20%20%20%20CONST%20%3D%20require('..%2F..%2Fconst')%3B%0A%0A%2F**%0A%20*%20%40author%20Mat%20Groves%0A%20*%0A%20*%20Big%20thanks%20to%20the%20very%20clever%20Matt%20DesLauriers%20%3Cmattdesl%3E%20https%3A%2F%2Fgithub.com%2Fmattdesl%2F%0A%20*%20for%20creating%20the%20original%20pixi%20version!%0A%20*%20Also%20a%20thanks%20to%20https%3A%2F%2Fgithub.com%2Fbchevalier%20for%20tweaking%20the%20tint%20and%20alpha%20so%20that%20they%20now%20share%204%20bytes%20on%20the%20vertex%20buffer%0A%20*%0A%20*%20Heavily%20inspired%20by%20LibGDX's%20SpriteRenderer%3A%0A%20*%20https%3A%2F%2Fgithub.com%2Flibgdx%2Flibgdx%2Fblob%2Fmaster%2Fgdx%2Fsrc%2Fcom%2Fbadlogic%2Fgdx%2Fgraphics%2Fg2d%2FSpriteRenderer.java%0A%20*%2F%0A%0A%2F**%0A%20*%20Renderer%20dedicated%20to%20drawing%20and%20batching%20sprites.%0A%20*%0A%20*%20%40class%0A%20*%20%40private%0A%20*%20%40memberof%20PIXI%0A%20*%20%40extends%20PIXI.ObjectRenderer%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20The%20renderer%20this%20sprite%20batch%20works%20for.%0A%20*%2F%0Afunction%20SpriteRenderer(renderer)%0A%7B%0A%20%20%20%20ObjectRenderer.call(this%2C%20renderer)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Number%20of%20values%20sent%20in%20the%20vertex%20buffer.%0A%20%20%20%20%20*%20positionX%2C%20positionY%2C%20colorR%2C%20colorG%2C%20colorB%20%3D%205%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.vertSize%20%3D%205%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20size%20of%20the%20vertex%20information%20in%20bytes.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.vertByteSize%20%3D%20this.vertSize%20*%204%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20number%20of%20images%20in%20the%20SpriteBatch%20before%20it%20flushes.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.size%20%3D%20CONST.SPRITE_BATCH_SIZE%3B%20%2F%2F%202000%20is%20a%20nice%20balance%20between%20mobile%20%2F%20desktop%0A%0A%20%20%20%20%2F%2F%20the%20total%20number%20of%20bytes%20in%20our%20batch%0A%20%20%20%20var%20numVerts%20%3D%20(this.size%20*%204)%20*%20this.vertByteSize%3B%0A%0A%20%20%20%20%2F%2F%20the%20total%20number%20of%20indices%20in%20our%20batch%2C%20there%20are%206%20points%20per%20quad.%0A%20%20%20%20var%20numIndices%20%3D%20this.size%20*%206%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Holds%20the%20vertex%20data%20that%20will%20be%20sent%20to%20the%20vertex%20shader.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BArrayBuffer%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.vertices%20%3D%20new%20ArrayBuffer(numVerts)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20View%20on%20the%20vertices%20as%20a%20Float32Array%20for%20positions%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BFloat32Array%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.positions%20%3D%20new%20Float32Array(this.vertices)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20View%20on%20the%20vertices%20as%20a%20Uint32Array%20for%20colors%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BUint32Array%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.colors%20%3D%20new%20Uint32Array(this.vertices)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Holds%20the%20indices%20of%20the%20geometry%20(quads)%20to%20draw%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BUint16Array%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.indices%20%3D%20new%20Uint16Array(numIndices)%3B%0A%0A%20%20%20%20%2F%2F%20fill%20the%20indices%20with%20the%20quads%20to%20draw%0A%20%20%20%20for%20(var%20i%3D0%2C%20j%3D0%3B%20i%20%3C%20numIndices%3B%20i%20%2B%3D%206%2C%20j%20%2B%3D%204)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.indices%5Bi%20%2B%200%5D%20%3D%20j%20%2B%200%3B%0A%20%20%20%20%20%20%20%20this.indices%5Bi%20%2B%201%5D%20%3D%20j%20%2B%201%3B%0A%20%20%20%20%20%20%20%20this.indices%5Bi%20%2B%202%5D%20%3D%20j%20%2B%202%3B%0A%20%20%20%20%20%20%20%20this.indices%5Bi%20%2B%203%5D%20%3D%20j%20%2B%200%3B%0A%20%20%20%20%20%20%20%20this.indices%5Bi%20%2B%204%5D%20%3D%20j%20%2B%202%3B%0A%20%20%20%20%20%20%20%20this.indices%5Bi%20%2B%205%5D%20%3D%20j%20%2B%203%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20current%20size%20of%20the%20batch%2C%20each%20render()%20call%20adds%20to%20this%20number.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.currentBatchSize%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20current%20sprites%20in%20the%20batch.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Sprite%5B%5D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.sprites%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20default%20shader%20that%20is%20used%20if%20a%20sprite%20doesn't%20have%20a%20more%20specific%20one.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Shader%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.shader%20%3D%20null%3B%0A%7D%0A%0ASpriteRenderer.prototype%20%3D%20Object.create(ObjectRenderer.prototype)%3B%0ASpriteRenderer.prototype.constructor%20%3D%20SpriteRenderer%3B%0Amodule.exports%20%3D%20SpriteRenderer%3B%0A%0AWebGLRenderer.registerPlugin('sprite'%2C%20SpriteRenderer)%3B%0A%0A%2F**%0A%20*%20Sets%20up%20the%20renderer%20context%20and%20necessary%20buffers.%0A%20*%0A%20*%20%40private%0A%20*%20%40param%20gl%20%7BWebGLRenderingContext%7D%20the%20current%20WebGL%20drawing%20context%0A%20*%2F%0ASpriteRenderer.prototype.onContextChange%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%0A%20%20%20%20%2F%2F%20setup%20default%20shader%0A%20%20%20%20this.shader%20%3D%20this.renderer.shaderManager.defaultShader%3B%0A%0A%20%20%20%20%2F%2F%20create%20a%20couple%20of%20buffers%0A%20%20%20%20this.vertexBuffer%20%3D%20gl.createBuffer()%3B%0A%20%20%20%20this.indexBuffer%20%3D%20gl.createBuffer()%3B%0A%0A%20%20%20%20%2F%2Fupload%20the%20index%20data%0A%20%20%20%20gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER%2C%20this.indexBuffer)%3B%0A%20%20%20%20gl.bufferData(gl.ELEMENT_ARRAY_BUFFER%2C%20this.indices%2C%20gl.STATIC_DRAW)%3B%0A%0A%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20this.vertexBuffer)%3B%0A%20%20%20%20gl.bufferData(gl.ARRAY_BUFFER%2C%20this.vertices%2C%20gl.DYNAMIC_DRAW)%3B%0A%0A%20%20%20%20this.currentBlendMode%20%3D%2099999%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Renders%20the%20sprite%20object.%0A%20*%0A%20*%20%40param%20sprite%20%7BPIXI.Sprite%7D%20the%20sprite%20to%20render%20when%20using%20this%20spritebatch%0A%20*%2F%0ASpriteRenderer.prototype.render%20%3D%20function%20(sprite)%0A%7B%0A%20%20%20%20var%20texture%20%3D%20sprite._texture%3B%0A%0A%20%20%20%20%2F%2FTODO%20set%20blend%20modes..%0A%20%20%20%20%2F%2F%20check%20texture..%0A%20%20%20%20if%20(this.currentBatchSize%20%3E%3D%20this.size)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.flush()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20get%20the%20uvs%20for%20the%20texture%0A%20%20%20%20var%20uvs%20%3D%20texture._uvs%3B%0A%0A%20%20%20%20%2F%2F%20if%20the%20uvs%20have%20not%20updated%20then%20no%20point%20rendering%20just%20yet!%0A%20%20%20%20if%20(!uvs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20TODO%20trim%3F%3F%0A%20%20%20%20var%20aX%20%3D%20sprite.anchor.x%3B%0A%20%20%20%20var%20aY%20%3D%20sprite.anchor.y%3B%0A%0A%20%20%20%20var%20w0%2C%20w1%2C%20h0%2C%20h1%3B%0A%0A%20%20%20%20if%20(texture.trim%20%26%26%20sprite.tileScale%20%3D%3D%3D%20undefined)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20if%20the%20sprite%20is%20trimmed%20and%20is%20not%20a%20tilingsprite%20then%20we%20need%20to%20add%20the%20extra%20space%20before%20transforming%20the%20sprite%20coords..%0A%20%20%20%20%20%20%20%20var%20trim%20%3D%20texture.trim%3B%0A%0A%20%20%20%20%20%20%20%20w1%20%3D%20trim.x%20-%20aX%20*%20trim.width%3B%0A%20%20%20%20%20%20%20%20w0%20%3D%20w1%20%2B%20texture.crop.width%3B%0A%0A%20%20%20%20%20%20%20%20h1%20%3D%20trim.y%20-%20aY%20*%20trim.height%3B%0A%20%20%20%20%20%20%20%20h0%20%3D%20h1%20%2B%20texture.crop.height%3B%0A%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20w0%20%3D%20(texture._frame.width%20)%20*%20(1-aX)%3B%0A%20%20%20%20%20%20%20%20w1%20%3D%20(texture._frame.width%20)%20*%20-aX%3B%0A%0A%20%20%20%20%20%20%20%20h0%20%3D%20texture._frame.height%20*%20(1-aY)%3B%0A%20%20%20%20%20%20%20%20h1%20%3D%20texture._frame.height%20*%20-aY%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20index%20%3D%20this.currentBatchSize%20*%20this.vertByteSize%3B%0A%0A%20%20%20%20var%20worldTransform%20%3D%20sprite.worldTransform%3B%0A%0A%20%20%20%20var%20a%20%3D%20worldTransform.a%3B%0A%20%20%20%20var%20b%20%3D%20worldTransform.b%3B%0A%20%20%20%20var%20c%20%3D%20worldTransform.c%3B%0A%20%20%20%20var%20d%20%3D%20worldTransform.d%3B%0A%20%20%20%20var%20tx%20%3D%20worldTransform.tx%3B%0A%20%20%20%20var%20ty%20%3D%20worldTransform.ty%3B%0A%0A%20%20%20%20var%20colors%20%3D%20this.colors%3B%0A%20%20%20%20var%20positions%20%3D%20this.positions%3B%0A%0A%20%20%20%20if%20(this.renderer.roundPixels)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20xy%0A%20%20%20%20%20%20%20%20positions%5Bindex%5D%20%3D%20a%20*%20w1%20%2B%20c%20*%20h1%20%2B%20tx%20%7C%200%3B%0A%20%20%20%20%20%20%20%20positions%5Bindex%2B1%5D%20%3D%20d%20*%20h1%20%2B%20b%20*%20w1%20%2B%20ty%20%7C%200%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20xy%0A%20%20%20%20%20%20%20%20positions%5Bindex%2B5%5D%20%3D%20a%20*%20w0%20%2B%20c%20*%20h1%20%2B%20tx%20%7C%200%3B%0A%20%20%20%20%20%20%20%20positions%5Bindex%2B6%5D%20%3D%20d%20*%20h1%20%2B%20b%20*%20w0%20%2B%20ty%20%7C%200%3B%0A%0A%20%20%20%20%20%20%20%20%20%2F%2F%20xy%0A%20%20%20%20%20%20%20%20positions%5Bindex%2B10%5D%20%3D%20a%20*%20w0%20%2B%20c%20*%20h0%20%2B%20tx%20%7C%200%3B%0A%20%20%20%20%20%20%20%20positions%5Bindex%2B11%5D%20%3D%20d%20*%20h0%20%2B%20b%20*%20w0%20%2B%20ty%20%7C%200%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20xy%0A%20%20%20%20%20%20%20%20positions%5Bindex%2B15%5D%20%3D%20a%20*%20w1%20%2B%20c%20*%20h0%20%2B%20tx%20%7C%200%3B%0A%20%20%20%20%20%20%20%20positions%5Bindex%2B16%5D%20%3D%20d%20*%20h0%20%2B%20b%20*%20w1%20%2B%20ty%20%7C%200%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20xy%0A%20%20%20%20%20%20%20%20positions%5Bindex%5D%20%3D%20a%20*%20w1%20%2B%20c%20*%20h1%20%2B%20tx%3B%0A%20%20%20%20%20%20%20%20positions%5Bindex%2B1%5D%20%3D%20d%20*%20h1%20%2B%20b%20*%20w1%20%2B%20ty%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20xy%0A%20%20%20%20%20%20%20%20positions%5Bindex%2B5%5D%20%3D%20a%20*%20w0%20%2B%20c%20*%20h1%20%2B%20tx%3B%0A%20%20%20%20%20%20%20%20positions%5Bindex%2B6%5D%20%3D%20d%20*%20h1%20%2B%20b%20*%20w0%20%2B%20ty%3B%0A%0A%20%20%20%20%20%20%20%20%20%2F%2F%20xy%0A%20%20%20%20%20%20%20%20positions%5Bindex%2B10%5D%20%3D%20a%20*%20w0%20%2B%20c%20*%20h0%20%2B%20tx%3B%0A%20%20%20%20%20%20%20%20positions%5Bindex%2B11%5D%20%3D%20d%20*%20h0%20%2B%20b%20*%20w0%20%2B%20ty%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20xy%0A%20%20%20%20%20%20%20%20positions%5Bindex%2B15%5D%20%3D%20a%20*%20w1%20%2B%20c%20*%20h0%20%2B%20tx%3B%0A%20%20%20%20%20%20%20%20positions%5Bindex%2B16%5D%20%3D%20d%20*%20h0%20%2B%20b%20*%20w1%20%2B%20ty%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20uv%0A%20%20%20%20positions%5Bindex%2B2%5D%20%3D%20uvs.x0%3B%0A%20%20%20%20positions%5Bindex%2B3%5D%20%3D%20uvs.y0%3B%0A%0A%20%20%20%20%2F%2F%20uv%0A%20%20%20%20positions%5Bindex%2B7%5D%20%3D%20uvs.x1%3B%0A%20%20%20%20positions%5Bindex%2B8%5D%20%3D%20uvs.y1%3B%0A%0A%20%20%20%20%20%2F%2F%20uv%0A%20%20%20%20positions%5Bindex%2B12%5D%20%3D%20uvs.x2%3B%0A%20%20%20%20positions%5Bindex%2B13%5D%20%3D%20uvs.y2%3B%0A%0A%20%20%20%20%2F%2F%20uv%0A%20%20%20%20positions%5Bindex%2B17%5D%20%3D%20uvs.x3%3B%0A%20%20%20%20positions%5Bindex%2B18%5D%20%3D%20uvs.y3%3B%0A%0A%20%20%20%20%2F%2F%20color%20and%20alpha%0A%20%20%20%20var%20tint%20%3D%20sprite.tint%3B%0A%20%20%20%20colors%5Bindex%2B4%5D%20%3D%20colors%5Bindex%2B9%5D%20%3D%20colors%5Bindex%2B14%5D%20%3D%20colors%5Bindex%2B19%5D%20%3D%20(tint%20%3E%3E%2016)%20%2B%20(tint%20%26%200xff00)%20%2B%20((tint%20%26%200xff)%20%3C%3C%2016)%20%2B%20(sprite.worldAlpha%20*%20255%20%3C%3C%2024)%3B%0A%0A%20%20%20%20%2F%2F%20increment%20the%20batchsize%0A%20%20%20%20this.sprites%5Bthis.currentBatchSize%2B%2B%5D%20%3D%20sprite%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Renders%20the%20content%20and%20empties%20the%20current%20batch.%0A%20*%0A%20*%2F%0ASpriteRenderer.prototype.flush%20%3D%20function%20()%0A%7B%0A%20%20%20%20%2F%2F%20If%20the%20batch%20is%20length%200%20then%20return%20as%20there%20is%20nothing%20to%20draw%0A%20%20%20%20if%20(this.currentBatchSize%20%3D%3D%3D%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%20%20%20%20var%20shader%3B%0A%0A%20%20%20%20%2F%2F%20upload%20the%20verts%20to%20the%20buffer%0A%20%20%20%20if%20(this.currentBatchSize%20%3E%20(%20this.size%20*%200.5%20)%20)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20gl.bufferSubData(gl.ARRAY_BUFFER%2C%200%2C%20this.vertices)%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20view%20%3D%20this.positions.subarray(0%2C%20this.currentBatchSize%20*%20this.vertByteSize)%3B%0A%20%20%20%20%20%20%20%20gl.bufferSubData(gl.ARRAY_BUFFER%2C%200%2C%20view)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20nextTexture%2C%20nextBlendMode%2C%20nextShader%3B%0A%20%20%20%20var%20batchSize%20%3D%200%3B%0A%20%20%20%20var%20start%20%3D%200%3B%0A%0A%20%20%20%20var%20currentBaseTexture%20%3D%20null%3B%0A%20%20%20%20var%20currentBlendMode%20%3D%20this.renderer.blendModeManager.currentBlendMode%3B%0A%20%20%20%20var%20currentShader%20%3D%20null%3B%0A%0A%20%20%20%20var%20blendSwap%20%3D%20false%3B%0A%20%20%20%20var%20shaderSwap%20%3D%20false%3B%0A%20%20%20%20var%20sprite%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%2C%20j%20%3D%20this.currentBatchSize%3B%20i%20%3C%20j%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20sprite%20%3D%20this.sprites%5Bi%5D%3B%0A%0A%20%20%20%20%20%20%20%20nextTexture%20%3D%20sprite._texture.baseTexture%3B%0A%20%20%20%20%20%20%20%20nextBlendMode%20%3D%20sprite.blendMode%3B%0A%20%20%20%20%20%20%20%20nextShader%20%3D%20sprite.shader%20%7C%7C%20this.shader%3B%0A%0A%20%20%20%20%20%20%20%20blendSwap%20%3D%20currentBlendMode%20!%3D%3D%20nextBlendMode%3B%0A%20%20%20%20%20%20%20%20shaderSwap%20%3D%20currentShader%20!%3D%3D%20nextShader%3B%20%2F%2F%20should%20I%20use%20uidS%3F%3F%3F%0A%0A%20%20%20%20%20%20%20%20if%20(currentBaseTexture%20!%3D%3D%20nextTexture%20%7C%7C%20blendSwap%20%7C%7C%20shaderSwap)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.renderBatch(currentBaseTexture%2C%20batchSize%2C%20start)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20start%20%3D%20i%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20batchSize%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20currentBaseTexture%20%3D%20nextTexture%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(blendSwap)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20currentBlendMode%20%3D%20nextBlendMode%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.renderer.blendModeManager.setBlendMode(%20currentBlendMode%20)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(shaderSwap)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20currentShader%20%3D%20nextShader%3B%0A%0A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20shader%20%3D%20currentShader.shaders%20%3F%20currentShader.shaders%5Bgl.id%5D%20%3A%20currentShader%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!shader)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20shader%20%3D%20currentShader.getShader(this.renderer)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20set%20shader%20function%3F%3F%3F%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.renderer.shaderManager.setShader(shader)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2FTODO%20-%20i%20KNOW%20this%20can%20be%20optimised!%20Once%20v3%20is%20stable%20il%20look%20at%20this%20next...%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20shader.uniforms.projectionMatrix.value%20%3D%20this.renderer.currentRenderTarget.projectionMatrix.toArray(true)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2FMake%20this%20a%20little%20more%20dynamic%20%2F%20intelligent!%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20shader.syncUniforms()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2FTODO%20investigate%20some%20kind%20of%20texture%20state%20managment%3F%3F%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20need%20to%20make%20sure%20this%20texture%20is%20the%20active%20one%20for%20all%20the%20batch%20swaps..%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.activeTexture(gl.TEXTURE0)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20both%20thease%20only%20need%20to%20be%20set%20if%20they%20are%20changing..%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20set%20the%20projection%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2Fgl.uniformMatrix3fv(shader.uniforms.projectionMatrix._location%2C%20false%2C%20this.renderer.currentRenderTarget.projectionMatrix.toArray(true))%3B%0A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20batchSize%2B%2B%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.renderBatch(currentBaseTexture%2C%20batchSize%2C%20start)%3B%0A%0A%20%20%20%20%2F%2F%20then%20reset%20the%20batch!%0A%20%20%20%20this.currentBatchSize%20%3D%200%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Draws%20the%20currently%20batches%20sprites.%0A%20*%0A%20*%20%40private%0A%20*%20%40param%20texture%20%7BPIXI.Texture%7D%0A%20*%20%40param%20size%20%7Bnumber%7D%0A%20*%20%40param%20startIndex%20%7Bnumber%7D%0A%20*%2F%0ASpriteRenderer.prototype.renderBatch%20%3D%20function%20(texture%2C%20size%2C%20startIndex)%0A%7B%0A%20%20%20%20if%20(size%20%3D%3D%3D%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%0A%20%20%20%20if%20(!texture._glTextures%5Bgl.id%5D)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.renderer.updateTexture(texture)%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20bind%20the%20current%20texture%0A%20%20%20%20%20%20%20%20gl.bindTexture(gl.TEXTURE_2D%2C%20texture._glTextures%5Bgl.id%5D)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20now%20draw%20those%20suckas!%0A%20%20%20%20gl.drawElements(gl.TRIANGLES%2C%20size%20*%206%2C%20gl.UNSIGNED_SHORT%2C%20startIndex%20*%206%20*%202)%3B%0A%0A%20%20%20%20%2F%2F%20increment%20the%20draw%20count%0A%20%20%20%20this.renderer.drawCount%2B%2B%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Starts%20a%20new%20sprite%20batch.%0A%20*%0A%20*%2F%0ASpriteRenderer.prototype.start%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%0A%20%20%20%20%2F%2F%20bind%20the%20main%20texture%0A%0A%0A%20%20%20%20%2F%2F%20bind%20the%20buffers%0A%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20this.vertexBuffer)%3B%0A%20%20%20%20gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER%2C%20this.indexBuffer)%3B%0A%0A%20%20%20%20%2F%2F%20this%20is%20the%20same%20for%20each%20shader%3F%0A%20%20%20%20var%20stride%20%3D%20%20this.vertByteSize%3B%0A%20%20%20%20gl.vertexAttribPointer(this.shader.attributes.aVertexPosition%2C%202%2C%20gl.FLOAT%2C%20false%2C%20stride%2C%200)%3B%0A%20%20%20%20gl.vertexAttribPointer(this.shader.attributes.aTextureCoord%2C%202%2C%20gl.FLOAT%2C%20false%2C%20stride%2C%202%20*%204)%3B%0A%0A%20%20%20%20%2F%2F%20color%20attributes%20will%20be%20interpreted%20as%20unsigned%20bytes%20and%20normalized%0A%20%20%20%20gl.vertexAttribPointer(this.shader.attributes.aColor%2C%204%2C%20gl.UNSIGNED_BYTE%2C%20true%2C%20stride%2C%204%20*%204)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20the%20SpriteBatch.%0A%20*%0A%20*%2F%0ASpriteRenderer.prototype.destroy%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.renderer.gl.deleteBuffer(this.vertexBuffer)%3B%0A%20%20%20%20this.renderer.gl.deleteBuffer(this.indexBuffer)%3B%0A%0A%20%20%20%20ObjectRenderer.prototype.destroy.call(this)%3B%0A%0A%20%20%20%20this.shader.destroy()%3B%0A%0A%20%20%20%20this.renderer%20%3D%20null%3B%0A%0A%20%20%20%20this.vertices%20%3D%20null%3B%0A%20%20%20%20this.positions%20%3D%20null%3B%0A%20%20%20%20this.colors%20%3D%20null%3B%0A%20%20%20%20this.indices%20%3D%20null%3B%0A%0A%20%20%20%20this.vertexBuffer%20%3D%20null%3B%0A%20%20%20%20this.indexBuffer%20%3D%20null%3B%0A%0A%20%20%20%20this.sprites%20%3D%20null%3B%0A%20%20%20%20this.shader%20%3D%20null%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2F..%2Fconst%22%3A13%2C%22..%2F..%2Frenderers%2Fwebgl%2FWebGLRenderer%22%3A39%2C%22..%2F..%2Frenderers%2Fwebgl%2Futils%2FObjectRenderer%22%3A53%7D%5D%2C59%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20Sprite%20%3D%20require('..%2Fsprites%2FSprite')%2C%0A%20%20%20%20Texture%20%3D%20require('..%2Ftextures%2FTexture')%2C%0A%20%20%20%20math%20%3D%20require('..%2Fmath')%2C%0A%20%20%20%20utils%20%3D%20require('..%2Futils')%2C%0A%20%20%20%20CONST%20%3D%20require('..%2Fconst')%3B%0A%0A%2F**%0A%20*%20A%20Text%20Object%20will%20create%20a%20line%20or%20multiple%20lines%20of%20text.%20To%20split%20a%20line%20you%20can%20use%20'%5Cn'%20in%20your%20text%20string%2C%0A%20*%20or%20add%20a%20wordWrap%20property%20set%20to%20true%20and%20and%20wordWrapWidth%20property%20with%20a%20value%20in%20the%20style%20object.%0A%20*%0A%20*%20A%20Text%20can%20be%20created%20directly%20from%20a%20string%20and%20a%20style%20object%0A%20*%0A%20*%20%60%60%60js%0A%20*%20var%20text%20%3D%20new%20PIXI.Text('This%20is%20a%20pixi%20text'%2C%7Bfont%20%3A%20'24px%20Arial'%2C%20fill%20%3A%200xff1010%2C%20align%20%3A%20'center'%7D)%3B%0A%20*%20%60%60%60%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.Sprite%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20text%20%7Bstring%7D%20The%20copy%20that%20you%20would%20like%20the%20text%20to%20display%0A%20*%20%40param%20%5Bstyle%5D%20%7Bobject%7D%20The%20style%20parameters%0A%20*%20%40param%20%5Bstyle.font%5D%20%7Bstring%7D%20default%20'bold%2020px%20Arial'%20The%20style%20and%20size%20of%20the%20font%0A%20*%20%40param%20%5Bstyle.fill%3D'black'%5D%20%7BString%7CNumber%7D%20A%20canvas%20fillstyle%20that%20will%20be%20used%20on%20the%20text%20e.g%20'red'%2C%20'%2300FF00'%0A%20*%20%40param%20%5Bstyle.align%3D'left'%5D%20%7Bstring%7D%20Alignment%20for%20multiline%20text%20('left'%2C%20'center'%20or%20'right')%2C%20does%20not%20affect%20single%20line%20text%0A%20*%20%40param%20%5Bstyle.stroke%5D%20%7BString%7CNumber%7D%20A%20canvas%20fillstyle%20that%20will%20be%20used%20on%20the%20text%20stroke%20e.g%20'blue'%2C%20'%23FCFF00'%0A%20*%20%40param%20%5Bstyle.strokeThickness%3D0%5D%20%7Bnumber%7D%20A%20number%20that%20represents%20the%20thickness%20of%20the%20stroke.%20Default%20is%200%20(no%20stroke)%0A%20*%20%40param%20%5Bstyle.wordWrap%3Dfalse%5D%20%7Bboolean%7D%20Indicates%20if%20word%20wrap%20should%20be%20used%0A%20*%20%40param%20%5Bstyle.wordWrapWidth%3D100%5D%20%7Bnumber%7D%20The%20width%20at%20which%20text%20will%20wrap%2C%20it%20needs%20wordWrap%20to%20be%20set%20to%20true%0A%20*%20%40param%20%5Bstyle.lineHeight%5D%20%7Bnumber%7D%20The%20line%20height%2C%20a%20number%20that%20represents%20the%20vertical%20space%20that%20a%20letter%20uses%0A%20*%20%40param%20%5Bstyle.dropShadow%3Dfalse%5D%20%7Bboolean%7D%20Set%20a%20drop%20shadow%20for%20the%20text%0A%20*%20%40param%20%5Bstyle.dropShadowColor%3D'%23000000'%5D%20%7Bstring%7D%20A%20fill%20style%20to%20be%20used%20on%20the%20dropshadow%20e.g%20'red'%2C%20'%2300FF00'%0A%20*%20%40param%20%5Bstyle.dropShadowAngle%3DMath.PI%2F4%5D%20%7Bnumber%7D%20Set%20a%20angle%20of%20the%20drop%20shadow%0A%20*%20%40param%20%5Bstyle.dropShadowDistance%3D5%5D%20%7Bnumber%7D%20Set%20a%20distance%20of%20the%20drop%20shadow%0A%20*%20%40param%20%5Bstyle.padding%3D0%5D%20%7Bnumber%7D%20Occasionally%20some%20fonts%20are%20cropped%20on%20top%20or%20bottom.%20Adding%20some%20padding%20will%0A%20*%20%20%20%20%20%20prevent%20this%20from%20happening%20by%20adding%20padding%20to%20the%20top%20and%20bottom%20of%20text%20height.%0A%20*%20%40param%20%5Bstyle.textBaseline%3D'alphabetic'%5D%20%7Bstring%7D%20The%20baseline%20of%20the%20text%20that%20is%20rendered.%0A%20*%20%40param%20%5Bstyle.lineJoin%3D'miter'%5D%20%7Bstring%7D%20The%20lineJoin%20property%20sets%20the%20type%20of%20corner%20created%2C%20it%20can%20resolve%0A%20*%20%20%20%20%20%20spiked%20text%20issues.%20Default%20is%20'miter'%20(creates%20a%20sharp%20corner).%0A%20*%20%40param%20%5Bstyle.miterLimit%3D10%5D%20%7Bnumber%7D%20The%20miter%20limit%20to%20use%20when%20using%20the%20'miter'%20lineJoin%20mode.%20This%20can%20reduce%0A%20*%20%20%20%20%20%20or%20increase%20the%20spikiness%20of%20rendered%20text.%0A%20*%2F%0Afunction%20Text(text%2C%20style%2C%20resolution)%0A%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20canvas%20element%20that%20everything%20is%20drawn%20to%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BHTMLCanvasElement%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.canvas%20%3D%20document.createElement('canvas')%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20canvas%202d%20context%20that%20everything%20is%20drawn%20with%0A%20%20%20%20%20*%20%40member%20%7BHTMLCanvasElement%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.context%20%3D%20this.canvas.getContext('2d')%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20resolution%20of%20the%20canvas.%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.resolution%20%3D%20resolution%20%7C%7C%20CONST.RESOLUTION%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Private%20tracker%20for%20the%20current%20text.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bstring%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._text%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Private%20tracker%20for%20the%20current%20style.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bobject%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._style%20%3D%20null%3B%0A%0A%20%20%20%20var%20texture%20%3D%20Texture.fromCanvas(this.canvas)%3B%0A%20%20%20%20texture.trim%20%3D%20new%20math.Rectangle()%3B%0A%20%20%20%20Sprite.call(this%2C%20texture)%3B%0A%0A%20%20%20%20this.text%20%3D%20text%3B%0A%20%20%20%20this.style%20%3D%20style%3B%0A%7D%0A%0A%2F%2F%20constructor%0AText.prototype%20%3D%20Object.create(Sprite.prototype)%3B%0AText.prototype.constructor%20%3D%20Text%3B%0Amodule.exports%20%3D%20Text%3B%0A%0AText.fontPropertiesCache%20%3D%20%7B%7D%3B%0AText.fontPropertiesCanvas%20%3D%20document.createElement('canvas')%3B%0AText.fontPropertiesContext%20%3D%20Text.fontPropertiesCanvas.getContext('2d')%3B%0A%0AObject.defineProperties(Text.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20width%20of%20the%20Text%2C%20setting%20this%20will%20actually%20modify%20the%20scale%20to%20achieve%20the%20value%20set%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.Text%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20width%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.dirty)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.updateText()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.scale.x%20*%20this._texture._frame.width%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.scale.x%20%3D%20value%20%2F%20this._texture._frame.width%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._width%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20height%20of%20the%20Text%2C%20setting%20this%20will%20actually%20modify%20the%20scale%20to%20achieve%20the%20value%20set%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.Text%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20height%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.dirty)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.updateText()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%20this.scale.y%20*%20this._texture._frame.height%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.scale.y%20%3D%20value%20%2F%20this._texture._frame.height%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._height%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Set%20the%20style%20of%20the%20text%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40param%20%5Bstyle%5D%20%7Bobject%7D%20The%20style%20parameters%0A%20%20%20%20%20*%20%40param%20%5Bstyle.font%3D'bold%2020pt%20Arial'%5D%20%7Bstring%7D%20The%20style%20and%20size%20of%20the%20font%0A%20%20%20%20%20*%20%40param%20%5Bstyle.fill%3D'black'%5D%20%7Bstring%7Cnumber%7D%20A%20canvas%20fillstyle%20that%20will%20be%20used%20on%20the%20text%20eg%20'red'%2C%20'%2300FF00'%0A%20%20%20%20%20*%20%40param%20%5Bstyle.align%3D'left'%5D%20%7Bstring%7D%20Alignment%20for%20multiline%20text%20('left'%2C%20'center'%20or%20'right')%2C%20does%20not%20affect%20single%20line%20text%0A%20%20%20%20%20*%20%40param%20%5Bstyle.stroke%3D'black'%5D%20%7Bstring%7Cnumber%7D%20A%20canvas%20fillstyle%20that%20will%20be%20used%20on%20the%20text%20stroke%20eg%20'blue'%2C%20'%23FCFF00'%0A%20%20%20%20%20*%20%40param%20%5Bstyle.strokeThickness%3D0%5D%20%7Bnumber%7D%20A%20number%20that%20represents%20the%20thickness%20of%20the%20stroke.%20Default%20is%200%20(no%20stroke)%0A%20%20%20%20%20*%20%40param%20%5Bstyle.wordWrap%3Dfalse%5D%20%7Bboolean%7D%20Indicates%20if%20word%20wrap%20should%20be%20used%0A%20%20%20%20%20*%20%40param%20%5Bstyle.wordWrapWidth%3D100%5D%20%7Bnumber%7D%20The%20width%20at%20which%20text%20will%20wrap%0A%20%20%20%20%20*%20%40param%20%5Bstyle.lineHeight%5D%20%7Bnumber%7D%20The%20line%20height%2C%20a%20number%20that%20represents%20the%20vertical%20space%20that%20a%20letter%20uses%0A%20%20%20%20%20*%20%40param%20%5Bstyle.dropShadow%3Dfalse%5D%20%7Bboolean%7D%20Set%20a%20drop%20shadow%20for%20the%20text%0A%20%20%20%20%20*%20%40param%20%5Bstyle.dropShadowColor%3D'%23000000'%5D%20%7Bstring%7Cnumber%7D%20A%20fill%20style%20to%20be%20used%20on%20the%20dropshadow%20e.g%20'red'%2C%20'%2300FF00'%0A%20%20%20%20%20*%20%40param%20%5Bstyle.dropShadowAngle%3DMath.PI%2F6%5D%20%7Bnumber%7D%20Set%20a%20angle%20of%20the%20drop%20shadow%0A%20%20%20%20%20*%20%40param%20%5Bstyle.dropShadowDistance%3D5%5D%20%7Bnumber%7D%20Set%20a%20distance%20of%20the%20drop%20shadow%0A%20%20%20%20%20*%20%40param%20%5Bstyle.padding%3D0%5D%20%7Bnumber%7D%20Occasionally%20some%20fonts%20are%20cropped%20on%20top%20or%20bottom.%20Adding%20some%20padding%20will%0A%20%20%20%20%20*%20%20%20%20%20%20prevent%20this%20from%20happening%20by%20adding%20padding%20to%20the%20top%20and%20bottom%20of%20text%20height.%0A%20%20%20%20%20*%20%40param%20%5Bstyle.textBaseline%3D'alphabetic'%5D%20%7Bstring%7D%20The%20baseline%20of%20the%20text%20that%20is%20rendered.%0A%20%20%20%20%20*%20%40param%20%5Bstyle.lineJoin%3D'miter'%5D%20%7Bstring%7D%20The%20lineJoin%20property%20sets%20the%20type%20of%20corner%20created%2C%20it%20can%20resolve%0A%20%20%20%20%20*%20%20%20%20%20%20spiked%20text%20issues.%20Default%20is%20'miter'%20(creates%20a%20sharp%20corner).%0A%20%20%20%20%20*%20%40param%20%5Bstyle.miterLimit%3D10%5D%20%7Bnumber%7D%20The%20miter%20limit%20to%20use%20when%20using%20the%20'miter'%20lineJoin%20mode.%20This%20can%20reduce%0A%20%20%20%20%20*%20%20%20%20%20%20or%20increase%20the%20spikiness%20of%20rendered%20text.%0A%20%20%20%20%20*%20%40memberof%20PIXI.Text%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20style%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this._style%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(style)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20style%20%3D%20style%20%7C%7C%20%7B%7D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(typeof%20style.fill%20%3D%3D%3D%20'number')%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20style.fill%20%3D%20utils.hex2string(style.fill)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(typeof%20style.stroke%20%3D%3D%3D%20'number')%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20style.stroke%20%3D%20utils.hex2string(style.stroke)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(typeof%20style.dropShadowColor%20%3D%3D%3D%20'number')%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20style.dropShadowColor%20%3D%20utils.hex2string(style.dropShadowColor)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20style.font%20%3D%20style.font%20%7C%7C%20'bold%2020pt%20Arial'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20style.fill%20%3D%20style.fill%20%7C%7C%20'black'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20style.align%20%3D%20style.align%20%7C%7C%20'left'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20style.stroke%20%3D%20style.stroke%20%7C%7C%20'black'%3B%20%2F%2Fprovide%20a%20default%2C%20see%3A%20https%3A%2F%2Fgithub.com%2Fpixijs%2Fpixi.js%2Fissues%2F136%0A%20%20%20%20%20%20%20%20%20%20%20%20style.strokeThickness%20%3D%20style.strokeThickness%20%7C%7C%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20style.wordWrap%20%3D%20style.wordWrap%20%7C%7C%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20style.wordWrapWidth%20%3D%20style.wordWrapWidth%20%7C%7C%20100%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20style.dropShadow%20%3D%20style.dropShadow%20%7C%7C%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20style.dropShadowColor%20%3D%20style.dropShadowColor%20%7C%7C%20'%23000000'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20style.dropShadowAngle%20%3D%20style.dropShadowAngle%20%7C%7C%20Math.PI%20%2F%206%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20style.dropShadowDistance%20%3D%20style.dropShadowDistance%20%7C%7C%205%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20style.padding%20%3D%20style.padding%20%7C%7C%200%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20style.textBaseline%20%3D%20style.textBaseline%20%7C%7C%20'alphabetic'%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20style.lineJoin%20%3D%20style.lineJoin%20%7C%7C%20'miter'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20style.miterLimit%20%3D%20style.miterLimit%20%7C%7C%2010%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20this._style%20%3D%20style%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.dirty%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Set%20the%20copy%20for%20the%20text%20object.%20To%20split%20a%20line%20you%20can%20use%20'%5Cn'.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40param%20text%20%7Bstring%7D%20The%20copy%20that%20you%20would%20like%20the%20text%20to%20display%0A%20%20%20%20%20*%20%40memberof%20PIXI.Text%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20text%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this._text%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(text)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20text%20%3D%20text.toString()%20%7C%7C%20'%20'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(this._text%20%3D%3D%3D%20text)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20this._text%20%3D%20text%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.dirty%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%2F**%0A%20*%20Renders%20text%20and%20updates%20it%20when%20needed%0A%20*%0A%20*%20%40private%0A%20*%2F%0AText.prototype.updateText%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20style%20%3D%20this._style%3B%0A%20%20%20%20this.context.font%20%3D%20style.font%3B%0A%0A%20%20%20%20%2F%2F%20word%20wrap%0A%20%20%20%20%2F%2F%20preserve%20original%20text%0A%20%20%20%20var%20outputText%20%3D%20style.wordWrap%20%3F%20this.wordWrap(this._text)%20%3A%20this._text%3B%0A%0A%20%20%20%20%2F%2F%20split%20text%20into%20lines%0A%20%20%20%20var%20lines%20%3D%20outputText.split(%2F(%3F%3A%5Cr%5Cn%7C%5Cr%7C%5Cn)%2F)%3B%0A%0A%20%20%20%20%2F%2F%20calculate%20text%20width%0A%20%20%20%20var%20lineWidths%20%3D%20new%20Array(lines.length)%3B%0A%20%20%20%20var%20maxLineWidth%20%3D%200%3B%0A%20%20%20%20var%20fontProperties%20%3D%20this.determineFontProperties(style.font)%3B%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20lines.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20lineWidth%20%3D%20this.context.measureText(lines%5Bi%5D).width%3B%0A%20%20%20%20%20%20%20%20lineWidths%5Bi%5D%20%3D%20lineWidth%3B%0A%20%20%20%20%20%20%20%20maxLineWidth%20%3D%20Math.max(maxLineWidth%2C%20lineWidth)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20width%20%3D%20maxLineWidth%20%2B%20style.strokeThickness%3B%0A%20%20%20%20if%20(style.dropShadow)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20width%20%2B%3D%20style.dropShadowDistance%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.canvas.width%20%3D%20(%20width%20%2B%20this.context.lineWidth%20)%20*%20this.resolution%3B%0A%0A%20%20%20%20%2F%2F%20calculate%20text%20height%0A%20%20%20%20var%20lineHeight%20%3D%20this.style.lineHeight%20%7C%7C%20fontProperties.fontSize%20%2B%20style.strokeThickness%3B%0A%0A%20%20%20%20var%20height%20%3D%20lineHeight%20*%20lines.length%3B%0A%20%20%20%20if%20(style.dropShadow)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20height%20%2B%3D%20style.dropShadowDistance%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.canvas.height%20%3D%20(%20height%20%2B%20this._style.padding%20*%202%20)%20*%20this.resolution%3B%0A%0A%20%20%20%20this.context.scale(%20this.resolution%2C%20this.resolution)%3B%0A%0A%20%20%20%20if%20(navigator.isCocoonJS)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.context.clearRect(0%2C%200%2C%20this.canvas.width%2C%20this.canvas.height)%3B%0A%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2Fthis.context.fillStyle%3D%22%23FF0000%22%3B%0A%20%20%20%20%2F%2Fthis.context.fillRect(0%2C%200%2C%20this.canvas.width%2C%20this.canvas.height)%3B%0A%0A%20%20%20%20this.context.font%20%3D%20style.font%3B%0A%20%20%20%20this.context.strokeStyle%20%3D%20style.stroke%3B%0A%20%20%20%20this.context.lineWidth%20%3D%20style.strokeThickness%3B%0A%20%20%20%20this.context.textBaseline%20%3D%20style.textBaseline%3B%0A%20%20%20%20this.context.lineJoin%20%3D%20style.lineJoin%3B%0A%20%20%20%20this.context.miterLimit%20%3D%20style.miterLimit%3B%0A%0A%20%20%20%20var%20linePositionX%3B%0A%20%20%20%20var%20linePositionY%3B%0A%0A%20%20%20%20if%20(style.dropShadow)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.context.fillStyle%20%3D%20style.dropShadowColor%3B%0A%0A%20%20%20%20%20%20%20%20var%20xShadowOffset%20%3D%20Math.cos(style.dropShadowAngle)%20*%20style.dropShadowDistance%3B%0A%20%20%20%20%20%20%20%20var%20yShadowOffset%20%3D%20Math.sin(style.dropShadowAngle)%20*%20style.dropShadowDistance%3B%0A%0A%20%20%20%20%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20lines.length%3B%20i%2B%2B)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20linePositionX%20%3D%20style.strokeThickness%20%2F%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20linePositionY%20%3D%20(style.strokeThickness%20%2F%202%20%2B%20i%20*%20lineHeight)%20%2B%20fontProperties.ascent%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(style.align%20%3D%3D%3D%20'right')%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20linePositionX%20%2B%3D%20maxLineWidth%20-%20lineWidths%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20if%20(style.align%20%3D%3D%3D%20'center')%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20linePositionX%20%2B%3D%20(maxLineWidth%20-%20lineWidths%5Bi%5D)%20%2F%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(style.fill)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.context.fillText(lines%5Bi%5D%2C%20linePositionX%20%2B%20xShadowOffset%2C%20linePositionY%20%2B%20yShadowOffset%20%2B%20this._style.padding)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2Fset%20canvas%20text%20styles%0A%20%20%20%20this.context.fillStyle%20%3D%20style.fill%3B%0A%0A%20%20%20%20%2F%2Fdraw%20lines%20line%20by%20line%0A%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20lines.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20linePositionX%20%3D%20style.strokeThickness%20%2F%202%3B%0A%20%20%20%20%20%20%20%20linePositionY%20%3D%20(style.strokeThickness%20%2F%202%20%2B%20i%20*%20lineHeight)%20%2B%20fontProperties.ascent%3B%0A%0A%20%20%20%20%20%20%20%20if%20(style.align%20%3D%3D%3D%20'right')%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20linePositionX%20%2B%3D%20maxLineWidth%20-%20lineWidths%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20if%20(style.align%20%3D%3D%3D%20'center')%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20linePositionX%20%2B%3D%20(maxLineWidth%20-%20lineWidths%5Bi%5D)%20%2F%202%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if%20(style.stroke%20%26%26%20style.strokeThickness)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.context.strokeText(lines%5Bi%5D%2C%20linePositionX%2C%20linePositionY%20%2B%20this._style.padding)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if%20(style.fill)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.context.fillText(lines%5Bi%5D%2C%20linePositionX%2C%20linePositionY%20%2B%20this._style.padding)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.updateTexture()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Updates%20texture%20size%20based%20on%20canvas%20size%0A%20*%0A%20*%20%40private%0A%20*%2F%0AText.prototype.updateTexture%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20texture%20%3D%20this._texture%3B%0A%0A%20%20%20%20texture.baseTexture.hasLoaded%20%3D%20true%3B%0A%20%20%20%20texture.baseTexture.resolution%20%3D%20this.resolution%3B%0A%0A%20%20%20%20texture.baseTexture.width%20%3D%20this.canvas.width%20%2F%20this.resolution%3B%0A%20%20%20%20texture.baseTexture.height%20%3D%20this.canvas.height%20%2F%20this.resolution%3B%0A%20%20%20%20texture.crop.width%20%3D%20texture._frame.width%20%3D%20this.canvas.width%20%2F%20this.resolution%3B%0A%20%20%20%20texture.crop.height%20%3D%20texture._frame.height%20%3D%20this.canvas.height%20%2F%20this.resolution%3B%0A%0A%20%20%20%20texture.trim.x%20%3D%200%3B%0A%20%20%20%20texture.trim.y%20%3D%20-this._style.padding%3B%0A%0A%20%20%20%20texture.trim.width%20%3D%20texture._frame.width%3B%0A%20%20%20%20texture.trim.height%20%3D%20texture._frame.height%20-%20this._style.padding*2%3B%0A%0A%20%20%20%20this._width%20%3D%20this.canvas.width%20%2F%20this.resolution%3B%0A%20%20%20%20this._height%20%3D%20this.canvas.height%20%2F%20this.resolution%3B%0A%0A%20%20%20%20texture.baseTexture.emit('update'%2C%20%20texture.baseTexture)%3B%0A%0A%20%20%20%20this.dirty%20%3D%20false%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Renders%20the%20object%20using%20the%20WebGL%20renderer%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%0A%20*%2F%0AText.prototype.renderWebGL%20%3D%20function%20(renderer)%0A%7B%0A%20%20%20%20if%20(this.dirty)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2Fthis.resolution%20%3D%201%2F%2Frenderer.resolution%3B%0A%0A%20%20%20%20%20%20%20%20this.updateText()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20Sprite.prototype.renderWebGL.call(this%2C%20renderer)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Renders%20the%20object%20using%20the%20Canvas%20renderer%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.CanvasRenderer%7D%0A%20*%20%40private%0A%20*%2F%0AText.prototype._renderCanvas%20%3D%20function%20(renderer)%0A%7B%0A%20%20%20%20if%20(this.dirty)%0A%20%20%20%20%7B%0A%20%20%20%20%20%2F%2F%20%20%20this.resolution%20%3D%201%2F%2Frenderer.resolution%3B%0A%0A%20%20%20%20%20%20%20%20this.updateText()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20Sprite.prototype._renderCanvas.call(this%2C%20renderer)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Calculates%20the%20ascent%2C%20descent%20and%20fontSize%20of%20a%20given%20fontStyle%0A%20*%0A%20*%20%40param%20fontStyle%20%7Bobject%7D%0A%20*%20%40private%0A%20*%2F%0AText.prototype.determineFontProperties%20%3D%20function%20(fontStyle)%0A%7B%0A%20%20%20%20var%20properties%20%3D%20Text.fontPropertiesCache%5BfontStyle%5D%3B%0A%0A%20%20%20%20if%20(!properties)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20properties%20%3D%20%7B%7D%3B%0A%0A%20%20%20%20%20%20%20%20var%20canvas%20%3D%20Text.fontPropertiesCanvas%3B%0A%20%20%20%20%20%20%20%20var%20context%20%3D%20Text.fontPropertiesContext%3B%0A%0A%20%20%20%20%20%20%20%20context.font%20%3D%20fontStyle%3B%0A%0A%20%20%20%20%20%20%20%20var%20width%20%3D%20Math.ceil(context.measureText('%7CM%C3%89q').width)%3B%0A%20%20%20%20%20%20%20%20var%20baseline%20%3D%20Math.ceil(context.measureText('M').width)%3B%0A%20%20%20%20%20%20%20%20var%20height%20%3D%202%20*%20baseline%3B%0A%0A%20%20%20%20%20%20%20%20baseline%20%3D%20baseline%20*%201.4%20%7C%200%3B%0A%0A%20%20%20%20%20%20%20%20canvas.width%20%3D%20width%3B%0A%20%20%20%20%20%20%20%20canvas.height%20%3D%20height%3B%0A%0A%20%20%20%20%20%20%20%20context.fillStyle%20%3D%20'%23f00'%3B%0A%20%20%20%20%20%20%20%20context.fillRect(0%2C%200%2C%20width%2C%20height)%3B%0A%0A%20%20%20%20%20%20%20%20context.font%20%3D%20fontStyle%3B%0A%0A%20%20%20%20%20%20%20%20context.textBaseline%20%3D%20'alphabetic'%3B%0A%20%20%20%20%20%20%20%20context.fillStyle%20%3D%20'%23000'%3B%0A%20%20%20%20%20%20%20%20context.fillText('%7CM%C3%89q'%2C%200%2C%20baseline)%3B%0A%0A%20%20%20%20%20%20%20%20var%20imagedata%20%3D%20context.getImageData(0%2C%200%2C%20width%2C%20height).data%3B%0A%20%20%20%20%20%20%20%20var%20pixels%20%3D%20imagedata.length%3B%0A%20%20%20%20%20%20%20%20var%20line%20%3D%20width%20*%204%3B%0A%0A%20%20%20%20%20%20%20%20var%20i%2C%20j%3B%0A%0A%20%20%20%20%20%20%20%20var%20idx%20%3D%200%3B%0A%20%20%20%20%20%20%20%20var%20stop%20%3D%20false%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20ascent.%20scan%20from%20top%20to%20bottom%20until%20we%20find%20a%20non%20red%20pixel%0A%20%20%20%20%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20baseline%3B%20i%2B%2B)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(j%20%3D%200%3B%20j%20%3C%20line%3B%20j%20%2B%3D%204)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(imagedata%5Bidx%20%2B%20j%5D%20!%3D%3D%20255)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stop%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!stop)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20idx%20%2B%3D%20line%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20properties.ascent%20%3D%20baseline%20-%20i%3B%0A%0A%20%20%20%20%20%20%20%20idx%20%3D%20pixels%20-%20line%3B%0A%20%20%20%20%20%20%20%20stop%20%3D%20false%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20descent.%20scan%20from%20bottom%20to%20top%20until%20we%20find%20a%20non%20red%20pixel%0A%20%20%20%20%20%20%20%20for%20(i%20%3D%20height%3B%20i%20%3E%20baseline%3B%20i--)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(j%20%3D%200%3B%20j%20%3C%20line%3B%20j%20%2B%3D%204)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(imagedata%5Bidx%20%2B%20j%5D%20!%3D%3D%20255)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stop%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!stop)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20idx%20-%3D%20line%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20properties.descent%20%3D%20i%20-%20baseline%3B%0A%20%20%20%20%20%20%20%20properties.fontSize%20%3D%20properties.ascent%20%2B%20properties.descent%3B%0A%0A%20%20%20%20%20%20%20%20Text.fontPropertiesCache%5BfontStyle%5D%20%3D%20properties%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20properties%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Applies%20newlines%20to%20a%20string%20to%20have%20it%20optimally%20fit%20into%20the%20horizontal%0A%20*%20bounds%20set%20by%20the%20Text%20object's%20wordWrapWidth%20property.%0A%20*%0A%20*%20%40param%20text%20%7Bstring%7D%0A%20*%20%40private%0A%20*%2F%0AText.prototype.wordWrap%20%3D%20function%20(text)%0A%7B%0A%20%20%20%20%2F%2F%20Greedy%20wrapping%20algorithm%20that%20will%20wrap%20words%20as%20the%20line%20grows%20longer%0A%20%20%20%20%2F%2F%20than%20its%20horizontal%20bounds.%0A%20%20%20%20var%20result%20%3D%20''%3B%0A%20%20%20%20var%20lines%20%3D%20text.split('%5Cn')%3B%0A%20%20%20%20var%20wordWrapWidth%20%3D%20this._style.wordWrapWidth%3B%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20lines.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20spaceLeft%20%3D%20wordWrapWidth%3B%0A%20%20%20%20%20%20%20%20var%20words%20%3D%20lines%5Bi%5D.split('%20')%3B%0A%20%20%20%20%20%20%20%20for%20(var%20j%20%3D%200%3B%20j%20%3C%20words.length%3B%20j%2B%2B)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20wordWidth%20%3D%20this.context.measureText(words%5Bj%5D).width%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20wordWidthWithSpace%20%3D%20wordWidth%20%2B%20this.context.measureText('%20').width%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(j%20%3D%3D%3D%200%20%7C%7C%20wordWidthWithSpace%20%3E%20spaceLeft)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Skip%20printing%20the%20newline%20if%20it's%20the%20first%20word%20of%20the%20line%20that%20is%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20greater%20than%20the%20word%20wrap%20width.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(j%20%3E%200)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20result%20%2B%3D%20'%5Cn'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20result%20%2B%3D%20words%5Bj%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20spaceLeft%20%3D%20wordWrapWidth%20-%20wordWidth%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20spaceLeft%20-%3D%20wordWidthWithSpace%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20result%20%2B%3D%20'%20'%20%2B%20words%5Bj%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if%20(i%20%3C%20lines.length-1)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20result%20%2B%3D%20'%5Cn'%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20result%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Returns%20the%20bounds%20of%20the%20Text%20as%20a%20rectangle.%20The%20bounds%20calculation%20takes%20the%20worldTransform%20into%20account.%0A%20*%0A%20*%20%40param%20matrix%20%7BPIXI.Matrix%7D%20the%20transformation%20matrix%20of%20the%20Text%0A%20*%20%40return%20%7BPIXI.Rectangle%7D%20the%20framing%20rectangle%0A%20*%2F%0AText.prototype.getBounds%20%3D%20function%20(matrix)%0A%7B%0A%20%20%20%20if%20(this.dirty)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.updateText()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20Sprite.prototype.getBounds.call(this%2C%20matrix)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20this%20text%20object.%0A%20*%0A%20*%20%40param%20%5BdestroyBaseTexture%3Dtrue%5D%20%7Bboolean%7D%20whether%20to%20destroy%20the%20base%20texture%20as%20well%0A%20*%2F%0AText.prototype.destroy%20%3D%20function%20(destroyBaseTexture)%0A%7B%0A%20%20%20%20%2F%2F%20make%20sure%20to%20reset%20the%20the%20context%20and%20canvas..%20dont%20want%20this%20hanging%20around%20in%20memory!%0A%20%20%20%20this.context%20%3D%20null%3B%0A%20%20%20%20this.canvas%20%3D%20null%3B%0A%0A%20%20%20%20this._style%20%3D%20null%3B%0A%0A%20%20%20%20this._texture.destroy(destroyBaseTexture%20%3D%3D%3D%20undefined%20%3F%20true%20%3A%20destroyBaseTexture)%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fconst%22%3A13%2C%22..%2Fmath%22%3A23%2C%22..%2Fsprites%2FSprite%22%3A57%2C%22..%2Ftextures%2FTexture%22%3A62%2C%22..%2Futils%22%3A67%7D%5D%2C60%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20utils%20%3D%20require('..%2Futils')%2C%0A%20%20%20%20CONST%20%3D%20require('..%2Fconst')%2C%0A%20%20%20%20EventEmitter%20%3D%20require('eventemitter3')%3B%0A%0A%2F**%0A%20*%20A%20texture%20stores%20the%20information%20that%20represents%20an%20image.%20All%20textures%20have%20a%20base%20texture.%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20source%20%7BImage%7CCanvas%7D%20the%20source%20object%20of%20the%20texture.%0A%20*%20%40param%20%5BscaleMode%3DPIXI.SCALE_MODES.DEFAULT%5D%20%7Bnumber%7D%20See%20%7B%40link%20PIXI.SCALE_MODES%7D%20for%20possible%20values%0A%20*%20%40param%20resolution%20%7Bnumber%7D%20the%20resolution%20of%20the%20texture%20for%20devices%20with%20different%20pixel%20ratios%0A%20*%2F%0Afunction%20BaseTexture(source%2C%20scaleMode%2C%20resolution)%0A%7B%0A%20%20%20%20EventEmitter.call(this)%3B%0A%0A%20%20%20%20this.uid%20%3D%20utils.uid()%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20Resolution%20of%20the%20texture.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.resolution%20%3D%20resolution%20%7C%7C%201%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20width%20of%20the%20base%20texture%20set%20when%20the%20image%20has%20loaded%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40readOnly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.width%20%3D%20100%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20height%20of%20the%20base%20texture%20set%20when%20the%20image%20has%20loaded%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40readOnly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.height%20%3D%20100%3B%0A%0A%20%20%20%20%2F%2F%20TODO%20docs%0A%20%20%20%20%2F%2F%20used%20to%20store%20the%20actual%20dimensions%20of%20the%20source%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Used%20to%20store%20the%20actual%20width%20of%20the%20source%20of%20this%20texture%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40readOnly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.realWidth%20%3D%20100%3B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Used%20to%20store%20the%20actual%20height%20of%20the%20source%20of%20this%20texture%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40readOnly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.realHeight%20%3D%20100%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20scale%20mode%20to%20apply%20when%20scaling%20this%20texture%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%20PIXI.SCALE_MODES.LINEAR%0A%20%20%20%20%20*%20%40see%20PIXI.SCALE_MODES%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.scaleMode%20%3D%20scaleMode%20%7C%7C%20CONST.SCALE_MODES.DEFAULT%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Set%20to%20true%20once%20the%20base%20texture%20has%20successfully%20loaded.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20This%20is%20never%20true%20if%20the%20underlying%20source%20fails%20to%20load%20or%20has%20no%20texture%20data.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40readOnly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.hasLoaded%20%3D%20false%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Set%20to%20true%20if%20the%20source%20is%20currently%20loading.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20If%20an%20Image%20source%20is%20loading%20the%20'loaded'%20or%20'error'%20event%20will%20be%0A%20%20%20%20%20*%20dispatched%20when%20the%20operation%20ends.%20An%20underyling%20source%20that%20is%0A%20%20%20%20%20*%20immediately-available%20bypasses%20loading%20entirely.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40readonly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.isLoading%20%3D%20false%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20image%20source%20that%20is%20used%20to%20create%20the%20texture.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20TODO%3A%20Make%20this%20a%20setter%20that%20calls%20loadSource()%3B%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BImage%7CCanvas%7D%0A%20%20%20%20%20*%20%40readonly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.source%20%3D%20null%3B%20%2F%2F%20set%20in%20loadSource%2C%20if%20at%20all%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Controls%20if%20RGB%20channels%20should%20be%20pre-multiplied%20by%20Alpha%20%20(WebGL%20only)%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40default%20true%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.premultipliedAlpha%20%3D%20true%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bstring%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.imageUrl%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Wether%20or%20not%20the%20texture%20is%20a%20power%20of%20two%2C%20try%20to%20use%20power%20of%20two%20textures%20as%20much%20as%20you%20can%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.isPowerOfTwo%20%3D%20false%3B%0A%0A%20%20%20%20%2F%2F%20used%20for%20webGL%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20Set%20this%20to%20true%20if%20a%20mipmap%20of%20this%20texture%20needs%20to%20be%20generated.%20This%20value%20needs%20to%20be%20set%20before%20the%20texture%20is%20used%0A%20%20%20%20%20*%20Also%20the%20texture%20must%20be%20a%20power%20of%20two%20size%20to%20work%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.mipmap%20%3D%20false%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20A%20map%20of%20renderer%20IDs%20to%20webgl%20textures%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bobject%3Cnumber%2C%20WebGLTexture%3E%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._glTextures%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20%2F%2F%20if%20no%20source%20passed%20don't%20try%20to%20load%0A%20%20%20%20if%20(source)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.loadSource(source)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Fired%20when%20a%20not-immediately-available%20source%20finishes%20loading.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40event%20loaded%0A%20%20%20%20%20*%20%40memberof%20PIXI.BaseTexture%23%0A%20%20%20%20%20*%20%40protected%0A%20%20%20%20%20*%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Fired%20when%20a%20not-immediately-available%20source%20fails%20to%20load.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40event%20error%0A%20%20%20%20%20*%20%40memberof%20PIXI.BaseTexture%23%0A%20%20%20%20%20*%20%40protected%0A%20%20%20%20%20*%2F%0A%7D%0A%0ABaseTexture.prototype%20%3D%20Object.create(EventEmitter.prototype)%3B%0ABaseTexture.prototype.constructor%20%3D%20BaseTexture%3B%0Amodule.exports%20%3D%20BaseTexture%3B%0A%0A%2F**%0A%20*%20Updates%20the%20texture%20on%20all%20the%20webgl%20renderers%2C%20this%20also%20assumes%20the%20src%20has%20changed.%0A%20*%0A%20*%20%40fires%20update%0A%20*%2F%0ABaseTexture.prototype.update%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.realWidth%20%3D%20this.source.naturalWidth%20%7C%7C%20this.source.width%3B%0A%20%20%20%20this.realHeight%20%3D%20this.source.naturalHeight%20%7C%7C%20this.source.height%3B%0A%0A%20%20%20%20this.width%20%3D%20this.realWidth%20%2F%20this.resolution%3B%0A%20%20%20%20this.height%20%3D%20this.realHeight%20%2F%20this.resolution%3B%0A%0A%20%20%20%20this.isPowerOfTwo%20%3D%20utils.isPowerOfTwo(this.realWidth%2C%20this.realHeight)%3B%0A%0A%20%20%20%20this.emit('update'%2C%20this)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Load%20a%20source.%0A%20*%0A%20*%20If%20the%20source%20is%20not-immediately-available%2C%20such%20as%20an%20image%20that%20needs%20to%20be%0A%20*%20downloaded%2C%20then%20the%20'loaded'%20or%20'error'%20event%20will%20be%20dispatched%20in%20the%20future%0A%20*%20and%20%60hasLoaded%60%20will%20remain%20false%20after%20this%20call.%0A%20*%0A%20*%20The%20logic%20state%20after%20calling%20%60loadSource%60%20directly%20or%20indirectly%20(eg.%20%60fromImage%60%2C%20%60new%20BaseTexture%60)%20is%3A%0A%20*%0A%20*%20%20%20%20%20if%20(texture.hasLoaded)%0A%20%7B%0A%20*%20%20%20%20%20%20%20%20%2F%2F%20texture%20ready%20for%20use%0A%20*%20%20%20%20%20%7D%20else%20if%20(texture.isLoading)%0A%20%7B%0A%20*%20%20%20%20%20%20%20%20%2F%2F%20listen%20to%20'loaded'%20and%2For%20'error'%20events%20on%20texture%0A%20*%20%20%20%20%20%7D%20else%20%7B%0A%20*%20%20%20%20%20%20%20%20%2F%2F%20not%20loading%2C%20not%20going%20to%20load%20UNLESS%20the%20source%20is%20reloaded%0A%20*%20%20%20%20%20%20%20%20%2F%2F%20(it%20may%20still%20make%20sense%20to%20listen%20to%20the%20events)%0A%20*%20%20%20%20%20%7D%0A%20*%0A%20*%20%40protected%0A%20*%20%40param%20source%20%7BImage%7CCanvas%7D%20the%20source%20object%20of%20the%20texture.%0A%20*%2F%0ABaseTexture.prototype.loadSource%20%3D%20function%20(source)%0A%7B%0A%20%20%20%20var%20wasLoading%20%3D%20this.isLoading%3B%0A%20%20%20%20this.hasLoaded%20%3D%20false%3B%0A%20%20%20%20this.isLoading%20%3D%20false%3B%0A%0A%20%20%20%20if%20(wasLoading%20%26%26%20this.source)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.source.onload%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20this.source.onerror%20%3D%20null%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.source%20%3D%20source%3B%0A%0A%20%20%20%20%2F%2F%20Apply%20source%20if%20loaded.%20Otherwise%20setup%20appropriate%20loading%20monitors.%0A%20%20%20%20if%20((this.source.complete%20%7C%7C%20this.source.getContext)%20%26%26%20this.source.width%20%26%26%20this.source.height)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this._sourceLoaded()%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%20if%20(!source.getContext)%0A%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Image%20fail%20%2F%20not%20ready%0A%20%20%20%20%20%20%20%20this.isLoading%20%3D%20true%3B%0A%0A%20%20%20%20%20%20%20%20var%20scope%20%3D%20this%3B%0A%0A%20%20%20%20%20%20%20%20source.onload%20%3D%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20source.onload%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20source.onerror%20%3D%20null%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!scope.isLoading)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20scope.isLoading%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20scope._sourceLoaded()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20scope.emit('loaded'%2C%20scope)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%0A%20%20%20%20%20%20%20%20source.onerror%20%3D%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20source.onload%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20source.onerror%20%3D%20null%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!scope.isLoading)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20scope.isLoading%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20scope.emit('error'%2C%20scope)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Per%20http%3A%2F%2Fwww.w3.org%2FTR%2Fhtml5%2Fembedded-content-0.html%23the-img-element%0A%20%20%20%20%20%20%20%20%2F%2F%20%20%20%22The%20value%20of%20%60complete%60%20can%20thus%20change%20while%20a%20script%20is%20executing.%22%0A%20%20%20%20%20%20%20%20%2F%2F%20So%20complete%20needs%20to%20be%20re-checked%20after%20the%20callbacks%20have%20been%20added..%0A%20%20%20%20%20%20%20%20%2F%2F%20NOTE%3A%20complete%20will%20be%20true%20if%20the%20image%20has%20no%20src%20so%20best%20to%20check%20if%20the%20src%20is%20set.%0A%20%20%20%20%20%20%20%20if%20(source.complete%20%26%26%20source.src)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.isLoading%20%3D%20false%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20..and%20if%20we're%20complete%20now%2C%20no%20need%20for%20callbacks%0A%20%20%20%20%20%20%20%20%20%20%20%20source.onload%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20source.onerror%20%3D%20null%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(source.width%20%26%26%20source.height)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._sourceLoaded()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20If%20any%20previous%20subscribers%20possible%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(wasLoading)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.emit('loaded'%2C%20this)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20If%20any%20previous%20subscribers%20possible%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(wasLoading)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.emit('error'%2C%20this)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Used%20internally%20to%20update%20the%20width%2C%20height%2C%20and%20some%20other%20tracking%20vars%20once%0A%20*%20a%20source%20has%20successfully%20loaded.%0A%20*%0A%20*%20%40private%0A%20*%2F%0ABaseTexture.prototype._sourceLoaded%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.hasLoaded%20%3D%20true%3B%0A%20%20%20%20this.update()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20this%20base%20texture%0A%20*%0A%20*%2F%0ABaseTexture.prototype.destroy%20%3D%20function%20()%0A%7B%0A%20%20%20%20if%20(this.imageUrl)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20delete%20utils.BaseTextureCache%5Bthis.imageUrl%5D%3B%0A%20%20%20%20%20%20%20%20delete%20utils.TextureCache%5Bthis.imageUrl%5D%3B%0A%0A%20%20%20%20%20%20%20%20this.imageUrl%20%3D%20null%3B%0A%0A%20%20%20%20%20%20%20%20if%20(!navigator.isCocoonJS)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.source.src%20%3D%20''%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20else%20if%20(this.source%20%26%26%20this.source._pixiId)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20delete%20utils.BaseTextureCache%5Bthis.source._pixiId%5D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.source%20%3D%20null%3B%0A%0A%20%20%20%20this.dispose()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Frees%20the%20texture%20from%20WebGL%20memory%20without%20destroying%20this%20texture%20object.%0A%20*%20This%20means%20you%20can%20still%20use%20the%20texture%20later%20which%20will%20upload%20it%20to%20GPU%0A%20*%20memory%20again.%0A%20*%0A%20*%2F%0ABaseTexture.prototype.dispose%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.emit('dispose'%2C%20this)%3B%0A%0A%20%20%20%20this._glTextures.length%20%3D%200%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Changes%20the%20source%20image%20of%20the%20texture.%0A%20*%20The%20original%20source%20must%20be%20an%20Image%20element.%0A%20*%0A%20*%20%40param%20newSrc%20%7Bstring%7D%20the%20path%20of%20the%20image%0A%20*%2F%0ABaseTexture.prototype.updateSourceImage%20%3D%20function%20(newSrc)%0A%7B%0A%20%20%20%20this.source.src%20%3D%20newSrc%3B%0A%0A%20%20%20%20this.loadSource(this.source)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Helper%20function%20that%20creates%20a%20base%20texture%20from%20the%20given%20image%20url.%0A%20*%20If%20the%20image%20is%20not%20in%20the%20base%20texture%20cache%20it%20will%20be%20created%20and%20loaded.%0A%20*%0A%20*%20%40static%0A%20*%20%40param%20imageUrl%20%7Bstring%7D%20The%20image%20url%20of%20the%20texture%0A%20*%20%40param%20%5Bcrossorigin%3D(auto)%5D%20%7Bboolean%7D%20Should%20use%20anonymous%20CORS%3F%20Defaults%20to%20true%20if%20the%20URL%20is%20not%20a%20data-URI.%0A%20*%20%40param%20%5BscaleMode%3DPIXI.SCALE_MODES.DEFAULT%5D%20%7Bnumber%7D%20See%20%7B%40link%20PIXI.SCALE_MODES%7D%20for%20possible%20values%0A%20*%20%40return%20PIXI.BaseTexture%0A%20*%2F%0ABaseTexture.fromImage%20%3D%20function%20(imageUrl%2C%20crossorigin%2C%20scaleMode)%0A%7B%0A%20%20%20%20var%20baseTexture%20%3D%20utils.BaseTextureCache%5BimageUrl%5D%3B%0A%0A%20%20%20%20if%20(crossorigin%20%3D%3D%3D%20undefined%20%26%26%20imageUrl.indexOf('data%3A')%20!%3D%3D%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20crossorigin%20%3D%20true%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(!baseTexture)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20new%20Image()%20breaks%20tex%20loading%20in%20some%20versions%20of%20Chrome.%0A%20%20%20%20%20%20%20%20%2F%2F%20See%20https%3A%2F%2Fcode.google.com%2Fp%2Fchromium%2Fissues%2Fdetail%3Fid%3D238071%0A%20%20%20%20%20%20%20%20var%20image%20%3D%20new%20Image()%3B%2F%2Fdocument.createElement('img')%3B%0A%20%20%20%20%20%20%20%20if%20(crossorigin)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20image.crossOrigin%20%3D%20''%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20baseTexture%20%3D%20new%20BaseTexture(image%2C%20scaleMode)%3B%0A%20%20%20%20%20%20%20%20baseTexture.imageUrl%20%3D%20imageUrl%3B%0A%0A%20%20%20%20%20%20%20%20image.src%20%3D%20imageUrl%3B%0A%0A%20%20%20%20%20%20%20%20utils.BaseTextureCache%5BimageUrl%5D%20%3D%20baseTexture%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20if%20there%20is%20an%20%402x%20at%20the%20end%20of%20the%20url%20we%20are%20going%20to%20assume%20its%20a%20highres%20image%0A%20%20%20%20%20%20%20%20baseTexture.resolution%20%3D%20utils.getResolutionOfUrl(imageUrl)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20baseTexture%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Helper%20function%20that%20creates%20a%20base%20texture%20from%20the%20given%20canvas%20element.%0A%20*%0A%20*%20%40static%0A%20*%20%40param%20canvas%20%7BCanvas%7D%20The%20canvas%20element%20source%20of%20the%20texture%0A%20*%20%40param%20scaleMode%20%7Bnumber%7D%20See%20%7B%40link%20PIXI.SCALE_MODES%7D%20for%20possible%20values%0A%20*%20%40return%20PIXI.BaseTexture%0A%20*%2F%0ABaseTexture.fromCanvas%20%3D%20function%20(canvas%2C%20scaleMode)%0A%7B%0A%20%20%20%20if%20(!canvas._pixiId)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20canvas._pixiId%20%3D%20'canvas_'%20%2B%20utils.uid()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20baseTexture%20%3D%20utils.BaseTextureCache%5Bcanvas._pixiId%5D%3B%0A%0A%20%20%20%20if%20(!baseTexture)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20baseTexture%20%3D%20new%20BaseTexture(canvas%2C%20scaleMode)%3B%0A%20%20%20%20%20%20%20%20utils.BaseTextureCache%5Bcanvas._pixiId%5D%20%3D%20baseTexture%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20baseTexture%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fconst%22%3A13%2C%22..%2Futils%22%3A67%2C%22eventemitter3%22%3A10%7D%5D%2C61%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20BaseTexture%20%3D%20require('.%2FBaseTexture')%2C%0A%20%20%20%20Texture%20%3D%20require('.%2FTexture')%2C%0A%20%20%20%20RenderTarget%20%3D%20require('..%2Frenderers%2Fwebgl%2Futils%2FRenderTarget')%2C%0A%20%20%20%20FilterManager%20%3D%20require('..%2Frenderers%2Fwebgl%2Fmanagers%2FFilterManager')%2C%0A%20%20%20%20CanvasBuffer%20%3D%20require('..%2Frenderers%2Fcanvas%2Futils%2FCanvasBuffer')%2C%0A%20%20%20%20math%20%3D%20require('..%2Fmath')%2C%0A%20%20%20%20CONST%20%3D%20require('..%2Fconst')%2C%0A%20%20%20%20tempMatrix%20%3D%20new%20math.Matrix()%3B%0A%0A%2F**%0A%20*%20A%20RenderTexture%20is%20a%20special%20texture%20that%20allows%20any%20Pixi%20display%20object%20to%20be%20rendered%20to%20it.%0A%20*%0A%20*%20__Hint__%3A%20All%20DisplayObjects%20(i.e.%20Sprites)%20that%20render%20to%20a%20RenderTexture%20should%20be%20preloaded%0A%20*%20otherwise%20black%20rectangles%20will%20be%20drawn%20instead.%0A%20*%0A%20*%20A%20RenderTexture%20takes%20a%20snapshot%20of%20any%20Display%20Object%20given%20to%20its%20render%20method.%20The%20position%0A%20*%20and%20rotation%20of%20the%20given%20Display%20Objects%20is%20ignored.%20For%20example%3A%0A%20*%0A%20*%20%60%60%60js%0A%20*%20var%20renderer%20%3D%20PIXI.autoDetectRenderer(1024%2C%201024%2C%20%7B%20view%3A%20canvas%2C%20ratio%3A%201%20%7D)%3B%0A%20*%20var%20renderTexture%20%3D%20new%20PIXI.RenderTexture(renderer%2C%20800%2C%20600)%3B%0A%20*%20var%20sprite%20%3D%20PIXI.Sprite.fromImage(%22spinObj_01.png%22)%3B%0A%20*%0A%20*%20sprite.position.x%20%3D%20800%2F2%3B%0A%20*%20sprite.position.y%20%3D%20600%2F2%3B%0A%20*%20sprite.anchor.x%20%3D%200.5%3B%0A%20*%20sprite.anchor.y%20%3D%200.5%3B%0A%20*%0A%20*%20renderTexture.render(sprite)%3B%0A%20*%20%60%60%60%0A%20*%0A%20*%20The%20Sprite%20in%20this%20case%20will%20be%20rendered%20to%20a%20position%20of%200%2C0.%20To%20render%20this%20sprite%20at%20its%20actual%0A%20*%20position%20a%20Container%20should%20be%20used%3A%0A%20*%0A%20*%20%60%60%60js%0A%20*%20var%20doc%20%3D%20new%20PIXI.Container()%3B%0A%20*%0A%20*%20doc.addChild(sprite)%3B%0A%20*%0A%20*%20renderTexture.render(doc)%3B%20%20%2F%2F%20Renders%20to%20center%20of%20renderTexture%0A%20*%20%60%60%60%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.Texture%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20renderer%20%7BPIXI.CanvasRenderer%7CPIXI.WebGLRenderer%7D%20The%20renderer%20used%20for%20this%20RenderTexture%0A%20*%20%40param%20%5Bwidth%3D100%5D%20%7Bnumber%7D%20The%20width%20of%20the%20render%20texture%0A%20*%20%40param%20%5Bheight%3D100%5D%20%7Bnumber%7D%20The%20height%20of%20the%20render%20texture%0A%20*%20%40param%20%5BscaleMode%5D%20%7Bnumber%7D%20See%20%7B%40link%20PIXI.SCALE_MODES%7D%20for%20possible%20values%0A%20*%20%40param%20%5Bresolution%3D1%5D%20%7Bnumber%7D%20The%20resolution%20of%20the%20texture%20being%20generated%0A%20*%2F%0Afunction%20RenderTexture(renderer%2C%20width%2C%20height%2C%20scaleMode%2C%20resolution)%0A%7B%0A%20%20%20%20if%20(!renderer)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error('Unable%20to%20create%20RenderTexture%2C%20you%20must%20pass%20a%20renderer%20into%20the%20constructor.')%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20width%20%3D%20width%20%7C%7C%20100%3B%0A%20%20%20%20height%20%3D%20height%20%7C%7C%20100%3B%0A%20%20%20%20resolution%20%3D%20resolution%20%7C%7C%20CONST.RESOLUTION%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20base%20texture%20object%20that%20this%20texture%20uses%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BBaseTexture%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20var%20baseTexture%20%3D%20new%20BaseTexture()%3B%0A%20%20%20%20baseTexture.width%20%3D%20width%3B%0A%20%20%20%20baseTexture.height%20%3D%20height%3B%0A%20%20%20%20baseTexture.resolution%20%3D%20resolution%3B%0A%20%20%20%20baseTexture.scaleMode%20%3D%20scaleMode%20%7C%7C%20CONST.SCALE_MODES.DEFAULT%3B%0A%20%20%20%20baseTexture.hasLoaded%20%3D%20true%3B%0A%0A%0A%20%20%20%20Texture.call(this%2C%0A%20%20%20%20%20%20%20%20baseTexture%2C%0A%20%20%20%20%20%20%20%20new%20math.Rectangle(0%2C%200%2C%20width%2C%20height)%0A%20%20%20%20)%3B%0A%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20with%20of%20the%20render%20texture%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.width%20%3D%20width%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20height%20of%20the%20render%20texture%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.height%20%3D%20height%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20Resolution%20of%20the%20texture.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.resolution%20%3D%20resolution%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Draw%2Frender%20the%20given%20DisplayObject%20onto%20the%20texture.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20The%20displayObject%20and%20descendents%20are%20transformed%20during%20this%20operation.%0A%20%20%20%20%20*%20If%20%60updateTransform%60%20is%20true%20then%20the%20transformations%20will%20be%20restored%20before%20the%0A%20%20%20%20%20*%20method%20returns.%20Otherwise%20it%20is%20up%20to%20the%20calling%20code%20to%20correctly%20use%20or%20reset%0A%20%20%20%20%20*%20the%20transformed%20display%20objects.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20The%20display%20object%20is%20always%20rendered%20with%20a%20worldAlpha%20value%20of%201.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40method%0A%20%20%20%20%20*%20%40param%20displayObject%20%7BPIXI.DisplayObject%7D%20The%20display%20object%20to%20render%20this%20texture%20on%0A%20%20%20%20%20*%20%40param%20%5Bmatrix%5D%20%7BPIXI.Matrix%7D%20Optional%20matrix%20to%20apply%20to%20the%20display%20object%20before%20rendering.%0A%20%20%20%20%20*%20%40param%20%5Bclear%3Dfalse%5D%20%7Bboolean%7D%20If%20true%20the%20texture%20will%20be%20cleared%20before%20the%20displayObject%20is%20drawn%0A%20%20%20%20%20*%20%40param%20%5BupdateTransform%3Dtrue%5D%20%7Bboolean%7D%20If%20true%20the%20displayObject's%20worldTransform%2FworldAlpha%20and%20all%20children%0A%20%20%20%20%20*%20%20transformations%20will%20be%20restored.%20Not%20restoring%20this%20information%20will%20be%20a%20little%20faster.%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.render%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20renderer%20this%20RenderTexture%20uses.%20A%20RenderTexture%20can%20only%20belong%20to%20one%20renderer%20at%20the%20moment%20if%20its%20webGL.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.CanvasRenderer%7CPIXI.WebGLRenderer%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.renderer%20%3D%20renderer%3B%0A%0A%20%20%20%20if%20(this.renderer.type%20%3D%3D%3D%20CONST.RENDERER_TYPE.WEBGL)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%0A%20%20%20%20%20%20%20%20this.textureBuffer%20%3D%20new%20RenderTarget(gl%2C%20this.width%2C%20this.height%2C%20baseTexture.scaleMode%2C%20this.resolution)%3B%2F%2F%2C%20this.baseTexture.scaleMode)%3B%0A%20%20%20%20%20%20%20%20this.baseTexture._glTextures%5Bgl.id%5D%20%3D%20%20this.textureBuffer.texture%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2FTODO%20refactor%20filter%20manager..%20as%20really%20its%20no%20longer%20a%20manager%20if%20we%20use%20it%20here..%0A%20%20%20%20%20%20%20%20this.filterManager%20%3D%20new%20FilterManager(this.renderer)%3B%0A%20%20%20%20%20%20%20%20this.filterManager.onContextChange()%3B%0A%20%20%20%20%20%20%20%20this.filterManager.resize(width%2C%20height)%3B%0A%20%20%20%20%20%20%20%20this.render%20%3D%20this.renderWebGL%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20the%20creation%20of%20a%20filter%20manager%20unbinds%20the%20buffers..%0A%20%20%20%20%20%20%20%20this.renderer.currentRenderer.start()%3B%0A%20%20%20%20%20%20%20%20this.renderer.currentRenderTarget.activate()%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20this.render%20%3D%20this.renderCanvas%3B%0A%20%20%20%20%20%20%20%20this.textureBuffer%20%3D%20new%20CanvasBuffer(this.width*%20this.resolution%2C%20this.height*%20this.resolution)%3B%0A%20%20%20%20%20%20%20%20this.baseTexture.source%20%3D%20this.textureBuffer.canvas%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.valid%20%3D%20true%3B%0A%0A%20%20%20%20this._updateUvs()%3B%0A%7D%0A%0ARenderTexture.prototype%20%3D%20Object.create(Texture.prototype)%3B%0ARenderTexture.prototype.constructor%20%3D%20RenderTexture%3B%0Amodule.exports%20%3D%20RenderTexture%3B%0A%0A%2F**%0A%20*%20Resizes%20the%20RenderTexture.%0A%20*%0A%20*%20%40param%20width%20%7Bnumber%7D%20The%20width%20to%20resize%20to.%0A%20*%20%40param%20height%20%7Bnumber%7D%20The%20height%20to%20resize%20to.%0A%20*%20%40param%20updateBase%20%7Bboolean%7D%20Should%20the%20baseTexture.width%20and%20height%20values%20be%20resized%20as%20well%3F%0A%20*%2F%0ARenderTexture.prototype.resize%20%3D%20function%20(width%2C%20height%2C%20updateBase)%0A%7B%0A%20%20%20%20if%20(width%20%3D%3D%3D%20this.width%20%26%26%20height%20%3D%3D%3D%20this.height)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.valid%20%3D%20(width%20%3E%200%20%26%26%20height%20%3E%200)%3B%0A%0A%20%20%20%20this.width%20%3D%20this._frame.width%20%3D%20this.crop.width%20%3D%20width%3B%0A%20%20%20%20this.height%20%3D%20%20this._frame.height%20%3D%20this.crop.height%20%3D%20height%3B%0A%0A%20%20%20%20if%20(updateBase)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.baseTexture.width%20%3D%20this.width%3B%0A%20%20%20%20%20%20%20%20this.baseTexture.height%20%3D%20this.height%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(!this.valid)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.textureBuffer.resize(this.width%2C%20this.height)%3B%0A%0A%20%20%20%20if(this.filterManager)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.filterManager.resize(this.width%2C%20this.height)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Clears%20the%20RenderTexture.%0A%20*%0A%20*%2F%0ARenderTexture.prototype.clear%20%3D%20function%20()%0A%7B%0A%20%20%20%20if%20(!this.valid)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(this.renderer.type%20%3D%3D%3D%20CONST.RENDERER_TYPE.WEBGL)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER%2C%20this.textureBuffer.frameBuffer)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.textureBuffer.clear()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Internal%20method%20assigned%20to%20the%20%60render%60%20property%20if%20using%20a%20CanvasRenderer.%0A%20*%0A%20*%20%40private%0A%20*%20%40param%20displayObject%20%7BPIXI.DisplayObject%7D%20The%20display%20object%20to%20render%20this%20texture%20on%0A%20*%20%40param%20%5Bmatrix%5D%20%7BPIXI.Matrix%7D%20Optional%20matrix%20to%20apply%20to%20the%20display%20object%20before%20rendering.%0A%20*%20%40param%20%5Bclear%3Dfalse%5D%20%7Bboolean%7D%20If%20true%20the%20texture%20will%20be%20cleared%20before%20the%20displayObject%20is%20drawn%0A%20*%20%40param%20%5BupdateTransform%3Dtrue%5D%20%7Bboolean%7D%20If%20true%20the%20displayObject's%20worldTransform%2FworldAlpha%20and%20all%20children%0A%20*%20%20transformations%20will%20be%20restored.%20Not%20restoring%20this%20information%20will%20be%20a%20little%20faster.%0A%20*%2F%0ARenderTexture.prototype.renderWebGL%20%3D%20function%20(displayObject%2C%20matrix%2C%20clear%2C%20updateTransform)%0A%7B%0A%20%20%20%20if%20(!this.valid)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%0A%20%20%20%20updateTransform%20%3D%20(updateTransform%20!%3D%3D%20undefined)%20%3F%20updateTransform%20%3A%20true%3B%2F%2F!updateTransform%3B%0A%0A%20%20%20%20this.textureBuffer.transform%20%3D%20matrix%3B%0A%0A%20%20%20%20%2F%2FTODO%20not%20a%20fan%20that%20this%20is%20here...%20it%20will%20move!%0A%20%20%20%20this.textureBuffer.activate()%3B%0A%0A%20%20%20%20%2F%2F%20setWorld%20Alpha%20to%20ensure%20that%20the%20object%20is%20renderer%20at%20full%20opacity%0A%20%20%20%20displayObject.worldAlpha%20%3D%201%3B%0A%0A%20%20%20%20if%20(updateTransform)%0A%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20reset%20the%20matrix%20of%20the%20displatyObject..%0A%20%20%20%20%20%20%20%20displayObject.worldTransform.identity()%3B%0A%0A%20%20%20%20%20%20%20%20displayObject.currentBounds%20%3D%20null%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Time%20to%20update%20all%20the%20children%20of%20the%20displayObject%20with%20the%20new%20matrix..%0A%20%20%20%20%20%20%20%20var%20children%20%3D%20displayObject.children%3B%0A%20%20%20%20%20%20%20%20var%20i%2C%20j%3B%0A%0A%20%20%20%20%20%20%20%20for%20(i%20%3D%200%2C%20j%20%3D%20children.length%3B%20i%20%3C%20j%3B%20%2B%2Bi)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20children%5Bi%5D.updateTransform()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2FTODO%20rename%20textureBuffer%20to%20renderTarget..%0A%20%20%20%20var%20temp%20%3D%20%20this.renderer.filterManager%3B%0A%0A%20%20%20%20this.renderer.filterManager%20%3D%20this.filterManager%3B%0A%20%20%20%20this.renderer.renderDisplayObject(displayObject%2C%20this.textureBuffer%2C%20clear)%3B%0A%0A%20%20%20%20this.renderer.filterManager%20%3D%20temp%3B%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Internal%20method%20assigned%20to%20the%20%60render%60%20property%20if%20using%20a%20CanvasRenderer.%0A%20*%0A%20*%20%40private%0A%20*%20%40param%20displayObject%20%7BPIXI.DisplayObject%7D%20The%20display%20object%20to%20render%20this%20texture%20on%0A%20*%20%40param%20%5Bmatrix%5D%20%7BPIXI.Matrix%7D%20Optional%20matrix%20to%20apply%20to%20the%20display%20object%20before%20rendering.%0A%20*%20%40param%20%5Bclear%5D%20%7Bboolean%7D%20If%20true%20the%20texture%20will%20be%20cleared%20before%20the%20displayObject%20is%20drawn%0A%20*%2F%0ARenderTexture.prototype.renderCanvas%20%3D%20function%20(displayObject%2C%20matrix%2C%20clear%2C%20updateTransform)%0A%7B%0A%20%20%20%20if%20(!this.valid)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20updateTransform%20%3D%20!!updateTransform%3B%0A%0A%20%20%20%20var%20wt%20%3D%20tempMatrix%3B%0A%0A%20%20%20%20wt.identity()%3B%0A%0A%20%20%20%20if%20(matrix)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20wt.append(matrix)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20displayObject.worldTransform%20%3D%20wt%3B%0A%20%20%20%20var%20cachedWt%20%3D%20displayObject.worldTransform%3B%0A%0A%20%20%20%20%2F%2F%20setWorld%20Alpha%20to%20ensure%20that%20the%20object%20is%20renderer%20at%20full%20opacity%0A%20%20%20%20displayObject.worldAlpha%20%3D%201%3B%0A%0A%20%20%20%20%2F%2F%20Time%20to%20update%20all%20the%20children%20of%20the%20displayObject%20with%20the%20new%20matrix..%0A%20%20%20%20var%20children%20%3D%20displayObject.children%3B%0A%20%20%20%20var%20i%2C%20j%3B%0A%0A%20%20%20%20for%20(i%20%3D%200%2C%20j%20%3D%20children.length%3B%20i%20%3C%20j%3B%20%2B%2Bi)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20children%5Bi%5D.updateTransform()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(clear)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.textureBuffer.clear()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%0A%2F%2F%20%20%20%20this.textureBuffer.%0A%20%20%20%20var%20context%20%3D%20this.textureBuffer.context%3B%0A%0A%20%20%20%20var%20realResolution%20%3D%20this.renderer.resolution%3B%0A%0A%20%20%20%20this.renderer.resolution%20%3D%20this.resolution%3B%0A%0A%20%20%20%20this.renderer.renderDisplayObject(displayObject%2C%20context)%3B%0A%0A%20%20%20%20this.renderer.resolution%20%3D%20realResolution%3B%0A%0A%20%20%20%20%20displayObject.worldTransform%20%3D%20cachedWt%3B%0A%0A%20%2F%2F%20%20%20context.setTransform(1%2C%200%2C%200%2C%201%2C%200%2C%200)%3B%0A%20%20%20%2F%2F%20context.fillStyle%20%3D%22%23FF0000%22%0A%2F%2F%20%20%20%20context.fillRect(0%2C%200%2C%20800%2C%20600)%3B%0A%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20this%20texture%0A%20*%0A%20*%20%40param%20destroyBase%20%7Bboolean%7D%20Whether%20to%20destroy%20the%20base%20texture%20as%20well%0A%20*%2F%0ARenderTexture.prototype.destroy%20%3D%20function%20()%0A%7B%0A%20%20%20%20Texture.prototype.destroy.call(this%2C%20true)%3B%0A%0A%20%20%20%20this.textureBuffer.destroy()%3B%0A%0A%20%20%20%20%2F%2F%20destroy%20the%20filtermanager..%0A%20%20%20%20if(this.filterManager)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.filterManager.destroy()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.renderer%20%3D%20null%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Will%20return%20a%20HTML%20Image%20of%20the%20texture%0A%20*%0A%20*%20%40return%20%7BImage%7D%0A%20*%2F%0ARenderTexture.prototype.getImage%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20image%20%3D%20new%20Image()%3B%0A%20%20%20%20image.src%20%3D%20this.getBase64()%3B%0A%20%20%20%20return%20image%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Will%20return%20a%20a%20base64%20encoded%20string%20of%20this%20texture.%20It%20works%20by%20calling%20RenderTexture.getCanvas%20and%20then%20running%20toDataURL%20on%20that.%0A%20*%0A%20*%20%40return%20%7Bstring%7D%20A%20base64%20encoded%20string%20of%20the%20texture.%0A%20*%2F%0ARenderTexture.prototype.getBase64%20%3D%20function%20()%0A%7B%0A%20%20%20%20return%20this.getCanvas().toDataURL()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Creates%20a%20Canvas%20element%2C%20renders%20this%20RenderTexture%20to%20it%20and%20then%20returns%20it.%0A%20*%0A%20*%20%40return%20%7BHTMLCanvasElement%7D%20A%20Canvas%20element%20with%20the%20texture%20rendered%20on.%0A%20*%2F%0ARenderTexture.prototype.getCanvas%20%3D%20function%20()%0A%7B%0A%20%20%20%20if%20(this.renderer.type%20%3D%3D%3D%20CONST.RENDERER_TYPE.WEBGL)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%20%20%20%20%20%20%20%20var%20width%20%3D%20this.textureBuffer.size.width%3B%0A%20%20%20%20%20%20%20%20var%20height%20%3D%20this.textureBuffer.size.height%3B%0A%0A%20%20%20%20%20%20%20%20var%20webGLPixels%20%3D%20new%20Uint8Array(4%20*%20width%20*%20height)%3B%0A%0A%20%20%20%20%20%20%20%20gl.bindFramebuffer(gl.FRAMEBUFFER%2C%20this.textureBuffer.frameBuffer)%3B%0A%20%20%20%20%20%20%20%20gl.readPixels(0%2C%200%2C%20width%2C%20height%2C%20gl.RGBA%2C%20gl.UNSIGNED_BYTE%2C%20webGLPixels)%3B%0A%20%20%20%20%20%20%20%20gl.bindFramebuffer(gl.FRAMEBUFFER%2C%20null)%3B%0A%0A%20%20%20%20%20%20%20%20var%20tempCanvas%20%3D%20new%20CanvasBuffer(width%2C%20height)%3B%0A%20%20%20%20%20%20%20%20var%20canvasData%20%3D%20tempCanvas.context.getImageData(0%2C%200%2C%20width%2C%20height)%3B%0A%20%20%20%20%20%20%20%20canvasData.data.set(webGLPixels)%3B%0A%0A%20%20%20%20%20%20%20%20tempCanvas.context.putImageData(canvasData%2C%200%2C%200)%3B%0A%0A%20%20%20%20%20%20%20%20return%20tempCanvas.canvas%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20this.textureBuffer.canvas%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Will%20return%20a%20one-dimensional%20array%20containing%20the%20pixel%20data%20of%20the%20entire%20texture%20in%20RGBA%20order%2C%20with%20integer%20values%20between%200%20and%20255%20(included).%0A%20*%0A%20*%20%40return%20%7BUint8ClampedArray%7D%0A%20*%2F%0ARenderTexture.prototype.getPixels%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20width%2C%20height%3B%0A%0A%20%20%20%20if%20(this.renderer.type%20%3D%3D%3D%20CONST.RENDERER_TYPE.WEBGL)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%20%20%20%20%20%20%20%20width%20%3D%20this.textureBuffer.size.width%3B%0A%20%20%20%20%20%20%20%20height%20%3D%20this.textureBuffer.size.height%3B%0A%0A%20%20%20%20%20%20%20%20var%20webGLPixels%20%3D%20new%20Uint8Array(4%20*%20width%20*%20height)%3B%0A%0A%20%20%20%20%20%20%20%20gl.bindFramebuffer(gl.FRAMEBUFFER%2C%20this.textureBuffer.frameBuffer)%3B%0A%20%20%20%20%20%20%20%20gl.readPixels(0%2C%200%2C%20width%2C%20height%2C%20gl.RGBA%2C%20gl.UNSIGNED_BYTE%2C%20webGLPixels)%3B%0A%20%20%20%20%20%20%20%20gl.bindFramebuffer(gl.FRAMEBUFFER%2C%20null)%3B%0A%0A%20%20%20%20%20%20%20%20return%20webGLPixels%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20width%20%3D%20this.textureBuffer.canvas.width%3B%0A%20%20%20%20%20%20%20%20height%20%3D%20this.textureBuffer.canvas.height%3B%0A%0A%20%20%20%20%20%20%20%20return%20this.textureBuffer.canvas.getContext('2d').getImageData(0%2C%200%2C%20width%2C%20height).data%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Will%20return%20a%20one-dimensional%20array%20containing%20the%20pixel%20data%20of%20a%20pixel%20within%20the%20texture%20in%20RGBA%20order%2C%20with%20integer%20values%20between%200%20and%20255%20(included).%0A%20*%0A%20*%20%40param%20x%20%7Bnumber%7D%20The%20x%20coordinate%20of%20the%20pixel%20to%20retrieve.%0A%20*%20%40param%20y%20%7Bnumber%7D%20The%20y%20coordinate%20of%20the%20pixel%20to%20retrieve.%0A%20*%20%40return%20%7BUint8ClampedArray%7D%0A%20*%2F%0ARenderTexture.prototype.getPixel%20%3D%20function%20(x%2C%20y)%0A%7B%0A%20%20%20%20if%20(this.renderer.type%20%3D%3D%3D%20CONST.RENDERER_TYPE.WEBGL)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%0A%20%20%20%20%20%20%20%20var%20webGLPixels%20%3D%20new%20Uint8Array(4)%3B%0A%0A%20%20%20%20%20%20%20%20gl.bindFramebuffer(gl.FRAMEBUFFER%2C%20this.textureBuffer.frameBuffer)%3B%0A%20%20%20%20%20%20%20%20gl.readPixels(x%2C%20y%2C%201%2C%201%2C%20gl.RGBA%2C%20gl.UNSIGNED_BYTE%2C%20webGLPixels)%3B%0A%20%20%20%20%20%20%20%20gl.bindFramebuffer(gl.FRAMEBUFFER%2C%20null)%3B%0A%0A%20%20%20%20%20%20%20%20return%20webGLPixels%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20this.textureBuffer.canvas.getContext('2d').getImageData(x%2C%20y%2C%201%2C%201).data%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fconst%22%3A13%2C%22..%2Fmath%22%3A23%2C%22..%2Frenderers%2Fcanvas%2Futils%2FCanvasBuffer%22%3A35%2C%22..%2Frenderers%2Fwebgl%2Fmanagers%2FFilterManager%22%3A44%2C%22..%2Frenderers%2Fwebgl%2Futils%2FRenderTarget%22%3A55%2C%22.%2FBaseTexture%22%3A60%2C%22.%2FTexture%22%3A62%7D%5D%2C62%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20BaseTexture%20%3D%20require('.%2FBaseTexture')%2C%0A%20%20%20%20VideoBaseTexture%20%3D%20require('.%2FVideoBaseTexture')%2C%0A%20%20%20%20TextureUvs%20%3D%20require('.%2FTextureUvs')%2C%0A%20%20%20%20EventEmitter%20%3D%20require('eventemitter3')%2C%0A%20%20%20%20math%20%3D%20require('..%2Fmath')%2C%0A%20%20%20%20utils%20%3D%20require('..%2Futils')%3B%0A%0A%2F**%0A%20*%20A%20texture%20stores%20the%20information%20that%20represents%20an%20image%20or%20part%20of%20an%20image.%20It%20cannot%20be%20added%0A%20*%20to%20the%20display%20list%20directly.%20Instead%20use%20it%20as%20the%20texture%20for%20a%20Sprite.%20If%20no%20frame%20is%20provided%20then%20the%20whole%20image%20is%20used.%0A%20*%0A%20*%20You%20can%20directly%20create%20a%20texture%20from%20an%20image%20and%20then%20reuse%20it%20multiple%20times%20like%20this%20%3A%0A%20*%0A%20*%20%60%60%60js%0A%20*%20var%20texture%20%3D%20PIXI.Texture.fromImage('assets%2Fimage.png')%3B%0A%20*%20var%20sprite1%20%3D%20new%20PIXI.Sprite(texture)%3B%0A%20*%20var%20sprite2%20%3D%20new%20PIXI.Sprite(texture)%3B%0A%20*%20%60%60%60%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20baseTexture%20%7BPIXI.BaseTexture%7D%20The%20base%20texture%20source%20to%20create%20the%20texture%20from%0A%20*%20%40param%20%5Bframe%5D%20%7BPIXI.Rectangle%7D%20The%20rectangle%20frame%20of%20the%20texture%20to%20show%0A%20*%20%40param%20%5Bcrop%5D%20%7BPIXI.Rectangle%7D%20The%20area%20of%20original%20texture%0A%20*%20%40param%20%5Btrim%5D%20%7BPIXI.Rectangle%7D%20Trimmed%20texture%20rectangle%0A%20*%20%40param%20%5Brotate%5D%20%7Bboolean%7D%20indicates%20whether%20the%20texture%20should%20be%20rotated%20by%2090%20degrees%20(%20used%20by%20texture%20packer%20)%0A%20*%2F%0Afunction%20Texture(baseTexture%2C%20frame%2C%20crop%2C%20trim%2C%20rotate)%0A%7B%0A%20%20%20%20EventEmitter.call(this)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Does%20this%20Texture%20have%20any%20frame%20data%20assigned%20to%20it%3F%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.noFrame%20%3D%20false%3B%0A%0A%20%20%20%20if%20(!frame)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.noFrame%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20frame%20%3D%20new%20math.Rectangle(0%2C%200%2C%201%2C%201)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(baseTexture%20instanceof%20Texture)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20baseTexture%20%3D%20baseTexture.baseTexture%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20base%20texture%20that%20this%20texture%20uses.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.BaseTexture%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.baseTexture%20%3D%20baseTexture%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20frame%20specifies%20the%20region%20of%20the%20base%20texture%20that%20this%20texture%20uses%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Rectangle%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._frame%20%3D%20frame%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20texture%20trim%20data.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Rectangle%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.trim%20%3D%20trim%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20This%20will%20let%20the%20renderer%20know%20if%20the%20texture%20is%20valid.%20If%20it's%20not%20then%20it%20cannot%20be%20rendered.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.valid%20%3D%20false%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20This%20will%20let%20a%20renderer%20know%20that%20a%20texture%20has%20been%20updated%20(used%20mainly%20for%20webGL%20uv%20updates)%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.requiresUpdate%20%3D%20false%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20WebGL%20UV%20data%20cache.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.TextureUvs%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._uvs%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20width%20of%20the%20Texture%20in%20pixels.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.width%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20height%20of%20the%20Texture%20in%20pixels.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.height%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20This%20is%20the%20area%20of%20the%20BaseTexture%20image%20to%20actually%20copy%20to%20the%20Canvas%20%2F%20WebGL%20when%20rendering%2C%0A%20%20%20%20%20*%20irrespective%20of%20the%20actual%20frame%20size%20or%20placement%20(which%20can%20be%20influenced%20by%20trimmed%20texture%20atlases)%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Rectangle%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.crop%20%3D%20crop%20%7C%7C%20frame%3B%2F%2Fnew%20math.Rectangle(0%2C%200%2C%201%2C%201)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Indicates%20whether%20the%20texture%20should%20be%20rotated%20by%2090%20degrees%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.rotate%20%3D%20!!rotate%3B%0A%0A%20%20%20%20if%20(baseTexture.hasLoaded)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(this.noFrame)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20frame%20%3D%20new%20math.Rectangle(0%2C%200%2C%20baseTexture.width%2C%20baseTexture.height)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20if%20there%20is%20no%20frame%20we%20should%20monitor%20for%20any%20base%20texture%20changes..%0A%20%20%20%20%20%20%20%20%20%20%20%20baseTexture.on('update'%2C%20this.onBaseTextureUpdated%2C%20this)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20this.frame%20%3D%20frame%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20baseTexture.once('loaded'%2C%20this.onBaseTextureLoaded%2C%20this)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Fired%20when%20the%20texture%20is%20updated.%20This%20happens%20if%20the%20frame%20or%20the%20baseTexture%20is%20updated.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40event%20update%0A%20%20%20%20%20*%20%40memberof%20PIXI.Texture%23%0A%20%20%20%20%20*%20%40protected%0A%20%20%20%20%20*%2F%0A%7D%0A%0ATexture.prototype%20%3D%20Object.create(EventEmitter.prototype)%3B%0ATexture.prototype.constructor%20%3D%20Texture%3B%0Amodule.exports%20%3D%20Texture%3B%0A%0AObject.defineProperties(Texture.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20frame%20specifies%20the%20region%20of%20the%20base%20texture%20that%20this%20texture%20uses.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Rectangle%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.Texture%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20frame%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this._frame%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(frame)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._frame%20%3D%20frame%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20this.noFrame%20%3D%20false%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20this.width%20%3D%20frame.width%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.height%20%3D%20frame.height%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!this.trim%20%26%26%20!this.rotate%20%26%26%20(frame.x%20%2B%20frame.width%20%3E%20this.baseTexture.width%20%7C%7C%20frame.y%20%2B%20frame.height%20%3E%20this.baseTexture.height))%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error('Texture%20Error%3A%20frame%20does%20not%20fit%20inside%20the%20base%20Texture%20dimensions%20'%20%2B%20this)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2Fthis.valid%20%3D%20frame%20%26%26%20frame.width%20%26%26%20frame.height%20%26%26%20this.baseTexture.source%20%26%26%20this.baseTexture.hasLoaded%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.valid%20%3D%20frame%20%26%26%20frame.width%20%26%26%20frame.height%20%26%26%20this.baseTexture.hasLoaded%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.trim)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.width%20%3D%20this.trim.width%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.height%20%3D%20this.trim.height%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._frame.width%20%3D%20this.trim.width%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._frame.height%20%3D%20this.trim.height%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.crop%20%3D%20frame%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.valid)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._updateUvs()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%2F**%0A%20*%20Updates%20this%20texture%20on%20the%20gpu.%0A%20*%0A%20*%2F%0ATexture.prototype.update%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.baseTexture.update()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Called%20when%20the%20base%20texture%20is%20loaded%0A%20*%0A%20*%20%40private%0A%20*%2F%0ATexture.prototype.onBaseTextureLoaded%20%3D%20function%20(baseTexture)%0A%7B%0A%20%20%20%20%2F%2F%20TODO%20this%20code%20looks%20confusing..%20boo%20to%20abusing%20getters%20and%20setterss!%0A%20%20%20%20if%20(this.noFrame)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.frame%20%3D%20new%20math.Rectangle(0%2C%200%2C%20baseTexture.width%2C%20baseTexture.height)%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.frame%20%3D%20this._frame%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.emit('update'%2C%20this)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Called%20when%20the%20base%20texture%20is%20updated%0A%20*%0A%20*%20%40private%0A%20*%2F%0ATexture.prototype.onBaseTextureUpdated%20%3D%20function%20(baseTexture)%0A%7B%0A%20%20%20%20this._frame.width%20%3D%20baseTexture.width%3B%0A%20%20%20%20this._frame.height%20%3D%20baseTexture.height%3B%0A%0A%20%20%20%20this.emit('update'%2C%20this)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20this%20texture%0A%20*%0A%20*%20%40param%20%5BdestroyBase%3Dfalse%5D%20%7Bboolean%7D%20Whether%20to%20destroy%20the%20base%20texture%20as%20well%0A%20*%2F%0ATexture.prototype.destroy%20%3D%20function%20(destroyBase)%0A%7B%0A%20%20%20%20if%20(this.baseTexture)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(destroyBase)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.baseTexture.destroy()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20this.baseTexture.off('update'%2C%20this.onBaseTextureUpdated%2C%20this)%3B%0A%20%20%20%20%20%20%20%20this.baseTexture.off('loaded'%2C%20this.onBaseTextureLoaded%2C%20this)%3B%0A%0A%20%20%20%20%20%20%20%20this.baseTexture%20%3D%20null%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this._frame%20%3D%20null%3B%0A%20%20%20%20this._uvs%20%3D%20null%3B%0A%20%20%20%20this.trim%20%3D%20null%3B%0A%20%20%20%20this.crop%20%3D%20null%3B%0A%0A%20%20%20%20this.valid%20%3D%20false%3B%0A%0A%20%20%20%20this.off('dispose'%2C%20this.dispose%2C%20this)%3B%0A%20%20%20%20this.off('update'%2C%20this.update%2C%20this)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Creates%20a%20new%20texture%20object%20that%20acts%20the%20same%20as%20this%20one.%0A%20*%0A%20*%20%40return%20%7BPIXI.Texture%7D%0A%20*%2F%0ATexture.prototype.clone%20%3D%20function%20()%0A%7B%0A%20%20%20%20return%20new%20Texture(this.baseTexture%2C%20this.frame%2C%20this.crop%2C%20this.trim%2C%20this.rotate)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Updates%20the%20internal%20WebGL%20UV%20cache.%0A%20*%0A%20*%20%40private%0A%20*%2F%0ATexture.prototype._updateUvs%20%3D%20function%20()%0A%7B%0A%20%20%20%20if%20(!this._uvs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this._uvs%20%3D%20new%20TextureUvs()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this._uvs.set(this.crop%2C%20this.baseTexture%2C%20this.rotate)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Helper%20function%20that%20creates%20a%20Texture%20object%20from%20the%20given%20image%20url.%0A%20*%20If%20the%20image%20is%20not%20in%20the%20texture%20cache%20it%20will%20be%20%20created%20and%20loaded.%0A%20*%0A%20*%20%40static%0A%20*%20%40param%20imageUrl%20%7Bstring%7D%20The%20image%20url%20of%20the%20texture%0A%20*%20%40param%20crossorigin%20%7Bboolean%7D%20Whether%20requests%20should%20be%20treated%20as%20crossorigin%0A%20*%20%40param%20scaleMode%20%7Bnumber%7D%20See%20%7B%40link%20PIXI.SCALE_MODES%7D%20for%20possible%20values%0A%20*%20%40return%20%7BPIXI.Texture%7D%20The%20newly%20created%20texture%0A%20*%2F%0ATexture.fromImage%20%3D%20function%20(imageUrl%2C%20crossorigin%2C%20scaleMode)%0A%7B%0A%20%20%20%20var%20texture%20%3D%20utils.TextureCache%5BimageUrl%5D%3B%0A%0A%20%20%20%20if%20(!texture)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20texture%20%3D%20new%20Texture(BaseTexture.fromImage(imageUrl%2C%20crossorigin%2C%20scaleMode))%3B%0A%20%20%20%20%20%20%20%20utils.TextureCache%5BimageUrl%5D%20%3D%20texture%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20texture%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Helper%20function%20that%20creates%20a%20sprite%20that%20will%20contain%20a%20texture%20from%20the%20TextureCache%20based%20on%20the%20frameId%0A%20*%20The%20frame%20ids%20are%20created%20when%20a%20Texture%20packer%20file%20has%20been%20loaded%0A%20*%0A%20*%20%40static%0A%20*%20%40param%20frameId%20%7Bstring%7D%20The%20frame%20Id%20of%20the%20texture%20in%20the%20cache%0A%20*%20%40return%20%7BPIXI.Texture%7D%20The%20newly%20created%20texture%0A%20*%2F%0ATexture.fromFrame%20%3D%20function%20(frameId)%0A%7B%0A%20%20%20%20var%20texture%20%3D%20utils.TextureCache%5BframeId%5D%3B%0A%0A%20%20%20%20if%20(!texture)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error('The%20frameId%20%22'%20%2B%20frameId%20%2B%20'%22%20does%20not%20exist%20in%20the%20texture%20cache')%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20texture%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Helper%20function%20that%20creates%20a%20new%20Texture%20based%20on%20the%20given%20canvas%20element.%0A%20*%0A%20*%20%40static%0A%20*%20%40param%20canvas%20%7BCanvas%7D%20The%20canvas%20element%20source%20of%20the%20texture%0A%20*%20%40param%20scaleMode%20%7Bnumber%7D%20See%20%7B%40link%20PIXI.SCALE_MODES%7D%20for%20possible%20values%0A%20*%20%40return%20%7BPIXI.Texture%7D%0A%20*%2F%0ATexture.fromCanvas%20%3D%20function%20(canvas%2C%20scaleMode)%0A%7B%0A%20%20%20%20return%20new%20Texture(BaseTexture.fromCanvas(canvas%2C%20scaleMode))%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Helper%20function%20that%20creates%20a%20new%20Texture%20based%20on%20the%20given%20video%20element.%0A%20*%0A%20*%20%40static%0A%20*%20%40param%20video%20%7BHTMLVideoElement%7D%0A%20*%20%40param%20scaleMode%20%7Bnumber%7D%20See%20%7B%40link%20PIXI.SCALE_MODES%7D%20for%20possible%20values%0A%20*%20%40return%20%7BPIXI.Texture%7D%20A%20Texture%0A%20*%2F%0ATexture.fromVideo%20%3D%20function%20(video%2C%20scaleMode)%0A%7B%0A%20%20%20%20if%20(typeof%20video%20%3D%3D%3D%20'string')%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20Texture.fromVideoUrl(video%2C%20scaleMode)%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20new%20Texture(VideoBaseTexture.fromVideo(video%2C%20scaleMode))%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Helper%20function%20that%20creates%20a%20new%20Texture%20based%20on%20the%20video%20url.%0A%20*%0A%20*%20%40static%0A%20*%20%40param%20videoUrl%20%7Bstring%7D%0A%20*%20%40param%20scaleMode%20%7Bnumber%7D%20See%20%7B%40link%20PIXI.SCALE_MODES%7D%20for%20possible%20values%0A%20*%20%40return%20%7BPIXI.Texture%7D%20A%20Texture%0A%20*%2F%0ATexture.fromVideoUrl%20%3D%20function%20(videoUrl%2C%20scaleMode)%0A%7B%0A%20%20%20%20return%20new%20Texture(VideoBaseTexture.fromUrl(videoUrl%2C%20scaleMode))%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Adds%20a%20texture%20to%20the%20global%20utils.TextureCache.%20This%20cache%20is%20shared%20across%20the%20whole%20PIXI%20object.%0A%20*%0A%20*%20%40static%0A%20*%20%40param%20texture%20%7BPIXI.Texture%7D%20The%20Texture%20to%20add%20to%20the%20cache.%0A%20*%20%40param%20id%20%7Bstring%7D%20The%20id%20that%20the%20texture%20will%20be%20stored%20against.%0A%20*%2F%0ATexture.addTextureToCache%20%3D%20function%20(texture%2C%20id)%0A%7B%0A%20%20%20%20utils.TextureCache%5Bid%5D%20%3D%20texture%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Remove%20a%20texture%20from%20the%20global%20utils.TextureCache.%0A%20*%0A%20*%20%40static%0A%20*%20%40param%20id%20%7Bstring%7D%20The%20id%20of%20the%20texture%20to%20be%20removed%0A%20*%20%40return%20%7BPIXI.Texture%7D%20The%20texture%20that%20was%20removed%0A%20*%2F%0ATexture.removeTextureFromCache%20%3D%20function%20(id)%0A%7B%0A%20%20%20%20var%20texture%20%3D%20utils.TextureCache%5Bid%5D%3B%0A%0A%20%20%20%20delete%20utils.TextureCache%5Bid%5D%3B%0A%20%20%20%20delete%20utils.BaseTextureCache%5Bid%5D%3B%0A%0A%20%20%20%20return%20texture%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20An%20empty%20texture%2C%20used%20often%20to%20not%20have%20to%20create%20multiple%20empty%20textures.%0A%20*%0A%20*%20%40static%0A%20*%20%40constant%0A%20*%2F%0ATexture.EMPTY%20%3D%20new%20Texture(new%20BaseTexture())%3B%0A%0A%7D%2C%7B%22..%2Fmath%22%3A23%2C%22..%2Futils%22%3A67%2C%22.%2FBaseTexture%22%3A60%2C%22.%2FTextureUvs%22%3A63%2C%22.%2FVideoBaseTexture%22%3A64%2C%22eventemitter3%22%3A10%7D%5D%2C63%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%0A%2F**%0A%20*%20A%20standard%20object%20to%20store%20the%20Uvs%20of%20a%20texture%0A%20*%0A%20*%20%40class%0A%20*%20%40private%0A%20*%20%40memberof%20PIXI%0A%20*%2F%0Afunction%20TextureUvs()%0A%7B%0A%20%20%20%20this.x0%20%3D%200%3B%0A%20%20%20%20this.y0%20%3D%200%3B%0A%0A%20%20%20%20this.x1%20%3D%201%3B%0A%20%20%20%20this.y1%20%3D%200%3B%0A%0A%20%20%20%20this.x2%20%3D%201%3B%0A%20%20%20%20this.y2%20%3D%201%3B%0A%0A%20%20%20%20this.x3%20%3D%200%3B%0A%20%20%20%20this.y3%20%3D%201%3B%0A%7D%0A%0Amodule.exports%20%3D%20TextureUvs%3B%0A%0A%2F**%0A%20*%20Sets%20the%20texture%20Uvs%20based%20on%20the%20given%20frame%20information%0A%20*%20%40param%20frame%20%7BPIXI.Rectangle%7D%0A%20*%20%40param%20baseFrame%20%7BPIXI.Rectangle%7D%0A%20*%20%40param%20rotate%20%7Bboolean%7D%20Whether%20or%20not%20the%20frame%20is%20rotated%0A%20*%20%40private%0A%20*%2F%0ATextureUvs.prototype.set%20%3D%20function%20(frame%2C%20baseFrame%2C%20rotate)%0A%7B%0A%20%20%20%20var%20tw%20%3D%20baseFrame.width%3B%0A%20%20%20%20var%20th%20%3D%20baseFrame.height%3B%0A%0A%20%20%20%20if(rotate)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.x0%20%3D%20(frame.x%20%2B%20frame.height)%20%2F%20tw%3B%0A%20%20%20%20%20%20%20%20this.y0%20%3D%20frame.y%20%2F%20th%3B%0A%0A%20%20%20%20%20%20%20%20this.x1%20%3D%20(frame.x%20%2B%20frame.height)%20%2F%20tw%3B%0A%20%20%20%20%20%20%20%20this.y1%20%3D%20(frame.y%20%2B%20frame.width)%20%2F%20th%3B%0A%0A%20%20%20%20%20%20%20%20this.x2%20%3D%20frame.x%20%2F%20tw%3B%0A%20%20%20%20%20%20%20%20this.y2%20%3D%20(frame.y%20%2B%20frame.width)%20%2F%20th%3B%0A%0A%20%20%20%20%20%20%20%20this.x3%20%3D%20frame.x%20%2F%20tw%3B%0A%20%20%20%20%20%20%20%20this.y3%20%3D%20frame.y%20%2F%20th%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20this.x0%20%3D%20frame.x%20%2F%20tw%3B%0A%20%20%20%20%20%20%20%20this.y0%20%3D%20frame.y%20%2F%20th%3B%0A%0A%20%20%20%20%20%20%20%20this.x1%20%3D%20(frame.x%20%2B%20frame.width)%20%2F%20tw%3B%0A%20%20%20%20%20%20%20%20this.y1%20%3D%20frame.y%20%2F%20th%3B%0A%0A%20%20%20%20%20%20%20%20this.x2%20%3D%20(frame.x%20%2B%20frame.width)%20%2F%20tw%3B%0A%20%20%20%20%20%20%20%20this.y2%20%3D%20(frame.y%20%2B%20frame.height)%20%2F%20th%3B%0A%0A%20%20%20%20%20%20%20%20this.x3%20%3D%20frame.x%20%2F%20tw%3B%0A%20%20%20%20%20%20%20%20this.y3%20%3D%20(frame.y%20%2B%20frame.height)%20%2F%20th%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%7D%2C%7B%7D%5D%2C64%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20BaseTexture%20%3D%20require('.%2FBaseTexture')%2C%0A%20%20%20%20utils%20%3D%20require('..%2Futils')%3B%0A%0A%2F**%0A%20*%20A%20texture%20of%20a%20%5Bplaying%5D%20Video.%0A%20*%0A%20*%20Video%20base%20textures%20mimic%20Pixi%20BaseTexture.from....%20method%20in%20their%20creation%20process.%0A%20*%0A%20*%20This%20can%20be%20used%20in%20several%20ways%2C%20such%20as%3A%0A%20*%0A%20*%20%60%60%60js%0A%20*%20var%20texture%20%3D%20PIXI.VideoBaseTexture.fromUrl('http%3A%2F%2Fmydomain.com%2Fvideo.mp4')%3B%0A%20*%0A%20*%20var%20texture%20%3D%20PIXI.VideoBaseTexture.fromUrl(%7B%20src%3A%20'http%3A%2F%2Fmydomain.com%2Fvideo.mp4'%2C%20mime%3A%20'video%2Fmp4'%20%7D)%3B%0A%20*%0A%20*%20var%20texture%20%3D%20PIXI.VideoBaseTexture.fromUrls(%5B'%2Fvideo.webm'%2C%20'%2Fvideo.mp4'%5D)%3B%0A%20*%0A%20*%20var%20texture%20%3D%20PIXI.VideoBaseTexture.fromUrls(%5B%0A%20*%20%20%20%20%20%7B%20src%3A%20'%2Fvideo.webm'%2C%20mime%3A%20'video%2Fwebm'%20%7D%2C%0A%20*%20%20%20%20%20%7B%20src%3A%20'%2Fvideo.mp4'%2C%20mime%3A%20'video%2Fmp4'%20%7D%0A%20*%20%5D)%3B%0A%20*%20%60%60%60%0A%20*%0A%20*%20See%20the%20%5B%22deus%22%20demo%5D(http%3A%2F%2Fwww.goodboydigital.com%2Fpixijs%2Fexamples%2Fdeus%2F).%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.BaseTexture%0A%20*%20%40memberof%20PIXI%0A%20*%20%40param%20source%20%7BHTMLVideoElement%7D%0A%20*%20%40param%20%5BscaleMode%5D%20%7Bnumber%7D%20See%20%7B%40link%20PIXI.SCALE_MODES%7D%20for%20possible%20values%0A%20*%2F%0Afunction%20VideoBaseTexture(source%2C%20scaleMode)%0A%7B%0A%20%20%20%20if%20(!source)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error('No%20video%20source%20element%20specified.')%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20hook%20in%20here%20to%20check%20if%20video%20is%20already%20available.%0A%20%20%20%20%2F%2F%20BaseTexture%20looks%20for%20a%20source.complete%20boolean%2C%20plus%20width%20%26%20height.%0A%0A%20%20%20%20if%20((source.readyState%20%3D%3D%3D%20source.HAVE_ENOUGH_DATA%20%7C%7C%20source.readyState%20%3D%3D%3D%20source.HAVE_FUTURE_DATA)%20%26%26%20source.width%20%26%26%20source.height)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20source.complete%20%3D%20true%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20BaseTexture.call(this%2C%20source%2C%20scaleMode)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Should%20the%20base%20texture%20automatically%20update%20itself%2C%20set%20to%20true%20by%20default%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40default%20true%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.autoUpdate%20%3D%20false%3B%0A%0A%20%20%20%20this._onUpdate%20%3D%20this._onUpdate.bind(this)%3B%0A%20%20%20%20this._onCanPlay%20%3D%20this._onCanPlay.bind(this)%3B%0A%0A%20%20%20%20if%20(!source.complete)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20source.addEventListener('canplay'%2C%20this._onCanPlay)%3B%0A%20%20%20%20%20%20%20%20source.addEventListener('canplaythrough'%2C%20this._onCanPlay)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20started%20playing..%0A%20%20%20%20%20%20%20%20source.addEventListener('play'%2C%20this._onPlayStart.bind(this))%3B%0A%20%20%20%20%20%20%20%20source.addEventListener('pause'%2C%20this._onPlayStop.bind(this))%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.__loaded%20%3D%20false%3B%0A%7D%0A%0AVideoBaseTexture.prototype%20%3D%20Object.create(BaseTexture.prototype)%3B%0AVideoBaseTexture.prototype.constructor%20%3D%20VideoBaseTexture%3B%0Amodule.exports%20%3D%20VideoBaseTexture%3B%0A%0A%2F**%0A%20*%20The%20internal%20update%20loop%20of%20the%20video%20base%20texture%2C%20only%20runs%20when%20autoUpdate%20is%20set%20to%20true%0A%20*%0A%20*%20%40private%0A%20*%2F%0AVideoBaseTexture.prototype._onUpdate%20%3D%20function%20()%0A%7B%0A%20%20%20%20if%20(this.autoUpdate)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20window.requestAnimationFrame(this._onUpdate)%3B%0A%20%20%20%20%20%20%20%20this.update()%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Runs%20the%20update%20loop%20when%20the%20video%20is%20ready%20to%20play%0A%20*%0A%20*%20%40private%0A%20*%2F%0AVideoBaseTexture.prototype._onPlayStart%20%3D%20function%20()%0A%7B%0A%20%20%20%20if%20(!this.autoUpdate)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20window.requestAnimationFrame(this._onUpdate)%3B%0A%20%20%20%20%20%20%20%20this.autoUpdate%20%3D%20true%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Fired%20when%20a%20pause%20event%20is%20triggered%2C%20stops%20the%20update%20loop%0A%20*%0A%20*%20%40private%0A%20*%2F%0AVideoBaseTexture.prototype._onPlayStop%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.autoUpdate%20%3D%20false%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Fired%20when%20the%20video%20is%20loaded%20and%20ready%20to%20play%0A%20*%0A%20*%20%40private%0A%20*%2F%0AVideoBaseTexture.prototype._onCanPlay%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.hasLoaded%20%3D%20true%3B%0A%0A%20%20%20%20if%20(this.source)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.source.removeEventListener('canplay'%2C%20this._onCanPlay)%3B%0A%20%20%20%20%20%20%20%20this.source.removeEventListener('canplaythrough'%2C%20this._onCanPlay)%3B%0A%0A%20%20%20%20%20%20%20%20this.width%20%3D%20this.source.videoWidth%3B%0A%20%20%20%20%20%20%20%20this.height%20%3D%20this.source.videoHeight%3B%0A%0A%20%20%20%20%20%20%20%20this.source.play()%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20prevent%20multiple%20loaded%20dispatches..%0A%20%20%20%20%20%20%20%20if%20(!this.__loaded)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.__loaded%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.emit('loaded'%2C%20this)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20this%20texture%0A%20*%0A%20*%2F%0AVideoBaseTexture.prototype.destroy%20%3D%20function%20()%0A%7B%0A%20%20%20%20if%20(this.source%20%26%26%20this.source._pixiId)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20delete%20utils.BaseTextureCache%5B%20this.source._pixiId%20%5D%3B%0A%20%20%20%20%20%20%20%20delete%20this.source._pixiId%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20BaseTexture.prototype.destroy.call(this)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Mimic%20Pixi%20BaseTexture.from....%20method.%0A%20*%0A%20*%20%40static%0A%20*%20%40param%20video%20%7BHTMLVideoElement%7D%0A%20*%20%40param%20scaleMode%20%7Bnumber%7D%20See%20%7B%40link%20PIXI.SCALE_MODES%7D%20for%20possible%20values%0A%20*%20%40return%20%7BPIXI.VideoBaseTexture%7D%0A%20*%2F%0AVideoBaseTexture.fromVideo%20%3D%20function%20(video%2C%20scaleMode)%0A%7B%0A%20%20%20%20if%20(!video._pixiId)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20video._pixiId%20%3D%20'video_'%20%2B%20utils.uid()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20baseTexture%20%3D%20utils.BaseTextureCache%5Bvideo._pixiId%5D%3B%0A%0A%20%20%20%20if%20(!baseTexture)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20baseTexture%20%3D%20new%20VideoBaseTexture(video%2C%20scaleMode)%3B%0A%20%20%20%20%20%20%20%20utils.BaseTextureCache%5B%20video._pixiId%20%5D%20%3D%20baseTexture%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20baseTexture%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Helper%20function%20that%20creates%20a%20new%20BaseTexture%20based%20on%20the%20given%20video%20element.%0A%20*%20This%20BaseTexture%20can%20then%20be%20used%20to%20create%20a%20texture%0A%20*%0A%20*%20%40static%0A%20*%20%40param%20videoSrc%20%7Bstring%7Cobject%7Cstring%5B%5D%7Cobject%5B%5D%7D%20The%20URL(s)%20for%20the%20video.%0A%20*%20%40param%20%5BvideoSrc.src%5D%20%7Bstring%7D%20One%20of%20the%20source%20urls%20for%20the%20video%0A%20*%20%40param%20%5BvideoSrc.mime%5D%20%7Bstring%7D%20The%20mimetype%20of%20the%20video%20(e.g.%20'video%2Fmp4').%20If%20not%20specified%0A%20*%20%20the%20url's%20extension%20will%20be%20used%20as%20the%20second%20part%20of%20the%20mime%20type.%0A%20*%20%40param%20scaleMode%20%7Bnumber%7D%20See%20%7B%40link%20PIXI.SCALE_MODES%7D%20for%20possible%20values%0A%20*%20%40return%20%7BPIXI.VideoBaseTexture%7D%0A%20*%2F%0AVideoBaseTexture.fromUrl%20%3D%20function%20(videoSrc%2C%20scaleMode)%0A%7B%0A%20%20%20%20var%20video%20%3D%20document.createElement('video')%3B%0A%0A%20%20%20%20%2F%2F%20array%20of%20objects%20or%20strings%0A%20%20%20%20if%20(Array.isArray(videoSrc))%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20videoSrc.length%3B%20%2B%2Bi)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20video.appendChild(createSource(videoSrc%5Bi%5D.src%20%7C%7C%20videoSrc%5Bi%5D%2C%20videoSrc%5Bi%5D.mime))%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20%2F%2F%20single%20object%20or%20string%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20video.appendChild(createSource(videoSrc.src%20%7C%7C%20videoSrc%2C%20videoSrc.mime))%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20video.load()%3B%0A%20%20%20%20video.play()%3B%0A%0A%20%20%20%20return%20VideoBaseTexture.fromVideo(video%2C%20scaleMode)%3B%0A%7D%3B%0A%0AVideoBaseTexture.fromUrls%20%3D%20VideoBaseTexture.fromUrl%3B%0A%0Afunction%20createSource(path%2C%20type)%0A%7B%0A%20%20%20%20if%20(!type)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20type%20%3D%20'video%2F'%20%2B%20path.substr(path.lastIndexOf('.')%20%2B%201)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20source%20%3D%20document.createElement('source')%3B%0A%0A%20%20%20%20source.src%20%3D%20path%3B%0A%20%20%20%20source.type%20%3D%20type%3B%0A%0A%20%20%20%20return%20source%3B%0A%7D%0A%0A%7D%2C%7B%22..%2Futils%22%3A67%2C%22.%2FBaseTexture%22%3A60%7D%5D%2C65%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20CONST%20%3D%20require('..%2Fconst')%2C%0A%20%20%20%20EventEmitter%20%3D%20require('eventemitter3')%2C%0A%20%20%20%20%2F%2F%20Internal%20event%20used%20by%20composed%20emitter%0A%20%20%20%20TICK%20%3D%20'tick'%3B%0A%0A%2F**%0A%20*%20A%20Ticker%20class%20that%20runs%20an%20update%20loop%20that%20other%20objects%20listen%20to.%0A%20*%20This%20class%20is%20composed%20around%20an%20EventEmitter%20object%20to%20add%20listeners%0A%20*%20meant%20for%20execution%20on%20the%20next%20requested%20animation%20frame.%0A%20*%20Animation%20frames%20are%20requested%20only%20when%20necessary%2C%0A%20*%20e.g.%20When%20the%20ticker%20is%20started%20and%20the%20emitter%20has%20listeners.%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI.ticker%0A%20*%2F%0Afunction%20Ticker()%0A%7B%0A%20%20%20%20var%20_this%20%3D%20this%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Internal%20tick%20method%20bound%20to%20ticker%20instance.%0A%20%20%20%20%20*%20This%20is%20because%20in%20early%202015%2C%20Function.bind%0A%20%20%20%20%20*%20is%20still%2060%25%20slower%20in%20high%20performance%20scenarios.%0A%20%20%20%20%20*%20Also%20separating%20frame%20requests%20from%20update%20method%0A%20%20%20%20%20*%20so%20listeners%20may%20be%20called%20at%20any%20time%20and%20with%0A%20%20%20%20%20*%20any%20animation%20API%2C%20just%20invoke%20ticker.update(time).%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._tick%20%3D%20function%20_tick(time)%20%7B%0A%0A%20%20%20%20%20%20%20%20_this._requestId%20%3D%20null%3B%0A%0A%20%20%20%20%20%20%20%20if%20(_this.started)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Invoke%20listeners%20now%0A%20%20%20%20%20%20%20%20%20%20%20%20_this.update(time)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Listener%20side%20effects%20may%20have%20modified%20ticker%20state.%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(_this.started%20%26%26%20_this._requestId%20%3D%3D%3D%20null%20%26%26%20_this._emitter.listeners(TICK%2C%20true))%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_this._requestId%20%3D%20requestAnimationFrame(_this._tick)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Internal%20emitter%20used%20to%20fire%20'tick'%20event%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._emitter%20%3D%20new%20EventEmitter()%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Internal%20current%20frame%20request%20ID%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._requestId%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Internal%20value%20managed%20by%20minFPS%20property%20setter%20and%20getter.%0A%20%20%20%20%20*%20This%20is%20the%20maximum%20allowed%20milliseconds%20between%20updates.%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._maxElapsedMS%20%3D%20100%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Whether%20or%20not%20this%20ticker%20should%20invoke%20the%20method%0A%20%20%20%20%20*%20%7B%40link%20PIXI.ticker.Ticker%23start%7D%20automatically%0A%20%20%20%20%20*%20when%20a%20listener%20is%20added.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40default%20false%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.autoStart%20%3D%20false%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Scalar%20time%20value%20from%20last%20frame%20to%20this%20frame.%0A%20%20%20%20%20*%20This%20value%20is%20capped%20by%20setting%20%7B%40link%20PIXI.ticker.Ticker%23minFPS%7D%0A%20%20%20%20%20*%20and%20is%20scaled%20with%20%7B%40link%20PIXI.ticker.Ticker%23speed%7D.%0A%20%20%20%20%20*%20**Note%3A**%20The%20cap%20may%20be%20exceeded%20by%20scaling.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%201%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.deltaTime%20%3D%201%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Time%20elapsed%20in%20milliseconds%20from%20last%20frame%20to%20this%20frame.%0A%20%20%20%20%20*%20Opposed%20to%20what%20the%20scalar%20%7B%40link%20PIXI.ticker.Ticker%23deltaTime%7D%0A%20%20%20%20%20*%20is%20based%2C%20this%20value%20is%20neither%20capped%20nor%20scaled.%0A%20%20%20%20%20*%20If%20the%20platform%20supports%20DOMHighResTimeStamp%2C%0A%20%20%20%20%20*%20this%20value%20will%20have%20a%20precision%20of%201%20%C2%B5s.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BDOMHighResTimeStamp%7Cnumber%7D%0A%20%20%20%20%20*%20%40default%201%20%2F%20TARGET_FPMS%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.elapsedMS%20%3D%201%20%2F%20CONST.TARGET_FPMS%3B%20%2F%2F%20default%20to%20target%20frame%20time%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20last%20time%20%7B%40link%20PIXI.ticker.Ticker%23update%7D%20was%20invoked.%0A%20%20%20%20%20*%20This%20value%20is%20also%20reset%20internally%20outside%20of%20invoking%0A%20%20%20%20%20*%20update%2C%20but%20only%20when%20a%20new%20animation%20frame%20is%20requested.%0A%20%20%20%20%20*%20If%20the%20platform%20supports%20DOMHighResTimeStamp%2C%0A%20%20%20%20%20*%20this%20value%20will%20have%20a%20precision%20of%201%20%C2%B5s.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BDOMHighResTimeStamp%7Cnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.lastTime%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Factor%20of%20current%20%7B%40link%20PIXI.ticker.Ticker%23deltaTime%7D.%0A%20%20%20%20%20*%20%40example%0A%20%20%20%20%20*%20%2F%2F%20Scales%20ticker.deltaTime%20to%20what%20would%20be%0A%20%20%20%20%20*%20%2F%2F%20the%20equivalent%20of%20approximately%20120%20FPS%0A%20%20%20%20%20*%20ticker.speed%20%3D%202%3B%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%201%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.speed%20%3D%201%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Whether%20or%20not%20this%20ticker%20has%20been%20started.%0A%20%20%20%20%20*%20%60true%60%20if%20%7B%40link%20PIXI.ticker.Ticker%23start%7D%20has%20been%20called.%0A%20%20%20%20%20*%20%60false%60%20if%20%7B%40link%20PIXI.ticker.Ticker%23stop%7D%20has%20been%20called.%0A%20%20%20%20%20*%20While%20%60false%60%2C%20this%20value%20may%20change%20to%20%60true%60%20in%20the%0A%20%20%20%20%20*%20event%20of%20%7B%40link%20PIXI.ticker.Ticker%23autoStart%7D%20being%20%60true%60%0A%20%20%20%20%20*%20and%20a%20listener%20is%20added.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40default%20false%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.started%20%3D%20false%3B%0A%7D%0A%0AObject.defineProperties(Ticker.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20frames%20per%20second%20at%20which%20this%20ticker%20is%20running.%0A%20%20%20%20%20*%20The%20default%20is%20approximately%2060%20in%20most%20modern%20browsers.%0A%20%20%20%20%20*%20**Note%3A**%20This%20does%20not%20factor%20in%20the%20value%20of%0A%20%20%20%20%20*%20%7B%40link%20PIXI.ticker.Ticker%23speed%7D%2C%20which%20is%20specific%0A%20%20%20%20%20*%20to%20scaling%20%7B%40link%20PIXI.ticker.Ticker%23deltaTime%7D.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%0A%20%20%20%20%20*%20%40memberof%20PIXI.ticker.Ticker%23%0A%20%20%20%20%20*%20%40readonly%0A%20%20%20%20%20*%2F%0A%20%20%20%20FPS%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%201000%20%2F%20this.elapsedMS%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Manages%20the%20maximum%20amount%20of%20milliseconds%20allowed%20to%0A%20%20%20%20%20*%20elapse%20between%20invoking%20%7B%40link%20PIXI.ticker.Ticker%23update%7D.%0A%20%20%20%20%20*%20This%20value%20is%20used%20to%20cap%20%7B%40link%20PIXI.ticker.Ticker%23deltaTime%7D%2C%0A%20%20%20%20%20*%20but%20does%20not%20effect%20the%20measured%20value%20of%20%7B%40link%20PIXI.ticker.Ticker%23FPS%7D.%0A%20%20%20%20%20*%20When%20setting%20this%20property%20it%20is%20clamped%20to%20a%20value%20between%0A%20%20%20%20%20*%20%600%60%20and%20%60PIXI.TARGET_FPMS%20*%201000%60.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%0A%20%20%20%20%20*%20%40memberof%20PIXI.ticker.Ticker%23%0A%20%20%20%20%20*%20%40default%2010%0A%20%20%20%20%20*%2F%0A%20%20%20%20minFPS%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%201000%20%2F%20this._maxElapsedMS%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function(fps)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Clamp%3A%200%20to%20TARGET_FPMS%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20minFPMS%20%3D%20Math.min(Math.max(0%2C%20fps)%20%2F%201000%2C%20CONST.TARGET_FPMS)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._maxElapsedMS%20%3D%201%20%2F%20minFPMS%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%2F**%0A%20*%20Conditionally%20requests%20a%20new%20animation%20frame.%0A%20*%20If%20a%20frame%20has%20not%20already%20been%20requested%2C%20and%20if%20the%20internal%0A%20*%20emitter%20has%20listeners%2C%20a%20new%20frame%20is%20requested.%0A%20*%0A%20*%20%40private%0A%20*%2F%0ATicker.prototype._requestIfNeeded%20%3D%20function%20_requestIfNeeded()%0A%7B%0A%20%20%20%20if%20(this._requestId%20%3D%3D%3D%20null%20%26%26%20this._emitter.listeners(TICK%2C%20true))%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20ensure%20callbacks%20get%20correct%20delta%0A%20%20%20%20%20%20%20%20this.lastTime%20%3D%20performance.now()%3B%0A%20%20%20%20%20%20%20%20this._requestId%20%3D%20requestAnimationFrame(this._tick)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Conditionally%20cancels%20a%20pending%20animation%20frame.%0A%20*%0A%20*%20%40private%0A%20*%2F%0ATicker.prototype._cancelIfNeeded%20%3D%20function%20_cancelIfNeeded()%0A%7B%0A%20%20%20%20if%20(this._requestId%20!%3D%3D%20null)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20cancelAnimationFrame(this._requestId)%3B%0A%20%20%20%20%20%20%20%20this._requestId%20%3D%20null%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Conditionally%20requests%20a%20new%20animation%20frame.%0A%20*%20If%20the%20ticker%20has%20been%20started%20it%20checks%20if%20a%20frame%20has%20not%20already%0A%20*%20been%20requested%2C%20and%20if%20the%20internal%20emitter%20has%20listeners.%20If%20these%0A%20*%20conditions%20are%20met%2C%20a%20new%20frame%20is%20requested.%20If%20the%20ticker%20has%20not%0A%20*%20been%20started%2C%20but%20autoStart%20is%20%60true%60%2C%20then%20the%20ticker%20starts%20now%2C%0A%20*%20and%20continues%20with%20the%20previous%20conditions%20to%20request%20a%20new%20frame.%0A%20*%0A%20*%20%40private%0A%20*%2F%0ATicker.prototype._startIfPossible%20%3D%20function%20_startIfPossible()%0A%7B%0A%20%20%20%20if%20(this.started)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this._requestIfNeeded()%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%20if%20(this.autoStart)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.start()%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Calls%20%7B%40link%20module%3Aeventemitter3.EventEmitter%23on%7D%20internally%20for%20the%0A%20*%20internal%20'tick'%20event.%20It%20checks%20if%20the%20emitter%20has%20listeners%2C%0A%20*%20and%20if%20so%20it%20requests%20a%20new%20animation%20frame%20at%20this%20point.%0A%20*%0A%20*%20%40param%20fn%20%7BFunction%7D%20The%20listener%20function%20to%20be%20added%20for%20updates%0A%20*%20%40param%20%5Bcontext%5D%20%7BFunction%7D%20The%20listener%20context%0A%20*%20%40returns%20%7BPIXI.ticker.Ticker%7D%20this%0A%20*%2F%0ATicker.prototype.add%20%3D%20function%20add(fn%2C%20context)%0A%7B%0A%20%20%20%20this._emitter.on(TICK%2C%20fn%2C%20context)%3B%0A%0A%20%20%20%20this._startIfPossible()%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Calls%20%7B%40link%20module%3Aeventemitter3.EventEmitter%23once%7D%20internally%20for%20the%0A%20*%20internal%20'tick'%20event.%20It%20checks%20if%20the%20emitter%20has%20listeners%2C%0A%20*%20and%20if%20so%20it%20requests%20a%20new%20animation%20frame%20at%20this%20point.%0A%20*%0A%20*%20%40param%20fn%20%7BFunction%7D%20The%20listener%20function%20to%20be%20added%20for%20one%20update%0A%20*%20%40param%20%5Bcontext%5D%20%7BFunction%7D%20The%20listener%20context%0A%20*%20%40returns%20%7BPIXI.ticker.Ticker%7D%20this%0A%20*%2F%0ATicker.prototype.addOnce%20%3D%20function%20addOnce(fn%2C%20context)%0A%7B%0A%20%20%20%20this._emitter.once(TICK%2C%20fn%2C%20context)%3B%0A%0A%20%20%20%20this._startIfPossible()%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Calls%20%7B%40link%20module%3Aeventemitter3.EventEmitter%23off%7D%20internally%20for%20'tick'%20event.%0A%20*%20It%20checks%20if%20the%20emitter%20has%20listeners%20for%20'tick'%20event.%0A%20*%20If%20it%20does%2C%20then%20it%20cancels%20the%20animation%20frame.%0A%20*%0A%20*%20%40param%20%5Bfn%5D%20%7BFunction%7D%20The%20listener%20function%20to%20be%20removed%0A%20*%20%40param%20%5Bcontext%5D%20%7BFunction%7D%20The%20listener%20context%20to%20be%20removed%0A%20*%20%40returns%20%7BPIXI.ticker.Ticker%7D%20this%0A%20*%2F%0ATicker.prototype.remove%20%3D%20function%20remove(fn%2C%20context)%0A%7B%0A%20%20%20%20this._emitter.off(TICK%2C%20fn%2C%20context)%3B%0A%0A%20%20%20%20if%20(!this._emitter.listeners(TICK%2C%20true))%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this._cancelIfNeeded()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Starts%20the%20ticker.%20If%20the%20ticker%20has%20listeners%0A%20*%20a%20new%20animation%20frame%20is%20requested%20at%20this%20point.%0A%20*%2F%0ATicker.prototype.start%20%3D%20function%20start()%0A%7B%0A%20%20%20%20if%20(!this.started)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.started%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20this._requestIfNeeded()%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Stops%20the%20ticker.%20If%20the%20ticker%20has%20requested%0A%20*%20an%20animation%20frame%20it%20is%20canceled%20at%20this%20point.%0A%20*%2F%0ATicker.prototype.stop%20%3D%20function%20stop()%0A%7B%0A%20%20%20%20if%20(this.started)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.started%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20this._cancelIfNeeded()%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Triggers%20an%20update.%20An%20update%20entails%20setting%20the%0A%20*%20current%20%7B%40link%20PIXI.ticker.Ticker%23elapsedMS%7D%2C%0A%20*%20the%20current%20%7B%40link%20PIXI.ticker.Ticker%23deltaTime%7D%2C%0A%20*%20invoking%20all%20listeners%20with%20current%20deltaTime%2C%0A%20*%20and%20then%20finally%20setting%20%7B%40link%20PIXI.ticker.Ticker%23lastTime%7D%0A%20*%20with%20the%20value%20of%20currentTime%20that%20was%20provided.%0A%20*%20This%20method%20will%20be%20called%20automatically%20by%20animation%0A%20*%20frame%20callbacks%20if%20the%20ticker%20instance%20has%20been%20started%0A%20*%20and%20listeners%20are%20added.%0A%20*%0A%20*%20%40param%20%5BcurrentTime%3Dperformance.now()%5D%20%7BDOMHighResTimeStamp%7Cnumber%7D%20the%20current%20time%20of%20execution%0A%20*%2F%0ATicker.prototype.update%20%3D%20function%20update(currentTime)%0A%7B%0A%20%20%20%20var%20elapsedMS%3B%0A%0A%20%20%20%20%2F%2F%20Allow%20calling%20update%20directly%20with%20default%20currentTime.%0A%20%20%20%20currentTime%20%3D%20currentTime%20%7C%7C%20performance.now()%3B%0A%20%20%20%20%2F%2F%20Save%20uncapped%20elapsedMS%20for%20measurement%0A%20%20%20%20elapsedMS%20%3D%20this.elapsedMS%20%3D%20currentTime%20-%20this.lastTime%3B%0A%0A%20%20%20%20%2F%2F%20cap%20the%20milliseconds%20elapsed%20used%20for%20deltaTime%0A%20%20%20%20if%20(elapsedMS%20%3E%20this._maxElapsedMS)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20elapsedMS%20%3D%20this._maxElapsedMS%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.deltaTime%20%3D%20elapsedMS%20*%20CONST.TARGET_FPMS%20*%20this.speed%3B%0A%0A%20%20%20%20%2F%2F%20Invoke%20listeners%20added%20to%20internal%20emitter%0A%20%20%20%20this._emitter.emit(TICK%2C%20this.deltaTime)%3B%0A%0A%20%20%20%20this.lastTime%20%3D%20currentTime%3B%0A%7D%3B%0A%0Amodule.exports%20%3D%20Ticker%3B%0A%0A%7D%2C%7B%22..%2Fconst%22%3A13%2C%22eventemitter3%22%3A10%7D%5D%2C66%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20Ticker%20%3D%20require('.%2FTicker')%3B%0A%0A%2F**%0A%20*%20The%20shared%20ticker%20instance%20used%20by%20%7B%40link%20PIXI.extras.MovieClip%7D.%0A%20*%20and%20by%20%7B%40link%20PIXI.interaction.InteractionManager%7D.%0A%20*%20The%20property%20%7B%40link%20PIXI.ticker.Ticker%23autoStart%7D%20is%20set%20to%20%60true%60%0A%20*%20for%20this%20instance.%20Please%20follow%20the%20examples%20for%20usage%2C%20including%0A%20*%20how%20to%20opt-out%20of%20auto-starting%20the%20shared%20ticker.%0A%20*%0A%20*%20%40example%0A%20*%20var%20ticker%20%3D%20PIXI.ticker.shared%3B%0A%20*%20%2F%2F%20Set%20this%20to%20prevent%20starting%20this%20ticker%20when%20listeners%20are%20added.%0A%20*%20%2F%2F%20By%20default%20this%20is%20true%20only%20for%20the%20PIXI.ticker.shared%20instance.%0A%20*%20ticker.autoStart%20%3D%20false%3B%0A%20*%20%2F%2F%20FYI%2C%20call%20this%20to%20ensure%20the%20ticker%20is%20stopped.%20It%20should%20be%20stopped%0A%20*%20%2F%2F%20if%20you%20have%20not%20attempted%20to%20render%20anything%20yet.%0A%20*%20ticker.stop()%3B%0A%20*%20%2F%2F%20Call%20this%20when%20you%20are%20ready%20for%20a%20running%20shared%20ticker.%0A%20*%20ticker.start()%3B%0A%20*%0A%20*%20%40example%0A%20*%20%2F%2F%20You%20may%20use%20the%20shared%20ticker%20to%20render...%0A%20*%20var%20renderer%20%3D%20PIXI.autoDetectRenderer(800%2C%20600)%3B%0A%20*%20var%20stage%20%3D%20new%20PIXI.Container()%3B%0A%20*%20var%20interactionManager%20%3D%20PIXI.interaction.InteractionManager(renderer)%3B%0A%20*%20document.body.appendChild(renderer.view)%3B%0A%20*%20ticker.add(function%20(time)%20%7B%0A%20*%20%20%20%20%20renderer.render(stage)%3B%0A%20*%20%7D)%3B%0A%20*%0A%20*%20%40example%0A%20*%20%2F%2F%20Or%20you%20can%20just%20update%20it%20manually.%0A%20*%20ticker.autoStart%20%3D%20false%3B%0A%20*%20ticker.stop()%3B%0A%20*%20function%20animate(time)%20%7B%0A%20*%20%20%20%20%20ticker.update(time)%3B%0A%20*%20%20%20%20%20renderer.render(stage)%3B%0A%20*%20%20%20%20%20requestAnimationFrame(animate)%3B%0A%20*%20%7D%0A%20*%20animate(performance.now())%3B%0A%20*%0A%20*%20%40type%20%7BPIXI.ticker.Ticker%7D%0A%20*%20%40memberof%20PIXI.ticker%0A%20*%2F%0Avar%20shared%20%3D%20new%20Ticker()%3B%0Ashared.autoStart%20%3D%20true%3B%0A%0A%2F**%0A%20*%20%40namespace%20PIXI.ticker%0A%20*%2F%0Amodule.exports%20%3D%20%7B%0A%20%20%20%20shared%3A%20shared%2C%0A%20%20%20%20Ticker%3A%20Ticker%0A%7D%3B%0A%0A%7D%2C%7B%22.%2FTicker%22%3A65%7D%5D%2C67%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20CONST%20%3D%20require('..%2Fconst')%3B%0A%0A%2F**%0A%20*%20%40namespace%20PIXI.utils%0A%20*%2F%0Avar%20utils%20%3D%20module.exports%20%3D%20%7B%0A%20%20%20%20_uid%3A%200%2C%0A%20%20%20%20_saidHello%3A%20false%2C%0A%0A%20%20%20%20EventEmitter%3A%20%20%20require('eventemitter3')%2C%0A%20%20%20%20pluginTarget%3A%20%20%20require('.%2FpluginTarget')%2C%0A%20%20%20%20async%3A%20%20%20%20%20%20%20%20%20%20require('async')%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Gets%20the%20next%20unique%20identifier%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40return%20%7Bnumber%7D%20The%20next%20unique%20identifier%20to%20use.%0A%20%20%20%20%20*%2F%0A%20%20%20%20uid%3A%20function%20()%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20%2B%2Butils._uid%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20a%20hex%20color%20number%20to%20an%20%5BR%2C%20G%2C%20B%5D%20array%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40param%20hex%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40param%20%20%7Bnumber%5B%5D%7D%20%5Bout%3D%5B%5D%5D%0A%20%20%20%20%20*%20%40return%20%7Bnumber%5B%5D%7D%20An%20array%20representing%20the%20%5BR%2C%20G%2C%20B%5D%20of%20the%20color.%0A%20%20%20%20%20*%2F%0A%20%20%20%20hex2rgb%3A%20function%20(hex%2C%20out)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20out%20%3D%20out%20%7C%7C%20%5B%5D%3B%0A%0A%20%20%20%20%20%20%20%20out%5B0%5D%20%3D%20(hex%20%3E%3E%2016%20%26%200xFF)%20%2F%20255%3B%0A%20%20%20%20%20%20%20%20out%5B1%5D%20%3D%20(hex%20%3E%3E%208%20%26%200xFF)%20%2F%20255%3B%0A%20%20%20%20%20%20%20%20out%5B2%5D%20%3D%20(hex%20%26%200xFF)%20%2F%20255%3B%0A%0A%20%20%20%20%20%20%20%20return%20out%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20a%20hex%20color%20number%20to%20a%20string.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40param%20hex%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40return%20%7Bstring%7D%20The%20string%20color.%0A%20%20%20%20%20*%2F%0A%20%20%20%20hex2string%3A%20function%20(hex)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20hex%20%3D%20hex.toString(16)%3B%0A%20%20%20%20%20%20%20%20hex%20%3D%20'000000'.substr(0%2C%206%20-%20hex.length)%20%2B%20hex%3B%0A%0A%20%20%20%20%20%20%20%20return%20'%23'%20%2B%20hex%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20a%20color%20as%20an%20%5BR%2C%20G%2C%20B%5D%20array%20to%20a%20hex%20number%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40param%20rgb%20%7Bnumber%5B%5D%7D%0A%20%20%20%20%20*%20%40return%20%7Bnumber%7D%20The%20color%20number%0A%20%20%20%20%20*%2F%0A%20%20%20%20rgb2hex%3A%20function%20(rgb)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20((rgb%5B0%5D*255%20%3C%3C%2016)%20%2B%20(rgb%5B1%5D*255%20%3C%3C%208)%20%2B%20rgb%5B2%5D*255)%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Checks%20whether%20the%20Canvas%20BlendModes%20are%20supported%20by%20the%20current%20browser%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40return%20%7Bboolean%7D%20whether%20they%20are%20supported%0A%20%20%20%20%20*%2F%0A%20%20%20%20canUseNewCanvasBlendModes%3A%20function%20()%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(typeof%20document%20%3D%3D%3D%20'undefined')%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20var%20pngHead%20%3D%20'data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX%2F'%3B%0A%20%20%20%20%20%20%20%20var%20pngEnd%20%3D%20'AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg%3D%3D'%3B%0A%0A%20%20%20%20%20%20%20%20var%20magenta%20%3D%20new%20Image()%3B%0A%20%20%20%20%20%20%20%20magenta.src%20%3D%20pngHead%20%2B%20'AP804Oa6'%20%2B%20pngEnd%3B%0A%0A%20%20%20%20%20%20%20%20var%20yellow%20%3D%20new%20Image()%3B%0A%20%20%20%20%20%20%20%20yellow.src%20%3D%20pngHead%20%2B%20'%2FwCKxvRF'%20%2B%20pngEnd%3B%0A%0A%20%20%20%20%20%20%20%20var%20canvas%20%3D%20document.createElement('canvas')%3B%0A%20%20%20%20%20%20%20%20canvas.width%20%3D%206%3B%0A%20%20%20%20%20%20%20%20canvas.height%20%3D%201%3B%0A%0A%20%20%20%20%20%20%20%20var%20context%20%3D%20canvas.getContext('2d')%3B%0A%20%20%20%20%20%20%20%20context.globalCompositeOperation%20%3D%20'multiply'%3B%0A%20%20%20%20%20%20%20%20context.drawImage(magenta%2C%200%2C%200)%3B%0A%20%20%20%20%20%20%20%20context.drawImage(yellow%2C%202%2C%200)%3B%0A%0A%20%20%20%20%20%20%20%20var%20data%20%3D%20context.getImageData(2%2C0%2C1%2C1).data%3B%0A%0A%20%20%20%20%20%20%20%20return%20(data%5B0%5D%20%3D%3D%3D%20255%20%26%26%20data%5B1%5D%20%3D%3D%3D%200%20%26%26%20data%5B2%5D%20%3D%3D%3D%200)%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Given%20a%20number%2C%20this%20function%20returns%20the%20closest%20number%20that%20is%20a%20power%20of%20two%0A%20%20%20%20%20*%20this%20function%20is%20taken%20from%20Starling%20Framework%20as%20its%20pretty%20neat%20%3B)%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40param%20number%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40return%20%7Bnumber%7D%20the%20closest%20number%20that%20is%20a%20power%20of%20two%0A%20%20%20%20%20*%2F%0A%20%20%20%20getNextPowerOfTwo%3A%20function%20(number)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20see%3A%20http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FPower_of_two%23Fast_algorithm_to_check_if_a_positive_number_is_a_power_of_two%0A%20%20%20%20%20%20%20%20if%20(number%20%3E%200%20%26%26%20(number%20%26%20(number%20-%201))%20%3D%3D%3D%200)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20number%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20result%20%3D%201%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20while%20(result%20%3C%20number)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20result%20%3C%3C%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20result%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20checks%20if%20the%20given%20width%20and%20height%20make%20a%20power%20of%20two%20rectangle%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40param%20width%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40param%20height%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40return%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20isPowerOfTwo%3A%20function%20(width%2C%20height)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20(width%20%3E%200%20%26%26%20(width%20%26%20(width%20-%201))%20%3D%3D%3D%200%20%26%26%20height%20%3E%200%20%26%26%20(height%20%26%20(height%20-%201))%20%3D%3D%3D%200)%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20get%20the%20resolution%20of%20an%20asset%20by%20looking%20for%20the%20prefix%0A%20%20%20%20%20*%20used%20by%20spritesheets%20and%20image%20urls%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40param%20url%20%7Bstring%7D%20the%20image%20path%0A%20%20%20%20%20*%20%40return%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20getResolutionOfUrl%3A%20function%20(url)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20resolution%20%3D%20CONST.RETINA_PREFIX.exec(url)%3B%0A%0A%20%20%20%20%20%20%20%20if%20(resolution)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20return%20parseFloat(resolution%5B1%5D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20return%201%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Logs%20out%20the%20version%20and%20renderer%20information%20for%20this%20running%20instance%20of%20PIXI.%0A%20%20%20%20%20*%20If%20you%20don't%20want%20to%20see%20this%20message%20you%20can%20set%20%60PIXI.utils._saidHello%20%3D%20true%3B%60%0A%20%20%20%20%20*%20so%20the%20library%20thinks%20it%20already%20said%20it.%20Keep%20in%20mind%20that%20doing%20that%20will%20forever%0A%20%20%20%20%20*%20makes%20you%20a%20jerk%20face.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40param%20%7Bstring%7D%20type%20-%20The%20string%20renderer%20type%20to%20log.%0A%20%20%20%20%20*%20%40constant%0A%20%20%20%20%20*%20%40static%0A%20%20%20%20%20*%2F%0A%20%20%20%20sayHello%3A%20function%20(type)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(utils._saidHello)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if%20(navigator.userAgent.toLowerCase().indexOf('chrome')%20%3E%20-1)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'%5Cn%20%25c%20%25c%20%25c%20Pixi.js%20'%20%2B%20CONST.VERSION%20%2B%20'%20-%20%E2%9C%B0%20'%20%2B%20type%20%2B%20'%20%E2%9C%B0%20%20%25c%20'%20%2B%20'%20%25c%20'%20%2B%20'%20http%3A%2F%2Fwww.pixijs.com%2F%20%20%25c%20%25c%20%E2%99%A5%25c%E2%99%A5%25c%E2%99%A5%20%5Cn%5Cn'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'background%3A%20%23ff66a5%3B%20padding%3A5px%200%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'background%3A%20%23ff66a5%3B%20padding%3A5px%200%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'color%3A%20%23ff66a5%3B%20background%3A%20%23030307%3B%20padding%3A5px%200%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'background%3A%20%23ff66a5%3B%20padding%3A5px%200%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'background%3A%20%23ffc3dc%3B%20padding%3A5px%200%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'background%3A%20%23ff66a5%3B%20padding%3A5px%200%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'color%3A%20%23ff2424%3B%20background%3A%20%23fff%3B%20padding%3A5px%200%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'color%3A%20%23ff2424%3B%20background%3A%20%23fff%3B%20padding%3A5px%200%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'color%3A%20%23ff2424%3B%20background%3A%20%23fff%3B%20padding%3A5px%200%3B'%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20window.console.log.apply(console%2C%20args)%3B%20%2F%2Fjshint%20ignore%3Aline%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20if%20(window.console)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20window.console.log('Pixi.js%20'%20%2B%20CONST.VERSION%20%2B%20'%20-%20'%20%2B%20type%20%2B%20'%20-%20http%3A%2F%2Fwww.pixijs.com%2F')%3B%20%2F%2Fjshint%20ignore%3Aline%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20utils._saidHello%20%3D%20true%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Helper%20for%20checking%20for%20webgl%20support%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40return%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20isWebGLSupported%3A%20function%20()%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20contextOptions%20%3D%20%7B%20stencil%3A%20true%20%7D%3B%0A%20%20%20%20%20%20%20%20try%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!window.WebGLRenderingContext)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20canvas%20%3D%20document.createElement('canvas')%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl%20%3D%20canvas.getContext('webgl'%2C%20contextOptions)%20%7C%7C%20canvas.getContext('experimental-webgl'%2C%20contextOptions)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20!!(gl%20%26%26%20gl.getContextAttributes().stencil)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20catch%20(e)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Returns%20sign%20of%20number%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40param%20n%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40returns%20%7Bnumber%7D%200%20if%20n%20is%200%2C%20-1%20if%20n%20is%20negative%2C%201%20if%20n%20i%20positive%0A%20%20%20%20%20*%2F%0A%20%20%20%20sign%3A%20function%20(n)%20%7B%0A%20%20%20%20%20%20%20%20return%20n%20%3F%20(n%20%3C%200%20%3F%20-1%20%3A%201)%20%3A%200%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40todo%20Describe%20property%20usage%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20TextureCache%3A%20%7B%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40todo%20Describe%20property%20usage%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20BaseTextureCache%3A%20%7B%7D%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fconst%22%3A13%2C%22.%2FpluginTarget%22%3A68%2C%22async%22%3A1%2C%22eventemitter3%22%3A10%7D%5D%2C68%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F**%0A%20*%20Mixins%20functionality%20to%20make%20an%20object%20have%20%22plugins%22.%0A%20*%0A%20*%20%40mixin%0A%20*%20%40memberof%20PIXI.utils%0A%20*%20%40param%20obj%20%7Bobject%7D%20The%20object%20to%20mix%20into.%0A%20*%20%40example%0A%20*%20%20%20%20%20%20function%20MyObject()%20%7B%7D%0A%20*%0A%20*%20%20%20%20%20%20pluginTarget.mixin(MyObject)%3B%0A%20*%2F%0Afunction%20pluginTarget(obj)%0A%7B%0A%20%20%20%20obj.__plugins%20%3D%20%7B%7D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Adds%20a%20plugin%20to%20an%20object%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40param%20pluginName%20%7Bstring%7D%20The%20events%20that%20should%20be%20listed.%0A%20%20%20%20%20*%20%40param%20ctor%20%7BFunction%7D%20The%20constructor%20function%20for%20the%20plugin.%0A%20%20%20%20%20*%2F%0A%20%20%20%20obj.registerPlugin%20%3D%20function%20(pluginName%2C%20ctor)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20obj.__plugins%5BpluginName%5D%20%3D%20ctor%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Instantiates%20all%20the%20plugins%20of%20this%20object%0A%20%20%20%20%20*%0A%20%20%20%20%20*%2F%0A%20%20%20%20obj.prototype.initPlugins%20%3D%20function%20()%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.plugins%20%3D%20this.plugins%20%7C%7C%20%7B%7D%3B%0A%0A%20%20%20%20%20%20%20%20for%20(var%20o%20in%20obj.__plugins)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.plugins%5Bo%5D%20%3D%20new%20(obj.__plugins%5Bo%5D)(this)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Removes%20all%20the%20plugins%20of%20this%20object%0A%20%20%20%20%20*%0A%20%20%20%20%20*%2F%0A%20%20%20%20obj.prototype.destroyPlugins%20%3D%20function%20()%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20for%20(var%20o%20in%20this.plugins)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.plugins%5Bo%5D.destroy()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.plugins%5Bo%5D%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20this.plugins%20%3D%20null%3B%0A%20%20%20%20%7D%3B%0A%7D%0A%0A%0Amodule.exports%20%3D%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Mixes%20in%20the%20properties%20of%20the%20pluginTarget%20into%20another%20object%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40param%20object%20%7Bobject%7D%20The%20obj%20to%20mix%20into%0A%20%20%20%20%20*%2F%0A%20%20%20%20mixin%3A%20function%20mixin(obj)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20pluginTarget(obj)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%7D%2C%7B%7D%5D%2C69%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F*global%20console%20*%2F%0Avar%20core%20%3D%20require('.%2Fcore')%2C%0A%20%20%20%20mesh%20%3D%20require('.%2Fmesh')%2C%0A%20%20%20%20extras%20%3D%20require('.%2Fextras')%2C%0A%20%20%20%20filters%20%3D%20require('.%2Ffilters')%3B%0A%0A%2F**%0A%20*%20%40class%0A%20*%20%40private%0A%20*%20%40name%20SpriteBatch%0A%20*%20%40memberof%20PIXI%0A%20*%20%40see%20PIXI.ParticleContainer%0A%20*%20%40throws%20%7BReferenceError%7D%20SpriteBatch%20does%20not%20exist%20any%20more%2C%20please%20use%20the%20new%20ParticleContainer%20instead.%0A%20*%20%40deprecated%20since%20version%203.0.0%0A%20*%2F%0Acore.SpriteBatch%20%3D%20function()%0A%7B%0A%20%20%20%20throw%20new%20ReferenceError('SpriteBatch%20does%20not%20exist%20any%20more%2C%20please%20use%20the%20new%20ParticleContainer%20instead.')%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20%40class%0A%20*%20%40private%0A%20*%20%40name%20AssetLoader%0A%20*%20%40memberof%20PIXI%0A%20*%20%40see%20PIXI.loaders.Loader%0A%20*%20%40throws%20%7BReferenceError%7D%20The%20loader%20system%20was%20overhauled%20in%20pixi%20v3%2C%20please%20see%20the%20new%20PIXI.loaders.Loader%20class.%0A%20*%20%40deprecated%20since%20version%203.0.0%0A%20*%2F%0Acore.AssetLoader%20%3D%20function()%0A%7B%0A%20%20%20%20throw%20new%20ReferenceError('The%20loader%20system%20was%20overhauled%20in%20pixi%20v3%2C%20please%20see%20the%20new%20PIXI.loaders.Loader%20class.')%3B%0A%7D%3B%0A%0AObject.defineProperties(core%2C%20%7B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40class%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40name%20Stage%0A%20%20%20%20%20*%20%40memberof%20PIXI%0A%20%20%20%20%20*%20%40see%20PIXI.Container%0A%20%20%20%20%20*%20%40deprecated%20since%20version%203.0.0%0A%20%20%20%20%20*%2F%0A%20%20%20%20Stage%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.warn('You%20do%20not%20need%20to%20use%20a%20PIXI%20Stage%20any%20more%2C%20you%20can%20simply%20render%20any%20container.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20core.Container%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40class%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40name%20DisplayObjectContainer%0A%20%20%20%20%20*%20%40memberof%20PIXI%0A%20%20%20%20%20*%20%40see%20PIXI.Container%0A%20%20%20%20%20*%20%40deprecated%20since%20version%203.0.0%0A%20%20%20%20%20*%2F%0A%20%20%20%20DisplayObjectContainer%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.warn('DisplayObjectContainer%20has%20been%20shortened%20to%20Container%2C%20please%20use%20Container%20from%20now%20on.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20core.Container%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40class%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40name%20Strip%0A%20%20%20%20%20*%20%40memberof%20PIXI%0A%20%20%20%20%20*%20%40see%20PIXI.mesh.Mesh%0A%20%20%20%20%20*%20%40deprecated%20since%20version%203.0.0%0A%20%20%20%20%20*%2F%0A%20%20%20%20Strip%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.warn('The%20Strip%20class%20has%20been%20renamed%20to%20Mesh%20and%20moved%20to%20mesh.Mesh%2C%20please%20use%20mesh.Mesh%20from%20now%20on.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20mesh.Mesh%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40class%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40name%20Rope%0A%20%20%20%20%20*%20%40memberof%20PIXI%0A%20%20%20%20%20*%20%40see%20PIXI.mesh.Rope%0A%20%20%20%20%20*%20%40deprecated%20since%20version%203.0.0%0A%20%20%20%20%20*%2F%0A%20%20%20%20Rope%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.warn('The%20Rope%20class%20has%20been%20moved%20to%20mesh.Rope%2C%20please%20use%20mesh.Rope%20from%20now%20on.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20mesh.Rope%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40class%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40name%20MovieClip%0A%20%20%20%20%20*%20%40memberof%20PIXI%0A%20%20%20%20%20*%20%40see%20PIXI.extras.MovieClip%0A%20%20%20%20%20*%20%40deprecated%20since%20version%203.0.0%0A%20%20%20%20%20*%2F%0A%20%20%20%20MovieClip%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.warn('The%20MovieClip%20class%20has%20been%20moved%20to%20extras.MovieClip%2C%20please%20use%20extras.MovieClip%20from%20now%20on.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20extras.MovieClip%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40class%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40name%20TilingSprite%0A%20%20%20%20%20*%20%40memberof%20PIXI%0A%20%20%20%20%20*%20%40see%20PIXI.extras.TilingSprite%0A%20%20%20%20%20*%20%40deprecated%20since%20version%203.0.0%0A%20%20%20%20%20*%2F%0A%20%20%20%20TilingSprite%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.warn('The%20TilingSprite%20class%20has%20been%20moved%20to%20extras.TilingSprite%2C%20please%20use%20extras.TilingSprite%20from%20now%20on.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20extras.TilingSprite%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40class%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40name%20BitmapText%0A%20%20%20%20%20*%20%40memberof%20PIXI%0A%20%20%20%20%20*%20%40see%20PIXI.extras.BitmapText%0A%20%20%20%20%20*%20%40deprecated%20since%20version%203.0.0%0A%20%20%20%20%20*%2F%0A%20%20%20%20BitmapText%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.warn('The%20BitmapText%20class%20has%20been%20moved%20to%20extras.BitmapText%2C%20please%20use%20extras.BitmapText%20from%20now%20on.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20extras.BitmapText%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40class%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40name%20blendModes%0A%20%20%20%20%20*%20%40memberof%20PIXI%0A%20%20%20%20%20*%20%40see%20PIXI.BLEND_MODES%0A%20%20%20%20%20*%20%40deprecated%20since%20version%203.0.0%0A%20%20%20%20%20*%2F%0A%20%20%20%20blendModes%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.warn('The%20blendModes%20has%20been%20moved%20to%20BLEND_MODES%2C%20please%20use%20BLEND_MODES%20from%20now%20on.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20core.BLEND_MODES%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40class%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40name%20scaleModes%0A%20%20%20%20%20*%20%40memberof%20PIXI%0A%20%20%20%20%20*%20%40see%20PIXI.SCALE_MODES%0A%20%20%20%20%20*%20%40deprecated%20since%20version%203.0.0%0A%20%20%20%20%20*%2F%0A%20%20%20%20scaleModes%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.warn('The%20scaleModes%20has%20been%20moved%20to%20SCALE_MODES%2C%20please%20use%20SCALE_MODES%20from%20now%20on.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20core.SCALE_MODES%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40class%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40name%20BaseTextureCache%0A%20%20%20%20%20*%20%40memberof%20PIXI%0A%20%20%20%20%20*%20%40see%20PIXI.utils.BaseTextureCache%0A%20%20%20%20%20*%20%40deprecated%20since%20version%203.0.0%0A%20%20%20%20%20*%2F%0A%20%20%20%20BaseTextureCache%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.warn('The%20BaseTextureCache%20class%20has%20been%20moved%20to%20utils.BaseTextureCache%2C%20please%20use%20utils.BaseTextureCache%20from%20now%20on.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20core.utils.BaseTextureCache%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40class%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40name%20TextureCache%0A%20%20%20%20%20*%20%40memberof%20PIXI%0A%20%20%20%20%20*%20%40see%20PIXI.utils.TextureCache%0A%20%20%20%20%20*%20%40deprecated%20since%20version%203.0.0%0A%20%20%20%20%20*%2F%0A%20%20%20%20TextureCache%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.warn('The%20TextureCache%20class%20has%20been%20moved%20to%20utils.TextureCache%2C%20please%20use%20utils.TextureCache%20from%20now%20on.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20core.utils.TextureCache%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40namespace%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40name%20math%0A%20%20%20%20%20*%20%40memberof%20PIXI%0A%20%20%20%20%20*%20%40see%20PIXI%0A%20%20%20%20%20*%20%40deprecated%20since%20version%203.0.6%0A%20%20%20%20%20*%2F%0A%20%20%20%20math%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.warn('The%20math%20namespace%20is%20deprecated%2C%20please%20access%20members%20already%20accessible%20on%20PIXI.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20core%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%2F**%0A%20*%20%40method%0A%20*%20%40private%0A%20*%20%40name%20PIXI.Sprite%23setTexture%0A%20*%20%40see%20PIXI.Sprite%23texture%0A%20*%20%40deprecated%20since%20version%203.0.0%0A%20*%2F%0Acore.Sprite.prototype.setTexture%20%3D%20function(texture)%0A%7B%0A%20%20%20%20this.texture%20%3D%20texture%3B%0A%20%20%20%20console.warn('setTexture%20is%20now%20deprecated%2C%20please%20use%20the%20texture%20property%2C%20e.g%20%3A%20sprite.texture%20%3D%20texture%3B')%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20%40method%0A%20*%20%40name%20PIXI.extras.BitmapText%23setText%0A%20*%20%40see%20PIXI.extras.BitmapText%23text%0A%20*%20%40deprecated%20since%20version%203.0.0%0A%20*%2F%0Aextras.BitmapText.prototype.setText%20%3D%20function(text)%0A%7B%0A%20%20%20%20this.text%20%3D%20text%3B%0A%20%20%20%20console.warn('setText%20is%20now%20deprecated%2C%20please%20use%20the%20text%20property%2C%20e.g%20%3A%20myBitmapText.text%20%3D%20%5C'my%20text%5C'%3B')%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20%40method%0A%20*%20%40name%20PIXI.Text%23setText%0A%20*%20%40see%20PIXI.Text%23text%0A%20*%20%40deprecated%20since%20version%203.0.0%0A%20*%2F%0Acore.Text.prototype.setText%20%3D%20function(text)%0A%7B%0A%20%20%20%20this.text%20%3D%20text%3B%0A%20%20%20%20console.warn('setText%20is%20now%20deprecated%2C%20please%20use%20the%20text%20property%2C%20e.g%20%3A%20myText.text%20%3D%20%5C'my%20text%5C'%3B')%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20%40method%0A%20*%20%40name%20PIXI.Text%23setStyle%0A%20*%20%40see%20PIXI.Text%23style%0A%20*%20%40deprecated%20since%20version%203.0.0%0A%20*%2F%0Acore.Text.prototype.setStyle%20%3D%20function(style)%0A%7B%0A%20%20%20%20this.style%20%3D%20style%3B%0A%20%20%20%20console.warn('setStyle%20is%20now%20deprecated%2C%20please%20use%20the%20style%20property%2C%20e.g%20%3A%20myText.style%20%3D%20style%3B')%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20%40method%0A%20*%20%40name%20PIXI.Texture%23setFrame%0A%20*%20%40see%20PIXI.Texture%23setFrame%0A%20*%20%40deprecated%20since%20version%203.0.0%0A%20*%2F%0Acore.Texture.prototype.setFrame%20%3D%20function(frame)%0A%7B%0A%20%20%20%20this.frame%20%3D%20frame%3B%0A%20%20%20%20console.warn('setFrame%20is%20now%20deprecated%2C%20please%20use%20the%20frame%20property%2C%20e.g%20%3A%20myTexture.frame%20%3D%20frame%3B')%3B%0A%7D%3B%0A%0AObject.defineProperties(filters%2C%20%7B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40class%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40name%20PIXI.filters.AbstractFilter%0A%20%20%20%20%20*%20%40see%20PIXI.AbstractFilter%0A%20%20%20%20%20*%20%40deprecated%20since%20version%203.0.6%0A%20%20%20%20%20*%2F%0A%20%20%20%20AbstractFilter%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.warn('filters.AbstractFilter%20is%20an%20undocumented%20alias%2C%20please%20use%20AbstractFilter%20from%20now%20on.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20core.AbstractFilter%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40class%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40name%20PIXI.filters.FXAAFilter%0A%20%20%20%20%20*%20%40see%20PIXI.FXAAFilter%0A%20%20%20%20%20*%20%40deprecated%20since%20version%203.0.6%0A%20%20%20%20%20*%2F%0A%20%20%20%20FXAAFilter%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.warn('filters.FXAAFilter%20is%20an%20undocumented%20alias%2C%20please%20use%20FXAAFilter%20from%20now%20on.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20core.FXAAFilter%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40class%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40name%20PIXI.filters.SpriteMaskFilter%0A%20%20%20%20%20*%20%40see%20PIXI.SpriteMaskFilter%0A%20%20%20%20%20*%20%40deprecated%20since%20version%203.0.6%0A%20%20%20%20%20*%2F%0A%20%20%20%20SpriteMaskFilter%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.warn('filters.SpriteMaskFilter%20is%20an%20undocumented%20alias%2C%20please%20use%20SpriteMaskFilter%20from%20now%20on.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20core.SpriteMaskFilter%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%2F**%0A%20*%20%40method%0A%20*%20%40name%20PIXI.utils.uuid%0A%20*%20%40see%20PIXI.utils.uid%0A%20*%20%40deprecated%20since%20version%203.0.6%0A%20*%2F%0Acore.utils.uuid%20%3D%20function%20()%0A%7B%0A%20%20%20%20console.warn('utils.uuid()%20is%20deprecated%2C%20please%20use%20utils.uid()%20from%20now%20on.')%3B%0A%20%20%20%20return%20core.utils.uid()%3B%0A%7D%3B%0A%0A%7D%2C%7B%22.%2Fcore%22%3A20%2C%22.%2Fextras%22%3A76%2C%22.%2Ffilters%22%3A93%2C%22.%2Fmesh%22%3A117%7D%5D%2C70%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2Fcore')%3B%0A%0A%2F**%0A%20*%20A%20BitmapText%20object%20will%20create%20a%20line%20or%20multiple%20lines%20of%20text%20using%20bitmap%20font.%20To%0A%20*%20split%20a%20line%20you%20can%20use%20'%5Cn'%2C%20'%5Cr'%20or%20'%5Cr%5Cn'%20in%20your%20string.%20You%20can%20generate%20the%20fnt%20files%20using%3A%0A%20*%0A%20*%20A%20BitmapText%20can%20only%20be%20created%20when%20the%20font%20is%20loaded%0A%20*%0A%20*%20%60%60%60js%0A%20*%20%2F%2F%20in%20this%20case%20the%20font%20is%20in%20a%20file%20called%20'desyrel.fnt'%0A%20*%20var%20bitmapText%20%3D%20new%20PIXI.extras.BitmapText(%22text%20using%20a%20fancy%20font!%22%2C%20%7Bfont%3A%20%2235px%20Desyrel%22%2C%20align%3A%20%22right%22%7D)%3B%0A%20*%20%60%60%60%0A%20*%0A%20*%0A%20*%20http%3A%2F%2Fwww.angelcode.com%2Fproducts%2Fbmfont%2F%20for%20windows%20or%0A%20*%20http%3A%2F%2Fwww.bmglyph.com%2F%20for%20mac.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.Container%0A%20*%20%40memberof%20PIXI.extras%0A%20*%20%40param%20text%20%7Bstring%7D%20The%20copy%20that%20you%20would%20like%20the%20text%20to%20display%0A%20*%20%40param%20style%20%7Bobject%7D%20The%20style%20parameters%0A%20*%20%40param%20style.font%20%7Bstring%7Cobject%7D%20The%20font%20descriptor%20for%20the%20object%2C%20can%20be%20passed%20as%20a%20string%20of%20form%0A%20*%20%20%20%20%20%20%2224px%20FontName%22%20or%20%22FontName%22%20or%20as%20an%20object%20with%20explicit%20name%2Fsize%20properties.%0A%20*%20%40param%20%5Bstyle.font.name%5D%20%7Bstring%7D%20The%20bitmap%20font%20id%0A%20*%20%40param%20%5Bstyle.font.size%5D%20%7Bnumber%7D%20The%20size%20of%20the%20font%20in%20pixels%2C%20e.g.%2024%0A%20*%20%40param%20%5Bstyle.align%3D'left'%5D%20%7Bstring%7D%20Alignment%20for%20multiline%20text%20('left'%2C%20'center'%20or%20'right')%2C%20does%20not%20affect%0A%20*%20%20%20%20%20%20single%20line%20text%0A%20*%20%40param%20%5Bstyle.tint%3D0xFFFFFF%5D%20%7Bnumber%7D%20The%20tint%20color%0A%20*%2F%0Afunction%20BitmapText(text%2C%20style)%0A%7B%0A%20%20%20%20core.Container.call(this)%3B%0A%0A%20%20%20%20style%20%3D%20style%20%7C%7C%20%7B%7D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20width%20of%20the%20overall%20text%2C%20different%20from%20fontSize%2C%0A%20%20%20%20%20*%20which%20is%20defined%20in%20the%20style%20object%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40readOnly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.textWidth%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20height%20of%20the%20overall%20text%2C%20different%20from%20fontSize%2C%0A%20%20%20%20%20*%20which%20is%20defined%20in%20the%20style%20object%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40readOnly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.textHeight%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Private%20tracker%20for%20the%20letter%20sprite%20pool.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Sprite%5B%5D%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._glyphs%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Private%20tracker%20for%20the%20current%20style.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bobject%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._font%20%3D%20%7B%0A%20%20%20%20%20%20%20%20tint%3A%20style.tint%20!%3D%3D%20undefined%20%3F%20style.tint%20%3A%200xFFFFFF%2C%0A%20%20%20%20%20%20%20%20align%3A%20style.align%20%7C%7C%20'left'%2C%0A%20%20%20%20%20%20%20%20name%3A%20null%2C%0A%20%20%20%20%20%20%20%20size%3A%200%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Private%20tracker%20for%20the%20current%20font.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bobject%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.font%20%3D%20style.font%3B%20%2F%2F%20run%20font%20setter%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Private%20tracker%20for%20the%20current%20text.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bstring%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._text%20%3D%20text%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20max%20width%20of%20this%20bitmap%20text%20in%20pixels.%20If%20the%20text%20provided%20is%20longer%20than%20the%20value%20provided%2C%20line%20breaks%20will%20be%20automatically%20inserted%20in%20the%20last%20whitespace.%0A%20%20%20%20%20*%20Disable%20by%20setting%20value%20to%200%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.maxWidth%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20max%20line%20height.%20This%20is%20useful%20when%20trying%20to%20use%20the%20total%20height%20of%20the%20Text%2C%20ie%3A%20when%20trying%20to%20vertically%20align.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.maxLineHeight%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20dirty%20state%20of%20this%20object.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.dirty%20%3D%20false%3B%0A%0A%20%20%20%20this.updateText()%3B%0A%7D%0A%0A%2F%2F%20constructor%0ABitmapText.prototype%20%3D%20Object.create(core.Container.prototype)%3B%0ABitmapText.prototype.constructor%20%3D%20BitmapText%3B%0Amodule.exports%20%3D%20BitmapText%3B%0A%0AObject.defineProperties(BitmapText.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20tint%20of%20the%20BitmapText%20object%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.extras.BitmapText%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20tint%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this._font.tint%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._font.tint%20%3D%20(typeof%20value%20%3D%3D%3D%20'number'%20%26%26%20value%20%3E%3D%200)%20%3F%20value%20%3A%200xFFFFFF%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20this.dirty%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20alignment%20of%20the%20BitmapText%20object%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bstring%7D%0A%20%20%20%20%20*%20%40default%20'left'%0A%20%20%20%20%20*%20%40memberof%20PIXI.extras.BitmapText%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20align%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this._font.align%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._font.align%20%3D%20value%20%7C%7C%20'left'%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20this.dirty%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20font%20descriptor%20of%20the%20BitmapText%20object%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BFont%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.extras.BitmapText%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20font%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this._font%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!value)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(typeof%20value%20%3D%3D%3D%20'string')%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20value%20%3D%20value.split('%20')%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._font.name%20%3D%20value.length%20%3D%3D%3D%201%20%3F%20value%5B0%5D%20%3A%20value.slice(1).join('%20')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._font.size%20%3D%20value.length%20%3E%3D%202%20%3F%20parseInt(value%5B0%5D%2C%2010)%20%3A%20BitmapText.fonts%5Bthis._font.name%5D.size%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._font.name%20%3D%20value.name%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._font.size%20%3D%20typeof%20value.size%20%3D%3D%3D%20'number'%20%3F%20value.size%20%3A%20parseInt(value.size%2C%2010)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20this.dirty%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20text%20of%20the%20BitmapText%20object%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bstring%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.extras.BitmapText%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20text%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this._text%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20value%20%3D%20value.toString()%20%7C%7C%20'%20'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(this._text%20%3D%3D%3D%20value)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20this._text%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.dirty%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%2F**%0A%20*%20Renders%20text%20and%20updates%20it%20when%20needed%0A%20*%0A%20*%20%40private%0A%20*%2F%0ABitmapText.prototype.updateText%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20data%20%3D%20BitmapText.fonts%5Bthis._font.name%5D%3B%0A%20%20%20%20var%20pos%20%3D%20new%20core.Point()%3B%0A%20%20%20%20var%20prevCharCode%20%3D%20null%3B%0A%20%20%20%20var%20chars%20%3D%20%5B%5D%3B%0A%20%20%20%20var%20lastLineWidth%20%3D%200%3B%0A%20%20%20%20var%20maxLineWidth%20%3D%200%3B%0A%20%20%20%20var%20lineWidths%20%3D%20%5B%5D%3B%0A%20%20%20%20var%20line%20%3D%200%3B%0A%20%20%20%20var%20scale%20%3D%20this._font.size%20%2F%20data.size%3B%0A%20%20%20%20var%20lastSpace%20%3D%20-1%3B%0A%20%20%20%20var%20maxLineHeight%20%3D%200%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20this.text.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20charCode%20%3D%20this.text.charCodeAt(i)%3B%0A%20%20%20%20%20%20%20%20lastSpace%20%3D%20%2F(%5Cs)%2F.test(this.text.charAt(i))%20%3F%20i%20%3A%20lastSpace%3B%0A%0A%20%20%20%20%20%20%20%20if%20(%2F(%3F%3A%5Cr%5Cn%7C%5Cr%7C%5Cn)%2F.test(this.text.charAt(i)))%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20lineWidths.push(lastLineWidth)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20maxLineWidth%20%3D%20Math.max(maxLineWidth%2C%20lastLineWidth)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20line%2B%2B%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20pos.x%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20pos.y%20%2B%3D%20data.lineHeight%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20prevCharCode%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if%20(lastSpace%20!%3D%3D%20-1%20%26%26%20this.maxWidth%20%3E%200%20%26%26%20pos.x%20*%20scale%20%3E%20this.maxWidth)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20chars.splice(lastSpace%2C%20i%20-%20lastSpace)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20i%20%3D%20lastSpace%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20lastSpace%20%3D%20-1%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20lineWidths.push(lastLineWidth)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20maxLineWidth%20%3D%20Math.max(maxLineWidth%2C%20lastLineWidth)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20line%2B%2B%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20pos.x%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20pos.y%20%2B%3D%20data.lineHeight%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20prevCharCode%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20var%20charData%20%3D%20data.chars%5BcharCode%5D%3B%0A%0A%20%20%20%20%20%20%20%20if%20(!charData)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if%20(prevCharCode%20%26%26%20charData.kerning%5BprevCharCode%5D)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20pos.x%20%2B%3D%20charData.kerning%5BprevCharCode%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20chars.push(%7Btexture%3AcharData.texture%2C%20line%3A%20line%2C%20charCode%3A%20charCode%2C%20position%3A%20new%20core.Point(pos.x%20%2B%20charData.xOffset%2C%20pos.y%20%2B%20charData.yOffset)%7D)%3B%0A%20%20%20%20%20%20%20%20lastLineWidth%20%3D%20pos.x%20%2B%20(charData.texture.width%20%2B%20charData.xOffset)%3B%0A%20%20%20%20%20%20%20%20pos.x%20%2B%3D%20charData.xAdvance%3B%0A%20%20%20%20%20%20%20%20maxLineHeight%20%3D%20Math.max(maxLineHeight%2C%20(charData.yOffset%20%2B%20charData.texture.height))%3B%0A%20%20%20%20%20%20%20%20prevCharCode%20%3D%20charCode%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20lineWidths.push(lastLineWidth)%3B%0A%20%20%20%20maxLineWidth%20%3D%20Math.max(maxLineWidth%2C%20lastLineWidth)%3B%0A%0A%20%20%20%20var%20lineAlignOffsets%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%3D%20line%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20alignOffset%20%3D%200%3B%0A%0A%20%20%20%20%20%20%20%20if%20(this._font.align%20%3D%3D%3D%20'right')%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20alignOffset%20%3D%20maxLineWidth%20-%20lineWidths%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20if%20(this._font.align%20%3D%3D%3D%20'center')%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20alignOffset%20%3D%20(maxLineWidth%20-%20lineWidths%5Bi%5D)%20%2F%202%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20lineAlignOffsets.push(alignOffset)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20lenChars%20%3D%20chars.length%3B%0A%20%20%20%20var%20tint%20%3D%20this.tint%3B%0A%0A%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20lenChars%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20c%20%3D%20this._glyphs%5Bi%5D%3B%20%2F%2F%20get%20the%20next%20glyph%20sprite%0A%0A%20%20%20%20%20%20%20%20if%20(c)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20c.texture%20%3D%20chars%5Bi%5D.texture%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20c%20%3D%20new%20core.Sprite(chars%5Bi%5D.texture)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._glyphs.push(c)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20c.position.x%20%3D%20(chars%5Bi%5D.position.x%20%2B%20lineAlignOffsets%5Bchars%5Bi%5D.line%5D)%20*%20scale%3B%0A%20%20%20%20%20%20%20%20c.position.y%20%3D%20chars%5Bi%5D.position.y%20*%20scale%3B%0A%20%20%20%20%20%20%20%20c.scale.x%20%3D%20c.scale.y%20%3D%20scale%3B%0A%20%20%20%20%20%20%20%20c.tint%20%3D%20tint%3B%0A%0A%20%20%20%20%20%20%20%20if%20(!c.parent)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.addChild(c)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20remove%20unnecessary%20children.%0A%20%20%20%20for%20(i%20%3D%20lenChars%3B%20i%20%3C%20this._glyphs.length%3B%20%2B%2Bi)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.removeChild(this._glyphs%5Bi%5D)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.textWidth%20%3D%20maxLineWidth%20*%20scale%3B%0A%20%20%20%20this.textHeight%20%3D%20(pos.y%20%2B%20data.lineHeight)%20*%20scale%3B%0A%20%20%20%20this.maxLineHeight%20%3D%20maxLineHeight%20*%20scale%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Updates%20the%20transform%20of%20this%20object%0A%20*%0A%20*%20%40private%0A%20*%2F%0ABitmapText.prototype.updateTransform%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.validate()%3B%0A%20%20%20%20this.containerUpdateTransform()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Validates%20text%20before%20calling%20parent's%20getLocalBounds%0A%20*%0A%20*%20%40return%20%7BPIXI.Rectangle%7D%20The%20rectangular%20bounding%20area%0A%20*%2F%0A%0ABitmapText.prototype.getLocalBounds%20%3D%20function()%0A%7B%0A%20%20%20%20this.validate()%3B%0A%20%20%20%20return%20core.Container.prototype.getLocalBounds.call(this)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Updates%20text%20when%20needed%0A%20*%0A%20*%20%40private%0A%20*%2F%0ABitmapText.prototype.validate%20%3D%20function()%0A%7B%0A%20%20%20%20if%20(this.dirty)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.updateText()%3B%0A%20%20%20%20%20%20%20%20this.dirty%20%3D%20false%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0ABitmapText.fonts%20%3D%20%7B%7D%3B%0A%0A%7D%2C%7B%22..%2Fcore%22%3A20%7D%5D%2C71%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2Fcore')%3B%0A%0A%2F**%0A%20*%20A%20MovieClip%20is%20a%20simple%20way%20to%20display%20an%20animation%20depicted%20by%20a%20list%20of%20textures.%0A%20*%0A%20*%20%60%60%60js%0A%20*%20var%20alienImages%20%3D%20%5B%22image_sequence_01.png%22%2C%22image_sequence_02.png%22%2C%22image_sequence_03.png%22%2C%22image_sequence_04.png%22%5D%3B%0A%20*%20var%20textureArray%20%3D%20%5B%5D%3B%0A%20*%0A%20*%20for%20(var%20i%3D0%3B%20i%20%3C%204%3B%20i%2B%2B)%0A%20*%20%7B%0A%20*%20%20%20%20%20%20var%20texture%20%3D%20PIXI.Texture.fromImage(alienImages%5Bi%5D)%3B%0A%20*%20%20%20%20%20%20textureArray.push(texture)%3B%0A%20*%20%7D%3B%0A%20*%0A%20*%20var%20mc%20%3D%20new%20PIXI.MovieClip(textureArray)%3B%0A%20*%20%60%60%60%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.Sprite%0A%20*%20%40memberof%20PIXI.extras%0A%20*%20%40param%20textures%20%7BPIXI.Texture%5B%5D%7CObject%5B%5D%7D%20an%20array%20of%20%7B%40link%20PIXI.Texture%7D%20or%20frame%20objects%20that%20make%20up%20the%20animation%0A%20*%20%40param%20textures%5B%5D.texture%20%7BPIXI.Texture%7D%20the%20%7B%40link%20PIXI.Texture%7D%20of%20the%20frame%0A%20*%20%40param%20textures%5B%5D.time%20%7Bnumber%7D%20the%20duration%20of%20the%20frame%20in%20ms%0A%20*%2F%0Afunction%20MovieClip(textures)%0A%7B%0A%20%20%20%20core.Sprite.call(this%2C%20textures%5B0%5D%20instanceof%20core.Texture%20%3F%20textures%5B0%5D%20%3A%20textures%5B0%5D.texture)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._textures%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._durations%20%3D%20null%3B%0A%0A%20%20%20%20this.textures%20%3D%20textures%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20speed%20that%20the%20MovieClip%20will%20play%20at.%20Higher%20is%20faster%2C%20lower%20is%20slower%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%201%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.animationSpeed%20%3D%201%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Whether%20or%20not%20the%20movie%20clip%20repeats%20after%20playing.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40default%20true%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.loop%20%3D%20true%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Function%20to%20call%20when%20a%20MovieClip%20finishes%20playing%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40method%0A%20%20%20%20%20*%20%40memberof%20PIXI.extras.MovieClip%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.onComplete%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Elapsed%20time%20since%20animation%20has%20been%20started%2C%20used%20internally%20to%20display%20current%20texture%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._currentTime%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Indicates%20if%20the%20MovieClip%20is%20currently%20playing%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40readonly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.playing%20%3D%20false%3B%0A%7D%0A%0A%2F%2F%20constructor%0AMovieClip.prototype%20%3D%20Object.create(core.Sprite.prototype)%3B%0AMovieClip.prototype.constructor%20%3D%20MovieClip%3B%0Amodule.exports%20%3D%20MovieClip%3B%0A%0AObject.defineProperties(MovieClip.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20totalFrames%20is%20the%20total%20number%20of%20frames%20in%20the%20MovieClip.%20This%20is%20the%20same%20as%20number%20of%20textures%0A%20%20%20%20%20*%20assigned%20to%20the%20MovieClip.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.extras.MovieClip%23%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%20%40readonly%0A%20%20%20%20%20*%2F%0A%20%20%20%20totalFrames%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this._textures.length%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20array%20of%20textures%20used%20for%20this%20MovieClip%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Texture%5B%5D%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.extras.MovieClip%23%0A%20%20%20%20%20*%0A%20%20%20%20%20*%2F%0A%20%20%20%20textures%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this._textures%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(value%5B0%5D%20instanceof%20core.Texture)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._textures%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._durations%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._textures%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._durations%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for(var%20i%20%3D%200%3B%20i%20%3C%20value.length%3B%20i%2B%2B)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._textures.push(value%5Bi%5D.texture)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._durations.push(value%5Bi%5D.time)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20*%20The%20MovieClips%20current%20frame%20index%0A%20%20%20%20*%0A%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20*%20%40memberof%20PIXI.extras.MovieClip%23%0A%20%20%20%20*%20%40readonly%0A%20%20%20%20*%2F%0A%20%20%20%20currentFrame%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20currentFrame%20%3D%20Math.floor(this._currentTime)%20%25%20this._textures.length%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(currentFrame%20%3C%200)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20currentFrame%20%2B%3D%20this._textures.length%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20currentFrame%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%7D)%3B%0A%0A%2F**%0A%20*%20Stops%20the%20MovieClip%0A%20*%0A%20*%2F%0AMovieClip.prototype.stop%20%3D%20function%20()%0A%7B%0A%20%20%20%20if(!this.playing)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.playing%20%3D%20false%3B%0A%20%20%20%20core.ticker.shared.remove(this.update%2C%20this)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Plays%20the%20MovieClip%0A%20*%0A%20*%2F%0AMovieClip.prototype.play%20%3D%20function%20()%0A%7B%0A%20%20%20%20if(this.playing)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.playing%20%3D%20true%3B%0A%20%20%20%20core.ticker.shared.add(this.update%2C%20this)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Stops%20the%20MovieClip%20and%20goes%20to%20a%20specific%20frame%0A%20*%0A%20*%20%40param%20frameNumber%20%7Bnumber%7D%20frame%20index%20to%20stop%20at%0A%20*%2F%0AMovieClip.prototype.gotoAndStop%20%3D%20function%20(frameNumber)%0A%7B%0A%20%20%20%20this.stop()%3B%0A%0A%20%20%20%20this._currentTime%20%3D%20frameNumber%3B%0A%0A%20%20%20%20this._texture%20%3D%20this._textures%5Bthis.currentFrame%5D%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Goes%20to%20a%20specific%20frame%20and%20begins%20playing%20the%20MovieClip%0A%20*%0A%20*%20%40param%20frameNumber%20%7Bnumber%7D%20frame%20index%20to%20start%20at%0A%20*%2F%0AMovieClip.prototype.gotoAndPlay%20%3D%20function%20(frameNumber)%0A%7B%0A%20%20%20%20this._currentTime%20%3D%20frameNumber%3B%0A%0A%20%20%20%20this.play()%3B%0A%7D%3B%0A%0A%2F*%0A%20*%20Updates%20the%20object%20transform%20for%20rendering%0A%20*%20%40private%0A%20*%2F%0AMovieClip.prototype.update%20%3D%20function%20(deltaTime)%0A%7B%0A%20%20%20%20var%20elapsed%20%3D%20this.animationSpeed%20*%20deltaTime%3B%0A%0A%20%20%20%20if%20(this._durations%20!%3D%3D%20null)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20lag%20%3D%20this._currentTime%20%25%201%20*%20this._durations%5Bthis.currentFrame%5D%3B%0A%0A%20%20%20%20%20%20%20%20lag%20%2B%3D%20elapsed%20%2F%2060%20*%201000%3B%0A%0A%20%20%20%20%20%20%20%20while%20(lag%20%3C%200)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._currentTime--%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20lag%20%2B%3D%20this._durations%5Bthis.currentFrame%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20var%20sign%20%3D%20Math.sign(this.animationSpeed%20*%20deltaTime)%3B%0A%20%20%20%20%20%20%20%20this._currentTime%20%3D%20Math.floor(this._currentTime)%3B%0A%0A%20%20%20%20%20%20%20%20while%20(lag%20%3E%3D%20this._durations%5Bthis.currentFrame%5D)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20lag%20-%3D%20this._durations%5Bthis.currentFrame%5D%20*%20sign%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._currentTime%20%2B%3D%20sign%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20this._currentTime%20%2B%3D%20lag%20%2F%20this._durations%5Bthis.currentFrame%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this._currentTime%20%2B%3D%20elapsed%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(this._currentTime%20%3C%200%20%26%26%20!this.loop)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.gotoAndStop(0)%3B%0A%0A%20%20%20%20%20%20%20%20if%20(this.onComplete)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.onComplete()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20else%20if%20(this._currentTime%20%3E%3D%20this._textures.length%20%26%26%20!this.loop)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.gotoAndStop(this._textures.length%20-%201)%3B%0A%0A%20%20%20%20%20%20%20%20if%20(this.onComplete)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.onComplete()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this._texture%20%3D%20this._textures%5Bthis.currentFrame%5D%3B%0A%20%20%20%20%7D%0A%0A%7D%3B%0A%0A%2F*%0A%20*%20Stops%20the%20MovieClip%20and%20destroys%20it%0A%20*%0A%20*%2F%0AMovieClip.prototype.destroy%20%3D%20function%20(%20)%0A%7B%0A%20%20%20%20this.stop()%3B%0A%20%20%20%20core.Sprite.prototype.destroy.call(this)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20A%20short%20hand%20way%20of%20creating%20a%20movieclip%20from%20an%20array%20of%20frame%20ids%0A%20*%0A%20*%20%40static%0A%20*%20%40param%20frames%20%7Bstring%5B%5D%7D%20the%20array%20of%20frames%20ids%20the%20movieclip%20will%20use%20as%20its%20texture%20frames%0A%20*%2F%0AMovieClip.fromFrames%20%3D%20function%20(frames)%0A%7B%0A%20%20%20%20var%20textures%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20frames.length%3B%20%2B%2Bi)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20textures.push(new%20core.Texture.fromFrame(frames%5Bi%5D))%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20new%20MovieClip(textures)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20A%20short%20hand%20way%20of%20creating%20a%20movieclip%20from%20an%20array%20of%20image%20ids%0A%20*%0A%20*%20%40static%0A%20*%20%40param%20images%20%7Bstring%5B%5D%7D%20the%20array%20of%20image%20urls%20the%20movieclip%20will%20use%20as%20its%20texture%20frames%0A%20*%2F%0AMovieClip.fromImages%20%3D%20function%20(images)%0A%7B%0A%20%20%20%20var%20textures%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20images.length%3B%20%2B%2Bi)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20textures.push(new%20core.Texture.fromImage(images%5Bi%5D))%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20new%20MovieClip(textures)%3B%0A%7D%3B%0A%7D%2C%7B%22..%2Fcore%22%3A20%7D%5D%2C72%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2Fcore')%2C%0A%20%20%20%20%2F%2F%20a%20sprite%20use%20dfor%20rendering%20textures..%0A%20%20%20%20tempPoint%20%3D%20new%20core.Point()%2C%0A%20%20%20%20CanvasTinter%20%3D%20require('..%2Fcore%2Frenderers%2Fcanvas%2Futils%2FCanvasTinter')%3B%0A%0A%2F**%0A%20*%20A%20tiling%20sprite%20is%20a%20fast%20way%20of%20rendering%20a%20tiling%20image%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.Sprite%0A%20*%20%40memberof%20PIXI.extras%0A%20*%20%40param%20texture%20%7BTexture%7D%20the%20texture%20of%20the%20tiling%20sprite%0A%20*%20%40param%20width%20%7Bnumber%7D%20%20the%20width%20of%20the%20tiling%20sprite%0A%20*%20%40param%20height%20%7Bnumber%7D%20the%20height%20of%20the%20tiling%20sprite%0A%20*%2F%0Afunction%20TilingSprite(texture%2C%20width%2C%20height)%0A%7B%0A%20%20%20%20core.Sprite.call(this%2C%20texture)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20scaling%20of%20the%20image%20that%20is%20being%20tiled%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Point%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.tileScale%20%3D%20new%20core.Point(1%2C1)%3B%0A%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20offset%20position%20of%20the%20image%20that%20is%20being%20tiled%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Point%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.tilePosition%20%3D%20new%20core.Point(0%2C0)%3B%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%20private%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20with%20of%20the%20tiling%20sprite%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._width%20%3D%20width%20%7C%7C%20100%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20height%20of%20the%20tiling%20sprite%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._height%20%3D%20height%20%7C%7C%20100%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20An%20internal%20WebGL%20UV%20cache.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.TextureUvs%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._uvs%20%3D%20new%20core.TextureUvs()%3B%0A%0A%20%20%20%20this._canvasPattern%20%3D%20null%3B%0A%0A%20%20%20%20%2F%2FTODO%20move..%0A%20%20%20%20this.shader%20%3D%20new%20core.AbstractFilter(%0A%0A%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20'precision%20lowp%20float%3B'%2C%0A%20%20%20%20%20%20%20%20'attribute%20vec2%20aVertexPosition%3B'%2C%0A%20%20%20%20%20%20%20%20'attribute%20vec2%20aTextureCoord%3B'%2C%0A%20%20%20%20%20%20%20%20'attribute%20vec4%20aColor%3B'%2C%0A%0A%20%20%20%20%20%20%20%20'uniform%20mat3%20projectionMatrix%3B'%2C%0A%0A%20%20%20%20%20%20%20%20'uniform%20vec4%20uFrame%3B'%2C%0A%20%20%20%20%20%20%20%20'uniform%20vec4%20uTransform%3B'%2C%0A%0A%20%20%20%20%20%20%20%20'varying%20vec2%20vTextureCoord%3B'%2C%0A%20%20%20%20%20%20%20%20'varying%20vec4%20vColor%3B'%2C%0A%0A%20%20%20%20%20%20%20%20'void%20main(void)%7B'%2C%0A%20%20%20%20%20%20%20%20'%20%20%20gl_Position%20%3D%20vec4((projectionMatrix%20*%20vec3(aVertexPosition%2C%201.0)).xy%2C%200.0%2C%201.0)%3B'%2C%0A%0A%20%20%20%20%20%20%20%20'%20%20%20vec2%20coord%20%3D%20aTextureCoord%3B'%2C%0A%20%20%20%20%20%20%20%20'%20%20%20coord%20-%3D%20uTransform.xy%3B'%2C%0A%20%20%20%20%20%20%20%20'%20%20%20coord%20%2F%3D%20uTransform.zw%3B'%2C%0A%20%20%20%20%20%20%20%20'%20%20%20vTextureCoord%20%3D%20coord%3B'%2C%0A%0A%20%20%20%20%20%20%20%20'%20%20%20vColor%20%3D%20vec4(aColor.rgb%20*%20aColor.a%2C%20aColor.a)%3B'%2C%0A%20%20%20%20%20%20%20%20'%7D'%0A%20%20%20%20%20%20%5D.join('%5Cn')%2C%0A%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20'precision%20lowp%20float%3B'%2C%0A%0A%20%20%20%20%20%20%20%20'varying%20vec2%20vTextureCoord%3B'%2C%0A%20%20%20%20%20%20%20%20'varying%20vec4%20vColor%3B'%2C%0A%0A%20%20%20%20%20%20%20%20'uniform%20sampler2D%20uSampler%3B'%2C%0A%20%20%20%20%20%20%20%20'uniform%20vec4%20uFrame%3B'%2C%0A%20%20%20%20%20%20%20%20'uniform%20vec2%20uPixelSize%3B'%2C%0A%0A%20%20%20%20%20%20%20%20'void%20main(void)%7B'%2C%0A%0A%20%20%20%20%20%20%20%20'%20%20%20vec2%20coord%20%3D%20mod(vTextureCoord%2C%20uFrame.zw)%3B'%2C%0A%20%20%20%20%20%20%20%20'%20%20%20coord%20%3D%20clamp(coord%2C%20uPixelSize%2C%20uFrame.zw%20-%20uPixelSize)%3B'%2C%0A%20%20%20%20%20%20%20%20'%20%20%20coord%20%2B%3D%20uFrame.xy%3B'%2C%0A%0A%20%20%20%20%20%20%20%20'%20%20%20gl_FragColor%20%3D%20%20texture2D(uSampler%2C%20coord)%20*%20vColor%20%3B'%2C%0A%20%20%20%20%20%20%20%20'%7D'%0A%20%20%20%20%20%20%5D.join('%5Cn')%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20set%20the%20uniforms%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20uFrame%3A%20%7B%20type%3A%20'4fv'%2C%20value%3A%20%5B0%2C0%2C1%2C1%5D%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20uTransform%3A%20%7B%20type%3A%20'4fv'%2C%20value%3A%20%5B0%2C0%2C1%2C1%5D%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20uPixelSize%20%3A%20%7B%20type%20%3A%20'2fv'%2C%20value%3A%20%5B1%2C%201%5D%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20)%3B%0A%7D%0A%0ATilingSprite.prototype%20%3D%20Object.create(core.Sprite.prototype)%3B%0ATilingSprite.prototype.constructor%20%3D%20TilingSprite%3B%0Amodule.exports%20%3D%20TilingSprite%3B%0A%0A%0AObject.defineProperties(TilingSprite.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20width%20of%20the%20sprite%2C%20setting%20this%20will%20actually%20modify%20the%20scale%20to%20achieve%20the%20value%20set%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.extras.TilingSprite%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20width%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this._width%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._width%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20height%20of%20the%20TilingSprite%2C%20setting%20this%20will%20actually%20modify%20the%20scale%20to%20achieve%20the%20value%20set%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.extras.TilingSprite%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20height%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this._height%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._height%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0ATilingSprite.prototype._onTextureUpdate%20%3D%20function%20()%0A%7B%0A%20%20%20%20return%3B%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Renders%20the%20object%20using%20the%20WebGL%20renderer%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%0A%20*%20%40private%0A%20*%2F%0ATilingSprite.prototype._renderWebGL%20%3D%20function%20(renderer)%0A%7B%0A%20%20%20%20%2F%2F%20tweak%20our%20texture%20temporarily..%0A%20%20%20%20var%20texture%20%3D%20this._texture%3B%0A%0A%20%20%20%20if(!texture%20%7C%7C%20!texture._uvs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20tempUvs%20%3D%20texture._uvs%2C%0A%20%20%20%20%20%20%20%20tempWidth%20%3D%20texture._frame.width%2C%0A%20%20%20%20%20%20%20%20tempHeight%20%3D%20texture._frame.height%2C%0A%20%20%20%20%20%20%20%20tw%20%3D%20texture.baseTexture.width%2C%0A%20%20%20%20%20%20%20%20th%20%3D%20texture.baseTexture.height%3B%0A%0A%20%20%20%20texture._uvs%20%3D%20this._uvs%3B%0A%20%20%20%20texture._frame.width%20%3D%20this.width%3B%0A%20%20%20%20texture._frame.height%20%3D%20this.height%3B%0A%0A%20%20%20%20this.shader.uniforms.uPixelSize.value%5B0%5D%20%3D%201.0%2Ftw%3B%0A%20%20%20%20this.shader.uniforms.uPixelSize.value%5B1%5D%20%3D%201.0%2Fth%3B%0A%0A%20%20%20%20this.shader.uniforms.uFrame.value%5B0%5D%20%3D%20tempUvs.x0%3B%0A%20%20%20%20this.shader.uniforms.uFrame.value%5B1%5D%20%3D%20tempUvs.y0%3B%0A%20%20%20%20this.shader.uniforms.uFrame.value%5B2%5D%20%3D%20tempUvs.x1%20-%20tempUvs.x0%3B%0A%20%20%20%20this.shader.uniforms.uFrame.value%5B3%5D%20%3D%20tempUvs.y2%20-%20tempUvs.y0%3B%0A%0A%20%20%20%20this.shader.uniforms.uTransform.value%5B0%5D%20%3D%20(this.tilePosition.x%20%25%20(tempWidth%20*%20this.tileScale.x))%20%2F%20this._width%3B%0A%20%20%20%20this.shader.uniforms.uTransform.value%5B1%5D%20%3D%20(this.tilePosition.y%20%25%20(tempHeight%20*%20this.tileScale.y))%20%2F%20this._height%3B%0A%20%20%20%20this.shader.uniforms.uTransform.value%5B2%5D%20%3D%20(%20tw%20%2F%20this._width%20)%20*%20this.tileScale.x%3B%0A%20%20%20%20this.shader.uniforms.uTransform.value%5B3%5D%20%3D%20(%20th%20%2F%20this._height%20)%20*%20this.tileScale.y%3B%0A%0A%20%20%20%20renderer.setObjectRenderer(renderer.plugins.sprite)%3B%0A%20%20%20%20renderer.plugins.sprite.render(this)%3B%0A%0A%20%20%20%20texture._uvs%20%3D%20tempUvs%3B%0A%20%20%20%20texture._frame.width%20%3D%20tempWidth%3B%0A%20%20%20%20texture._frame.height%20%3D%20tempHeight%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Renders%20the%20object%20using%20the%20Canvas%20renderer%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.CanvasRenderer%7D%20a%20reference%20to%20the%20canvas%20renderer%0A%20*%20%40private%0A%20*%2F%0ATilingSprite.prototype._renderCanvas%20%3D%20function%20(renderer)%0A%7B%0A%20%20%20%20var%20texture%20%3D%20this._texture%3B%0A%0A%20%20%20%20if%20(!texture.baseTexture.hasLoaded)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20context%20%3D%20renderer.context%2C%0A%20%20%20%20%20%20%20%20transform%20%3D%20this.worldTransform%2C%0A%20%20%20%20%20%20%20%20resolution%20%3D%20renderer.resolution%2C%0A%20%20%20%20%20%20%20%20baseTexture%20%3D%20texture.baseTexture%2C%0A%20%20%20%20%20%20%20%20modX%20%3D%20(this.tilePosition.x%20%2F%20this.tileScale.x)%20%25%20texture._frame.width%2C%0A%20%20%20%20%20%20%20%20modY%20%3D%20(this.tilePosition.y%20%2F%20this.tileScale.y)%20%25%20texture._frame.height%3B%0A%0A%20%20%20%20%2F%2F%20create%20a%20nice%20shiny%20pattern!%0A%20%20%20%20%2F%2F%20TODO%20this%20needs%20to%20be%20refreshed%20if%20texture%20changes..%0A%20%20%20%20if(!this._canvasPattern)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20cut%20an%20object%20from%20a%20spritesheet..%0A%20%20%20%20%20%20%20%20var%20tempCanvas%20%3D%20new%20core.CanvasBuffer(texture._frame.width%2C%20texture._frame.height)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Tint%20the%20tiling%20sprite%0A%20%20%20%20%20%20%20%20if%20(this.tint%20!%3D%3D%200xFFFFFF)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.cachedTint%20!%3D%3D%20this.tint)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.cachedTint%20%3D%20this.tint%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.tintedTexture%20%3D%20CanvasTinter.getTintedTexture(this%2C%20this.tint)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20tempCanvas.context.drawImage(this.tintedTexture%2C%200%2C%200)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20tempCanvas.context.drawImage(baseTexture.source%2C%20-texture._frame.x%2C%20-texture._frame.y)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20this._canvasPattern%20%3D%20tempCanvas.context.createPattern(%20tempCanvas.canvas%2C%20'repeat'%20)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20set%20context%20state..%0A%20%20%20%20context.globalAlpha%20%3D%20this.worldAlpha%3B%0A%20%20%20%20context.setTransform(transform.a%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20transform.b%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20transform.c%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20transform.d%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20transform.tx%20*%20resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20transform.ty%20*%20resolution)%3B%0A%0A%20%20%20%20%2F%2F%20TODO%20-%20this%20should%20be%20rolled%20into%20the%20setTransform%20above..%0A%20%20%20%20context.scale(this.tileScale.x%2Cthis.tileScale.y)%3B%0A%0A%20%20%20%20context.translate(modX%20%2B%20(this.anchor.x%20*%20-this._width%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20modY%20%2B%20(this.anchor.y%20*%20-this._height))%3B%0A%0A%20%20%20%20%2F%2F%20check%20blend%20mode%0A%20%20%20%20var%20compositeOperation%20%3D%20renderer.blendModes%5Bthis.blendMode%5D%3B%0A%20%20%20%20if%20(compositeOperation%20!%3D%3D%20renderer.context.globalCompositeOperation)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20context.globalCompositeOperation%20%3D%20compositeOperation%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20fill%20the%20pattern!%0A%20%20%20%20context.fillStyle%20%3D%20this._canvasPattern%3B%0A%20%20%20%20context.fillRect(-modX%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-modY%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._width%20%2F%20this.tileScale.x%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._height%20%2F%20this.tileScale.y)%3B%0A%0A%0A%20%20%20%20%2F%2FTODO%20-%20pretty%20sure%20this%20can%20be%20deleted...%0A%20%20%20%20%2F%2Fcontext.translate(-this.tilePosition.x%20%2B%20(this.anchor.x%20*%20this._width)%2C%20-this.tilePosition.y%20%2B%20(this.anchor.y%20*%20this._height))%3B%0A%20%20%20%20%2F%2Fcontext.scale(1%20%2F%20this.tileScale.x%2C%201%20%2F%20this.tileScale.y)%3B%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Returns%20the%20framing%20rectangle%20of%20the%20sprite%20as%20a%20Rectangle%20object%0A*%0A%20*%20%40return%20%7BPIXI.Rectangle%7D%20the%20framing%20rectangle%0A%20*%2F%0ATilingSprite.prototype.getBounds%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20width%20%3D%20this._width%3B%0A%20%20%20%20var%20height%20%3D%20this._height%3B%0A%0A%20%20%20%20var%20w0%20%3D%20width%20*%20(1-this.anchor.x)%3B%0A%20%20%20%20var%20w1%20%3D%20width%20*%20-this.anchor.x%3B%0A%0A%20%20%20%20var%20h0%20%3D%20height%20*%20(1-this.anchor.y)%3B%0A%20%20%20%20var%20h1%20%3D%20height%20*%20-this.anchor.y%3B%0A%0A%20%20%20%20var%20worldTransform%20%3D%20this.worldTransform%3B%0A%0A%20%20%20%20var%20a%20%3D%20worldTransform.a%3B%0A%20%20%20%20var%20b%20%3D%20worldTransform.b%3B%0A%20%20%20%20var%20c%20%3D%20worldTransform.c%3B%0A%20%20%20%20var%20d%20%3D%20worldTransform.d%3B%0A%20%20%20%20var%20tx%20%3D%20worldTransform.tx%3B%0A%20%20%20%20var%20ty%20%3D%20worldTransform.ty%3B%0A%0A%20%20%20%20var%20x1%20%3D%20a%20*%20w1%20%2B%20c%20*%20h1%20%2B%20tx%3B%0A%20%20%20%20var%20y1%20%3D%20d%20*%20h1%20%2B%20b%20*%20w1%20%2B%20ty%3B%0A%0A%20%20%20%20var%20x2%20%3D%20a%20*%20w0%20%2B%20c%20*%20h1%20%2B%20tx%3B%0A%20%20%20%20var%20y2%20%3D%20d%20*%20h1%20%2B%20b%20*%20w0%20%2B%20ty%3B%0A%0A%20%20%20%20var%20x3%20%3D%20a%20*%20w0%20%2B%20c%20*%20h0%20%2B%20tx%3B%0A%20%20%20%20var%20y3%20%3D%20d%20*%20h0%20%2B%20b%20*%20w0%20%2B%20ty%3B%0A%0A%20%20%20%20var%20x4%20%3D%20%20a%20*%20w1%20%2B%20c%20*%20h0%20%2B%20tx%3B%0A%20%20%20%20var%20y4%20%3D%20%20d%20*%20h0%20%2B%20b%20*%20w1%20%2B%20ty%3B%0A%0A%20%20%20%20var%20minX%2C%0A%20%20%20%20%20%20%20%20maxX%2C%0A%20%20%20%20%20%20%20%20minY%2C%0A%20%20%20%20%20%20%20%20maxY%3B%0A%0A%20%20%20%20minX%20%3D%20x1%3B%0A%20%20%20%20minX%20%3D%20x2%20%3C%20minX%20%3F%20x2%20%3A%20minX%3B%0A%20%20%20%20minX%20%3D%20x3%20%3C%20minX%20%3F%20x3%20%3A%20minX%3B%0A%20%20%20%20minX%20%3D%20x4%20%3C%20minX%20%3F%20x4%20%3A%20minX%3B%0A%0A%20%20%20%20minY%20%3D%20y1%3B%0A%20%20%20%20minY%20%3D%20y2%20%3C%20minY%20%3F%20y2%20%3A%20minY%3B%0A%20%20%20%20minY%20%3D%20y3%20%3C%20minY%20%3F%20y3%20%3A%20minY%3B%0A%20%20%20%20minY%20%3D%20y4%20%3C%20minY%20%3F%20y4%20%3A%20minY%3B%0A%0A%20%20%20%20maxX%20%3D%20x1%3B%0A%20%20%20%20maxX%20%3D%20x2%20%3E%20maxX%20%3F%20x2%20%3A%20maxX%3B%0A%20%20%20%20maxX%20%3D%20x3%20%3E%20maxX%20%3F%20x3%20%3A%20maxX%3B%0A%20%20%20%20maxX%20%3D%20x4%20%3E%20maxX%20%3F%20x4%20%3A%20maxX%3B%0A%0A%20%20%20%20maxY%20%3D%20y1%3B%0A%20%20%20%20maxY%20%3D%20y2%20%3E%20maxY%20%3F%20y2%20%3A%20maxY%3B%0A%20%20%20%20maxY%20%3D%20y3%20%3E%20maxY%20%3F%20y3%20%3A%20maxY%3B%0A%20%20%20%20maxY%20%3D%20y4%20%3E%20maxY%20%3F%20y4%20%3A%20maxY%3B%0A%0A%20%20%20%20var%20bounds%20%3D%20this._bounds%3B%0A%0A%20%20%20%20bounds.x%20%3D%20minX%3B%0A%20%20%20%20bounds.width%20%3D%20maxX%20-%20minX%3B%0A%0A%20%20%20%20bounds.y%20%3D%20minY%3B%0A%20%20%20%20bounds.height%20%3D%20maxY%20-%20minY%3B%0A%0A%20%20%20%20%2F%2F%20store%20a%20reference%20so%20that%20if%20this%20function%20gets%20called%20again%20in%20the%20render%20cycle%20we%20do%20not%20have%20to%20recalculate%0A%20%20%20%20this._currentBounds%20%3D%20bounds%3B%0A%0A%20%20%20%20return%20bounds%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Checks%20if%20a%20point%20is%20inside%20this%20tiling%20sprite%0A%20*%20%40param%20point%20%7BPIXI.Point%7D%20the%20point%20to%20check%0A%20*%2F%0ATilingSprite.prototype.containsPoint%20%3D%20function(%20point%20)%0A%7B%0A%20%20%20%20this.worldTransform.applyInverse(point%2C%20%20tempPoint)%3B%0A%0A%20%20%20%20var%20width%20%3D%20this._width%3B%0A%20%20%20%20var%20height%20%3D%20this._height%3B%0A%20%20%20%20var%20x1%20%3D%20-width%20*%20this.anchor.x%3B%0A%20%20%20%20var%20y1%3B%0A%0A%20%20%20%20if%20(%20tempPoint.x%20%3E%20x1%20%26%26%20tempPoint.x%20%3C%20x1%20%2B%20width%20)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20y1%20%3D%20-height%20*%20this.anchor.y%3B%0A%0A%20%20%20%20%20%20%20%20if%20(%20tempPoint.y%20%3E%20y1%20%26%26%20tempPoint.y%20%3C%20y1%20%2B%20height%20)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20false%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20this%20tiling%20sprite%0A%20*%0A%20*%2F%0ATilingSprite.prototype.destroy%20%3D%20function%20()%20%7B%0A%20%20%20%20core.Sprite.prototype.destroy.call(this)%3B%0A%0A%20%20%20%20this.tileScale%20%3D%20null%3B%0A%20%20%20%20this._tileScaleOffset%20%3D%20null%3B%0A%20%20%20%20this.tilePosition%20%3D%20null%3B%0A%0A%20%20%20%20this._uvs%20%3D%20null%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Helper%20function%20that%20creates%20a%20tiling%20sprite%20that%20will%20use%20a%20texture%20from%20the%20TextureCache%20based%20on%20the%20frameId%0A%20*%20The%20frame%20ids%20are%20created%20when%20a%20Texture%20packer%20file%20has%20been%20loaded%0A%20*%0A%20*%20%40static%0A%20*%20%40param%20frameId%20%7Bstring%7D%20The%20frame%20Id%20of%20the%20texture%20in%20the%20cache%0A%20*%20%40return%20%7BPIXI.extras.TilingSprite%7D%20A%20new%20TilingSprite%20using%20a%20texture%20from%20the%20texture%20cache%20matching%20the%20frameId%0A%20*%20%40param%20width%20%7Bnumber%7D%20%20the%20width%20of%20the%20tiling%20sprite%0A%20*%20%40param%20height%20%7Bnumber%7D%20the%20height%20of%20the%20tiling%20sprite%0A%20*%2F%0ATilingSprite.fromFrame%20%3D%20function%20(frameId%2Cwidth%2Cheight)%0A%7B%0A%20%20%20%20var%20texture%20%3D%20core.utils.TextureCache%5BframeId%5D%3B%0A%0A%20%20%20%20if%20(!texture)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error('The%20frameId%20%22'%20%2B%20frameId%20%2B%20'%22%20does%20not%20exist%20in%20the%20texture%20cache%20'%20%2B%20this)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20new%20TilingSprite(texture%2Cwidth%2Cheight)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Helper%20function%20that%20creates%20a%20sprite%20that%20will%20contain%20a%20texture%20based%20on%20an%20image%20url%0A%20*%20If%20the%20image%20is%20not%20in%20the%20texture%20cache%20it%20will%20be%20loaded%0A%20*%0A%20*%20%40static%0A%20*%20%40param%20imageId%20%7Bstring%7D%20The%20image%20url%20of%20the%20texture%0A%20*%20%40param%20width%20%7Bnumber%7D%20%20the%20width%20of%20the%20tiling%20sprite%0A%20*%20%40param%20height%20%7Bnumber%7D%20the%20height%20of%20the%20tiling%20sprite%0A%20*%20%40param%20%5Bcrossorigin%3D(auto)%5D%20%7Bboolean%7D%20if%20you%20want%20to%20specify%20the%20cross-origin%20parameter%0A%20*%20%40param%20%5BscaleMode%3DPIXI.SCALE_MODES.DEFAULT%5D%20%7Bnumber%7D%20if%20you%20want%20to%20specify%20the%20scale%20mode%2C%20see%20%7B%40link%20PIXI.SCALE_MODES%7D%20for%20possible%20values%0A%20*%20%40return%20%7BPIXI.extras.TilingSprite%7D%20A%20new%20TilingSprite%20using%20a%20texture%20from%20the%20texture%20cache%20matching%20the%20image%20id%0A%20*%2F%0ATilingSprite.fromImage%20%3D%20function%20(imageId%2C%20width%2C%20height%2C%20crossorigin%2C%20scaleMode)%0A%7B%0A%20%20%20%20return%20new%20TilingSprite(core.Texture.fromImage(imageId%2C%20crossorigin%2C%20scaleMode)%2Cwidth%2Cheight)%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fcore%22%3A20%2C%22..%2Fcore%2Frenderers%2Fcanvas%2Futils%2FCanvasTinter%22%3A38%7D%5D%2C73%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2Fcore')%2C%0A%20%20%20%20DisplayObject%20%3D%20core.DisplayObject%2C%0A%20%20%20%20_tempMatrix%20%3D%20new%20core.Matrix()%3B%0A%0ADisplayObject.prototype._cacheAsBitmap%20%3D%20false%3B%0ADisplayObject.prototype._originalRenderWebGL%20%3D%20null%3B%0ADisplayObject.prototype._originalRenderCanvas%20%3D%20null%3B%0A%0ADisplayObject.prototype._originalUpdateTransform%20%3D%20null%3B%0ADisplayObject.prototype._originalHitTest%20%3D%20null%3B%0ADisplayObject.prototype._originalDestroy%20%3D%20null%3B%0ADisplayObject.prototype._cachedSprite%20%3D%20null%3B%0A%0AObject.defineProperties(DisplayObject.prototype%2C%20%7B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Set%20this%20to%20true%20if%20you%20want%20this%20display%20object%20to%20be%20cached%20as%20a%20bitmap.%0A%20%20%20%20%20*%20This%20basically%20takes%20a%20snap%20shot%20of%20the%20display%20object%20as%20it%20is%20at%20that%20moment.%20It%20can%20provide%20a%20performance%20benefit%20for%20complex%20static%20displayObjects.%0A%20%20%20%20%20*%20To%20remove%20simply%20set%20this%20property%20to%20'null'%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.DisplayObject%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20cacheAsBitmap%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this._cacheAsBitmap%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(this._cacheAsBitmap%20%3D%3D%3D%20value)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20this._cacheAsBitmap%20%3D%20value%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(value)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._originalRenderWebGL%20%3D%20this.renderWebGL%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._originalRenderCanvas%20%3D%20this.renderCanvas%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._originalUpdateTransform%20%3D%20this.updateTransform%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._originalGetBounds%20%3D%20this.getBounds%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._originalDestroy%20%3D%20this.destroy%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._originalContainsPoint%20%3D%20this.containsPoint%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.renderWebGL%20%3D%20this._renderCachedWebGL%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.renderCanvas%20%3D%20this._renderCachedCanvas%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.destroy%20%3D%20this._cacheAsBitmapDestroy%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(this._cachedSprite)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._destroyCachedDisplayObject()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.renderWebGL%20%3D%20this._originalRenderWebGL%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.renderCanvas%20%3D%20this._originalRenderCanvas%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.getBounds%20%3D%20this._originalGetBounds%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.destroy%20%3D%20this._originalDestroy%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.updateTransform%20%3D%20this._originalUpdateTransform%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.containsPoint%20%3D%20this._originalContainsPoint%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%2F**%0A*%20Renders%20a%20cached%20version%20of%20the%20sprite%20with%20WebGL%0A*%0A*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20the%20WebGL%20renderer%0A*%20%40private%0A*%2F%0ADisplayObject.prototype._renderCachedWebGL%20%3D%20function%20(renderer)%0A%7B%0A%20%20%20%20if%20(!this.visible%20%7C%7C%20this.worldAlpha%20%3C%3D%200%20%7C%7C%20!this.renderable)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this._initCachedDisplayObject(%20renderer%20)%3B%0A%0A%20%20%20%20this._cachedSprite.worldAlpha%20%3D%20this.worldAlpha%3B%0A%0A%20%20%20%20renderer.setObjectRenderer(renderer.plugins.sprite)%3B%0A%20%20%20%20renderer.plugins.sprite.render(%20this._cachedSprite%20)%3B%0A%7D%3B%0A%0A%2F**%0A*%20Prepares%20the%20WebGL%20renderer%20to%20cache%20the%20sprite%0A*%0A*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20the%20WebGL%20renderer%0A*%20%40private%0A*%2F%0ADisplayObject.prototype._initCachedDisplayObject%20%3D%20function%20(renderer)%0A%7B%0A%20%20%20%20if(this._cachedSprite)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20first%20we%20flush%20anything%20left%20in%20the%20renderer%20(otherwise%20it%20would%20get%20rendered%20to%20the%20cached%20texture)%0A%20%20%20%20renderer.currentRenderer.flush()%3B%0A%20%20%20%20%2F%2Fthis.filters%3D%20%5B%5D%3B%0A%20%20%20%20%2F%2F%20next%20we%20find%20the%20dimensions%20of%20the%20untransformed%20object%0A%20%20%20%20%2F%2F%20this%20function%20also%20calls%20updatetransform%20on%20all%20its%20children%20as%20part%20of%20the%20measuring.%20This%20means%20we%20don't%20need%20to%20update%20the%20transform%20again%20in%20this%20function%0A%20%20%20%20%2F%2F%20TODO%20pass%20an%20object%20to%20clone%20too%3F%20saves%20having%20to%20create%20a%20new%20one%20each%20time!%0A%20%20%20%20var%20bounds%20%3D%20this.getLocalBounds().clone()%3B%0A%0A%20%20%20%20%2F%2F%20add%20some%20padding!%0A%20%20%20%20if(this._filters)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20padding%20%3D%20this._filters%5B0%5D.padding%3B%0A%20%20%20%20%20%20%20%20bounds.x%20-%3D%20padding%3B%0A%20%20%20%20%20%20%20%20bounds.y%20-%3D%20padding%3B%0A%0A%20%20%20%20%20%20%20%20bounds.width%20%2B%3D%20padding%20*%202%3B%0A%20%20%20%20%20%20%20%20bounds.height%20%2B%3D%20padding%20*%202%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20for%20now%20we%20cache%20the%20current%20renderTarget%20that%20the%20webGL%20renderer%20is%20currently%20using.%0A%20%20%20%20%2F%2F%20this%20could%20be%20more%20elegent..%0A%20%20%20%20var%20cachedRenderTarget%20%3D%20renderer.currentRenderTarget%3B%0A%20%20%20%20%2F%2F%20We%20also%20store%20the%20filter%20stack%20-%20I%20will%20definitely%20look%20to%20change%20how%20this%20works%20a%20little%20later%20down%20the%20line.%0A%20%20%20%20var%20stack%20%3D%20renderer.filterManager.filterStack%3B%0A%0A%20%20%20%20%2F%2F%20this%20renderTexture%20will%20be%20used%20to%20store%20the%20cached%20DisplayObject%0A%20%20%20%20var%20renderTexture%20%3D%20new%20core.RenderTexture(renderer%2C%20bounds.width%20%7C%200%2C%20bounds.height%20%7C%200)%3B%0A%0A%20%20%20%20%2F%2F%20need%20to%20set%20%2F%2F%0A%20%20%20%20var%20m%20%3D%20_tempMatrix%3B%0A%0A%20%20%20%20m.tx%20%3D%20-bounds.x%3B%0A%20%20%20%20m.ty%20%3D%20-bounds.y%3B%0A%0A%0A%0A%20%20%20%20%2F%2F%20set%20all%20properties%20to%20there%20original%20so%20we%20can%20render%20to%20a%20texture%0A%20%20%20%20this.renderWebGL%20%3D%20this._originalRenderWebGL%3B%0A%0A%20%20%20%20renderTexture.render(this%2C%20m%2C%20true%2C%20true)%3B%0A%0A%20%20%20%20%2F%2F%20now%20restore%20the%20state%20be%20setting%20the%20new%20properties%0A%20%20%20%20renderer.setRenderTarget(cachedRenderTarget)%3B%0A%20%20%20%20renderer.filterManager.filterStack%20%3D%20stack%3B%0A%0A%20%20%20%20this.renderWebGL%20%20%20%20%20%3D%20this._renderCachedWebGL%3B%0A%20%20%20%20this.updateTransform%20%3D%20this.displayObjectUpdateTransform%3B%0A%20%20%20%20this.getBounds%20%20%20%20%20%20%20%3D%20this._getCachedBounds%3B%0A%0A%0A%20%20%20%20%2F%2F%20create%20our%20cached%20sprite%0A%20%20%20%20this._cachedSprite%20%3D%20new%20core.Sprite(renderTexture)%3B%0A%20%20%20%20this._cachedSprite.worldTransform%20%3D%20this.worldTransform%3B%0A%20%20%20%20this._cachedSprite.anchor.x%20%3D%20-(%20bounds.x%20%2F%20bounds.width%20)%3B%0A%20%20%20%20this._cachedSprite.anchor.y%20%3D%20-(%20bounds.y%20%2F%20bounds.height%20)%3B%0A%0A%20%20%20%20%2F%2F%20restore%20the%20transform%20of%20the%20cached%20sprite%20to%20avoid%20the%20nasty%20flicker..%0A%20%20%20%20this.updateTransform()%3B%0A%0A%20%20%20%20%2F%2F%20map%20the%20hit%20test..%0A%20%20%20%20this.containsPoint%20%3D%20this._cachedSprite.containsPoint.bind(this._cachedSprite)%3B%0A%7D%3B%0A%0A%2F**%0A*%20Renders%20a%20cached%20version%20of%20the%20sprite%20with%20canvas%0A*%0A*%20%40param%20renderer%20%7BPIXI.CanvasRenderer%7D%20the%20Canvas%20renderer%0A*%20%40private%0A*%2F%0ADisplayObject.prototype._renderCachedCanvas%20%3D%20function%20(renderer)%0A%7B%0A%20%20%20%20if%20(!this.visible%20%7C%7C%20this.worldAlpha%20%3C%3D%200%20%7C%7C%20!this.renderable)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this._initCachedDisplayObjectCanvas(%20renderer%20)%3B%0A%0A%20%20%20%20this._cachedSprite.worldAlpha%20%3D%20this.worldAlpha%3B%0A%0A%20%20%20%20this._cachedSprite.renderCanvas(renderer)%3B%0A%7D%3B%0A%0A%2F%2FTODO%20this%20can%20be%20the%20same%20as%20the%20webGL%20verison..%20will%20need%20to%20do%20a%20little%20tweaking%20first%20though..%0A%2F**%0A*%20Prepares%20the%20Canvas%20renderer%20to%20cache%20the%20sprite%0A*%0A*%20%40param%20renderer%20%7BPIXI.CanvasRenderer%7D%20the%20Canvas%20renderer%0A*%20%40private%0A*%2F%0ADisplayObject.prototype._initCachedDisplayObjectCanvas%20%3D%20function%20(renderer)%0A%7B%0A%20%20%20%20if(this._cachedSprite)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2Fget%20bounds%20actually%20transforms%20the%20object%20for%20us%20already!%0A%20%20%20%20var%20bounds%20%3D%20this.getLocalBounds()%3B%0A%0A%20%20%20%20var%20cachedRenderTarget%20%3D%20renderer.context%3B%0A%0A%20%20%20%20var%20renderTexture%20%3D%20new%20core.RenderTexture(renderer%2C%20bounds.width%20%7C%200%2C%20bounds.height%20%7C%200)%3B%0A%0A%20%20%20%20%2F%2F%20need%20to%20set%20%2F%2F%0A%20%20%20%20var%20m%20%3D%20_tempMatrix%3B%0A%0A%20%20%20%20m.tx%20%3D%20-bounds.x%3B%0A%20%20%20%20m.ty%20%3D%20-bounds.y%3B%0A%0A%20%20%20%20%2F%2F%20set%20all%20properties%20to%20there%20original%20so%20we%20can%20render%20to%20a%20texture%0A%20%20%20%20this.renderCanvas%20%3D%20this._originalRenderCanvas%3B%0A%0A%20%20%20%20renderTexture.render(this%2C%20m%2C%20true)%3B%0A%0A%20%20%20%20%2F%2F%20now%20restore%20the%20state%20be%20setting%20the%20new%20properties%0A%20%20%20%20renderer.context%20%3D%20cachedRenderTarget%3B%0A%0A%20%20%20%20this.renderCanvas%20%3D%20this._renderCachedCanvas%3B%0A%20%20%20%20this.updateTransform%20%3D%20this.displayObjectUpdateTransform%3B%0A%20%20%20%20this.getBounds%20%20%3D%20this._getCachedBounds%3B%0A%0A%0A%20%20%20%20%2F%2F%20create%20our%20cached%20sprite%0A%20%20%20%20this._cachedSprite%20%3D%20new%20core.Sprite(renderTexture)%3B%0A%20%20%20%20this._cachedSprite.worldTransform%20%3D%20this.worldTransform%3B%0A%20%20%20%20this._cachedSprite.anchor.x%20%3D%20-(%20bounds.x%20%2F%20bounds.width%20)%3B%0A%20%20%20%20this._cachedSprite.anchor.y%20%3D%20-(%20bounds.y%20%2F%20bounds.height%20)%3B%0A%0A%20%20%20%20this.updateTransform()%3B%0A%0A%20%20%20%20this.containsPoint%20%3D%20this._cachedSprite.containsPoint.bind(this._cachedSprite)%3B%0A%7D%3B%0A%0A%2F**%0A*%20Calculates%20the%20bounds%20of%20the%20cached%20sprite%0A*%0A*%20%40private%0A*%2F%0ADisplayObject.prototype._getCachedBounds%20%3D%20function%20()%0A%7B%0A%20%20%20%20this._cachedSprite._currentBounds%20%3D%20null%3B%0A%0A%20%20%20%20return%20this._cachedSprite.getBounds()%3B%0A%7D%3B%0A%0A%2F**%0A*%20Destroys%20the%20cached%20sprite.%0A*%0A*%20%40private%0A*%2F%0ADisplayObject.prototype._destroyCachedDisplayObject%20%3D%20function%20()%0A%7B%0A%20%20%20%20this._cachedSprite._texture.destroy()%3B%0A%20%20%20%20this._cachedSprite%20%3D%20null%3B%0A%7D%3B%0A%0ADisplayObject.prototype._cacheAsBitmapDestroy%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.cacheAsBitmap%20%3D%20false%3B%0A%20%20%20%20this._originalDestroy()%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fcore%22%3A20%7D%5D%2C74%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2Fcore')%3B%0A%0A%2F**%0A%20*%20The%20instance%20name%20of%20the%20object.%0A%20*%0A%20*%20%40memberof%20PIXI.DisplayObject%23%0A%20*%20%40member%20%7Bstring%7D%0A%20*%2F%0Acore.DisplayObject.prototype.name%20%3D%20null%3B%0A%0A%2F**%0A*%20Returns%20the%20display%20object%20in%20the%20container%0A*%0A*%20%40memberof%20PIXI.Container%23%0A*%20%40param%20name%20%7Bstring%7D%20instance%20name%0A*%20%40return%20%7BPIXI.DisplayObject%7D%0A*%2F%0Acore.Container.prototype.getChildByName%20%3D%20function%20(name)%0A%7B%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20this.children.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if%20(this.children%5Bi%5D.name%20%3D%3D%3D%20name)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.children%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20null%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fcore%22%3A20%7D%5D%2C75%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2Fcore')%3B%0A%0A%2F**%0A*%20Returns%20the%20global%20position%20of%20the%20displayObject%0A*%0A*%20%40memberof%20PIXI.DisplayObject%23%0A*%20%40param%20point%20%7BPoint%7D%20the%20point%20to%20write%20the%20global%20value%20to.%20If%20null%20a%20new%20point%20will%20be%20returned%0A*%20%40return%20%7BPoint%7D%0A*%2F%0Acore.DisplayObject.prototype.getGlobalPosition%20%3D%20function%20(point)%0A%7B%0A%20%20%20%20point%20%3D%20point%20%7C%7C%20new%20core.Point()%3B%0A%0A%20%20%20%20if(this.parent)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.displayObjectUpdateTransform()%3B%0A%0A%20%20%20%20%20%20%20%20point.x%20%3D%20this.worldTransform.tx%3B%0A%20%20%20%20%20%20%20%20point.y%20%3D%20this.worldTransform.ty%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20point.x%20%3D%20this.position.x%3B%0A%20%20%20%20%20%20%20%20point.y%20%3D%20this.position.y%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20point%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fcore%22%3A20%7D%5D%2C76%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F**%0A%20*%20%40file%20%20%20%20%20%20%20%20Main%20export%20of%20the%20PIXI%20extras%20library%0A%20*%20%40author%20%20%20%20%20%20Mat%20Groves%20%3Cmat%40goodboydigital.com%3E%0A%20*%20%40copyright%20%20%202013-2015%20GoodBoyDigital%0A%20*%20%40license%20%20%20%20%20%7B%40link%20https%3A%2F%2Fgithub.com%2Fpixijs%2Fpixi.js%2Fblob%2Fmaster%2FLICENSE%7CMIT%20License%7D%0A%20*%2F%0A%0Arequire('.%2FcacheAsBitmap')%3B%0Arequire('.%2FgetChildByName')%3B%0Arequire('.%2FgetGlobalPosition')%3B%0A%0A%2F**%0A%20*%20%40namespace%20PIXI.extras%0A%20*%2F%0Amodule.exports%20%3D%20%7B%0A%20%20%20%20MovieClip%3A%20%20%20%20%20%20require('.%2FMovieClip')%2C%0A%20%20%20%20TilingSprite%3A%20%20%20require('.%2FTilingSprite')%2C%0A%20%20%20%20BitmapText%3A%20%20%20%20%20require('.%2FBitmapText')%0A%7D%3B%0A%0A%7D%2C%7B%22.%2FBitmapText%22%3A70%2C%22.%2FMovieClip%22%3A71%2C%22.%2FTilingSprite%22%3A72%2C%22.%2FcacheAsBitmap%22%3A73%2C%22.%2FgetChildByName%22%3A74%2C%22.%2FgetGlobalPosition%22%3A75%7D%5D%2C77%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F%2F%20TODO%20(cengler)%20-%20The%20Y%20is%20flipped%20in%20this%20shader%20for%20some%20reason.%0A%0A%2F**%0A%20*%20%40author%20Vico%20%40vicocotea%0A%20*%20original%20shader%20%3A%20https%3A%2F%2Fwww.shadertoy.com%2Fview%2FlssGDj%20by%20%40movAX13h%0A%20*%2F%0A%0A%2F**%0A%20*%20An%20ASCII%20filter.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20AsciiFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20null%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20mediump%20float%3B%5Cn%5Cnuniform%20vec4%20dimensions%3B%5Cnuniform%20float%20pixelSize%3B%5Cnuniform%20sampler2D%20uSampler%3B%5Cn%5Cnfloat%20character(float%20n%2C%20vec2%20p)%5Cn%7B%5Cn%20%20%20%20p%20%3D%20floor(p*vec2(4.0%2C%20-4.0)%20%2B%202.5)%3B%5Cn%20%20%20%20if%20(clamp(p.x%2C%200.0%2C%204.0)%20%3D%3D%20p.x%20%26%26%20clamp(p.y%2C%200.0%2C%204.0)%20%3D%3D%20p.y)%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20if%20(int(mod(n%2Fexp2(p.x%20%2B%205.0*p.y)%2C%202.0))%20%3D%3D%201)%20return%201.0%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20return%200.0%3B%5Cn%7D%5Cn%5Cnvoid%20main()%5Cn%7B%5Cn%20%20%20%20vec2%20uv%20%3D%20gl_FragCoord.xy%3B%5Cn%5Cn%20%20%20%20vec3%20col%20%3D%20texture2D(uSampler%2C%20floor(%20uv%20%2F%20pixelSize%20)%20*%20pixelSize%20%2F%20dimensions.xy).rgb%3B%5Cn%5Cn%20%20%20%20float%20gray%20%3D%20(col.r%20%2B%20col.g%20%2B%20col.b)%20%2F%203.0%3B%5Cn%5Cn%20%20%20%20float%20n%20%3D%20%2065536.0%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20.%5Cn%20%20%20%20if%20(gray%20%3E%200.2)%20n%20%3D%2065600.0%3B%20%20%20%20%2F%2F%20%3A%5Cn%20%20%20%20if%20(gray%20%3E%200.3)%20n%20%3D%20332772.0%3B%20%20%20%2F%2F%20*%5Cn%20%20%20%20if%20(gray%20%3E%200.4)%20n%20%3D%2015255086.0%3B%20%2F%2F%20o%5Cn%20%20%20%20if%20(gray%20%3E%200.5)%20n%20%3D%2023385164.0%3B%20%2F%2F%20%26%5Cn%20%20%20%20if%20(gray%20%3E%200.6)%20n%20%3D%2015252014.0%3B%20%2F%2F%208%5Cn%20%20%20%20if%20(gray%20%3E%200.7)%20n%20%3D%2013199452.0%3B%20%2F%2F%20%40%5Cn%20%20%20%20if%20(gray%20%3E%200.8)%20n%20%3D%2011512810.0%3B%20%2F%2F%20%23%5Cn%5Cn%20%20%20%20vec2%20p%20%3D%20mod(%20uv%20%2F%20(%20pixelSize%20*%200.5%20)%2C%202.0)%20-%20vec2(1.0)%3B%5Cn%20%20%20%20col%20%3D%20col%20*%20character(n%2C%20p)%3B%5Cn%5Cn%20%20%20%20gl_FragColor%20%3D%20vec4(col%2C%201.0)%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20dimensions%3A%20%7B%20type%3A%20'4fv'%2C%20value%3A%20new%20Float32Array(%5B0%2C%200%2C%200%2C%200%5D)%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20pixelSize%3A%20%20%7B%20type%3A%20'1f'%2C%20value%3A%208%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%7D%0A%0AAsciiFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0AAsciiFilter.prototype.constructor%20%3D%20AsciiFilter%3B%0Amodule.exports%20%3D%20AsciiFilter%3B%0A%0AObject.defineProperties(AsciiFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20pixel%20size%20used%20by%20the%20filter.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.AsciiFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20size%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.pixelSize.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.pixelSize.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C78%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%2C%0A%20%20%20%20BlurXFilter%20%3D%20require('..%2Fblur%2FBlurXFilter')%2C%0A%20%20%20%20BlurYFilter%20%3D%20require('..%2Fblur%2FBlurYFilter')%3B%0A%0A%2F**%0A%20*%20The%20BloomFilter%20applies%20a%20Gaussian%20blur%20to%20an%20object.%0A%20*%20The%20strength%20of%20the%20blur%20can%20be%20set%20for%20x-%20and%20y-axis%20separately.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20BloomFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this)%3B%0A%0A%20%20%20%20this.blurXFilter%20%3D%20new%20BlurXFilter()%3B%0A%20%20%20%20this.blurYFilter%20%3D%20new%20BlurYFilter()%3B%0A%0A%20%20%20%20this.defaultFilter%20%3D%20new%20core.AbstractFilter()%3B%0A%7D%0A%0ABloomFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0ABloomFilter.prototype.constructor%20%3D%20BloomFilter%3B%0Amodule.exports%20%3D%20BloomFilter%3B%0A%0ABloomFilter.prototype.applyFilter%20%3D%20function%20(renderer%2C%20input%2C%20output)%0A%7B%0A%20%20%20%20var%20renderTarget%20%3D%20renderer.filterManager.getRenderTarget(true)%3B%0A%0A%20%20%20%20%2F%2FTODO%20-%20copyTexSubImage2D%20could%20be%20used%20here%3F%0A%20%20%20%20this.defaultFilter.applyFilter(renderer%2C%20input%2C%20output)%3B%0A%0A%20%20%20%20this.blurXFilter.applyFilter(renderer%2C%20input%2C%20renderTarget)%3B%0A%0A%20%20%20%20renderer.blendModeManager.setBlendMode(core.BLEND_MODES.SCREEN)%3B%0A%0A%20%20%20%20this.blurYFilter.applyFilter(renderer%2C%20renderTarget%2C%20output)%3B%0A%0A%20%20%20%20renderer.blendModeManager.setBlendMode(core.BLEND_MODES.NORMAL)%3B%0A%0A%20%20%20%20renderer.filterManager.returnRenderTarget(renderTarget)%3B%0A%7D%3B%0A%0AObject.defineProperties(BloomFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20strength%20of%20both%20the%20blurX%20and%20blurY%20properties%20simultaneously%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberOf%20PIXI.filters.BloomFilter%23%0A%20%20%20%20%20*%20%40default%202%0A%20%20%20%20%20*%2F%0A%20%20%20%20blur%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.blurXFilter.blur%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blurXFilter.blur%20%3D%20this.blurYFilter.blur%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20strength%20of%20the%20blurX%20property%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberOf%20PIXI.filters.BloomFilter%23%0A%20%20%20%20%20*%20%40default%202%0A%20%20%20%20%20*%2F%0A%20%20%20%20blurX%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.blurXFilter.blur%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blurXFilter.blur%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20strength%20of%20the%20blurY%20property%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberOf%20PIXI.filters.BloomFilter%23%0A%20%20%20%20%20*%20%40default%202%0A%20%20%20%20%20*%2F%0A%20%20%20%20blurY%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.blurYFilter.blur%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blurYFilter.blur%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%2C%22..%2Fblur%2FBlurXFilter%22%3A81%2C%22..%2Fblur%2FBlurYFilter%22%3A82%7D%5D%2C79%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%0A%0A%2F**%0A%20*%20The%20BlurDirFilter%20applies%20a%20Gaussian%20blur%20toward%20a%20direction%20to%20an%20object.%0A%20*%0A%20*%20%40class%0A%20*%20%40param%20%7Bnumber%7D%20dirX%0A%20*%20%40param%20%7Bnumber%7D%20dirY%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20BlurDirFilter(dirX%2C%20dirY)%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20%22attribute%20vec2%20aVertexPosition%3B%5Cnattribute%20vec2%20aTextureCoord%3B%5Cnattribute%20vec4%20aColor%3B%5Cn%5Cnuniform%20float%20strength%3B%5Cnuniform%20float%20dirX%3B%5Cnuniform%20float%20dirY%3B%5Cnuniform%20mat3%20projectionMatrix%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cnvarying%20vec4%20vColor%3B%5Cnvarying%20vec2%20vBlurTexCoords%5B3%5D%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20%20gl_Position%20%3D%20vec4((projectionMatrix%20*%20vec3((aVertexPosition)%2C%201.0)).xy%2C%200.0%2C%201.0)%3B%5Cn%20%20%20%20vTextureCoord%20%3D%20aTextureCoord%3B%5Cn%5Cn%20%20%20%20vBlurTexCoords%5B0%5D%20%3D%20aTextureCoord%20%2B%20vec2(%20(0.004%20*%20strength)%20*%20dirX%2C%20(0.004%20*%20strength)%20*%20dirY%20)%3B%5Cn%20%20%20%20vBlurTexCoords%5B1%5D%20%3D%20aTextureCoord%20%2B%20vec2(%20(0.008%20*%20strength)%20*%20dirX%2C%20(0.008%20*%20strength)%20*%20dirY%20)%3B%5Cn%20%20%20%20vBlurTexCoords%5B2%5D%20%3D%20aTextureCoord%20%2B%20vec2(%20(0.012%20*%20strength)%20*%20dirX%2C%20(0.012%20*%20strength)%20*%20dirY%20)%3B%5Cn%5Cn%20%20%20%20vColor%20%3D%20vec4(aColor.rgb%20*%20aColor.a%2C%20aColor.a)%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20lowp%20float%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cnvarying%20vec2%20vBlurTexCoords%5B3%5D%3B%5Cnvarying%20vec4%20vColor%3B%5Cn%5Cnuniform%20sampler2D%20uSampler%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20%20gl_FragColor%20%3D%20vec4(0.0)%3B%5Cn%5Cn%20%20%20%20gl_FragColor%20%2B%3D%20texture2D(uSampler%2C%20vTextureCoord%20%20%20%20%20)%20*%200.3989422804014327%3B%5Cn%20%20%20%20gl_FragColor%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%200%5D)%20*%200.2419707245191454%3B%5Cn%20%20%20%20gl_FragColor%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%201%5D)%20*%200.05399096651318985%3B%5Cn%20%20%20%20gl_FragColor%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%202%5D)%20*%200.004431848411938341%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20set%20the%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20strength%3A%20%7B%20type%3A%20'1f'%2C%20value%3A%201%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20dirX%3A%20%7B%20type%3A%20'1f'%2C%20value%3A%20dirX%20%7C%7C%200%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20dirY%3A%20%7B%20type%3A%20'1f'%2C%20value%3A%20dirY%20%7C%7C%200%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%0A%20%20%20%20this.defaultFilter%20%3D%20new%20core.AbstractFilter()%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20number%20of%20passes%20for%20blur.%20More%20passes%20means%20higher%20quaility%20bluring.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%201%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.passes%20%3D%201%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20X%20direction%20of%20the%20blur%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.dirX%20%3D%20dirX%20%7C%7C%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20Y%20direction%20of%20the%20blur%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.dirY%20%3D%20dirY%20%7C%7C%200%3B%0A%0A%20%20%20%20this.strength%20%3D%204%3B%0A%7D%0A%0ABlurDirFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0ABlurDirFilter.prototype.constructor%20%3D%20BlurDirFilter%3B%0Amodule.exports%20%3D%20BlurDirFilter%3B%0A%0ABlurDirFilter.prototype.applyFilter%20%3D%20function%20(renderer%2C%20input%2C%20output%2C%20clear)%20%7B%0A%0A%20%20%20%20var%20shader%20%3D%20this.getShader(renderer)%3B%0A%0A%20%20%20%20this.uniforms.strength.value%20%3D%20this.strength%20%2F%204%20%2F%20this.passes%20*%20(input.frame.width%20%2F%20input.size.width)%3B%0A%0A%20%20%20%20if%20(this.passes%20%3D%3D%3D%201)%20%7B%0A%20%20%20%20%20%20%20%20renderer.filterManager.applyFilter(shader%2C%20input%2C%20output%2C%20clear)%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20var%20renderTarget%20%3D%20renderer.filterManager.getRenderTarget(true)%3B%0A%0A%20%20%20%20%20%20%20%20renderer.filterManager.applyFilter(shader%2C%20input%2C%20renderTarget%2C%20clear)%3B%0A%0A%20%20%20%20%20%20%20%20for(var%20i%20%3D%200%3B%20i%20%3C%20this.passes-2%3B%20i%2B%2B)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2Fthis.uniforms.strength.value%20%3D%20this.strength%20%2F%204%20%2F%20(this.passes%2B(i*2))%20*%20(input.frame.width%20%2F%20input.size.width)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderer.filterManager.applyFilter(shader%2C%20renderTarget%2C%20renderTarget%2C%20clear)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20renderer.filterManager.applyFilter(shader%2C%20renderTarget%2C%20output%2C%20clear)%3B%0A%0A%20%20%20%20%20%20%20%20renderer.filterManager.returnRenderTarget(renderTarget)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%0AObject.defineProperties(BlurDirFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20strength%20of%20both%20the%20blur.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.BlurDirFilter%23%0A%20%20%20%20%20*%20%40default%202%0A%20%20%20%20%20*%2F%0A%20%20%20%20blur%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.strength%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.padding%20%3D%20value%20*%200.5%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.strength%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20X%20direction%20of%20the%20blur.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.BlurYFilter%23%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20dirX%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.dirX%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.dirX.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20Y%20direction%20of%20the%20blur.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.BlurDirFilter%23%0A%20%20%20%20%20*%20%40default%200%0A%20%20%20%20%20*%2F%0A%20%20%20%20dirY%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.dirY%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.dirY.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C80%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%2C%0A%20%20%20%20BlurXFilter%20%3D%20require('.%2FBlurXFilter')%2C%0A%20%20%20%20BlurYFilter%20%3D%20require('.%2FBlurYFilter')%3B%0A%0A%2F**%0A%20*%20The%20BlurFilter%20applies%20a%20Gaussian%20blur%20to%20an%20object.%0A%20*%20The%20strength%20of%20the%20blur%20can%20be%20set%20for%20x-%20and%20y-axis%20separately.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20BlurFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this)%3B%0A%0A%20%20%20%20this.blurXFilter%20%3D%20new%20BlurXFilter()%3B%0A%20%20%20%20this.blurYFilter%20%3D%20new%20BlurYFilter()%3B%0A%7D%0A%0ABlurFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0ABlurFilter.prototype.constructor%20%3D%20BlurFilter%3B%0Amodule.exports%20%3D%20BlurFilter%3B%0A%0ABlurFilter.prototype.applyFilter%20%3D%20function%20(renderer%2C%20input%2C%20output)%0A%7B%0A%20%20%20%20var%20renderTarget%20%3D%20renderer.filterManager.getRenderTarget(true)%3B%0A%0A%20%20%20%20this.blurXFilter.applyFilter(renderer%2C%20input%2C%20renderTarget)%3B%0A%20%20%20%20this.blurYFilter.applyFilter(renderer%2C%20renderTarget%2C%20output)%3B%0A%0A%20%20%20%20renderer.filterManager.returnRenderTarget(renderTarget)%3B%0A%7D%3B%0A%0AObject.defineProperties(BlurFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20strength%20of%20both%20the%20blurX%20and%20blurY%20properties%20simultaneously%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberOf%20PIXI.filters.BlurFilter%23%0A%20%20%20%20%20*%20%40default%202%0A%20%20%20%20%20*%2F%0A%20%20%20%20blur%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.blurXFilter.blur%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.padding%20%3D%20Math.abs(value)%20*%200.5%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blurXFilter.blur%20%3D%20this.blurYFilter.blur%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20number%20of%20passes%20for%20blur.%20More%20passes%20means%20higher%20quaility%20bluring.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.BlurYFilter%23%0A%20%20%20%20%20*%20%40default%201%0A%20%20%20%20%20*%2F%0A%20%20%20%20passes%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%20this.blurXFilter.passes%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blurXFilter.passes%20%3D%20this.blurYFilter.passes%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20strength%20of%20the%20blurX%20property%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberOf%20PIXI.filters.BlurFilter%23%0A%20%20%20%20%20*%20%40default%202%0A%20%20%20%20%20*%2F%0A%20%20%20%20blurX%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.blurXFilter.blur%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blurXFilter.blur%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20strength%20of%20the%20blurY%20property%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberOf%20PIXI.filters.BlurFilter%23%0A%20%20%20%20%20*%20%40default%202%0A%20%20%20%20%20*%2F%0A%20%20%20%20blurY%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.blurYFilter.blur%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blurYFilter.blur%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%2C%22.%2FBlurXFilter%22%3A81%2C%22.%2FBlurYFilter%22%3A82%7D%5D%2C81%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20The%20BlurXFilter%20applies%20a%20horizontal%20Gaussian%20blur%20to%20an%20object.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20BlurXFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20%22attribute%20vec2%20aVertexPosition%3B%5Cnattribute%20vec2%20aTextureCoord%3B%5Cnattribute%20vec4%20aColor%3B%5Cn%5Cnuniform%20float%20strength%3B%5Cnuniform%20mat3%20projectionMatrix%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cnvarying%20vec4%20vColor%3B%5Cnvarying%20vec2%20vBlurTexCoords%5B6%5D%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20%20gl_Position%20%3D%20vec4((projectionMatrix%20*%20vec3((aVertexPosition)%2C%201.0)).xy%2C%200.0%2C%201.0)%3B%5Cn%20%20%20%20vTextureCoord%20%3D%20aTextureCoord%3B%5Cn%5Cn%20%20%20%20vBlurTexCoords%5B%200%5D%20%3D%20aTextureCoord%20%2B%20vec2(-0.012%20*%20strength%2C%200.0)%3B%5Cn%20%20%20%20vBlurTexCoords%5B%201%5D%20%3D%20aTextureCoord%20%2B%20vec2(-0.008%20*%20strength%2C%200.0)%3B%5Cn%20%20%20%20vBlurTexCoords%5B%202%5D%20%3D%20aTextureCoord%20%2B%20vec2(-0.004%20*%20strength%2C%200.0)%3B%5Cn%20%20%20%20vBlurTexCoords%5B%203%5D%20%3D%20aTextureCoord%20%2B%20vec2(%200.004%20*%20strength%2C%200.0)%3B%5Cn%20%20%20%20vBlurTexCoords%5B%204%5D%20%3D%20aTextureCoord%20%2B%20vec2(%200.008%20*%20strength%2C%200.0)%3B%5Cn%20%20%20%20vBlurTexCoords%5B%205%5D%20%3D%20aTextureCoord%20%2B%20vec2(%200.012%20*%20strength%2C%200.0)%3B%5Cn%5Cn%20%20%20%20vColor%20%3D%20vec4(aColor.rgb%20*%20aColor.a%2C%20aColor.a)%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20lowp%20float%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cnvarying%20vec2%20vBlurTexCoords%5B6%5D%3B%5Cnvarying%20vec4%20vColor%3B%5Cn%5Cnuniform%20sampler2D%20uSampler%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20%20gl_FragColor%20%3D%20vec4(0.0)%3B%5Cn%5Cn%20%20%20%20gl_FragColor%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%200%5D)*0.004431848411938341%3B%5Cn%20%20%20%20gl_FragColor%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%201%5D)*0.05399096651318985%3B%5Cn%20%20%20%20gl_FragColor%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%202%5D)*0.2419707245191454%3B%5Cn%20%20%20%20gl_FragColor%20%2B%3D%20texture2D(uSampler%2C%20vTextureCoord%20%20%20%20%20)*0.3989422804014327%3B%5Cn%20%20%20%20gl_FragColor%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%203%5D)*0.2419707245191454%3B%5Cn%20%20%20%20gl_FragColor%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%204%5D)*0.05399096651318985%3B%5Cn%20%20%20%20gl_FragColor%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%205%5D)*0.004431848411938341%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20set%20the%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20strength%3A%20%7B%20type%3A%20'1f'%2C%20value%3A%201%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20number%20of%20passes%20for%20blur.%20More%20passes%20means%20higher%20quaility%20bluring.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%201%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.passes%20%3D%201%3B%0A%0A%20%20%20%20this.strength%20%3D%204%3B%0A%7D%0A%0ABlurXFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0ABlurXFilter.prototype.constructor%20%3D%20BlurXFilter%3B%0Amodule.exports%20%3D%20BlurXFilter%3B%0A%0ABlurXFilter.prototype.applyFilter%20%3D%20function%20(renderer%2C%20input%2C%20output%2C%20clear)%0A%7B%0A%20%20%20%20var%20shader%20%3D%20this.getShader(renderer)%3B%0A%0A%20%20%20%20this.uniforms.strength.value%20%3D%20this.strength%20%2F%204%20%2F%20this.passes%20*%20(input.frame.width%20%2F%20input.size.width)%3B%0A%0A%20%20%20%20if(this.passes%20%3D%3D%3D%201)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20renderer.filterManager.applyFilter(shader%2C%20input%2C%20output%2C%20clear)%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20renderTarget%20%3D%20renderer.filterManager.getRenderTarget(true)%3B%0A%20%20%20%20%20%20%20%20var%20flip%20%3D%20input%3B%0A%20%20%20%20%20%20%20%20var%20flop%20%3D%20renderTarget%3B%0A%0A%20%20%20%20%20%20%20%20for(var%20i%20%3D%200%3B%20i%20%3C%20this.passes-1%3B%20i%2B%2B)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderer.filterManager.applyFilter(shader%2C%20flip%2C%20flop%2C%20true)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20var%20temp%20%3D%20flop%3B%0A%20%20%20%20%20%20%20%20%20%20%20flop%20%3D%20flip%3B%0A%20%20%20%20%20%20%20%20%20%20%20flip%20%3D%20temp%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20renderer.filterManager.applyFilter(shader%2C%20flip%2C%20output%2C%20clear)%3B%0A%0A%20%20%20%20%20%20%20%20renderer.filterManager.returnRenderTarget(renderTarget)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%0AObject.defineProperties(BlurXFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20strength%20of%20both%20the%20blur.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.BlurXFilter%23%0A%20%20%20%20%20*%20%40default%202%0A%20%20%20%20%20*%2F%0A%20%20%20%20blur%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%20this.strength%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.padding%20%3D%20%20Math.abs(value)%20*%200.5%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.strength%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C82%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20The%20BlurYFilter%20applies%20a%20horizontal%20Gaussian%20blur%20to%20an%20object.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20BlurYFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20%22attribute%20vec2%20aVertexPosition%3B%5Cnattribute%20vec2%20aTextureCoord%3B%5Cnattribute%20vec4%20aColor%3B%5Cn%5Cnuniform%20float%20strength%3B%5Cnuniform%20mat3%20projectionMatrix%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cnvarying%20vec4%20vColor%3B%5Cnvarying%20vec2%20vBlurTexCoords%5B6%5D%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20%20gl_Position%20%3D%20vec4((projectionMatrix%20*%20vec3((aVertexPosition)%2C%201.0)).xy%2C%200.0%2C%201.0)%3B%5Cn%20%20%20%20vTextureCoord%20%3D%20aTextureCoord%3B%5Cn%5Cn%20%20%20%20vBlurTexCoords%5B%200%5D%20%3D%20aTextureCoord%20%2B%20vec2(0.0%2C%20-0.012%20*%20strength)%3B%5Cn%20%20%20%20vBlurTexCoords%5B%201%5D%20%3D%20aTextureCoord%20%2B%20vec2(0.0%2C%20-0.008%20*%20strength)%3B%5Cn%20%20%20%20vBlurTexCoords%5B%202%5D%20%3D%20aTextureCoord%20%2B%20vec2(0.0%2C%20-0.004%20*%20strength)%3B%5Cn%20%20%20%20vBlurTexCoords%5B%203%5D%20%3D%20aTextureCoord%20%2B%20vec2(0.0%2C%20%200.004%20*%20strength)%3B%5Cn%20%20%20%20vBlurTexCoords%5B%204%5D%20%3D%20aTextureCoord%20%2B%20vec2(0.0%2C%20%200.008%20*%20strength)%3B%5Cn%20%20%20%20vBlurTexCoords%5B%205%5D%20%3D%20aTextureCoord%20%2B%20vec2(0.0%2C%20%200.012%20*%20strength)%3B%5Cn%5Cn%20%20%20vColor%20%3D%20vec4(aColor.rgb%20*%20aColor.a%2C%20aColor.a)%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20lowp%20float%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cnvarying%20vec2%20vBlurTexCoords%5B6%5D%3B%5Cnvarying%20vec4%20vColor%3B%5Cn%5Cnuniform%20sampler2D%20uSampler%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20%20gl_FragColor%20%3D%20vec4(0.0)%3B%5Cn%5Cn%20%20%20%20gl_FragColor%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%200%5D)*0.004431848411938341%3B%5Cn%20%20%20%20gl_FragColor%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%201%5D)*0.05399096651318985%3B%5Cn%20%20%20%20gl_FragColor%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%202%5D)*0.2419707245191454%3B%5Cn%20%20%20%20gl_FragColor%20%2B%3D%20texture2D(uSampler%2C%20vTextureCoord%20%20%20%20%20)*0.3989422804014327%3B%5Cn%20%20%20%20gl_FragColor%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%203%5D)*0.2419707245191454%3B%5Cn%20%20%20%20gl_FragColor%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%204%5D)*0.05399096651318985%3B%5Cn%20%20%20%20gl_FragColor%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%205%5D)*0.004431848411938341%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20set%20the%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20strength%3A%20%7B%20type%3A%20'1f'%2C%20value%3A%201%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%0A%20%20%20%20this.passes%20%3D%201%3B%0A%20%20%20%20this.strength%20%3D%204%3B%0A%7D%0A%0ABlurYFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0ABlurYFilter.prototype.constructor%20%3D%20BlurYFilter%3B%0Amodule.exports%20%3D%20BlurYFilter%3B%0A%0ABlurYFilter.prototype.applyFilter%20%3D%20function%20(renderer%2C%20input%2C%20output%2C%20clear)%0A%7B%0A%20%20%20%20var%20shader%20%3D%20this.getShader(renderer)%3B%0A%0A%20%20%20%20this.uniforms.strength.value%20%3D%20Math.abs(this.strength)%20%2F%204%20%2F%20this.passes%20*%20(input.frame.height%20%2F%20input.size.height)%3B%0A%0A%20%20%20%20if(this.passes%20%3D%3D%3D%201)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20renderer.filterManager.applyFilter(shader%2C%20input%2C%20output%2C%20clear)%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20renderTarget%20%3D%20renderer.filterManager.getRenderTarget(true)%3B%0A%20%20%20%20%20%20%20%20var%20flip%20%3D%20input%3B%0A%20%20%20%20%20%20%20%20var%20flop%20%3D%20renderTarget%3B%0A%0A%20%20%20%20%20%20%20%20for(var%20i%20%3D%200%3B%20i%20%3C%20this.passes-1%3B%20i%2B%2B)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderer.filterManager.applyFilter(shader%2C%20flip%2C%20flop%2C%20true)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20var%20temp%20%3D%20flop%3B%0A%20%20%20%20%20%20%20%20%20%20%20flop%20%3D%20flip%3B%0A%20%20%20%20%20%20%20%20%20%20%20flip%20%3D%20temp%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20renderer.filterManager.applyFilter(shader%2C%20flip%2C%20output%2C%20clear)%3B%0A%0A%20%20%20%20%20%20%20%20renderer.filterManager.returnRenderTarget(renderTarget)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%0AObject.defineProperties(BlurYFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20strength%20of%20both%20the%20blur.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.BlurYFilter%23%0A%20%20%20%20%20*%20%40default%202%0A%20%20%20%20%20*%2F%0A%20%20%20%20blur%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%20this.strength%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.padding%20%3D%20Math.abs(value)%20*%200.5%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.strength%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C83%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20A%20Smart%20Blur%20Filter.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20SmartBlurFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20null%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20mediump%20float%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cn%5Cnuniform%20sampler2D%20uSampler%3B%5Cnuniform%20vec2%20delta%3B%5Cn%5Cnfloat%20random(vec3%20scale%2C%20float%20seed)%5Cn%7B%5Cn%20%20%20%20return%20fract(sin(dot(gl_FragCoord.xyz%20%2B%20seed%2C%20scale))%20*%2043758.5453%20%2B%20seed)%3B%5Cn%7D%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20%20vec4%20color%20%3D%20vec4(0.0)%3B%5Cn%20%20%20%20float%20total%20%3D%200.0%3B%5Cn%5Cn%20%20%20%20float%20offset%20%3D%20random(vec3(12.9898%2C%2078.233%2C%20151.7182)%2C%200.0)%3B%5Cn%5Cn%20%20%20%20for%20(float%20t%20%3D%20-30.0%3B%20t%20%3C%3D%2030.0%3B%20t%2B%2B)%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20float%20percent%20%3D%20(t%20%2B%20offset%20-%200.5)%20%2F%2030.0%3B%5Cn%20%20%20%20%20%20%20%20float%20weight%20%3D%201.0%20-%20abs(percent)%3B%5Cn%20%20%20%20%20%20%20%20vec4%20sample%20%3D%20texture2D(uSampler%2C%20vTextureCoord%20%2B%20delta%20*%20percent)%3B%5Cn%20%20%20%20%20%20%20%20sample.rgb%20*%3D%20sample.a%3B%5Cn%20%20%20%20%20%20%20%20color%20%2B%3D%20sample%20*%20weight%3B%5Cn%20%20%20%20%20%20%20%20total%20%2B%3D%20weight%3B%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20gl_FragColor%20%3D%20color%20%2F%20total%3B%5Cn%20%20%20%20gl_FragColor.rgb%20%2F%3D%20gl_FragColor.a%20%2B%200.00001%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20delta%3A%20%7B%20type%3A%20'v2'%2C%20value%3A%20%7B%20x%3A%200.1%2C%20y%3A%200.0%20%7D%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%7D%0A%0ASmartBlurFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0ASmartBlurFilter.prototype.constructor%20%3D%20SmartBlurFilter%3B%0Amodule.exports%20%3D%20SmartBlurFilter%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C84%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20The%20ColorMatrixFilter%20class%20lets%20you%20apply%20a%205x4%20matrix%20transformation%20on%20the%20RGBA%0A%20*%20color%20and%20alpha%20values%20of%20every%20pixel%20on%20your%20displayObject%20to%20produce%20a%20result%0A%20*%20with%20a%20new%20set%20of%20RGBA%20color%20and%20alpha%20values.%20It's%20pretty%20powerful!%0A%20*%0A%20*%20%60%60%60js%0A%20*%20%20var%20colorMatrix%20%3D%20new%20PIXI.ColorMatrixFilter()%3B%0A%20*%20%20container.filters%20%3D%20%5BcolorMatrix%5D%3B%0A%20*%20%20colorMatrix.contrast(2)%3B%0A%20*%20%60%60%60%0A%20*%20%40author%20Cl%C3%A9ment%20Chenebault%20%3Cclement%40goodboydigital.com%3E%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20ColorMatrixFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20null%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20mediump%20float%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cnuniform%20sampler2D%20uSampler%3B%5Cnuniform%20float%20m%5B25%5D%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%5Cn%20%20%20%20vec4%20c%20%3D%20texture2D(uSampler%2C%20vTextureCoord)%3B%5Cn%5Cn%20%20%20%20gl_FragColor.r%20%3D%20(m%5B0%5D%20*%20c.r)%3B%5Cn%20%20%20%20%20%20%20%20gl_FragColor.r%20%2B%3D%20(m%5B1%5D%20*%20c.g)%3B%5Cn%20%20%20%20%20%20%20%20gl_FragColor.r%20%2B%3D%20(m%5B2%5D%20*%20c.b)%3B%5Cn%20%20%20%20%20%20%20%20gl_FragColor.r%20%2B%3D%20(m%5B3%5D%20*%20c.a)%3B%5Cn%20%20%20%20%20%20%20%20gl_FragColor.r%20%2B%3D%20m%5B4%5D%3B%5Cn%5Cn%20%20%20%20gl_FragColor.g%20%3D%20(m%5B5%5D%20*%20c.r)%3B%5Cn%20%20%20%20%20%20%20%20gl_FragColor.g%20%2B%3D%20(m%5B6%5D%20*%20c.g)%3B%5Cn%20%20%20%20%20%20%20%20gl_FragColor.g%20%2B%3D%20(m%5B7%5D%20*%20c.b)%3B%5Cn%20%20%20%20%20%20%20%20gl_FragColor.g%20%2B%3D%20(m%5B8%5D%20*%20c.a)%3B%5Cn%20%20%20%20%20%20%20%20gl_FragColor.g%20%2B%3D%20m%5B9%5D%3B%5Cn%5Cn%20%20%20%20%20gl_FragColor.b%20%3D%20(m%5B10%5D%20*%20c.r)%3B%5Cn%20%20%20%20%20%20%20%20gl_FragColor.b%20%2B%3D%20(m%5B11%5D%20*%20c.g)%3B%5Cn%20%20%20%20%20%20%20%20gl_FragColor.b%20%2B%3D%20(m%5B12%5D%20*%20c.b)%3B%5Cn%20%20%20%20%20%20%20%20gl_FragColor.b%20%2B%3D%20(m%5B13%5D%20*%20c.a)%3B%5Cn%20%20%20%20%20%20%20%20gl_FragColor.b%20%2B%3D%20m%5B14%5D%3B%5Cn%5Cn%20%20%20%20%20gl_FragColor.a%20%3D%20(m%5B15%5D%20*%20c.r)%3B%5Cn%20%20%20%20%20%20%20%20gl_FragColor.a%20%2B%3D%20(m%5B16%5D%20*%20c.g)%3B%5Cn%20%20%20%20%20%20%20%20gl_FragColor.a%20%2B%3D%20(m%5B17%5D%20*%20c.b)%3B%5Cn%20%20%20%20%20%20%20%20gl_FragColor.a%20%2B%3D%20(m%5B18%5D%20*%20c.a)%3B%5Cn%20%20%20%20%20%20%20%20gl_FragColor.a%20%2B%3D%20m%5B19%5D%3B%5Cn%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20m%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20type%3A%20'1fv'%2C%20value%3A%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%201%2C%200%2C%200%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%200%2C%201%2C%200%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%200%2C%200%2C%201%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%200%2C%200%2C%200%2C%201%2C%200%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%7D%0A%0AColorMatrixFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0AColorMatrixFilter.prototype.constructor%20%3D%20ColorMatrixFilter%3B%0Amodule.exports%20%3D%20ColorMatrixFilter%3B%0A%0A%0A%2F**%0A%20*%20Transforms%20current%20matrix%20and%20set%20the%20new%20one%0A%20*%0A%20*%20%40param%20matrix%20%7Bnumber%5B%5D%7D%20(mat%205x4)%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20if%20true%2C%20current%20matrix%20and%20matrix%20are%20multiplied.%20If%20false%2C%20just%20set%20the%20current%20matrix%20with%20%40param%20matrix%0A%20*%2F%0AColorMatrixFilter.prototype._loadMatrix%20%3D%20function%20(matrix%2C%20multiply)%0A%7B%0A%20%20%20%20multiply%20%3D%20!!multiply%3B%0A%0A%20%20%20%20var%20newMatrix%20%3D%20matrix%3B%0A%0A%20%20%20%20if%20(multiply)%20%7B%0A%20%20%20%20%20%20%20%20this._multiply(newMatrix%2C%20this.uniforms.m.value%2C%20matrix)%3B%0A%20%20%20%20%20%20%20%20newMatrix%20%3D%20this._colorMatrix(newMatrix)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20set%20the%20new%20matrix%0A%20%20%20%20this.uniforms.m.value%20%3D%20newMatrix%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Multiplies%20two%20mat5's%0A%20*%0A%20*%20%40param%20out%20%7Bnumber%5B%5D%7D%20(mat%205x4)%20the%20receiving%20matrix%0A%20*%20%40param%20a%20%7Bnumber%5B%5D%7D%20(mat%205x4)%20the%20first%20operand%0A%20*%20%40param%20b%20%7Bnumber%5B%5D%7D%20(mat%205x4)%20the%20second%20operand%0A%20*%20%40returns%20out%20%7Bnumber%5B%5D%7D%20(mat%205x4)%0A%20*%2F%0AColorMatrixFilter.prototype._multiply%20%3D%20function%20(out%2C%20a%2C%20b)%0A%7B%0A%0A%20%20%20%20%2F%2F%20Red%20Channel%0A%20%20%20%20out%5B0%5D%20%3D%20(a%5B0%5D%20*%20b%5B0%5D)%20%2B%20(a%5B1%5D%20*%20b%5B5%5D)%20%2B%20(a%5B2%5D%20*%20b%5B10%5D)%20%2B%20(a%5B3%5D%20*%20b%5B15%5D)%3B%0A%20%20%20%20out%5B1%5D%20%3D%20(a%5B0%5D%20*%20b%5B1%5D)%20%2B%20(a%5B1%5D%20*%20b%5B6%5D)%20%2B%20(a%5B2%5D%20*%20b%5B11%5D)%20%2B%20(a%5B3%5D%20*%20b%5B16%5D)%3B%0A%20%20%20%20out%5B2%5D%20%3D%20(a%5B0%5D%20*%20b%5B2%5D)%20%2B%20(a%5B1%5D%20*%20b%5B7%5D)%20%2B%20(a%5B2%5D%20*%20b%5B12%5D)%20%2B%20(a%5B3%5D%20*%20b%5B17%5D)%3B%0A%20%20%20%20out%5B3%5D%20%3D%20(a%5B0%5D%20*%20b%5B3%5D)%20%2B%20(a%5B1%5D%20*%20b%5B8%5D)%20%2B%20(a%5B2%5D%20*%20b%5B13%5D)%20%2B%20(a%5B3%5D%20*%20b%5B18%5D)%3B%0A%20%20%20%20out%5B4%5D%20%3D%20(a%5B0%5D%20*%20b%5B4%5D)%20%2B%20(a%5B1%5D%20*%20b%5B9%5D)%20%2B%20(a%5B2%5D%20*%20b%5B14%5D)%20%2B%20(a%5B3%5D%20*%20b%5B19%5D)%3B%0A%0A%20%20%20%20%2F%2F%20Green%20Channel%0A%20%20%20%20out%5B5%5D%20%3D%20(a%5B5%5D%20*%20b%5B0%5D)%20%2B%20(a%5B6%5D%20*%20b%5B5%5D)%20%2B%20(a%5B7%5D%20*%20b%5B10%5D)%20%2B%20(a%5B8%5D%20*%20b%5B15%5D)%3B%0A%20%20%20%20out%5B6%5D%20%3D%20(a%5B5%5D%20*%20b%5B1%5D)%20%2B%20(a%5B6%5D%20*%20b%5B6%5D)%20%2B%20(a%5B7%5D%20*%20b%5B11%5D)%20%2B%20(a%5B8%5D%20*%20b%5B16%5D)%3B%0A%20%20%20%20out%5B7%5D%20%3D%20(a%5B5%5D%20*%20b%5B2%5D)%20%2B%20(a%5B6%5D%20*%20b%5B7%5D)%20%2B%20(a%5B7%5D%20*%20b%5B12%5D)%20%2B%20(a%5B8%5D%20*%20b%5B17%5D)%3B%0A%20%20%20%20out%5B8%5D%20%3D%20(a%5B5%5D%20*%20b%5B3%5D)%20%2B%20(a%5B6%5D%20*%20b%5B8%5D)%20%2B%20(a%5B7%5D%20*%20b%5B13%5D)%20%2B%20(a%5B8%5D%20*%20b%5B18%5D)%3B%0A%20%20%20%20out%5B9%5D%20%3D%20(a%5B5%5D%20*%20b%5B4%5D)%20%2B%20(a%5B6%5D%20*%20b%5B9%5D)%20%2B%20(a%5B7%5D%20*%20b%5B14%5D)%20%2B%20(a%5B8%5D%20*%20b%5B19%5D)%3B%0A%0A%20%20%20%20%2F%2F%20Blue%20Channel%0A%20%20%20%20out%5B10%5D%20%3D%20(a%5B10%5D%20*%20b%5B0%5D)%20%2B%20(a%5B11%5D%20*%20b%5B5%5D)%20%2B%20(a%5B12%5D%20*%20b%5B10%5D)%20%2B%20(a%5B13%5D%20*%20b%5B15%5D)%3B%0A%20%20%20%20out%5B11%5D%20%3D%20(a%5B10%5D%20*%20b%5B1%5D)%20%2B%20(a%5B11%5D%20*%20b%5B6%5D)%20%2B%20(a%5B12%5D%20*%20b%5B11%5D)%20%2B%20(a%5B13%5D%20*%20b%5B16%5D)%3B%0A%20%20%20%20out%5B12%5D%20%3D%20(a%5B10%5D%20*%20b%5B2%5D)%20%2B%20(a%5B11%5D%20*%20b%5B7%5D)%20%2B%20(a%5B12%5D%20*%20b%5B12%5D)%20%2B%20(a%5B13%5D%20*%20b%5B17%5D)%3B%0A%20%20%20%20out%5B13%5D%20%3D%20(a%5B10%5D%20*%20b%5B3%5D)%20%2B%20(a%5B11%5D%20*%20b%5B8%5D)%20%2B%20(a%5B12%5D%20*%20b%5B13%5D)%20%2B%20(a%5B13%5D%20*%20b%5B18%5D)%3B%0A%20%20%20%20out%5B14%5D%20%3D%20(a%5B10%5D%20*%20b%5B4%5D)%20%2B%20(a%5B11%5D%20*%20b%5B9%5D)%20%2B%20(a%5B12%5D%20*%20b%5B14%5D)%20%2B%20(a%5B13%5D%20*%20b%5B19%5D)%3B%0A%0A%20%20%20%20%2F%2F%20Alpha%20Channel%0A%20%20%20%20out%5B15%5D%20%3D%20(a%5B15%5D%20*%20b%5B0%5D)%20%2B%20(a%5B16%5D%20*%20b%5B5%5D)%20%2B%20(a%5B17%5D%20*%20b%5B10%5D)%20%2B%20(a%5B18%5D%20*%20b%5B15%5D)%3B%0A%20%20%20%20out%5B16%5D%20%3D%20(a%5B15%5D%20*%20b%5B1%5D)%20%2B%20(a%5B16%5D%20*%20b%5B6%5D)%20%2B%20(a%5B17%5D%20*%20b%5B11%5D)%20%2B%20(a%5B18%5D%20*%20b%5B16%5D)%3B%0A%20%20%20%20out%5B17%5D%20%3D%20(a%5B15%5D%20*%20b%5B2%5D)%20%2B%20(a%5B16%5D%20*%20b%5B7%5D)%20%2B%20(a%5B17%5D%20*%20b%5B12%5D)%20%2B%20(a%5B18%5D%20*%20b%5B17%5D)%3B%0A%20%20%20%20out%5B18%5D%20%3D%20(a%5B15%5D%20*%20b%5B3%5D)%20%2B%20(a%5B16%5D%20*%20b%5B8%5D)%20%2B%20(a%5B17%5D%20*%20b%5B13%5D)%20%2B%20(a%5B18%5D%20*%20b%5B18%5D)%3B%0A%20%20%20%20out%5B19%5D%20%3D%20(a%5B15%5D%20*%20b%5B4%5D)%20%2B%20(a%5B16%5D%20*%20b%5B9%5D)%20%2B%20(a%5B17%5D%20*%20b%5B14%5D)%20%2B%20(a%5B18%5D%20*%20b%5B19%5D)%3B%0A%0A%20%20%20%20return%20out%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Create%20a%20Float32%20Array%20and%20normalize%20the%20offset%20component%20to%200-1%0A%20*%0A%20*%20%40param%20matrix%20%7Bnumber%5B%5D%7D%20(mat%205x4)%0A%20*%20%40return%20m%20%7Bnumber%5B%5D%7D%20(mat%205x4)%20with%20all%20values%20between%200-1%0A%20*%2F%0AColorMatrixFilter.prototype._colorMatrix%20%3D%20function%20(matrix)%0A%7B%0A%20%20%20%20%2F%2F%20Create%20a%20Float32%20Array%20and%20normalize%20the%20offset%20component%20to%200-1%0A%20%20%20%20var%20m%20%3D%20new%20Float32Array(matrix)%3B%0A%20%20%20%20m%5B4%5D%20%2F%3D%20255%3B%0A%20%20%20%20m%5B9%5D%20%2F%3D%20255%3B%0A%20%20%20%20m%5B14%5D%20%2F%3D%20255%3B%0A%20%20%20%20m%5B19%5D%20%2F%3D%20255%3B%0A%0A%20%20%20%20return%20m%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Adjusts%20brightness%0A%20*%0A%20*%20%40param%20b%20%7Bnumber%7D%20value%20of%20the%20brigthness%20(0%20is%20black)%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20refer%20to%20._loadMatrix()%20method%0A%20*%2F%0AColorMatrixFilter.prototype.brightness%20%3D%20function%20(b%2C%20multiply)%0A%7B%0A%20%20%20%20var%20matrix%20%3D%20%5B%0A%20%20%20%20%20%20%20%20b%2C%200%2C%200%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200%2C%20b%2C%200%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%20b%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%200%2C%201%2C%200%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20this._loadMatrix(matrix%2C%20multiply)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Set%20the%20matrices%20in%20grey%20scales%0A%20*%0A%20*%20%40param%20scale%20%7Bnumber%7D%20value%20of%20the%20grey%20(0%20is%20black)%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20refer%20to%20._loadMatrix()%20method%0A%20*%2F%0AColorMatrixFilter.prototype.greyscale%20%3D%20function%20(scale%2C%20multiply)%0A%7B%0A%20%20%20%20var%20matrix%20%3D%20%5B%0A%20%20%20%20%20%20%20%20scale%2C%20scale%2C%20scale%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%20scale%2C%20scale%2C%20scale%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%20scale%2C%20scale%2C%20scale%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%200%2C%201%2C%200%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20this._loadMatrix(matrix%2C%20multiply)%3B%0A%7D%3B%0A%2F%2FAmericanized%20alias%0AColorMatrixFilter.prototype.grayscale%20%3D%20ColorMatrixFilter.prototype.greyscale%3B%0A%0A%2F**%0A%20*%20Set%20the%20black%20and%20white%20matrice%0A%20*%20Multiply%20the%20current%20matrix%0A%20*%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20refer%20to%20._loadMatrix()%20method%0A%20*%2F%0AColorMatrixFilter.prototype.blackAndWhite%20%3D%20function%20(multiply)%0A%7B%0A%20%20%20%20var%20matrix%20%3D%20%5B%0A%20%20%20%20%20%20%20%200.3%2C%200.6%2C%200.1%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200.3%2C%200.6%2C%200.1%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200.3%2C%200.6%2C%200.1%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%200%2C%201%2C%200%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20this._loadMatrix(matrix%2C%20multiply)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Set%20the%20hue%20property%20of%20the%20color%0A%20*%0A%20*%20%40param%20rotation%20%7Bnumber%7D%20in%20degrees%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20refer%20to%20._loadMatrix()%20method%0A%20*%2F%0AColorMatrixFilter.prototype.hue%20%3D%20function%20(rotation%2C%20multiply)%0A%7B%0A%20%20%20%20rotation%20%3D%20(rotation%20%7C%7C%200)%20%2F%20180%20*%20Math.PI%3B%0A%20%20%20%20var%20cos%20%3D%20Math.cos(rotation)%2C%0A%20%20%20%20%20%20%20%20sin%20%3D%20Math.sin(rotation)%3B%0A%0A%20%20%20%20%2F%2F%20luminanceRed%2C%20luminanceGreen%2C%20luminanceBlue%0A%20%20%20%20var%20lumR%20%3D%200.213%2C%20%2F%2F%20or%200.3086%0A%20%20%20%20%20%20%20%20lumG%20%3D%200.715%2C%20%2F%2F%20or%200.6094%0A%20%20%20%20%20%20%20%20lumB%20%3D%200.072%3B%20%2F%2F%20or%200.0820%0A%0A%20%20%20%20var%20matrix%20%3D%20%5B%0A%20%20%20%20%20%20%20%20lumR%20%2B%20cos%20*%20(1%20-%20lumR)%20%2B%20sin%20*%20(-lumR)%2C%20lumG%20%2B%20cos%20*%20(-lumG)%20%2B%20sin%20*%20(-lumG)%2C%20lumB%20%2B%20cos%20*%20(-lumB)%20%2B%20sin%20*%20(1%20-%20lumB)%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%20lumR%20%2B%20cos%20*%20(-lumR)%20%2B%20sin%20*%20(0.143)%2C%20lumG%20%2B%20cos%20*%20(1%20-%20lumG)%20%2B%20sin%20*%20(0.140)%2C%20lumB%20%2B%20cos%20*%20(-lumB)%20%2B%20sin%20*%20(-0.283)%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%20lumR%20%2B%20cos%20*%20(-lumR)%20%2B%20sin%20*%20(-(1%20-%20lumR))%2C%20lumG%20%2B%20cos%20*%20(-lumG)%20%2B%20sin%20*%20(lumG)%2C%20lumB%20%2B%20cos%20*%20(1%20-%20lumB)%20%2B%20sin%20*%20(lumB)%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%200%2C%201%2C%200%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20this._loadMatrix(matrix%2C%20multiply)%3B%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Set%20the%20contrast%20matrix%2C%20increase%20the%20separation%20between%20dark%20and%20bright%0A%20*%20Increase%20contrast%20%3A%20shadows%20darker%20and%20highlights%20brighter%0A%20*%20Decrease%20contrast%20%3A%20bring%20the%20shadows%20up%20and%20the%20highlights%20down%0A%20*%0A%20*%20%40param%20amount%20%7Bnumber%7D%20value%20of%20the%20contrast%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20refer%20to%20._loadMatrix()%20method%0A%20*%2F%0AColorMatrixFilter.prototype.contrast%20%3D%20function%20(amount%2C%20multiply)%0A%7B%0A%20%20%20%20var%20v%20%3D%20(amount%20%7C%7C%200)%20%2B%201%3B%0A%20%20%20%20var%20o%20%3D%20-128%20*%20(v%20-%201)%3B%0A%0A%20%20%20%20var%20matrix%20%3D%20%5B%0A%20%20%20%20%20%20%20%20v%2C%200%2C%200%2C%200%2C%20o%2C%0A%20%20%20%20%20%20%20%200%2C%20v%2C%200%2C%200%2C%20o%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%20v%2C%200%2C%20o%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%200%2C%201%2C%200%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20this._loadMatrix(matrix%2C%20multiply)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Set%20the%20saturation%20matrix%2C%20increase%20the%20separation%20between%20colors%0A%20*%20Increase%20saturation%20%3A%20increase%20contrast%2C%20brightness%2C%20and%20sharpness%0A%20*%0A%20*%20%40param%20amount%20%7Bnumber%7D%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20refer%20to%20._loadMatrix()%20method%0A%20*%2F%0AColorMatrixFilter.prototype.saturate%20%3D%20function%20(amount%2C%20multiply)%0A%7B%0A%20%20%20%20var%20x%20%3D%20(amount%20%7C%7C%200)%20*%202%20%2F%203%20%2B%201%3B%0A%20%20%20%20var%20y%20%3D%20((x%20-%201)%20*%20-0.5)%3B%0A%0A%20%20%20%20var%20matrix%20%3D%20%5B%0A%20%20%20%20%20%20%20%20x%2C%20y%2C%20y%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%20y%2C%20x%2C%20y%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%20y%2C%20y%2C%20x%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%200%2C%201%2C%200%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20this._loadMatrix(matrix%2C%20multiply)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Desaturate%20image%20(remove%20color)%0A%20*%0A%20*%20Call%20the%20saturate%20function%0A%20*%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20refer%20to%20._loadMatrix()%20method%0A%20*%2F%0AColorMatrixFilter.prototype.desaturate%20%3D%20function%20(multiply)%20%2F%2F%20jshint%20unused%3Afalse%0A%7B%0A%20%20%20%20this.saturate(-1)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Negative%20image%20(inverse%20of%20classic%20rgb%20matrix)%0A%20*%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20refer%20to%20._loadMatrix()%20method%0A%20*%2F%0AColorMatrixFilter.prototype.negative%20%3D%20function%20(multiply)%0A%7B%0A%20%20%20%20var%20matrix%20%3D%20%5B%0A%20%20%20%20%20%20%20%200%2C%201%2C%201%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%201%2C%200%2C%201%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%201%2C%201%2C%200%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%200%2C%201%2C%200%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20this._loadMatrix(matrix%2C%20multiply)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Sepia%20image%0A%20*%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20refer%20to%20._loadMatrix()%20method%0A%20*%2F%0AColorMatrixFilter.prototype.sepia%20%3D%20function%20(multiply)%0A%7B%0A%20%20%20%20var%20matrix%20%3D%20%5B%0A%20%20%20%20%20%20%20%200.393%2C%200.7689999%2C%200.18899999%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200.349%2C%200.6859999%2C%200.16799999%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200.272%2C%200.5339999%2C%200.13099999%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%200%2C%201%2C%200%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20this._loadMatrix(matrix%2C%20multiply)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Color%20motion%20picture%20process%20invented%20in%201916%20(thanks%20Dominic%20Szablewski)%0A%20*%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20refer%20to%20._loadMatrix()%20method%0A%20*%2F%0AColorMatrixFilter.prototype.technicolor%20%3D%20function%20(multiply)%0A%7B%0A%20%20%20%20var%20matrix%20%3D%20%5B%0A%20%20%20%20%20%20%20%201.9125277891456083%2C%20-0.8545344976951645%2C%20-0.09155508482755585%2C%200%2C%2011.793603434377337%2C%0A%20%20%20%20%20%20%20%20-0.3087833385928097%2C%201.7658908555458428%2C%20-0.10601743074722245%2C%200%2C%20-70.35205161461398%2C%0A%20%20%20%20%20%20%20%20-0.231103377548616%2C%20-0.7501899197440212%2C%201.847597816108189%2C%200%2C%2030.950940869491138%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%200%2C%201%2C%200%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20this._loadMatrix(matrix%2C%20multiply)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Polaroid%20filter%0A%20*%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20refer%20to%20._loadMatrix()%20method%0A%20*%2F%0AColorMatrixFilter.prototype.polaroid%20%3D%20function%20(multiply)%0A%7B%0A%20%20%20%20var%20matrix%20%3D%20%5B%0A%20%20%20%20%20%20%20%201.438%2C%20-0.062%2C%20-0.062%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%20-0.122%2C%201.378%2C%20-0.122%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%20-0.016%2C%20-0.016%2C%201.483%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%200%2C%201%2C%200%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20this._loadMatrix(matrix%2C%20multiply)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Filter%20who%20transforms%20%3A%20Red%20-%3E%20Blue%20and%20Blue%20-%3E%20Red%0A%20*%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20refer%20to%20._loadMatrix()%20method%0A%20*%2F%0AColorMatrixFilter.prototype.toBGR%20%3D%20function%20(multiply)%0A%7B%0A%20%20%20%20var%20matrix%20%3D%20%5B%0A%20%20%20%20%20%20%20%200%2C%200%2C%201%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200%2C%201%2C%200%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%201%2C%200%2C%200%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%200%2C%201%2C%200%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20this._loadMatrix(matrix%2C%20multiply)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Color%20reversal%20film%20introduced%20by%20Eastman%20Kodak%20in%201935.%20(thanks%20Dominic%20Szablewski)%0A%20*%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20refer%20to%20._loadMatrix()%20method%0A%20*%2F%0AColorMatrixFilter.prototype.kodachrome%20%3D%20function%20(multiply)%0A%7B%0A%20%20%20%20var%20matrix%20%3D%20%5B%0A%20%20%20%20%20%20%20%201.1285582396593525%2C%20-0.3967382283601348%2C%20-0.03992559172921793%2C%200%2C%2063.72958762196502%2C%0A%20%20%20%20%20%20%20%20-0.16404339962244616%2C%201.0835251566291304%2C%20-0.05498805115633132%2C%200%2C%2024.732407896706203%2C%0A%20%20%20%20%20%20%20%20-0.16786010706155763%2C%20-0.5603416277695248%2C%201.6014850761964943%2C%200%2C%2035.62982807460946%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%200%2C%201%2C%200%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20this._loadMatrix(matrix%2C%20multiply)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Brown%20delicious%20browni%20filter%20(thanks%20Dominic%20Szablewski)%0A%20*%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20refer%20to%20._loadMatrix()%20method%0A%20*%2F%0AColorMatrixFilter.prototype.browni%20%3D%20function%20(multiply)%0A%7B%0A%20%20%20%20var%20matrix%20%3D%20%5B%0A%20%20%20%20%20%20%20%200.5997023498159715%2C%200.34553243048391263%2C%20-0.2708298674538042%2C%200%2C%2047.43192855600873%2C%0A%20%20%20%20%20%20%20%20-0.037703249837783157%2C%200.8609577587992641%2C%200.15059552388459913%2C%200%2C%20-36.96841498319127%2C%0A%20%20%20%20%20%20%20%200.24113635128153335%2C%20-0.07441037908422492%2C%200.44972182064877153%2C%200%2C%20-7.562075277591283%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%200%2C%201%2C%200%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20this._loadMatrix(matrix%2C%20multiply)%3B%0A%7D%3B%0A%0A%2F*%0A%20*%20Vintage%20filter%20(thanks%20Dominic%20Szablewski)%0A%20*%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20refer%20to%20._loadMatrix()%20method%0A%20*%2F%0AColorMatrixFilter.prototype.vintage%20%3D%20function%20(multiply)%0A%7B%0A%20%20%20%20var%20matrix%20%3D%20%5B%0A%20%20%20%20%20%20%20%200.6279345635605994%2C%200.3202183420819367%2C%20-0.03965408211312453%2C%200%2C%209.651285835294123%2C%0A%20%20%20%20%20%20%20%200.02578397704808868%2C%200.6441188644374771%2C%200.03259127616149294%2C%200%2C%207.462829176470591%2C%0A%20%20%20%20%20%20%20%200.0466055556782719%2C%20-0.0851232987247891%2C%200.5241648018700465%2C%200%2C%205.159190588235296%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%200%2C%201%2C%200%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20this._loadMatrix(matrix%2C%20multiply)%3B%0A%7D%3B%0A%0A%2F*%0A%20*%20We%20don't%20know%20exactly%20what%20it%20does%2C%20kind%20of%20gradient%20map%2C%20but%20funny%20to%20play%20with!%0A%20*%0A%20*%20%40param%20desaturation%20%7Bnumber%7D%0A%20*%20%40param%20toned%20%7Bnumber%7D%0A%20*%20%40param%20lightColor%20%7Bstring%7D%20(example%20%3A%20%220xFFE580%22)%0A%20*%20%40param%20darkColor%20%7Bstring%7D%20%20(example%20%3A%20%220xFFE580%22)%0A%20*%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20refer%20to%20._loadMatrix()%20method%0A%20*%2F%0AColorMatrixFilter.prototype.colorTone%20%3D%20function%20(desaturation%2C%20toned%2C%20lightColor%2C%20darkColor%2C%20multiply)%0A%7B%0A%20%20%20%20desaturation%20%3D%20desaturation%20%7C%7C%200.2%3B%0A%20%20%20%20toned%20%3D%20toned%20%7C%7C%200.15%3B%0A%20%20%20%20lightColor%20%3D%20lightColor%20%7C%7C%200xFFE580%3B%0A%20%20%20%20darkColor%20%3D%20darkColor%20%7C%7C%200x338000%3B%0A%0A%20%20%20%20var%20lR%20%3D%20((lightColor%20%3E%3E%2016)%20%26%200xFF)%20%2F%20255%3B%0A%20%20%20%20var%20lG%20%3D%20((lightColor%20%3E%3E%208)%20%26%200xFF)%20%2F%20255%3B%0A%20%20%20%20var%20lB%20%3D%20(lightColor%20%26%200xFF)%20%2F%20255%3B%0A%0A%20%20%20%20var%20dR%20%3D%20((darkColor%20%3E%3E%2016)%20%26%200xFF)%20%2F%20255%3B%0A%20%20%20%20var%20dG%20%3D%20((darkColor%20%3E%3E%208)%20%26%200xFF)%20%2F%20255%3B%0A%20%20%20%20var%20dB%20%3D%20(darkColor%20%26%200xFF)%20%2F%20255%3B%0A%0A%20%20%20%20var%20matrix%20%3D%20%5B%0A%20%20%20%20%20%20%20%200.3%2C%200.59%2C%200.11%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%20lR%2C%20lG%2C%20lB%2C%20desaturation%2C%200%2C%0A%20%20%20%20%20%20%20%20dR%2C%20dG%2C%20dB%2C%20toned%2C%200%2C%0A%20%20%20%20%20%20%20%20lR%20-%20dR%2C%20lG%20-%20dG%2C%20lB%20-%20dB%2C%200%2C%200%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20this._loadMatrix(matrix%2C%20multiply)%3B%0A%7D%3B%0A%0A%2F*%0A%20*%20Night%20effect%0A%20*%0A%20*%20%40param%20intensity%20%7Bnumber%7D%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20refer%20to%20._loadMatrix()%20method%0A%20*%2F%0AColorMatrixFilter.prototype.night%20%3D%20function%20(intensity%2C%20multiply)%0A%7B%0A%20%20%20%20intensity%20%3D%20intensity%20%7C%7C%200.1%3B%0A%20%20%20%20var%20matrix%20%3D%20%5B%0A%20%20%20%20%20%20%20%20intensity%20*%20(%20-2.0)%2C%20-intensity%2C%200%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%20-intensity%2C%200%2C%20intensity%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200%2C%20intensity%2C%20intensity%20*%202.0%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%200%2C%201%2C%200%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20this._loadMatrix(matrix%2C%20multiply)%3B%0A%7D%3B%0A%0A%0A%2F*%0A%20*%20Predator%20effect%0A%20*%0A%20*%20Erase%20the%20current%20matrix%20by%20setting%20a%20new%20indepent%20one%0A%20*%0A%20*%20%40param%20amount%20%7Bnumber%7D%20how%20much%20the%20predator%20feels%20his%20future%20victim%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20refer%20to%20._loadMatrix()%20method%0A%20*%2F%0AColorMatrixFilter.prototype.predator%20%3D%20function%20(amount%2C%20multiply)%0A%7B%0A%20%20%20%20var%20matrix%20%3D%20%5B%0A%20%20%20%20%20%20%20%2011.224130630493164%20*%20amount%2C%20-4.794486999511719%20*%20amount%2C%20-2.8746118545532227%20*%20amount%2C%200%20*%20amount%2C%200.40342438220977783%20*%20amount%2C%0A%20%20%20%20%20%20%20%20-3.6330697536468506%20*%20amount%2C%209.193157196044922%20*%20amount%2C%20-2.951810836791992%20*%20amount%2C%200%20*%20amount%2C%20-1.316135048866272%20*%20amount%2C%0A%20%20%20%20%20%20%20%20-3.2184197902679443%20*%20amount%2C%20-4.2375030517578125%20*%20amount%2C%207.476448059082031%20*%20amount%2C%200%20*%20amount%2C%200.8044459223747253%20*%20amount%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%200%2C%201%2C%200%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20this._loadMatrix(matrix%2C%20multiply)%3B%0A%7D%3B%0A%0A%2F*%0A%20*%20LSD%20effect%0A%20*%0A%20*%20Multiply%20the%20current%20matrix%0A%20*%0A%20*%20%40param%20amount%20%7Bnumber%7D%20How%20crazy%20is%20your%20effect%0A%20*%20%40param%20multiply%20%7Bboolean%7D%20refer%20to%20._loadMatrix()%20method%0A%20*%2F%0AColorMatrixFilter.prototype.lsd%20%3D%20function%20(multiply)%0A%7B%0A%20%20%20%20var%20matrix%20%3D%20%5B%0A%20%20%20%20%20%20%20%202%2C%20-0.4%2C%200.5%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%20-0.5%2C%202%2C%20-0.4%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%20-0.4%2C%20-0.5%2C%203%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%200%2C%201%2C%200%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20this._loadMatrix(matrix%2C%20multiply)%3B%0A%7D%3B%0A%0A%2F*%0A%20*%20Erase%20the%20current%20matrix%20by%20setting%20the%20default%20one%0A%20*%0A%20*%2F%0AColorMatrixFilter.prototype.reset%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20matrix%20%3D%20%5B%0A%20%20%20%20%20%20%20%201%2C%200%2C%200%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200%2C%201%2C%200%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%201%2C%200%2C%200%2C%0A%20%20%20%20%20%20%20%200%2C%200%2C%200%2C%201%2C%200%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20this._loadMatrix(matrix%2C%20false)%3B%0A%7D%3B%0A%0A%0AObject.defineProperties(ColorMatrixFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20matrix%20of%20the%20color%20matrix%20filter%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%5B%5D%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.ColorMatrixFilter%23%0A%20%20%20%20%20*%20%40default%20%5B1%2C%200%2C%200%2C%200%2C%200%2C%200%2C%201%2C%200%2C%200%2C%200%2C%200%2C%200%2C%201%2C%200%2C%200%2C%200%2C%200%2C%200%2C%201%2C%200%5D%0A%20%20%20%20%20*%2F%0A%20%20%20%20matrix%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.m.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.m.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C85%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20This%20lowers%20the%20color%20depth%20of%20your%20image%20by%20the%20given%20amount%2C%20producing%20an%20image%20with%20a%20smaller%20palette.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20ColorStepFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20null%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20mediump%20float%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cn%5Cnuniform%20sampler2D%20uSampler%3B%5Cnuniform%20float%20step%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20%20vec4%20color%20%3D%20texture2D(uSampler%2C%20vTextureCoord)%3B%5Cn%5Cn%20%20%20%20color%20%3D%20floor(color%20*%20step)%20%2F%20step%3B%5Cn%5Cn%20%20%20%20gl_FragColor%20%3D%20color%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20step%3A%20%7B%20type%3A%20'1f'%2C%20value%3A%205%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%7D%0A%0AColorStepFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0AColorStepFilter.prototype.constructor%20%3D%20ColorStepFilter%3B%0Amodule.exports%20%3D%20ColorStepFilter%3B%0A%0AObject.defineProperties(ColorStepFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20number%20of%20steps%20to%20reduce%20the%20palette%20by.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.ColorStepFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20step%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.step.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.step.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C86%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20The%20ConvolutionFilter%20class%20applies%20a%20matrix%20convolution%20filter%20effect.%0A%20*%20A%20convolution%20combines%20pixels%20in%20the%20input%20image%20with%20neighboring%20pixels%20to%20produce%20a%20new%20image.%0A%20*%20A%20wide%20variety%20of%20image%20effects%20can%20be%20achieved%20through%20convolutions%2C%20including%20blurring%2C%20edge%0A%20*%20detection%2C%20sharpening%2C%20embossing%2C%20and%20beveling.%20The%20matrix%20should%20be%20specified%20as%20a%209%20point%20Array.%0A%20*%20See%20http%3A%2F%2Fdocs.gimp.org%2Fen%2Fplug-in-convmatrix.html%20for%20more%20info.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%20%40param%20matrix%20%7Bnumber%5B%5D%7D%20An%20array%20of%20values%20used%20for%20matrix%20transformation.%20Specified%20as%20a%209%20point%20Array.%0A%20*%20%40param%20width%20%7Bnumber%7D%20Width%20of%20the%20object%20you%20are%20transforming%0A%20*%20%40param%20height%20%7Bnumber%7D%20Height%20of%20the%20object%20you%20are%20transforming%0A%20*%2F%0Afunction%20ConvolutionFilter(matrix%2C%20width%2C%20height)%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20null%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20mediump%20float%3B%5Cn%5Cnvarying%20mediump%20vec2%20vTextureCoord%3B%5Cn%5Cnuniform%20sampler2D%20uSampler%3B%5Cnuniform%20vec2%20texelSize%3B%5Cnuniform%20float%20matrix%5B9%5D%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20vec4%20c11%20%3D%20texture2D(uSampler%2C%20vTextureCoord%20-%20texelSize)%3B%20%2F%2F%20top%20left%5Cn%20%20%20vec4%20c12%20%3D%20texture2D(uSampler%2C%20vec2(vTextureCoord.x%2C%20vTextureCoord.y%20-%20texelSize.y))%3B%20%2F%2F%20top%20center%5Cn%20%20%20vec4%20c13%20%3D%20texture2D(uSampler%2C%20vec2(vTextureCoord.x%20%2B%20texelSize.x%2C%20vTextureCoord.y%20-%20texelSize.y))%3B%20%2F%2F%20top%20right%5Cn%5Cn%20%20%20vec4%20c21%20%3D%20texture2D(uSampler%2C%20vec2(vTextureCoord.x%20-%20texelSize.x%2C%20vTextureCoord.y))%3B%20%2F%2F%20mid%20left%5Cn%20%20%20vec4%20c22%20%3D%20texture2D(uSampler%2C%20vTextureCoord)%3B%20%2F%2F%20mid%20center%5Cn%20%20%20vec4%20c23%20%3D%20texture2D(uSampler%2C%20vec2(vTextureCoord.x%20%2B%20texelSize.x%2C%20vTextureCoord.y))%3B%20%2F%2F%20mid%20right%5Cn%5Cn%20%20%20vec4%20c31%20%3D%20texture2D(uSampler%2C%20vec2(vTextureCoord.x%20-%20texelSize.x%2C%20vTextureCoord.y%20%2B%20texelSize.y))%3B%20%2F%2F%20bottom%20left%5Cn%20%20%20vec4%20c32%20%3D%20texture2D(uSampler%2C%20vec2(vTextureCoord.x%2C%20vTextureCoord.y%20%2B%20texelSize.y))%3B%20%2F%2F%20bottom%20center%5Cn%20%20%20vec4%20c33%20%3D%20texture2D(uSampler%2C%20vTextureCoord%20%2B%20texelSize)%3B%20%2F%2F%20bottom%20right%5Cn%5Cn%20%20%20gl_FragColor%20%3D%5Cn%20%20%20%20%20%20%20c11%20*%20matrix%5B0%5D%20%2B%20c12%20*%20matrix%5B1%5D%20%2B%20c13%20*%20matrix%5B2%5D%20%2B%5Cn%20%20%20%20%20%20%20c21%20*%20matrix%5B3%5D%20%2B%20c22%20*%20matrix%5B4%5D%20%2B%20c23%20*%20matrix%5B5%5D%20%2B%5Cn%20%20%20%20%20%20%20c31%20*%20matrix%5B6%5D%20%2B%20c32%20*%20matrix%5B7%5D%20%2B%20c33%20*%20matrix%5B8%5D%3B%5Cn%5Cn%20%20%20gl_FragColor.a%20%3D%20c22.a%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20matrix%3A%20%20%20%20%20%7B%20type%3A%20'1fv'%2C%20value%3A%20new%20Float32Array(matrix)%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20texelSize%3A%20%20%7B%20type%3A%20'v2'%2C%20value%3A%20%7B%20x%3A%201%20%2F%20width%2C%20y%3A%201%20%2F%20height%20%7D%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%7D%0A%0AConvolutionFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0AConvolutionFilter.prototype.constructor%20%3D%20ConvolutionFilter%3B%0Amodule.exports%20%3D%20ConvolutionFilter%3B%0A%0AObject.defineProperties(ConvolutionFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20An%20array%20of%20values%20used%20for%20matrix%20transformation.%20Specified%20as%20a%209%20point%20Array.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%5B%5D%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.ConvolutionFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20matrix%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.matrix.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.matrix.value%20%3D%20new%20Float32Array(value)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Width%20of%20the%20object%20you%20are%20transforming%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.ConvolutionFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20width%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%201%2Fthis.uniforms.texelSize.value.x%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.texelSize.value.x%20%3D%201%2Fvalue%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Height%20of%20the%20object%20you%20are%20transforming%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.ConvolutionFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20height%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%201%2Fthis.uniforms.texelSize.value.y%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.texelSize.value.y%20%3D%201%2Fvalue%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C87%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20A%20Cross%20Hatch%20effect%20filter.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20CrossHatchFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20null%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20mediump%20float%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cn%5Cnuniform%20sampler2D%20uSampler%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20%20float%20lum%20%3D%20length(texture2D(uSampler%2C%20vTextureCoord.xy).rgb)%3B%5Cn%5Cn%20%20%20%20gl_FragColor%20%3D%20vec4(1.0%2C%201.0%2C%201.0%2C%201.0)%3B%5Cn%5Cn%20%20%20%20if%20(lum%20%3C%201.00)%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20if%20(mod(gl_FragCoord.x%20%2B%20gl_FragCoord.y%2C%2010.0)%20%3D%3D%200.0)%5Cn%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20gl_FragColor%20%3D%20vec4(0.0%2C%200.0%2C%200.0%2C%201.0)%3B%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20if%20(lum%20%3C%200.75)%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20if%20(mod(gl_FragCoord.x%20-%20gl_FragCoord.y%2C%2010.0)%20%3D%3D%200.0)%5Cn%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20gl_FragColor%20%3D%20vec4(0.0%2C%200.0%2C%200.0%2C%201.0)%3B%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20if%20(lum%20%3C%200.50)%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20if%20(mod(gl_FragCoord.x%20%2B%20gl_FragCoord.y%20-%205.0%2C%2010.0)%20%3D%3D%200.0)%5Cn%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20gl_FragColor%20%3D%20vec4(0.0%2C%200.0%2C%200.0%2C%201.0)%3B%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20if%20(lum%20%3C%200.3)%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20if%20(mod(gl_FragCoord.x%20-%20gl_FragCoord.y%20-%205.0%2C%2010.0)%20%3D%3D%200.0)%5Cn%20%20%20%20%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20gl_FragColor%20%3D%20vec4(0.0%2C%200.0%2C%200.0%2C%201.0)%3B%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%7D%5Cn%22%0A%20%20%20%20)%3B%0A%7D%0A%0ACrossHatchFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0ACrossHatchFilter.prototype.constructor%20%3D%20CrossHatchFilter%3B%0Amodule.exports%20%3D%20CrossHatchFilter%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C88%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20The%20DisplacementFilter%20class%20uses%20the%20pixel%20values%20from%20the%20specified%20texture%20(called%20the%20displacement%20map)%20to%20perform%20a%20displacement%20of%20an%20object.%0A%20*%20You%20can%20use%20this%20filter%20to%20apply%20all%20manor%20of%20crazy%20warping%20effects%0A%20*%20Currently%20the%20r%20property%20of%20the%20texture%20is%20used%20to%20offset%20the%20x%20and%20the%20g%20property%20of%20the%20texture%20is%20used%20to%20offset%20the%20y.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%20%40param%20sprite%20%7BPIXI.Sprite%7D%20the%20sprite%20used%20for%20the%20displacement%20map.%20(make%20sure%20its%20added%20to%20the%20scene!)%0A%20*%2F%0Afunction%20DisplacementFilter(sprite%2C%20scale)%0A%7B%0A%20%20%20%20var%20maskMatrix%20%3D%20new%20core.Matrix()%3B%0A%20%20%20%20sprite.renderable%20%3D%20false%3B%0A%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20%22attribute%20vec2%20aVertexPosition%3B%5Cnattribute%20vec2%20aTextureCoord%3B%5Cnattribute%20vec4%20aColor%3B%5Cn%5Cnuniform%20mat3%20projectionMatrix%3B%5Cnuniform%20mat3%20otherMatrix%3B%5Cn%5Cnvarying%20vec2%20vMapCoord%3B%5Cnvarying%20vec2%20vTextureCoord%3B%5Cnvarying%20vec4%20vColor%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20gl_Position%20%3D%20vec4((projectionMatrix%20*%20vec3(aVertexPosition%2C%201.0)).xy%2C%200.0%2C%201.0)%3B%5Cn%20%20%20vTextureCoord%20%3D%20aTextureCoord%3B%5Cn%20%20%20vMapCoord%20%3D%20(%20otherMatrix%20*%20vec3(%20aTextureCoord%2C%201.0)%20%20).xy%3B%5Cn%20%20%20vColor%20%3D%20vec4(aColor.rgb%20*%20aColor.a%2C%20aColor.a)%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20mediump%20float%3B%5Cn%5Cnvarying%20vec2%20vMapCoord%3B%5Cnvarying%20vec2%20vTextureCoord%3B%5Cnvarying%20vec4%20vColor%3B%5Cn%5Cnuniform%20vec2%20scale%3B%5Cn%5Cnuniform%20sampler2D%20uSampler%3B%5Cnuniform%20sampler2D%20mapSampler%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20vec4%20map%20%3D%20%20texture2D(mapSampler%2C%20vMapCoord)%3B%5Cn%5Cn%20%20%20map%20-%3D%200.5%3B%5Cn%20%20%20map.xy%20*%3D%20scale%3B%5Cn%5Cn%20%20%20gl_FragColor%20%3D%20texture2D(uSampler%2C%20vec2(vTextureCoord.x%20%2B%20map.x%2C%20vTextureCoord.y%20%2B%20map.y))%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20mapSampler%3A%20%20%20%20%20%7B%20type%3A%20'sampler2D'%2C%20value%3A%20sprite.texture%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20otherMatrix%3A%20%20%20%20%7B%20type%3A%20'mat3'%2C%20value%3A%20maskMatrix.toArray(true)%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20scale%3A%20%20%20%20%20%20%20%20%20%20%7B%20type%3A%20'v2'%2C%20value%3A%20%7B%20x%3A%201%2C%20y%3A%201%20%7D%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%0A%20%20%20%20this.maskSprite%20%3D%20sprite%3B%0A%20%20%20%20this.maskMatrix%20%3D%20maskMatrix%3B%0A%0A%20%20%20%20if%20(scale%20%3D%3D%3D%20null%20%7C%7C%20scale%20%3D%3D%3D%20undefined)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20scale%20%3D%2020%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.scale%20%3D%20new%20core.Point(scale%2C%20scale)%3B%0A%7D%0A%0ADisplacementFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0ADisplacementFilter.prototype.constructor%20%3D%20DisplacementFilter%3B%0Amodule.exports%20%3D%20DisplacementFilter%3B%0A%0ADisplacementFilter.prototype.applyFilter%20%3D%20function%20(renderer%2C%20input%2C%20output)%0A%7B%0A%20%20%20%20var%20filterManager%20%3D%20renderer.filterManager%3B%0A%0A%20%20%20%20filterManager.calculateMappedMatrix(input.frame%2C%20this.maskSprite%2C%20this.maskMatrix)%3B%0A%0A%20%20%20%20this.uniforms.otherMatrix.value%20%3D%20this.maskMatrix.toArray(true)%3B%0A%20%20%20%20this.uniforms.scale.value.x%20%3D%20this.scale.x%20*%20(1%2Finput.frame.width)%3B%0A%20%20%20%20this.uniforms.scale.value.y%20%3D%20this.scale.y%20*%20(1%2Finput.frame.height)%3B%0A%0A%20%20%20%20var%20shader%20%3D%20this.getShader(renderer)%3B%0A%20%20%20%20%20%2F%2F%20draw%20the%20filter...%0A%20%20%20%20filterManager.applyFilter(shader%2C%20input%2C%20output)%3B%0A%7D%3B%0A%0A%0AObject.defineProperties(DisplacementFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20texture%20used%20for%20the%20displacement%20map.%20Must%20be%20power%20of%202%20sized%20texture.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Texture%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.DisplacementFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20map%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.mapSampler.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.mapSampler.value%20%3D%20value%3B%0A%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C89%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20%40author%20Mat%20Groves%20http%3A%2F%2Fmatgroves.com%2F%20%40Doormat23%0A%20*%20original%20filter%3A%20https%3A%2F%2Fgithub.com%2Fevanw%2Fglfx.js%2Fblob%2Fmaster%2Fsrc%2Ffilters%2Ffun%2Fdotscreen.js%0A%20*%2F%0A%0A%2F**%0A%20*%20This%20filter%20applies%20a%20dotscreen%20effect%20making%20display%20objects%20appear%20to%20be%20made%20out%20of%0A%20*%20black%20and%20white%20halftone%20dots%20like%20an%20old%20printer.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20DotScreenFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20null%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20mediump%20float%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cnvarying%20vec4%20vColor%3B%5Cn%5Cnuniform%20vec4%20dimensions%3B%5Cnuniform%20sampler2D%20uSampler%3B%5Cn%5Cnuniform%20float%20angle%3B%5Cnuniform%20float%20scale%3B%5Cn%5Cnfloat%20pattern()%5Cn%7B%5Cn%20%20%20float%20s%20%3D%20sin(angle)%2C%20c%20%3D%20cos(angle)%3B%5Cn%20%20%20vec2%20tex%20%3D%20vTextureCoord%20*%20dimensions.xy%3B%5Cn%20%20%20vec2%20point%20%3D%20vec2(%5Cn%20%20%20%20%20%20%20c%20*%20tex.x%20-%20s%20*%20tex.y%2C%5Cn%20%20%20%20%20%20%20s%20*%20tex.x%20%2B%20c%20*%20tex.y%5Cn%20%20%20)%20*%20scale%3B%5Cn%20%20%20return%20(sin(point.x)%20*%20sin(point.y))%20*%204.0%3B%5Cn%7D%5Cn%5Cnvoid%20main()%5Cn%7B%5Cn%20%20%20vec4%20color%20%3D%20texture2D(uSampler%2C%20vTextureCoord)%3B%5Cn%20%20%20float%20average%20%3D%20(color.r%20%2B%20color.g%20%2B%20color.b)%20%2F%203.0%3B%5Cn%20%20%20gl_FragColor%20%3D%20vec4(vec3(average%20*%2010.0%20-%205.0%20%2B%20pattern())%2C%20color.a)%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20scale%3A%20%20%20%20%20%20%7B%20type%3A%20'1f'%2C%20value%3A%201%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20angle%3A%20%20%20%20%20%20%7B%20type%3A%20'1f'%2C%20value%3A%205%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20dimensions%3A%20%7B%20type%3A%20'4fv'%2C%20value%3A%20%5B0%2C%200%2C%200%2C%200%5D%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%7D%0A%0ADotScreenFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0ADotScreenFilter.prototype.constructor%20%3D%20DotScreenFilter%3B%0Amodule.exports%20%3D%20DotScreenFilter%3B%0A%0AObject.defineProperties(DotScreenFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20scale%20of%20the%20effect.%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.DotScreenFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20scale%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.scale.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.scale.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20radius%20of%20the%20effect.%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.DotScreenFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20angle%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.angle.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.angle.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C90%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20The%20BlurYTintFilter%20applies%20a%20vertical%20Gaussian%20blur%20to%20an%20object.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20BlurYTintFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20%22attribute%20vec2%20aVertexPosition%3B%5Cnattribute%20vec2%20aTextureCoord%3B%5Cnattribute%20vec4%20aColor%3B%5Cn%5Cnuniform%20float%20strength%3B%5Cnuniform%20vec2%20offset%3B%5Cn%5Cnuniform%20mat3%20projectionMatrix%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cnvarying%20vec4%20vColor%3B%5Cnvarying%20vec2%20vBlurTexCoords%5B6%5D%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20%20gl_Position%20%3D%20vec4((projectionMatrix%20*%20vec3((aVertexPosition%2Boffset)%2C%201.0)).xy%2C%200.0%2C%201.0)%3B%5Cn%20%20%20%20vTextureCoord%20%3D%20aTextureCoord%3B%5Cn%5Cn%20%20%20%20vBlurTexCoords%5B%200%5D%20%3D%20aTextureCoord%20%2B%20vec2(0.0%2C%20-0.012%20*%20strength)%3B%5Cn%20%20%20%20vBlurTexCoords%5B%201%5D%20%3D%20aTextureCoord%20%2B%20vec2(0.0%2C%20-0.008%20*%20strength)%3B%5Cn%20%20%20%20vBlurTexCoords%5B%202%5D%20%3D%20aTextureCoord%20%2B%20vec2(0.0%2C%20-0.004%20*%20strength)%3B%5Cn%20%20%20%20vBlurTexCoords%5B%203%5D%20%3D%20aTextureCoord%20%2B%20vec2(0.0%2C%20%200.004%20*%20strength)%3B%5Cn%20%20%20%20vBlurTexCoords%5B%204%5D%20%3D%20aTextureCoord%20%2B%20vec2(0.0%2C%20%200.008%20*%20strength)%3B%5Cn%20%20%20%20vBlurTexCoords%5B%205%5D%20%3D%20aTextureCoord%20%2B%20vec2(0.0%2C%20%200.012%20*%20strength)%3B%5Cn%5Cn%20%20%20vColor%20%3D%20vec4(aColor.rgb%20*%20aColor.a%2C%20aColor.a)%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20lowp%20float%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cnvarying%20vec2%20vBlurTexCoords%5B6%5D%3B%5Cnvarying%20vec4%20vColor%3B%5Cn%5Cnuniform%20vec3%20color%3B%5Cnuniform%20float%20alpha%3B%5Cn%5Cnuniform%20sampler2D%20uSampler%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20%20vec4%20sum%20%3D%20vec4(0.0)%3B%5Cn%5Cn%20%20%20%20sum%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%200%5D)*0.004431848411938341%3B%5Cn%20%20%20%20sum%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%201%5D)*0.05399096651318985%3B%5Cn%20%20%20%20sum%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%202%5D)*0.2419707245191454%3B%5Cn%20%20%20%20sum%20%2B%3D%20texture2D(uSampler%2C%20vTextureCoord%20%20%20%20%20)*0.3989422804014327%3B%5Cn%20%20%20%20sum%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%203%5D)*0.2419707245191454%3B%5Cn%20%20%20%20sum%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%204%5D)*0.05399096651318985%3B%5Cn%20%20%20%20sum%20%2B%3D%20texture2D(uSampler%2C%20vBlurTexCoords%5B%205%5D)*0.004431848411938341%3B%5Cn%5Cn%20%20%20%20gl_FragColor%20%3D%20vec4(%20color.rgb%20*%20sum.a%20*%20alpha%2C%20sum.a%20*%20alpha%20)%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20set%20the%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20blur%3A%20%7B%20type%3A%20'1f'%2C%20value%3A%201%20%2F%20512%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20%7B%20type%3A%20'c'%2C%20value%3A%20%5B0%2C0%2C0%5D%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alpha%3A%20%7B%20type%3A%20'1f'%2C%20value%3A%200.7%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20offset%3A%20%7B%20type%3A%20'2f'%2C%20value%3A%5B5%2C%205%5D%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20strength%3A%20%7B%20type%3A%20'1f'%2C%20value%3A1%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%0A%20%20%20%20this.passes%20%3D%201%3B%0A%20%20%20%20this.strength%20%3D%204%3B%0A%7D%0A%0ABlurYTintFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0ABlurYTintFilter.prototype.constructor%20%3D%20BlurYTintFilter%3B%0Amodule.exports%20%3D%20BlurYTintFilter%3B%0A%0ABlurYTintFilter.prototype.applyFilter%20%3D%20function%20(renderer%2C%20input%2C%20output%2C%20clear)%0A%7B%0A%20%20%20%20var%20shader%20%3D%20this.getShader(renderer)%3B%0A%0A%20%20%20%20this.uniforms.strength.value%20%3D%20this.strength%20%2F%204%20%2F%20this.passes%20*%20(input.frame.height%20%2F%20input.size.height)%3B%0A%0A%20%20%20%20if(this.passes%20%3D%3D%3D%201)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20renderer.filterManager.applyFilter(shader%2C%20input%2C%20output%2C%20clear)%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20renderTarget%20%3D%20renderer.filterManager.getRenderTarget(true)%3B%0A%20%20%20%20%20%20%20%20var%20flip%20%3D%20input%3B%0A%20%20%20%20%20%20%20%20var%20flop%20%3D%20renderTarget%3B%0A%0A%20%20%20%20%20%20%20%20for(var%20i%20%3D%200%3B%20i%20%3C%20this.passes-1%3B%20i%2B%2B)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderer.filterManager.applyFilter(shader%2C%20flip%2C%20flop%2C%20clear)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20var%20temp%20%3D%20flop%3B%0A%20%20%20%20%20%20%20%20%20%20%20flop%20%3D%20flip%3B%0A%20%20%20%20%20%20%20%20%20%20%20flip%20%3D%20temp%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20renderer.filterManager.applyFilter(shader%2C%20flip%2C%20output%2C%20clear)%3B%0A%0A%20%20%20%20%20%20%20%20renderer.filterManager.returnRenderTarget(renderTarget)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%0AObject.defineProperties(BlurYTintFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20strength%20of%20both%20the%20blur.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.BlurYTintFilter%23%0A%20%20%20%20%20*%20%40default%202%0A%20%20%20%20%20*%2F%0A%20%20%20%20blur%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%20this.strength%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.padding%20%3D%20value%20*%200.5%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.strength%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C91%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%2C%0A%20%20%20%20BlurXFilter%20%3D%20require('..%2Fblur%2FBlurXFilter')%2C%0A%20%20%20%20BlurYTintFilter%20%3D%20require('.%2FBlurYTintFilter')%3B%0A%0A%2F**%0A%20*%20The%20DropShadowFilter%20applies%20a%20Gaussian%20blur%20to%20an%20object.%0A%20*%20The%20strength%20of%20the%20blur%20can%20be%20set%20for%20x-%20and%20y-axis%20separately.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20DropShadowFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this)%3B%0A%0A%20%20%20%20this.blurXFilter%20%3D%20new%20BlurXFilter()%3B%0A%20%20%20%20this.blurYTintFilter%20%3D%20new%20BlurYTintFilter()%3B%0A%0A%20%20%20%20this.defaultFilter%20%3D%20new%20core.AbstractFilter()%3B%0A%0A%20%20%20%20this.padding%20%3D%2030%3B%0A%0A%20%20%20%20this._dirtyPosition%20%3D%20true%3B%0A%20%20%20%20this._angle%20%3D%2045%20*%20Math.PI%20%2F%20180%3B%0A%20%20%20%20this._distance%20%3D%2010%3B%0A%20%20%20%20this.alpha%20%3D%200.75%3B%0A%20%20%20%20this.hideObject%20%3D%20false%3B%0A%20%20%20%20this.blendMode%20%3D%20core.BLEND_MODES.MULTIPLY%3B%0A%7D%0A%0ADropShadowFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0ADropShadowFilter.prototype.constructor%20%3D%20DropShadowFilter%3B%0Amodule.exports%20%3D%20DropShadowFilter%3B%0A%0ADropShadowFilter.prototype.applyFilter%20%3D%20function%20(renderer%2C%20input%2C%20output)%0A%7B%0A%20%20%20%20var%20renderTarget%20%3D%20renderer.filterManager.getRenderTarget(true)%3B%0A%0A%20%20%20%20%2F%2FTODO%20-%20copyTexSubImage2D%20could%20be%20used%20here%3F%0A%20%20%20%20if(this._dirtyPosition)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this._dirtyPosition%20%3D%20false%3B%0A%0A%20%20%20%20%20%20%20%20this.blurYTintFilter.uniforms.offset.value%5B0%5D%20%3D%20Math.sin(this._angle)%20*%20this._distance%3B%0A%20%20%20%20%20%20%20%20this.blurYTintFilter.uniforms.offset.value%5B1%5D%20%3D%20Math.cos(this._angle)%20*%20this._distance%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.blurXFilter.applyFilter(renderer%2C%20input%2C%20renderTarget)%3B%0A%0A%20%20%20%20renderer.blendModeManager.setBlendMode(this.blendMode)%3B%0A%0A%20%20%20%20this.blurYTintFilter.applyFilter(renderer%2C%20renderTarget%2C%20output)%3B%0A%0A%20%20%20%20renderer.blendModeManager.setBlendMode(core.BLEND_MODES.NORMAL)%3B%0A%0A%20%20%20%20if(!this.hideObject)%0A%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20this.defaultFilter.applyFilter(renderer%2C%20input%2C%20output)%3B%0A%20%20%20%20%7D%0A%0A%0A%20%20%20%20renderer.filterManager.returnRenderTarget(renderTarget)%3B%0A%7D%3B%0A%0AObject.defineProperties(DropShadowFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20strength%20of%20both%20the%20blurX%20and%20blurY%20properties%20simultaneously%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberOf%20PIXI.filters.DropShadowFilter%23%0A%20%20%20%20%20*%20%40default%202%0A%20%20%20%20%20*%2F%0A%20%20%20%20blur%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.blurXFilter.blur%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blurXFilter.blur%20%3D%20this.blurYTintFilter.blur%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20strength%20of%20the%20blurX%20property%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberOf%20PIXI.filters.DropShadowFilter%23%0A%20%20%20%20%20*%20%40default%202%0A%20%20%20%20%20*%2F%0A%20%20%20%20blurX%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.blurXFilter.blur%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blurXFilter.blur%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20strength%20of%20the%20blurY%20property%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberOf%20PIXI.filters.DropShadowFilter%23%0A%20%20%20%20%20*%20%40default%202%0A%20%20%20%20%20*%2F%0A%20%20%20%20blurY%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.blurYTintFilter.blur%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blurYTintFilter.blur%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20color%20of%20the%20shadow%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberOf%20PIXI.filters.DropShadowFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20color%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%20core.utils.rgb2hex(%20this.blurYTintFilter.uniforms.color.value%20)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blurYTintFilter.uniforms.color.value%20%3D%20core.utils.hex2rgb(value)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20alpha%20of%20the%20shadow%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberOf%20PIXI.filters.DropShadowFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20alpha%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%20this.blurYTintFilter.uniforms.alpha.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.blurYTintFilter.uniforms.alpha.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20distance%20of%20the%20shadow%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberOf%20PIXI.filters.DropShadowFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20distance%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%20this._distance%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._dirtyPosition%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._distance%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20angle%20of%20the%20shadow%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberOf%20PIXI.filters.DropShadowFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20angle%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%20this._angle%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._dirtyPosition%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._angle%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%2C%22..%2Fblur%2FBlurXFilter%22%3A81%2C%22.%2FBlurYTintFilter%22%3A90%7D%5D%2C92%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20This%20greyscales%20the%20palette%20of%20your%20Display%20Objects.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20GrayFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20null%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20mediump%20float%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cnvarying%20vec4%20vColor%3B%5Cn%5Cnuniform%20sampler2D%20uSampler%3B%5Cnuniform%20float%20gray%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20gl_FragColor%20%3D%20texture2D(uSampler%2C%20vTextureCoord)%3B%5Cn%20%20%20gl_FragColor.rgb%20%3D%20mix(gl_FragColor.rgb%2C%20vec3(0.2126*gl_FragColor.r%20%2B%200.7152*gl_FragColor.g%20%2B%200.0722*gl_FragColor.b)%2C%20gray)%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20set%20the%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20gray%3A%20%7B%20type%3A%20'1f'%2C%20value%3A%201%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%7D%0A%0AGrayFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0AGrayFilter.prototype.constructor%20%3D%20GrayFilter%3B%0Amodule.exports%20%3D%20GrayFilter%3B%0A%0AObject.defineProperties(GrayFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20strength%20of%20the%20gray.%201%20will%20make%20the%20object%20black%20and%20white%2C%200%20will%20make%20the%20object%20its%20normal%20color.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.GrayFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20gray%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.gray.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.gray.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C93%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F**%0A%20*%20%40file%20%20%20%20%20%20%20%20Main%20export%20of%20the%20PIXI%20filters%20library%0A%20*%20%40author%20%20%20%20%20%20Mat%20Groves%20%3Cmat%40goodboydigital.com%3E%0A%20*%20%40copyright%20%20%202013-2015%20GoodBoyDigital%0A%20*%20%40license%20%20%20%20%20%7B%40link%20https%3A%2F%2Fgithub.com%2Fpixijs%2Fpixi.js%2Fblob%2Fmaster%2FLICENSE%7CMIT%20License%7D%0A%20*%2F%0A%0A%2F**%0A%20*%20%40namespace%20PIXI.filters%0A%20*%2F%0Amodule.exports%20%3D%20%7B%0A%20%20%20%20AsciiFilter%3A%20%20%20%20%20%20%20%20require('.%2Fascii%2FAsciiFilter')%2C%0A%20%20%20%20BloomFilter%3A%20%20%20%20%20%20%20%20require('.%2Fbloom%2FBloomFilter')%2C%0A%20%20%20%20BlurFilter%3A%20%20%20%20%20%20%20%20%20require('.%2Fblur%2FBlurFilter')%2C%0A%20%20%20%20BlurXFilter%3A%20%20%20%20%20%20%20%20require('.%2Fblur%2FBlurXFilter')%2C%0A%20%20%20%20BlurYFilter%3A%20%20%20%20%20%20%20%20require('.%2Fblur%2FBlurYFilter')%2C%0A%20%20%20%20BlurDirFilter%3A%20%20%20%20%20%20require('.%2Fblur%2FBlurDirFilter')%2C%0A%20%20%20%20ColorMatrixFilter%3A%20%20require('.%2Fcolor%2FColorMatrixFilter')%2C%0A%20%20%20%20ColorStepFilter%3A%20%20%20%20require('.%2Fcolor%2FColorStepFilter')%2C%0A%20%20%20%20ConvolutionFilter%3A%20%20require('.%2Fconvolution%2FConvolutionFilter')%2C%0A%20%20%20%20CrossHatchFilter%3A%20%20%20require('.%2Fcrosshatch%2FCrossHatchFilter')%2C%0A%20%20%20%20DisplacementFilter%3A%20require('.%2Fdisplacement%2FDisplacementFilter')%2C%0A%20%20%20%20DotScreenFilter%3A%20%20%20%20require('.%2Fdot%2FDotScreenFilter')%2C%0A%20%20%20%20GrayFilter%3A%20%20%20%20%20%20%20%20%20require('.%2Fgray%2FGrayFilter')%2C%0A%20%20%20%20DropShadowFilter%3A%20%20%20require('.%2Fdropshadow%2FDropShadowFilter')%2C%0A%20%20%20%20InvertFilter%3A%20%20%20%20%20%20%20require('.%2Finvert%2FInvertFilter')%2C%0A%20%20%20%20NoiseFilter%3A%20%20%20%20%20%20%20%20require('.%2Fnoise%2FNoiseFilter')%2C%0A%20%20%20%20PixelateFilter%3A%20%20%20%20%20require('.%2Fpixelate%2FPixelateFilter')%2C%0A%20%20%20%20RGBSplitFilter%3A%20%20%20%20%20require('.%2Frgb%2FRGBSplitFilter')%2C%0A%20%20%20%20ShockwaveFilter%3A%20%20%20%20require('.%2Fshockwave%2FShockwaveFilter')%2C%0A%20%20%20%20SepiaFilter%3A%20%20%20%20%20%20%20%20require('.%2Fsepia%2FSepiaFilter')%2C%0A%20%20%20%20SmartBlurFilter%3A%20%20%20%20require('.%2Fblur%2FSmartBlurFilter')%2C%0A%20%20%20%20TiltShiftFilter%3A%20%20%20%20require('.%2Ftiltshift%2FTiltShiftFilter')%2C%0A%20%20%20%20TiltShiftXFilter%3A%20%20%20require('.%2Ftiltshift%2FTiltShiftXFilter')%2C%0A%20%20%20%20TiltShiftYFilter%3A%20%20%20require('.%2Ftiltshift%2FTiltShiftYFilter')%2C%0A%20%20%20%20TwistFilter%3A%20%20%20%20%20%20%20%20require('.%2Ftwist%2FTwistFilter')%0A%7D%3B%0A%0A%7D%2C%7B%22.%2Fascii%2FAsciiFilter%22%3A77%2C%22.%2Fbloom%2FBloomFilter%22%3A78%2C%22.%2Fblur%2FBlurDirFilter%22%3A79%2C%22.%2Fblur%2FBlurFilter%22%3A80%2C%22.%2Fblur%2FBlurXFilter%22%3A81%2C%22.%2Fblur%2FBlurYFilter%22%3A82%2C%22.%2Fblur%2FSmartBlurFilter%22%3A83%2C%22.%2Fcolor%2FColorMatrixFilter%22%3A84%2C%22.%2Fcolor%2FColorStepFilter%22%3A85%2C%22.%2Fconvolution%2FConvolutionFilter%22%3A86%2C%22.%2Fcrosshatch%2FCrossHatchFilter%22%3A87%2C%22.%2Fdisplacement%2FDisplacementFilter%22%3A88%2C%22.%2Fdot%2FDotScreenFilter%22%3A89%2C%22.%2Fdropshadow%2FDropShadowFilter%22%3A91%2C%22.%2Fgray%2FGrayFilter%22%3A92%2C%22.%2Finvert%2FInvertFilter%22%3A94%2C%22.%2Fnoise%2FNoiseFilter%22%3A95%2C%22.%2Fpixelate%2FPixelateFilter%22%3A96%2C%22.%2Frgb%2FRGBSplitFilter%22%3A97%2C%22.%2Fsepia%2FSepiaFilter%22%3A98%2C%22.%2Fshockwave%2FShockwaveFilter%22%3A99%2C%22.%2Ftiltshift%2FTiltShiftFilter%22%3A101%2C%22.%2Ftiltshift%2FTiltShiftXFilter%22%3A102%2C%22.%2Ftiltshift%2FTiltShiftYFilter%22%3A103%2C%22.%2Ftwist%2FTwistFilter%22%3A104%7D%5D%2C94%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20This%20inverts%20your%20Display%20Objects%20colors.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20InvertFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20null%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20mediump%20float%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cn%5Cnuniform%20float%20invert%3B%5Cnuniform%20sampler2D%20uSampler%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20%20gl_FragColor%20%3D%20texture2D(uSampler%2C%20vTextureCoord)%3B%5Cn%5Cn%20%20%20%20gl_FragColor.rgb%20%3D%20mix(%20(vec3(1)-gl_FragColor.rgb)%20*%20gl_FragColor.a%2C%20gl_FragColor.rgb%2C%201.0%20-%20invert)%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20invert%3A%20%7B%20type%3A%20'1f'%2C%20value%3A%201%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%7D%0A%0AInvertFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0AInvertFilter.prototype.constructor%20%3D%20InvertFilter%3B%0Amodule.exports%20%3D%20InvertFilter%3B%0A%0AObject.defineProperties(InvertFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20strength%20of%20the%20invert.%20%601%60%20will%20fully%20invert%20the%20colors%2C%20and%0A%20%20%20%20%20*%20%600%60%20will%20make%20the%20object%20its%20normal%20color.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.InvertFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20invert%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.invert.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.invert.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C95%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20%40author%20Vico%20%40vicocotea%0A%20*%20original%20filter%3A%20https%3A%2F%2Fgithub.com%2Fevanw%2Fglfx.js%2Fblob%2Fmaster%2Fsrc%2Ffilters%2Fadjust%2Fnoise.js%0A%20*%2F%0A%0A%2F**%0A%20*%20A%20Noise%20effect%20filter.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20NoiseFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20null%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20highp%20float%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cnvarying%20vec4%20vColor%3B%5Cn%5Cnuniform%20float%20noise%3B%5Cnuniform%20sampler2D%20uSampler%3B%5Cn%5Cnfloat%20rand(vec2%20co)%5Cn%7B%5Cn%20%20%20%20return%20fract(sin(dot(co.xy%2C%20vec2(12.9898%2C%2078.233)))%20*%2043758.5453)%3B%5Cn%7D%5Cn%5Cnvoid%20main()%5Cn%7B%5Cn%20%20%20%20vec4%20color%20%3D%20texture2D(uSampler%2C%20vTextureCoord)%3B%5Cn%5Cn%20%20%20%20float%20diff%20%3D%20(rand(vTextureCoord)%20-%200.5)%20*%20noise%3B%5Cn%5Cn%20%20%20%20color.r%20%2B%3D%20diff%3B%5Cn%20%20%20%20color.g%20%2B%3D%20diff%3B%5Cn%20%20%20%20color.b%20%2B%3D%20diff%3B%5Cn%5Cn%20%20%20%20gl_FragColor%20%3D%20color%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20noise%3A%20%7B%20type%3A%20'1f'%2C%20value%3A%200.5%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%7D%0A%0ANoiseFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0ANoiseFilter.prototype.constructor%20%3D%20NoiseFilter%3B%0Amodule.exports%20%3D%20NoiseFilter%3B%0A%0AObject.defineProperties(NoiseFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20amount%20of%20noise%20to%20apply.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.NoiseFilter%23%0A%20%20%20%20%20*%20%40default%200.5%0A%20%20%20%20%20*%2F%0A%20%20%20%20noise%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.noise.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.noise.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C96%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20This%20filter%20applies%20a%20pixelate%20effect%20making%20display%20objects%20appear%20'blocky'.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20PixelateFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20null%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20mediump%20float%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cn%5Cnuniform%20vec4%20dimensions%3B%5Cnuniform%20vec2%20pixelSize%3B%5Cnuniform%20sampler2D%20uSampler%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20%20vec2%20coord%20%3D%20vTextureCoord%3B%5Cn%5Cn%20%20%20%20vec2%20size%20%3D%20dimensions.xy%20%2F%20pixelSize%3B%5Cn%5Cn%20%20%20%20vec2%20color%20%3D%20floor(%20(%20vTextureCoord%20*%20size%20)%20)%20%2F%20size%20%2B%20pixelSize%2Fdimensions.xy%20*%200.5%3B%5Cn%5Cn%20%20%20%20gl_FragColor%20%3D%20texture2D(uSampler%2C%20color)%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20dimensions%3A%20%7B%20type%3A%20'4fv'%2C%20%20value%3A%20new%20Float32Array(%5B0%2C%200%2C%200%2C%200%5D)%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20pixelSize%3A%20%20%7B%20type%3A%20'v2'%2C%20%20%20value%3A%20%7B%20x%3A%2010%2C%20y%3A%2010%20%7D%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%7D%0A%0APixelateFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0APixelateFilter.prototype.constructor%20%3D%20PixelateFilter%3B%0Amodule.exports%20%3D%20PixelateFilter%3B%0A%0AObject.defineProperties(PixelateFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20This%20a%20point%20that%20describes%20the%20size%20of%20the%20blocks.%0A%20%20%20%20%20*%20x%20is%20the%20width%20of%20the%20block%20and%20y%20is%20the%20height.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Point%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.PixelateFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20size%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.pixelSize.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.pixelSize.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C97%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20An%20RGB%20Split%20Filter.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20RGBSplitFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20null%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20mediump%20float%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cn%5Cnuniform%20sampler2D%20uSampler%3B%5Cnuniform%20vec4%20dimensions%3B%5Cnuniform%20vec2%20red%3B%5Cnuniform%20vec2%20green%3B%5Cnuniform%20vec2%20blue%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20gl_FragColor.r%20%3D%20texture2D(uSampler%2C%20vTextureCoord%20%2B%20red%2Fdimensions.xy).r%3B%5Cn%20%20%20gl_FragColor.g%20%3D%20texture2D(uSampler%2C%20vTextureCoord%20%2B%20green%2Fdimensions.xy).g%3B%5Cn%20%20%20gl_FragColor.b%20%3D%20texture2D(uSampler%2C%20vTextureCoord%20%2B%20blue%2Fdimensions.xy).b%3B%5Cn%20%20%20gl_FragColor.a%20%3D%20texture2D(uSampler%2C%20vTextureCoord).a%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20red%3A%20%20%20%20%20%20%20%20%7B%20type%3A%20'v2'%2C%20value%3A%20%7B%20x%3A%2020%2C%20y%3A%2020%20%7D%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20green%3A%20%20%20%20%20%20%7B%20type%3A%20'v2'%2C%20value%3A%20%7B%20x%3A%20-20%2C%20y%3A%2020%20%7D%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20blue%3A%20%20%20%20%20%20%20%7B%20type%3A%20'v2'%2C%20value%3A%20%7B%20x%3A%2020%2C%20y%3A%20-20%20%7D%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20dimensions%3A%20%7B%20type%3A%20'4fv'%2C%20value%3A%20%5B0%2C%200%2C%200%2C%200%5D%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%7D%0A%0ARGBSplitFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0ARGBSplitFilter.prototype.constructor%20%3D%20RGBSplitFilter%3B%0Amodule.exports%20%3D%20RGBSplitFilter%3B%0A%0AObject.defineProperties(RGBSplitFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Red%20channel%20offset.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Point%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.RGBSplitFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20red%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.red.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.red.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Green%20channel%20offset.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Point%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.RGBSplitFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20green%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.green.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.green.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Blue%20offset.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Point%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.RGBSplitFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20blue%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.blue.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.blue.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C98%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20This%20applies%20a%20sepia%20effect%20to%20your%20Display%20Objects.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20SepiaFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20null%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20mediump%20float%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cn%5Cnuniform%20sampler2D%20uSampler%3B%5Cnuniform%20float%20sepia%3B%5Cn%5Cnconst%20mat3%20sepiaMatrix%20%3D%20mat3(0.3588%2C%200.7044%2C%200.1368%2C%200.2990%2C%200.5870%2C%200.1140%2C%200.2392%2C%200.4696%2C%200.0912)%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20gl_FragColor%20%3D%20texture2D(uSampler%2C%20vTextureCoord)%3B%5Cn%20%20%20gl_FragColor.rgb%20%3D%20mix(%20gl_FragColor.rgb%2C%20gl_FragColor.rgb%20*%20sepiaMatrix%2C%20sepia)%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20sepia%3A%20%7B%20type%3A%20'1f'%2C%20value%3A%201%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%7D%0A%0ASepiaFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0ASepiaFilter.prototype.constructor%20%3D%20SepiaFilter%3B%0Amodule.exports%20%3D%20SepiaFilter%3B%0A%0AObject.defineProperties(SepiaFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20strength%20of%20the%20sepia.%20%601%60%20will%20apply%20the%20full%20sepia%20effect%2C%20and%0A%20%20%20%20%20*%20%600%60%20will%20make%20the%20object%20its%20normal%20color.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.SepiaFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20sepia%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.sepia.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.sepia.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C99%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20The%20ColorMatrixFilter%20class%20lets%20you%20apply%20a%204x4%20matrix%20transformation%20on%20the%20RGBA%0A%20*%20color%20and%20alpha%20values%20of%20every%20pixel%20on%20your%20displayObject%20to%20produce%20a%20result%0A%20*%20with%20a%20new%20set%20of%20RGBA%20color%20and%20alpha%20values.%20It's%20pretty%20powerful!%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20ShockwaveFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20null%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20lowp%20float%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cn%5Cnuniform%20sampler2D%20uSampler%3B%5Cn%5Cnuniform%20vec2%20center%3B%5Cnuniform%20vec3%20params%3B%20%2F%2F%2010.0%2C%200.8%2C%200.1%5Cnuniform%20float%20time%3B%5Cn%5Cnvoid%20main()%5Cn%7B%5Cn%20%20%20%20vec2%20uv%20%3D%20vTextureCoord%3B%5Cn%20%20%20%20vec2%20texCoord%20%3D%20uv%3B%5Cn%5Cn%20%20%20%20float%20dist%20%3D%20distance(uv%2C%20center)%3B%5Cn%5Cn%20%20%20%20if%20(%20(dist%20%3C%3D%20(time%20%2B%20params.z))%20%26%26%20(dist%20%3E%3D%20(time%20-%20params.z))%20)%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20float%20diff%20%3D%20(dist%20-%20time)%3B%5Cn%20%20%20%20%20%20%20%20float%20powDiff%20%3D%201.0%20-%20pow(abs(diff*params.x)%2C%20params.y)%3B%5Cn%5Cn%20%20%20%20%20%20%20%20float%20diffTime%20%3D%20diff%20%20*%20powDiff%3B%5Cn%20%20%20%20%20%20%20%20vec2%20diffUV%20%3D%20normalize(uv%20-%20center)%3B%5Cn%20%20%20%20%20%20%20%20texCoord%20%3D%20uv%20%2B%20(diffUV%20*%20diffTime)%3B%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20gl_FragColor%20%3D%20texture2D(uSampler%2C%20texCoord)%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20center%3A%20%7B%20type%3A%20'v2'%2C%20value%3A%20%7B%20x%3A%200.5%2C%20y%3A%200.5%20%7D%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20params%3A%20%7B%20type%3A%20'v3'%2C%20value%3A%20%7B%20x%3A%2010%2C%20y%3A%200.8%2C%20z%3A%200.1%20%7D%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20time%3A%20%7B%20type%3A%20'1f'%2C%20value%3A%200%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%7D%0A%0AShockwaveFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0AShockwaveFilter.prototype.constructor%20%3D%20ShockwaveFilter%3B%0Amodule.exports%20%3D%20ShockwaveFilter%3B%0A%0AObject.defineProperties(ShockwaveFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20center%20of%20the%20shockwave%20in%20normalized%20screen%20coords.%20That%20is%0A%20%20%20%20%20*%20(0%2C0)%20is%20the%20top-left%20and%20(1%2C1)%20is%20the%20bottom%20right.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bobject%3Cstring%2C%20number%3E%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.ShockwaveFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20center%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.center.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.center.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20params%20of%20the%20shockwave.%20These%20modify%20the%20look%20and%20behavior%20of%0A%20%20%20%20%20*%20the%20shockwave%20as%20it%20ripples%20out.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bobject%3Cstring%2C%20number%3E%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.ShockwaveFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20params%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.params.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.params.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Sets%20the%20elapsed%20time%20of%20the%20shockwave.%20This%20controls%20the%20speed%20at%20which%0A%20%20%20%20%20*%20the%20shockwave%20ripples%20out.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.ShockwaveFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20time%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.time.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.time.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C100%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20%40author%20Vico%20%40vicocotea%0A%20*%20original%20filter%20https%3A%2F%2Fgithub.com%2Fevanw%2Fglfx.js%2Fblob%2Fmaster%2Fsrc%2Ffilters%2Fblur%2Ftiltshift.js%20by%20Evan%20Wallace%20%3A%20http%3A%2F%2Fmadebyevan.com%2F%0A%20*%2F%0A%0A%2F**%0A%20*%20A%20TiltShiftAxisFilter.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20TiltShiftAxisFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20null%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20mediump%20float%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cn%5Cnuniform%20sampler2D%20uSampler%3B%5Cnuniform%20float%20blur%3B%5Cnuniform%20float%20gradientBlur%3B%5Cnuniform%20vec2%20start%3B%5Cnuniform%20vec2%20end%3B%5Cnuniform%20vec2%20delta%3B%5Cnuniform%20vec2%20texSize%3B%5Cn%5Cnfloat%20random(vec3%20scale%2C%20float%20seed)%5Cn%7B%5Cn%20%20%20%20return%20fract(sin(dot(gl_FragCoord.xyz%20%2B%20seed%2C%20scale))%20*%2043758.5453%20%2B%20seed)%3B%5Cn%7D%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20%20vec4%20color%20%3D%20vec4(0.0)%3B%5Cn%20%20%20%20float%20total%20%3D%200.0%3B%5Cn%5Cn%20%20%20%20float%20offset%20%3D%20random(vec3(12.9898%2C%2078.233%2C%20151.7182)%2C%200.0)%3B%5Cn%20%20%20%20vec2%20normal%20%3D%20normalize(vec2(start.y%20-%20end.y%2C%20end.x%20-%20start.x))%3B%5Cn%20%20%20%20float%20radius%20%3D%20smoothstep(0.0%2C%201.0%2C%20abs(dot(vTextureCoord%20*%20texSize%20-%20start%2C%20normal))%20%2F%20gradientBlur)%20*%20blur%3B%5Cn%5Cn%20%20%20%20for%20(float%20t%20%3D%20-30.0%3B%20t%20%3C%3D%2030.0%3B%20t%2B%2B)%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20%20%20float%20percent%20%3D%20(t%20%2B%20offset%20-%200.5)%20%2F%2030.0%3B%5Cn%20%20%20%20%20%20%20%20float%20weight%20%3D%201.0%20-%20abs(percent)%3B%5Cn%20%20%20%20%20%20%20%20vec4%20sample%20%3D%20texture2D(uSampler%2C%20vTextureCoord%20%2B%20delta%20%2F%20texSize%20*%20percent%20*%20radius)%3B%5Cn%20%20%20%20%20%20%20%20sample.rgb%20*%3D%20sample.a%3B%5Cn%20%20%20%20%20%20%20%20color%20%2B%3D%20sample%20*%20weight%3B%5Cn%20%20%20%20%20%20%20%20total%20%2B%3D%20weight%3B%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20gl_FragColor%20%3D%20color%20%2F%20total%3B%5Cn%20%20%20%20gl_FragColor.rgb%20%2F%3D%20gl_FragColor.a%20%2B%200.00001%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20blur%3A%20%20%20%20%20%20%20%20%20%20%20%7B%20type%3A%20'1f'%2C%20value%3A%20100%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20gradientBlur%3A%20%20%20%7B%20type%3A%20'1f'%2C%20value%3A%20600%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20start%3A%20%20%20%20%20%20%20%20%20%20%7B%20type%3A%20'v2'%2C%20value%3A%20%7B%20x%3A%200%2C%20%20%20%20y%3A%20window.innerHeight%20%2F%202%20%7D%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20end%3A%20%20%20%20%20%20%20%20%20%20%20%20%7B%20type%3A%20'v2'%2C%20value%3A%20%7B%20x%3A%20600%2C%20%20y%3A%20window.innerHeight%20%2F%202%20%7D%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20delta%3A%20%20%20%20%20%20%20%20%20%20%7B%20type%3A%20'v2'%2C%20value%3A%20%7B%20x%3A%2030%2C%20%20%20y%3A%2030%20%7D%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20texSize%3A%20%20%20%20%20%20%20%20%7B%20type%3A%20'v2'%2C%20value%3A%20%7B%20x%3A%20window.innerWidth%2C%20y%3A%20window.innerHeight%20%7D%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%0A%20%20%20%20this.updateDelta()%3B%0A%7D%0A%0ATiltShiftAxisFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0ATiltShiftAxisFilter.prototype.constructor%20%3D%20TiltShiftAxisFilter%3B%0Amodule.exports%20%3D%20TiltShiftAxisFilter%3B%0A%0A%2F**%0A%20*%20Updates%20the%20filter%20delta%20values.%0A%20*%20This%20is%20overridden%20in%20the%20X%20and%20Y%20filters%2C%20does%20nothing%20for%20this%20class.%0A%20*%0A%20*%2F%0ATiltShiftAxisFilter.prototype.updateDelta%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.uniforms.delta.value.x%20%3D%200%3B%0A%20%20%20%20this.uniforms.delta.value.y%20%3D%200%3B%0A%7D%3B%0A%0AObject.defineProperties(TiltShiftAxisFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20strength%20of%20the%20blur.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.TiltShiftAxisFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20blur%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.blur.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.blur.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20strength%20of%20the%20gradient%20blur.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.TiltShiftAxisFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20gradientBlur%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.gradientBlur.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.gradientBlur.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20X%20value%20to%20start%20the%20effect%20at.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Point%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.TiltShiftAxisFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20start%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.start.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.start.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.updateDelta()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20X%20value%20to%20end%20the%20effect%20at.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Point%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.TiltShiftAxisFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20end%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.end.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.end.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.updateDelta()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C101%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%2C%0A%20%20%20%20TiltShiftXFilter%20%3D%20require('.%2FTiltShiftXFilter')%2C%0A%20%20%20%20TiltShiftYFilter%20%3D%20require('.%2FTiltShiftYFilter')%3B%0A%0A%2F**%0A%20*%20%40author%20Vico%20%40vicocotea%0A%20*%20original%20filter%20https%3A%2F%2Fgithub.com%2Fevanw%2Fglfx.js%2Fblob%2Fmaster%2Fsrc%2Ffilters%2Fblur%2Ftiltshift.js%20by%20Evan%20Wallace%20%3A%20http%3A%2F%2Fmadebyevan.com%2F%0A%20*%2F%0A%0A%2F**%0A%20*%20A%20TiltShift%20Filter.%20Manages%20the%20pass%20of%20both%20a%20TiltShiftXFilter%20and%20TiltShiftYFilter.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20TiltShiftFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this)%3B%0A%0A%20%20%20%20this.tiltShiftXFilter%20%3D%20new%20TiltShiftXFilter()%3B%0A%20%20%20%20this.tiltShiftYFilter%20%3D%20new%20TiltShiftYFilter()%3B%0A%7D%0A%0ATiltShiftFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0ATiltShiftFilter.prototype.constructor%20%3D%20TiltShiftFilter%3B%0Amodule.exports%20%3D%20TiltShiftFilter%3B%0A%0ATiltShiftFilter.prototype.applyFilter%20%3D%20function%20(renderer%2C%20input%2C%20output)%0A%7B%0A%20%20%20%20var%20renderTarget%20%3D%20renderer.filterManager.getRenderTarget(true)%3B%0A%0A%20%20%20%20this.tiltShiftXFilter.applyFilter(renderer%2C%20input%2C%20renderTarget)%3B%0A%0A%20%20%20%20this.tiltShiftYFilter.applyFilter(renderer%2C%20renderTarget%2C%20output)%3B%0A%0A%20%20%20%20renderer.filterManager.returnRenderTarget(renderTarget)%3B%0A%7D%3B%0A%0AObject.defineProperties(TiltShiftFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20strength%20of%20the%20blur.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.TiltShiftFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20blur%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.tiltShiftXFilter.blur%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.tiltShiftXFilter.blur%20%3D%20this.tiltShiftYFilter.blur%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20strength%20of%20the%20gradient%20blur.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.TiltShiftFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20gradientBlur%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.tiltShiftXFilter.gradientBlur%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.tiltShiftXFilter.gradientBlur%20%3D%20this.tiltShiftYFilter.gradientBlur%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20Y%20value%20to%20start%20the%20effect%20at.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.TiltShiftFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20start%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.tiltShiftXFilter.start%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.tiltShiftXFilter.start%20%3D%20this.tiltShiftYFilter.start%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20Y%20value%20to%20end%20the%20effect%20at.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.TiltShiftFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20end%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.tiltShiftXFilter.end%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.tiltShiftXFilter.end%20%3D%20this.tiltShiftYFilter.end%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%2C%22.%2FTiltShiftXFilter%22%3A102%2C%22.%2FTiltShiftYFilter%22%3A103%7D%5D%2C102%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20TiltShiftAxisFilter%20%3D%20require('.%2FTiltShiftAxisFilter')%3B%0A%0A%2F**%0A%20*%20%40author%20Vico%20%40vicocotea%0A%20*%20original%20filter%20https%3A%2F%2Fgithub.com%2Fevanw%2Fglfx.js%2Fblob%2Fmaster%2Fsrc%2Ffilters%2Fblur%2Ftiltshift.js%20by%20Evan%20Wallace%20%3A%20http%3A%2F%2Fmadebyevan.com%2F%0A%20*%2F%0A%0A%2F**%0A%20*%20A%20TiltShiftXFilter.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.TiltShiftAxisFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20TiltShiftXFilter()%0A%7B%0A%20%20%20%20TiltShiftAxisFilter.call(this)%3B%0A%7D%0A%0ATiltShiftXFilter.prototype%20%3D%20Object.create(TiltShiftAxisFilter.prototype)%3B%0ATiltShiftXFilter.prototype.constructor%20%3D%20TiltShiftXFilter%3B%0Amodule.exports%20%3D%20TiltShiftXFilter%3B%0A%0A%2F**%0A%20*%20Updates%20the%20filter%20delta%20values.%0A%20*%0A%20*%2F%0ATiltShiftXFilter.prototype.updateDelta%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20dx%20%3D%20this.uniforms.end.value.x%20-%20this.uniforms.start.value.x%3B%0A%20%20%20%20var%20dy%20%3D%20this.uniforms.end.value.y%20-%20this.uniforms.start.value.y%3B%0A%20%20%20%20var%20d%20%3D%20Math.sqrt(dx%20*%20dx%20%2B%20dy%20*%20dy)%3B%0A%0A%20%20%20%20this.uniforms.delta.value.x%20%3D%20dx%20%2F%20d%3B%0A%20%20%20%20this.uniforms.delta.value.y%20%3D%20dy%20%2F%20d%3B%0A%7D%3B%0A%0A%7D%2C%7B%22.%2FTiltShiftAxisFilter%22%3A100%7D%5D%2C103%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20TiltShiftAxisFilter%20%3D%20require('.%2FTiltShiftAxisFilter')%3B%0A%0A%2F**%0A%20*%20%40author%20Vico%20%40vicocotea%0A%20*%20original%20filter%20https%3A%2F%2Fgithub.com%2Fevanw%2Fglfx.js%2Fblob%2Fmaster%2Fsrc%2Ffilters%2Fblur%2Ftiltshift.js%20by%20Evan%20Wallace%20%3A%20http%3A%2F%2Fmadebyevan.com%2F%0A%20*%2F%0A%0A%2F**%0A%20*%20A%20TiltShiftYFilter.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.TiltShiftAxisFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20TiltShiftYFilter()%0A%7B%0A%20%20%20%20TiltShiftAxisFilter.call(this)%3B%0A%7D%0A%0ATiltShiftYFilter.prototype%20%3D%20Object.create(TiltShiftAxisFilter.prototype)%3B%0ATiltShiftYFilter.prototype.constructor%20%3D%20TiltShiftYFilter%3B%0Amodule.exports%20%3D%20TiltShiftYFilter%3B%0A%0A%2F**%0A%20*%20Updates%20the%20filter%20delta%20values.%0A%20*%0A%20*%2F%0ATiltShiftYFilter.prototype.updateDelta%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20dx%20%3D%20this.uniforms.end.value.x%20-%20this.uniforms.start.value.x%3B%0A%20%20%20%20var%20dy%20%3D%20this.uniforms.end.value.y%20-%20this.uniforms.start.value.y%3B%0A%20%20%20%20var%20d%20%3D%20Math.sqrt(dx%20*%20dx%20%2B%20dy%20*%20dy)%3B%0A%0A%20%20%20%20this.uniforms.delta.value.x%20%3D%20-dy%20%2F%20d%3B%0A%20%20%20%20this.uniforms.delta.value.y%20%3D%20dx%20%2F%20d%3B%0A%7D%3B%0A%0A%7D%2C%7B%22.%2FTiltShiftAxisFilter%22%3A100%7D%5D%2C104%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%2F%2F%20%40see%20https%3A%2F%2Fgithub.com%2Fsubstack%2Fbrfs%2Fissues%2F25%0A%0A%0A%2F**%0A%20*%20This%20filter%20applies%20a%20twist%20effect%20making%20display%20objects%20appear%20twisted%20in%20the%20given%20direction.%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.AbstractFilter%0A%20*%20%40memberof%20PIXI.filters%0A%20*%2F%0Afunction%20TwistFilter()%0A%7B%0A%20%20%20%20core.AbstractFilter.call(this%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20null%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20fragment%20shader%0A%20%20%20%20%20%20%20%20%22precision%20mediump%20float%3B%5Cn%5Cnvarying%20vec2%20vTextureCoord%3B%5Cn%5Cnuniform%20sampler2D%20uSampler%3B%5Cnuniform%20float%20radius%3B%5Cnuniform%20float%20angle%3B%5Cnuniform%20vec2%20offset%3B%5Cn%5Cnvoid%20main(void)%5Cn%7B%5Cn%20%20%20vec2%20coord%20%3D%20vTextureCoord%20-%20offset%3B%5Cn%20%20%20float%20dist%20%3D%20length(coord)%3B%5Cn%5Cn%20%20%20if%20(dist%20%3C%20radius)%5Cn%20%20%20%7B%5Cn%20%20%20%20%20%20%20float%20ratio%20%3D%20(radius%20-%20dist)%20%2F%20radius%3B%5Cn%20%20%20%20%20%20%20float%20angleMod%20%3D%20ratio%20*%20ratio%20*%20angle%3B%5Cn%20%20%20%20%20%20%20float%20s%20%3D%20sin(angleMod)%3B%5Cn%20%20%20%20%20%20%20float%20c%20%3D%20cos(angleMod)%3B%5Cn%20%20%20%20%20%20%20coord%20%3D%20vec2(coord.x%20*%20c%20-%20coord.y%20*%20s%2C%20coord.x%20*%20s%20%2B%20coord.y%20*%20c)%3B%5Cn%20%20%20%7D%5Cn%5Cn%20%20%20gl_FragColor%20%3D%20texture2D(uSampler%2C%20coord%2Boffset)%3B%5Cn%7D%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20radius%3A%20%20%20%20%20%7B%20type%3A%20'1f'%2C%20value%3A%200.5%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20angle%3A%20%20%20%20%20%20%7B%20type%3A%20'1f'%2C%20value%3A%205%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20offset%3A%20%20%20%20%20%7B%20type%3A%20'v2'%2C%20value%3A%20%7B%20x%3A%200.5%2C%20y%3A%200.5%20%7D%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%7D%0A%0ATwistFilter.prototype%20%3D%20Object.create(core.AbstractFilter.prototype)%3B%0ATwistFilter.prototype.constructor%20%3D%20TwistFilter%3B%0Amodule.exports%20%3D%20TwistFilter%3B%0A%0AObject.defineProperties(TwistFilter.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20This%20point%20describes%20the%20the%20offset%20of%20the%20twist.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Point%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.TwistFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20offset%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.offset.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.offset.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20This%20radius%20of%20the%20twist.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.TwistFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20radius%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.radius.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.radius.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20This%20angle%20of%20the%20twist.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.filters.TwistFilter%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20angle%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.angle.value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.uniforms.angle.value%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C105%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A(function%20(global)%7B%0A%2F%2F%20run%20the%20polyfills%0Arequire('.%2Fpolyfill')%3B%0A%0Avar%20core%20%3D%20module.exports%20%3D%20require('.%2Fcore')%3B%0A%0A%2F%2F%20add%20core%20plugins.%0Acore.extras%20%20%20%20%20%20%20%20%20%3D%20require('.%2Fextras')%3B%0Acore.filters%20%20%20%20%20%20%20%20%3D%20require('.%2Ffilters')%3B%0Acore.interaction%20%20%20%20%3D%20require('.%2Finteraction')%3B%0Acore.loaders%20%20%20%20%20%20%20%20%3D%20require('.%2Floaders')%3B%0Acore.mesh%20%20%20%20%20%20%20%20%20%20%20%3D%20require('.%2Fmesh')%3B%0A%0A%2F%2F%20export%20a%20premade%20loader%20instance%0A%2F**%0A%20*%20A%20premade%20instance%20of%20the%20loader%20that%20can%20be%20used%20to%20loader%20resources.%0A%20*%0A%20*%20%40name%20loader%0A%20*%20%40memberof%20PIXI%0A%20*%20%40property%20%7BPIXI.loaders.Loader%7D%0A%20*%2F%0Acore.loader%20%3D%20new%20core.loaders.Loader()%3B%0A%0A%2F%2F%20mixin%20the%20deprecation%20features.%0AObject.assign(core%2C%20require('.%2Fdeprecation'))%3B%0A%0A%2F%2F%20Always%20export%20pixi%20globally.%0Aglobal.PIXI%20%3D%20core%3B%0A%0A%7D).call(this%2Ctypeof%20global%20!%3D%3D%20%22undefined%22%20%3F%20global%20%3A%20typeof%20self%20!%3D%3D%20%22undefined%22%20%3F%20self%20%3A%20typeof%20window%20!%3D%3D%20%22undefined%22%20%3F%20window%20%3A%20%7B%7D)%0A%0A%7D%2C%7B%22.%2Fcore%22%3A20%2C%22.%2Fdeprecation%22%3A69%2C%22.%2Fextras%22%3A76%2C%22.%2Ffilters%22%3A93%2C%22.%2Finteraction%22%3A108%2C%22.%2Floaders%22%3A111%2C%22.%2Fmesh%22%3A117%2C%22.%2Fpolyfill%22%3A122%7D%5D%2C106%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2Fcore')%3B%0A%0A%2F**%0A%20*%20Holds%20all%20information%20related%20to%20an%20Interaction%20event%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI.interaction%0A%20*%2F%0Afunction%20InteractionData()%0A%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20This%20point%20stores%20the%20global%20coords%20of%20where%20the%20touch%2Fmouse%20event%20happened%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Point%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.global%20%3D%20new%20core.Point()%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20target%20Sprite%20that%20was%20interacted%20with%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Sprite%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.target%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20When%20passed%20to%20an%20event%20handler%2C%20this%20will%20be%20the%20original%20DOM%20Event%20that%20was%20captured%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BEvent%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.originalEvent%20%3D%20null%3B%0A%7D%0A%0AInteractionData.prototype.constructor%20%3D%20InteractionData%3B%0Amodule.exports%20%3D%20InteractionData%3B%0A%0A%2F**%0A%20*%20This%20will%20return%20the%20local%20coordinates%20of%20the%20specified%20displayObject%20for%20this%20InteractionData%0A%20*%0A%20*%20%40param%20displayObject%20%7BPIXI.DisplayObject%7D%20The%20DisplayObject%20that%20you%20would%20like%20the%20local%20coords%20off%0A%20*%20%40param%20%5Bpoint%5D%20%7BPIXI.Point%7D%20A%20Point%20object%20in%20which%20to%20store%20the%20value%2C%20optional%20(otherwise%20will%20create%20a%20new%20point)%0A%20*%20param%20%5BglobalPos%5D%20%7BPIXI.Point%7D%20A%20Point%20object%20containing%20your%20custom%20global%20coords%2C%20optional%20(otherwise%20will%20use%20the%20current%20global%20coords)%0A%20*%20%40return%20%7BPIXI.Point%7D%20A%20point%20containing%20the%20coordinates%20of%20the%20InteractionData%20position%20relative%20to%20the%20DisplayObject%0A%20*%2F%0AInteractionData.prototype.getLocalPosition%20%3D%20function%20(displayObject%2C%20point%2C%20globalPos)%0A%7B%0A%20%20%20%20return%20displayObject.toLocal(globalPos%20%3F%20globalPos%20%3A%20this.global%2C%20point)%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fcore%22%3A20%7D%5D%2C107%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2Fcore')%2C%0A%20%20%20%20InteractionData%20%3D%20require('.%2FInteractionData')%3B%0A%0A%2F%2F%20Mix%20interactiveTarget%20into%20core.DisplayObject.prototype%0AObject.assign(%0A%20%20%20%20core.DisplayObject.prototype%2C%0A%20%20%20%20require('.%2FinteractiveTarget')%0A)%3B%0A%0A%2F**%0A%20*%20The%20interaction%20manager%20deals%20with%20mouse%20and%20touch%20events.%20Any%20DisplayObject%20can%20be%20interactive%0A%20*%20if%20its%20interactive%20parameter%20is%20set%20to%20true%0A%20*%20This%20manager%20also%20supports%20multitouch.%0A%20*%0A%20*%20%40class%0A%20*%20%40memberof%20PIXI.interaction%0A%20*%20%40param%20renderer%20%7BPIXI.CanvasRenderer%7CPIXI.WebGLRenderer%7D%20A%20reference%20to%20the%20current%20renderer%0A%20*%20%40param%20%5Boptions%5D%20%7Bobject%7D%0A%20*%20%40param%20%5Boptions.autoPreventDefault%3Dtrue%5D%20%7Bboolean%7D%20Should%20the%20manager%20automatically%20prevent%20default%20browser%20actions.%0A%20*%20%40param%20%5Boptions.interactionFrequency%3D10%5D%20%7Bnumber%7D%20Frequency%20increases%20the%20interaction%20events%20will%20be%20checked.%0A%20*%2F%0Afunction%20InteractionManager(renderer%2C%20options)%0A%7B%0A%20%20%20%20options%20%3D%20options%20%7C%7C%20%7B%7D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20renderer%20this%20interaction%20manager%20works%20for.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.SystemRenderer%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.renderer%20%3D%20renderer%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Should%20default%20browser%20actions%20automatically%20be%20prevented.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40default%20true%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.autoPreventDefault%20%3D%20options.autoPreventDefault%20!%3D%3D%20undefined%20%3F%20options.autoPreventDefault%20%3A%20true%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20As%20this%20frequency%20increases%20the%20interaction%20events%20will%20be%20checked%20more%20often.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%2010%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.interactionFrequency%20%3D%20options.interactionFrequency%20%7C%7C%2010%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20mouse%20data%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.interaction.InteractionData%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.mouse%20%3D%20new%20InteractionData()%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20An%20event%20data%20object%20to%20handle%20all%20the%20event%20tracking%2Fdispatching%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bobject%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.eventData%20%3D%20%7B%0A%20%20%20%20%20%20%20%20stopped%3A%20false%2C%0A%20%20%20%20%20%20%20%20target%3A%20null%2C%0A%20%20%20%20%20%20%20%20type%3A%20null%2C%0A%20%20%20%20%20%20%20%20data%3A%20this.mouse%2C%0A%20%20%20%20%20%20%20%20stopPropagation%3Afunction()%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.stopped%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Tiny%20little%20interactiveData%20pool%20!%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.interaction.InteractionData%5B%5D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.interactiveDataPool%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20DOM%20element%20to%20bind%20to.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BHTMLElement%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.interactionDOMElement%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Have%20events%20been%20attached%20to%20the%20dom%20element%3F%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.eventsAdded%20%3D%20false%3B%0A%0A%20%20%20%20%2F%2Fthis%20will%20make%20it%20so%20that%20you%20don't%20have%20to%20call%20bind%20all%20the%20time%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7BFunction%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.onMouseUp%20%3D%20this.onMouseUp.bind(this)%3B%0A%20%20%20%20this.processMouseUp%20%3D%20this.processMouseUp.bind(%20this%20)%3B%0A%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7BFunction%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.onMouseDown%20%3D%20this.onMouseDown.bind(this)%3B%0A%20%20%20%20this.processMouseDown%20%3D%20this.processMouseDown.bind(%20this%20)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7BFunction%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.onMouseMove%20%3D%20this.onMouseMove.bind(%20this%20)%3B%0A%20%20%20%20this.processMouseMove%20%3D%20this.processMouseMove.bind(%20this%20)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7BFunction%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.onMouseOut%20%3D%20this.onMouseOut.bind(this)%3B%0A%20%20%20%20this.processMouseOverOut%20%3D%20this.processMouseOverOut.bind(%20this%20)%3B%0A%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7BFunction%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.onTouchStart%20%3D%20this.onTouchStart.bind(this)%3B%0A%20%20%20%20this.processTouchStart%20%3D%20this.processTouchStart.bind(this)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7BFunction%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.onTouchEnd%20%3D%20this.onTouchEnd.bind(this)%3B%0A%20%20%20%20this.processTouchEnd%20%3D%20this.processTouchEnd.bind(this)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7BFunction%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.onTouchMove%20%3D%20this.onTouchMove.bind(this)%3B%0A%20%20%20%20this.processTouchMove%20%3D%20this.processTouchMove.bind(this)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.last%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20css%20style%20of%20the%20cursor%20that%20is%20being%20used%0A%20%20%20%20%20*%20%40member%20%7Bstring%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.currentCursorStyle%20%3D%20'inherit'%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Internal%20cached%20var%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Point%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._tempPoint%20%3D%20new%20core.Point()%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20current%20resolution%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.resolution%20%3D%201%3B%0A%0A%20%20%20%20this.setTargetElement(this.renderer.view%2C%20this.renderer.resolution)%3B%0A%7D%0A%0AInteractionManager.prototype.constructor%20%3D%20InteractionManager%3B%0Amodule.exports%20%3D%20InteractionManager%3B%0A%0A%2F**%0A%20*%20Sets%20the%20DOM%20element%20which%20will%20receive%20mouse%2Ftouch%20events.%20This%20is%20useful%20for%20when%20you%20have%0A%20*%20other%20DOM%20elements%20on%20top%20of%20the%20renderers%20Canvas%20element.%20With%20this%20you'll%20be%20bale%20to%20deletegate%0A%20*%20another%20DOM%20element%20to%20receive%20those%20events.%0A%20*%0A%20*%20%40param%20element%20%7BHTMLElement%7D%20the%20DOM%20element%20which%20will%20receive%20mouse%20and%20touch%20events.%0A%20*%20%40param%20%5Bresolution%3D1%5D%20%7Bnumber%7D%20THe%20resolution%20of%20the%20new%20element%20(relative%20to%20the%20canvas).%0A%20*%20%40private%0A%20*%2F%0AInteractionManager.prototype.setTargetElement%20%3D%20function%20(element%2C%20resolution)%0A%7B%0A%20%20%20%20this.removeEvents()%3B%0A%0A%20%20%20%20this.interactionDOMElement%20%3D%20element%3B%0A%0A%20%20%20%20this.resolution%20%3D%20resolution%20%7C%7C%201%3B%0A%0A%20%20%20%20this.addEvents()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Registers%20all%20the%20DOM%20events%0A%20*%0A%20*%20%40private%0A%20*%2F%0AInteractionManager.prototype.addEvents%20%3D%20function%20()%0A%7B%0A%20%20%20%20if%20(!this.interactionDOMElement)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20core.ticker.shared.add(this.update%2C%20this)%3B%0A%0A%20%20%20%20if%20(window.navigator.msPointerEnabled)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.interactionDOMElement.style%5B'-ms-content-zooming'%5D%20%3D%20'none'%3B%0A%20%20%20%20%20%20%20%20this.interactionDOMElement.style%5B'-ms-touch-action'%5D%20%3D%20'none'%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20window.document.addEventListener('mousemove'%2C%20%20%20%20this.onMouseMove%2C%20true)%3B%0A%20%20%20%20this.interactionDOMElement.addEventListener('mousedown'%2C%20%20%20%20this.onMouseDown%2C%20true)%3B%0A%20%20%20%20this.interactionDOMElement.addEventListener('mouseout'%2C%20%20%20%20%20this.onMouseOut%2C%20true)%3B%0A%0A%20%20%20%20this.interactionDOMElement.addEventListener('touchstart'%2C%20%20%20this.onTouchStart%2C%20true)%3B%0A%20%20%20%20this.interactionDOMElement.addEventListener('touchend'%2C%20%20%20%20%20this.onTouchEnd%2C%20true)%3B%0A%20%20%20%20this.interactionDOMElement.addEventListener('touchmove'%2C%20%20%20%20this.onTouchMove%2C%20true)%3B%0A%0A%20%20%20%20window.addEventListener('mouseup'%2C%20%20this.onMouseUp%2C%20true)%3B%0A%0A%20%20%20%20this.eventsAdded%20%3D%20true%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Removes%20all%20the%20DOM%20events%20that%20were%20previously%20registered%0A%20*%0A%20*%20%40private%0A%20*%2F%0AInteractionManager.prototype.removeEvents%20%3D%20function%20()%0A%7B%0A%20%20%20%20if%20(!this.interactionDOMElement)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20core.ticker.shared.remove(this.update)%3B%0A%0A%20%20%20%20if%20(window.navigator.msPointerEnabled)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.interactionDOMElement.style%5B'-ms-content-zooming'%5D%20%3D%20''%3B%0A%20%20%20%20%20%20%20%20this.interactionDOMElement.style%5B'-ms-touch-action'%5D%20%3D%20''%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20window.document.removeEventListener('mousemove'%2C%20this.onMouseMove%2C%20true)%3B%0A%20%20%20%20this.interactionDOMElement.removeEventListener('mousedown'%2C%20this.onMouseDown%2C%20true)%3B%0A%20%20%20%20this.interactionDOMElement.removeEventListener('mouseout'%2C%20%20this.onMouseOut%2C%20true)%3B%0A%0A%20%20%20%20this.interactionDOMElement.removeEventListener('touchstart'%2C%20this.onTouchStart%2C%20true)%3B%0A%20%20%20%20this.interactionDOMElement.removeEventListener('touchend'%2C%20%20this.onTouchEnd%2C%20true)%3B%0A%20%20%20%20this.interactionDOMElement.removeEventListener('touchmove'%2C%20this.onTouchMove%2C%20true)%3B%0A%0A%20%20%20%20this.interactionDOMElement%20%3D%20null%3B%0A%0A%20%20%20%20window.removeEventListener('mouseup'%2C%20%20this.onMouseUp%2C%20true)%3B%0A%0A%20%20%20%20this.eventsAdded%20%3D%20false%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Updates%20the%20state%20of%20interactive%20objects.%0A%20*%20Invoked%20by%20a%20throttled%20ticker%20update%20from%0A%20*%20%7B%40link%20PIXI.ticker.shared%7D.%0A%20*%0A%20*%20%40param%20deltaTime%20%7Bnumber%7D%0A%20*%2F%0AInteractionManager.prototype.update%20%3D%20function%20(deltaTime)%0A%7B%0A%20%20%20%20this._deltaTime%20%2B%3D%20deltaTime%3B%0A%0A%20%20%20%20if%20(this._deltaTime%20%3C%20this.interactionFrequency)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this._deltaTime%20%3D%200%3B%0A%0A%20%20%20%20if%20(!this.interactionDOMElement)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20if%20the%20user%20move%20the%20mouse%20this%20check%20has%20already%20been%20dfone%20using%20the%20mouse%20move!%0A%20%20%20%20if(this.didMove)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.didMove%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.cursor%20%3D%20'inherit'%3B%0A%0A%20%20%20%20this.processInteractive(this.mouse.global%2C%20this.renderer._lastObjectRendered%2C%20this.processMouseOverOut%2C%20true%20)%3B%0A%0A%20%20%20%20if%20(this.currentCursorStyle%20!%3D%3D%20this.cursor)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.currentCursorStyle%20%3D%20this.cursor%3B%0A%20%20%20%20%20%20%20%20this.interactionDOMElement.style.cursor%20%3D%20this.cursor%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2FTODO%0A%7D%3B%0A%0A%2F**%0A%20*%20Dispatches%20an%20event%20on%20the%20display%20object%20that%20was%20interacted%20with%0A%20*%0A%20*%20%40param%20displayObject%20%7BPIXI.Container%7CPIXI.Sprite%7CPIXI.extras.TilingSprite%7D%20the%20display%20object%20in%20question%0A%20*%20%40param%20eventString%20%7Bstring%7D%20the%20name%20of%20the%20event%20(e.g%2C%20mousedown)%0A%20*%20%40param%20eventData%20%7Bobject%7D%20the%20event%20data%20object%0A%20*%20%40private%0A%20*%2F%0AInteractionManager.prototype.dispatchEvent%20%3D%20function%20(%20displayObject%2C%20eventString%2C%20eventData%20)%0A%7B%0A%20%20%20%20if(!eventData.stopped)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20eventData.target%20%3D%20displayObject%3B%0A%20%20%20%20%20%20%20%20eventData.type%20%3D%20eventString%3B%0A%0A%20%20%20%20%20%20%20%20displayObject.emit(%20eventString%2C%20eventData%20)%3B%0A%0A%20%20%20%20%20%20%20%20if(%20displayObject%5BeventString%5D%20)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20displayObject%5BeventString%5D(%20eventData%20)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Maps%20x%20and%20y%20coords%20from%20a%20DOM%20object%20and%20maps%20them%20correctly%20to%20the%20pixi%20view.%20The%20resulting%20value%20is%20stored%20in%20the%20point.%0A%20*%20This%20takes%20into%20account%20the%20fact%20that%20the%20DOM%20element%20could%20be%20scaled%20and%20positioned%20anywhere%20on%20the%20screen.%0A%20*%0A%20*%20%40param%20%20%7BPIXI.Point%7D%20point%20the%20point%20that%20the%20result%20will%20be%20stored%20in%0A%20*%20%40param%20%20%7Bnumber%7D%20x%20%20%20%20%20the%20x%20coord%20of%20the%20position%20to%20map%0A%20*%20%40param%20%20%7Bnumber%7D%20y%20%20%20%20%20the%20y%20coord%20of%20the%20position%20to%20map%0A%20*%2F%0AInteractionManager.prototype.mapPositionToPoint%20%3D%20function%20(%20point%2C%20x%2C%20y%20)%0A%7B%0A%20%20%20%20var%20rect%20%3D%20this.interactionDOMElement.getBoundingClientRect()%3B%0A%20%20%20%20point.x%20%3D%20(%20(%20x%20-%20rect.left%20)%20*%20(this.interactionDOMElement.width%20%20%2F%20rect.width%20%20)%20)%20%2F%20this.resolution%3B%0A%20%20%20%20point.y%20%3D%20(%20(%20y%20-%20rect.top%20%20)%20*%20(this.interactionDOMElement.height%20%2F%20rect.height%20)%20)%20%2F%20this.resolution%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20This%20function%20is%20provides%20a%20neat%20way%20of%20crawling%20through%20the%20scene%20graph%20and%20running%20a%20specified%20function%20on%20all%20interactive%20objects%20it%20finds.%0A%20*%20It%20will%20also%20take%20care%20of%20hit%20testing%20the%20interactive%20objects%20and%20passes%20the%20hit%20across%20in%20the%20function.%0A%20*%0A%20*%20%40param%20%20%7BPIXI.Point%7D%20point%20the%20point%20that%20is%20tested%20for%20collision%0A%20*%20%40param%20%20%7BPIXI.Container%7CPIXI.Sprite%7CPIXI.extras.TilingSprite%7D%20displayObject%20the%20displayObject%20that%20will%20be%20hit%20test%20(recurcsivly%20crawls%20its%20children)%0A%20*%20%40param%20%20%7BFunction%7D%20func%20the%20function%20that%20will%20be%20called%20on%20each%20interactive%20object.%20The%20displayObject%20and%20hit%20will%20be%20passed%20to%20the%20function%0A%20*%20%40param%20%20%7Bboolean%7D%20hitTest%20this%20indicates%20if%20the%20objects%20inside%20should%20be%20hit%20test%20against%20the%20point%0A%20*%20%40return%20%7Bboolean%7D%20returns%20true%20if%20the%20displayObject%20hit%20the%20point%0A%20*%2F%0AInteractionManager.prototype.processInteractive%20%3D%20function%20(point%2C%20displayObject%2C%20func%2C%20hitTest%2C%20interactive%20)%0A%7B%0A%20%20%20%20if(!displayObject%20%7C%7C%20!displayObject.visible)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20children%20%3D%20displayObject.children%3B%0A%0A%20%20%20%20var%20hit%20%3D%20false%3B%0A%0A%20%20%20%20%2F%2F%20if%20the%20object%20is%20interactive%20we%20must%20hit%20test%20all%20its%20children..%0A%20%20%20%20interactive%20%3D%20interactive%20%7C%7C%20displayObject.interactive%3B%0A%0A%20%20%20%20if(displayObject.interactiveChildren)%0A%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%20children.length-1%3B%20i%20%3E%3D%200%3B%20i--)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(!%20hit%20%20%26%26%20hitTest)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20hit%20%3D%20this.processInteractive(point%2C%20children%5Bi%5D%2C%20func%2C%20true%2C%20interactive%20)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20now%20we%20know%20we%20can%20miss%20it%20all!%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.processInteractive(point%2C%20children%5Bi%5D%2C%20func%2C%20false%2C%20false%20)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(interactive)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if(hitTest)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(displayObject.hitArea)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20lets%20use%20the%20hit%20object%20first!%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20displayObject.worldTransform.applyInverse(point%2C%20%20this._tempPoint)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20hit%20%3D%20displayObject.hitArea.contains(%20this._tempPoint.x%2C%20this._tempPoint.y%20)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20if(displayObject.containsPoint)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20hit%20%3D%20displayObject.containsPoint(point)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if(displayObject.interactive)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20func(displayObject%2C%20hit)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20hit%3B%0A%7D%3B%0A%0A%0A%0A%0A%2F**%0A%20*%20Is%20called%20when%20the%20mouse%20button%20is%20pressed%20down%20on%20the%20renderer%20element%0A%20*%0A%20*%20%40param%20event%20%7BEvent%7D%20The%20DOM%20event%20of%20a%20mouse%20button%20being%20pressed%20down%0A%20*%20%40private%0A%20*%2F%0AInteractionManager.prototype.onMouseDown%20%3D%20function%20(event)%0A%7B%0A%20%20%20%20this.mouse.originalEvent%20%3D%20event%3B%0A%20%20%20%20this.eventData.data%20%3D%20this.mouse%3B%0A%20%20%20%20this.eventData.stopped%20%3D%20false%3B%0A%0A%20%20%20%20%2F%2F%20Update%20internal%20mouse%20reference%0A%20%20%20%20this.mapPositionToPoint(%20this.mouse.global%2C%20event.clientX%2C%20event.clientY)%3B%0A%0A%20%20%20%20if%20(this.autoPreventDefault)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.mouse.originalEvent.preventDefault()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.processInteractive(this.mouse.global%2C%20this.renderer._lastObjectRendered%2C%20this.processMouseDown%2C%20true%20)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Processes%20the%20result%20of%20the%20mouse%20down%20check%20and%20dispatches%20the%20event%20if%20need%20be%0A%20*%0A%20*%20%40param%20displayObject%20%7BPIXI.Container%7CPIXI.Sprite%7CPIXI.extras.TilingSprite%7D%20The%20display%20object%20that%20was%20tested%0A%20*%20%40param%20hit%20%7Bboolean%7D%20the%20result%20of%20the%20hit%20test%20on%20the%20dispay%20object%0A%20*%20%40private%0A%20*%2F%0AInteractionManager.prototype.processMouseDown%20%3D%20function%20(%20displayObject%2C%20hit%20)%0A%7B%0A%20%20%20%20var%20e%20%3D%20this.mouse.originalEvent%3B%0A%0A%20%20%20%20var%20isRightButton%20%3D%20e.button%20%3D%3D%3D%202%20%7C%7C%20e.which%20%3D%3D%3D%203%3B%0A%0A%20%20%20%20if(hit)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20displayObject%5B%20isRightButton%20%3F%20'_isRightDown'%20%3A%20'_isLeftDown'%20%5D%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20this.dispatchEvent(%20displayObject%2C%20isRightButton%20%3F%20'rightdown'%20%3A%20'mousedown'%2C%20this.eventData%20)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%0A%0A%2F**%0A%20*%20Is%20called%20when%20the%20mouse%20button%20is%20released%20on%20the%20renderer%20element%0A%20*%0A%20*%20%40param%20event%20%7BEvent%7D%20The%20DOM%20event%20of%20a%20mouse%20button%20being%20released%0A%20*%20%40private%0A%20*%2F%0AInteractionManager.prototype.onMouseUp%20%3D%20function%20(event)%0A%7B%0A%20%20%20%20this.mouse.originalEvent%20%3D%20event%3B%0A%20%20%20%20this.eventData.data%20%3D%20this.mouse%3B%0A%20%20%20%20this.eventData.stopped%20%3D%20false%3B%0A%0A%20%20%20%20%2F%2F%20Update%20internal%20mouse%20reference%0A%20%20%20%20this.mapPositionToPoint(%20this.mouse.global%2C%20event.clientX%2C%20event.clientY)%3B%0A%0A%20%20%20%20this.processInteractive(this.mouse.global%2C%20this.renderer._lastObjectRendered%2C%20this.processMouseUp%2C%20true%20)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Processes%20the%20result%20of%20the%20mouse%20up%20check%20and%20dispatches%20the%20event%20if%20need%20be%0A%20*%0A%20*%20%40param%20displayObject%20%7BPIXI.Container%7CPIXI.Sprite%7CPIXI.extras.TilingSprite%7D%20The%20display%20object%20that%20was%20tested%0A%20*%20%40param%20hit%20%7Bboolean%7D%20the%20result%20of%20the%20hit%20test%20on%20the%20display%20object%0A%20*%20%40private%0A%20*%2F%0AInteractionManager.prototype.processMouseUp%20%3D%20function%20(%20displayObject%2C%20hit%20)%0A%7B%0A%20%20%20%20var%20e%20%3D%20this.mouse.originalEvent%3B%0A%0A%20%20%20%20var%20isRightButton%20%3D%20e.button%20%3D%3D%3D%202%20%7C%7C%20e.which%20%3D%3D%3D%203%3B%0A%20%20%20%20var%20isDown%20%3D%20%20isRightButton%20%3F%20'_isRightDown'%20%3A%20'_isLeftDown'%3B%0A%0A%20%20%20%20if(hit)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.dispatchEvent(%20displayObject%2C%20isRightButton%20%3F%20'rightup'%20%3A%20'mouseup'%2C%20this.eventData%20)%3B%0A%0A%20%20%20%20%20%20%20%20if(%20displayObject%5B%20isDown%20%5D%20)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20displayObject%5B%20isDown%20%5D%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.dispatchEvent(%20displayObject%2C%20isRightButton%20%3F%20'rightclick'%20%3A%20'click'%2C%20this.eventData%20)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if(%20displayObject%5B%20isDown%20%5D%20)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20displayObject%5B%20isDown%20%5D%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.dispatchEvent(%20displayObject%2C%20isRightButton%20%3F%20'rightupoutside'%20%3A%20'mouseupoutside'%2C%20this.eventData%20)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Is%20called%20when%20the%20mouse%20moves%20across%20the%20renderer%20element%0A%20*%0A%20*%20%40param%20event%20%7BEvent%7D%20The%20DOM%20event%20of%20the%20mouse%20moving%0A%20*%20%40private%0A%20*%2F%0AInteractionManager.prototype.onMouseMove%20%3D%20function%20(event)%0A%7B%0A%20%20%20%20this.mouse.originalEvent%20%3D%20event%3B%0A%20%20%20%20this.eventData.data%20%3D%20this.mouse%3B%0A%20%20%20%20this.eventData.stopped%20%3D%20false%3B%0A%0A%20%20%20%20this.mapPositionToPoint(%20this.mouse.global%2C%20event.clientX%2C%20event.clientY)%3B%0A%0A%20%20%20%20this.didMove%20%3D%20true%3B%0A%0A%20%20%20%20this.cursor%20%3D%20'inherit'%3B%0A%0A%20%20%20%20this.processInteractive(this.mouse.global%2C%20this.renderer._lastObjectRendered%2C%20this.processMouseMove%2C%20true%20)%3B%0A%0A%20%20%20%20if%20(this.currentCursorStyle%20!%3D%3D%20this.cursor)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.currentCursorStyle%20%3D%20this.cursor%3B%0A%20%20%20%20%20%20%20%20this.interactionDOMElement.style.cursor%20%3D%20this.cursor%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2FTODO%20BUG%20for%20parents%20ineractive%20object%20(border%20order%20issue)%0A%7D%3B%0A%0A%2F**%0A%20*%20Processes%20the%20result%20of%20the%20mouse%20move%20check%20and%20dispatches%20the%20event%20if%20need%20be%0A%20*%0A%20*%20%40param%20displayObject%20%7BPIXI.Container%7CPIXI.Sprite%7CPIXI.extras.TilingSprite%7D%20The%20display%20object%20that%20was%20tested%0A%20*%20%40param%20hit%20%7Bboolean%7D%20the%20result%20of%20the%20hit%20test%20on%20the%20display%20object%0A%20*%20%40private%0A%20*%2F%0AInteractionManager.prototype.processMouseMove%20%3D%20function%20(%20displayObject%2C%20hit%20)%0A%7B%0A%20%20%20%20this.dispatchEvent(%20displayObject%2C%20'mousemove'%2C%20this.eventData)%3B%0A%20%20%20%20this.processMouseOverOut(displayObject%2C%20hit)%3B%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Is%20called%20when%20the%20mouse%20is%20moved%20out%20of%20the%20renderer%20element%0A%20*%0A%20*%20%40param%20event%20%7BEvent%7D%20The%20DOM%20event%20of%20a%20mouse%20being%20moved%20out%0A%20*%20%40private%0A%20*%2F%0AInteractionManager.prototype.onMouseOut%20%3D%20function%20(event)%0A%7B%0A%20%20%20%20this.mouse.originalEvent%20%3D%20event%3B%0A%20%20%20%20this.eventData.stopped%20%3D%20false%3B%0A%0A%20%20%20%20%2F%2F%20Update%20internal%20mouse%20reference%0A%20%20%20%20this.mapPositionToPoint(%20this.mouse.global%2C%20event.clientX%2C%20event.clientY)%3B%0A%0A%20%20%20%20this.interactionDOMElement.style.cursor%20%3D%20'inherit'%3B%0A%0A%20%20%20%20%2F%2F%20TODO%20optimize%20by%20not%20check%20EVERY%20TIME!%20maybe%20half%20as%20often%3F%20%2F%2F%0A%20%20%20%20this.mapPositionToPoint(%20this.mouse.global%2C%20event.clientX%2C%20event.clientY%20)%3B%0A%0A%20%20%20%20this.processInteractive(%20this.mouse.global%2C%20this.renderer._lastObjectRendered%2C%20this.processMouseOverOut%2C%20false%20)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Processes%20the%20result%20of%20the%20mouse%20over%2Fout%20check%20and%20dispatches%20the%20event%20if%20need%20be%0A%20*%0A%20*%20%40param%20displayObject%20%7BPIXI.Container%7CPIXI.Sprite%7CPIXI.extras.TilingSprite%7D%20The%20display%20object%20that%20was%20tested%0A%20*%20%40param%20hit%20%7Bboolean%7D%20the%20result%20of%20the%20hit%20test%20on%20the%20display%20object%0A%20*%20%40private%0A%20*%2F%0AInteractionManager.prototype.processMouseOverOut%20%3D%20function%20(%20displayObject%2C%20hit%20)%0A%7B%0A%20%20%20%20if(hit)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if(!displayObject._over)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20displayObject._over%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.dispatchEvent(%20displayObject%2C%20'mouseover'%2C%20this.eventData%20)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if%20(displayObject.buttonMode)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.cursor%20%3D%20displayObject.defaultCursor%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if(displayObject._over)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20displayObject._over%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.dispatchEvent(%20displayObject%2C%20'mouseout'%2C%20this.eventData)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Is%20called%20when%20a%20touch%20is%20started%20on%20the%20renderer%20element%0A%20*%0A%20*%20%40param%20event%20%7BEvent%7D%20The%20DOM%20event%20of%20a%20touch%20starting%20on%20the%20renderer%20view%0A%20*%20%40private%0A%20*%2F%0AInteractionManager.prototype.onTouchStart%20%3D%20function%20(event)%0A%7B%0A%20%20%20%20if%20(this.autoPreventDefault)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20event.preventDefault()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20changedTouches%20%3D%20event.changedTouches%3B%0A%20%20%20%20var%20cLength%20%3D%20changedTouches.length%3B%0A%0A%20%20%20%20for%20(var%20i%3D0%3B%20i%20%3C%20cLength%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20touchEvent%20%3D%20changedTouches%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%2F%2FTODO%20POOL%0A%20%20%20%20%20%20%20%20var%20touchData%20%3D%20this.getTouchData(%20touchEvent%20)%3B%0A%0A%20%20%20%20%20%20%20%20touchData.originalEvent%20%3D%20event%3B%0A%0A%20%20%20%20%20%20%20%20this.eventData.data%20%3D%20touchData%3B%0A%20%20%20%20%20%20%20%20this.eventData.stopped%20%3D%20false%3B%0A%0A%20%20%20%20%20%20%20%20this.processInteractive(%20touchData.global%2C%20this.renderer._lastObjectRendered%2C%20this.processTouchStart%2C%20true%20)%3B%0A%0A%20%20%20%20%20%20%20%20this.returnTouchData(%20touchData%20)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Processes%20the%20result%20of%20a%20touch%20check%20and%20dispatches%20the%20event%20if%20need%20be%0A%20*%0A%20*%20%40param%20displayObject%20%7BPIXI.Container%7CPIXI.Sprite%7CPIXI.extras.TilingSprite%7D%20The%20display%20object%20that%20was%20tested%0A%20*%20%40param%20hit%20%7Bboolean%7D%20the%20result%20of%20the%20hit%20test%20on%20the%20display%20object%0A%20*%20%40private%0A%20*%2F%0AInteractionManager.prototype.processTouchStart%20%3D%20function%20(%20displayObject%2C%20hit%20)%0A%7B%0A%20%20%20%20%2F%2Fconsole.log(%22hit%22%20%2B%20hit)%0A%20%20%20%20if(hit)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20displayObject._touchDown%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20this.dispatchEvent(%20displayObject%2C%20'touchstart'%2C%20this.eventData%20)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Is%20called%20when%20a%20touch%20ends%20on%20the%20renderer%20element%0A%20*%0A%20*%20%40param%20event%20%7BEvent%7D%20The%20DOM%20event%20of%20a%20touch%20ending%20on%20the%20renderer%20view%0A%20*%2F%0AInteractionManager.prototype.onTouchEnd%20%3D%20function%20(event)%0A%7B%0A%20%20%20%20if%20(this.autoPreventDefault)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20event.preventDefault()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20changedTouches%20%3D%20event.changedTouches%3B%0A%20%20%20%20var%20cLength%20%3D%20changedTouches.length%3B%0A%0A%20%20%20%20for%20(var%20i%3D0%3B%20i%20%3C%20cLength%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20touchEvent%20%3D%20changedTouches%5Bi%5D%3B%0A%0A%20%20%20%20%20%20%20%20var%20touchData%20%3D%20this.getTouchData(%20touchEvent%20)%3B%0A%0A%20%20%20%20%20%20%20%20touchData.originalEvent%20%3D%20event%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2FTODO%20this%20should%20be%20passed%20along..%20no%20set%0A%20%20%20%20%20%20%20%20this.eventData.data%20%3D%20touchData%3B%0A%20%20%20%20%20%20%20%20this.eventData.stopped%20%3D%20false%3B%0A%0A%0A%20%20%20%20%20%20%20%20this.processInteractive(%20touchData.global%2C%20this.renderer._lastObjectRendered%2C%20this.processTouchEnd%2C%20true%20)%3B%0A%0A%20%20%20%20%20%20%20%20this.returnTouchData(%20touchData%20)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Processes%20the%20result%20of%20the%20end%20of%20a%20touch%20and%20dispatches%20the%20event%20if%20need%20be%0A%20*%0A%20*%20%40param%20displayObject%20%7BPIXI.Container%7CPIXI.Sprite%7CPIXI.extras.TilingSprite%7D%20The%20display%20object%20that%20was%20tested%0A%20*%20%40param%20hit%20%7Bboolean%7D%20the%20result%20of%20the%20hit%20test%20on%20the%20display%20object%0A%20*%20%40private%0A%20*%2F%0AInteractionManager.prototype.processTouchEnd%20%3D%20function%20(%20displayObject%2C%20hit%20)%0A%7B%0A%20%20%20%20if(hit)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.dispatchEvent(%20displayObject%2C%20'touchend'%2C%20this.eventData%20)%3B%0A%0A%20%20%20%20%20%20%20%20if(%20displayObject._touchDown%20)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20displayObject._touchDown%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.dispatchEvent(%20displayObject%2C%20'tap'%2C%20this.eventData%20)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20if(%20displayObject._touchDown%20)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20displayObject._touchDown%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.dispatchEvent(%20displayObject%2C%20'touchendoutside'%2C%20this.eventData%20)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Is%20called%20when%20a%20touch%20is%20moved%20across%20the%20renderer%20element%0A%20*%0A%20*%20%40param%20event%20%7BEvent%7D%20The%20DOM%20event%20of%20a%20touch%20moving%20across%20the%20renderer%20view%0A%20*%20%40private%0A%20*%2F%0AInteractionManager.prototype.onTouchMove%20%3D%20function%20(event)%0A%7B%0A%20%20%20%20if%20(this.autoPreventDefault)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20event.preventDefault()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20changedTouches%20%3D%20event.changedTouches%3B%0A%20%20%20%20var%20cLength%20%3D%20changedTouches.length%3B%0A%0A%20%20%20%20for%20(var%20i%3D0%3B%20i%20%3C%20cLength%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20touchEvent%20%3D%20changedTouches%5Bi%5D%3B%0A%0A%20%20%20%20%20%20%20%20var%20touchData%20%3D%20this.getTouchData(%20touchEvent%20)%3B%0A%0A%20%20%20%20%20%20%20%20touchData.originalEvent%20%3D%20event%3B%0A%0A%20%20%20%20%20%20%20%20this.eventData.data%20%3D%20touchData%3B%0A%20%20%20%20%20%20%20%20this.eventData.stopped%20%3D%20false%3B%0A%0A%20%20%20%20%20%20%20%20this.processInteractive(%20touchData.global%2C%20this.renderer._lastObjectRendered%2C%20this.processTouchMove%2C%20true%20)%3B%0A%0A%20%20%20%20%20%20%20%20this.returnTouchData(%20touchData%20)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Processes%20the%20result%20of%20a%20touch%20move%20check%20and%20dispatches%20the%20event%20if%20need%20be%0A%20*%0A%20*%20%40param%20displayObject%20%7BPIXI.Container%7CPIXI.Sprite%7CPIXI.extras.TilingSprite%7D%20The%20display%20object%20that%20was%20tested%0A%20*%20%40param%20hit%20%7Bboolean%7D%20the%20result%20of%20the%20hit%20test%20on%20the%20display%20object%0A%20*%20%40private%0A%20*%2F%0AInteractionManager.prototype.processTouchMove%20%3D%20function%20(%20displayObject%2C%20hit%20)%0A%7B%0A%20%20%20%20hit%20%3D%20hit%3B%0A%20%20%20%20this.dispatchEvent(%20displayObject%2C%20'touchmove'%2C%20this.eventData)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Grabs%20an%20interaction%20data%20object%20from%20the%20internal%20pool%0A%20*%0A%20*%20%40param%20touchEvent%20%7BEventData%7D%20The%20touch%20event%20we%20need%20to%20pair%20with%20an%20interactionData%20object%0A%20*%0A%20*%20%40private%0A%20*%2F%0AInteractionManager.prototype.getTouchData%20%3D%20function%20(touchEvent)%0A%7B%0A%20%20%20%20var%20touchData%20%3D%20this.interactiveDataPool.pop()%3B%0A%0A%20%20%20%20if(!touchData)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20touchData%20%3D%20new%20InteractionData()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20touchData.identifier%20%3D%20touchEvent.identifier%3B%0A%20%20%20%20this.mapPositionToPoint(%20touchData.global%2C%20touchEvent.clientX%2C%20touchEvent.clientY%20)%3B%0A%0A%20%20%20%20if(navigator.isCocoonJS)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20touchData.global.x%20%3D%20touchData.global.x%20%2F%20this.resolution%3B%0A%20%20%20%20%20%20%20%20touchData.global.y%20%3D%20touchData.global.y%20%2F%20this.resolution%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20touchEvent.globalX%20%3D%20touchData.global.x%3B%0A%20%20%20%20touchEvent.globalY%20%3D%20touchData.global.y%3B%0A%0A%20%20%20%20return%20touchData%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Returns%20an%20interaction%20data%20object%20to%20the%20internal%20pool%0A%20*%0A%20*%20%40param%20touchData%20%7BPIXI.interaction.InteractionData%7D%20The%20touch%20data%20object%20we%20want%20to%20return%20to%20the%20pool%0A%20*%0A%20*%20%40private%0A%20*%2F%0AInteractionManager.prototype.returnTouchData%20%3D%20function%20(%20touchData%20)%0A%7B%0A%20%20%20%20this.interactiveDataPool.push(%20touchData%20)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20the%20interaction%20manager%0A%20*%0A%20*%2F%0AInteractionManager.prototype.destroy%20%3D%20function%20()%20%7B%0A%20%20%20%20this.removeEvents()%3B%0A%0A%20%20%20%20this.renderer%20%3D%20null%3B%0A%0A%20%20%20%20this.mouse%20%3D%20null%3B%0A%0A%20%20%20%20this.eventData%20%3D%20null%3B%0A%0A%20%20%20%20this.interactiveDataPool%20%3D%20null%3B%0A%0A%20%20%20%20this.interactionDOMElement%20%3D%20null%3B%0A%0A%20%20%20%20this.onMouseUp%20%3D%20null%3B%0A%20%20%20%20this.processMouseUp%20%3D%20null%3B%0A%0A%0A%20%20%20%20this.onMouseDown%20%3D%20null%3B%0A%20%20%20%20this.processMouseDown%20%3D%20null%3B%0A%0A%20%20%20%20this.onMouseMove%20%3D%20null%3B%0A%20%20%20%20this.processMouseMove%20%3D%20null%3B%0A%0A%20%20%20%20this.onMouseOut%20%3D%20null%3B%0A%20%20%20%20this.processMouseOverOut%20%3D%20null%3B%0A%0A%0A%20%20%20%20this.onTouchStart%20%3D%20null%3B%0A%20%20%20%20this.processTouchStart%20%3D%20null%3B%0A%0A%20%20%20%20this.onTouchEnd%20%3D%20null%3B%0A%20%20%20%20this.processTouchEnd%20%3D%20null%3B%0A%0A%20%20%20%20this.onTouchMove%20%3D%20null%3B%0A%20%20%20%20this.processTouchMove%20%3D%20null%3B%0A%0A%20%20%20%20this._tempPoint%20%3D%20null%3B%0A%7D%3B%0A%0Acore.WebGLRenderer.registerPlugin('interaction'%2C%20InteractionManager)%3B%0Acore.CanvasRenderer.registerPlugin('interaction'%2C%20InteractionManager)%3B%0A%0A%7D%2C%7B%22..%2Fcore%22%3A20%2C%22.%2FInteractionData%22%3A106%2C%22.%2FinteractiveTarget%22%3A109%7D%5D%2C108%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F**%0A%20*%20%40file%20%20%20%20%20%20%20%20Main%20export%20of%20the%20PIXI%20interactions%20library%0A%20*%20%40author%20%20%20%20%20%20Mat%20Groves%20%3Cmat%40goodboydigital.com%3E%0A%20*%20%40copyright%20%20%202013-2015%20GoodBoyDigital%0A%20*%20%40license%20%20%20%20%20%7B%40link%20https%3A%2F%2Fgithub.com%2Fpixijs%2Fpixi.js%2Fblob%2Fmaster%2FLICENSE%7CMIT%20License%7D%0A%20*%2F%0A%0A%2F**%0A%20*%20%40namespace%20PIXI.interaction%0A%20*%2F%0Amodule.exports%20%3D%20%7B%0A%20%20%20%20InteractionData%3A%20%20%20%20require('.%2FInteractionData')%2C%0A%20%20%20%20InteractionManager%3A%20require('.%2FInteractionManager')%2C%0A%20%20%20%20interactiveTarget%3A%20%20require('.%2FinteractiveTarget')%0A%7D%3B%0A%0A%7D%2C%7B%22.%2FInteractionData%22%3A106%2C%22.%2FInteractionManager%22%3A107%2C%22.%2FinteractiveTarget%22%3A109%7D%5D%2C109%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F**%0A%20*%20Default%20property%20values%20of%20interactive%20objects%0A%20*%20used%20by%20%7B%40link%20PIXI.interaction.InteractionManager%7D.%0A%20*%0A%20*%20%40mixin%0A%20*%20%40memberof%20PIXI.interaction%0A%20*%20%40example%0A%20*%20%20%20%20%20%20function%20MyObject()%20%7B%7D%0A%20*%0A%20*%20%20%20%20%20%20Object.assign(%0A%20*%20%20%20%20%20%20%20%20%20%20MyObject.prototype%2C%0A%20*%20%20%20%20%20%20%20%20%20%20PIXI.interaction.interactiveTarget%0A%20*%20%20%20%20%20%20)%3B%0A%20*%2F%0Avar%20interactiveTarget%20%3D%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40todo%20Needs%20docs.%0A%20%20%20%20%20*%2F%0A%20%20%20%20interactive%3A%20false%2C%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40todo%20Needs%20docs.%0A%20%20%20%20%20*%2F%0A%20%20%20%20buttonMode%3A%20false%2C%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40todo%20Needs%20docs.%0A%20%20%20%20%20*%2F%0A%20%20%20%20interactiveChildren%3A%20true%2C%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40todo%20Needs%20docs.%0A%20%20%20%20%20*%2F%0A%20%20%20%20defaultCursor%3A%20'pointer'%2C%0A%0A%20%20%20%20%2F%2F%20some%20internal%20checks..%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40todo%20Needs%20docs.%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20_over%3A%20false%2C%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40todo%20Needs%20docs.%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20_touchDown%3A%20false%0A%7D%3B%0A%0Amodule.exports%20%3D%20interactiveTarget%3B%0A%0A%7D%2C%7B%7D%5D%2C110%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20Resource%20%3D%20require('resource-loader').Resource%2C%0A%20%20%20%20core%20%3D%20require('..%2Fcore')%2C%0A%20%20%20%20extras%20%3D%20require('..%2Fextras')%2C%0A%20%20%20%20path%20%3D%20require('path')%3B%0A%0A%0Afunction%20parse(resource%2C%20texture)%20%7B%0A%20%20%20%20var%20data%20%3D%20%7B%7D%3B%0A%20%20%20%20var%20info%20%3D%20resource.data.getElementsByTagName('info')%5B0%5D%3B%0A%20%20%20%20var%20common%20%3D%20resource.data.getElementsByTagName('common')%5B0%5D%3B%0A%0A%20%20%20%20data.font%20%3D%20info.getAttribute('face')%3B%0A%20%20%20%20data.size%20%3D%20parseInt(info.getAttribute('size')%2C%2010)%3B%0A%20%20%20%20data.lineHeight%20%3D%20parseInt(common.getAttribute('lineHeight')%2C%2010)%3B%0A%20%20%20%20data.chars%20%3D%20%7B%7D%3B%0A%0A%20%20%20%20%2F%2Fparse%20letters%0A%20%20%20%20var%20letters%20%3D%20resource.data.getElementsByTagName('char')%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20letters.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20charCode%20%3D%20parseInt(letters%5Bi%5D.getAttribute('id')%2C%2010)%3B%0A%0A%20%20%20%20%20%20%20%20var%20textureRect%20%3D%20new%20core.Rectangle(%0A%20%20%20%20%20%20%20%20%20%20%20%20parseInt(letters%5Bi%5D.getAttribute('x')%2C%2010)%20%2B%20texture.frame.x%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20parseInt(letters%5Bi%5D.getAttribute('y')%2C%2010)%20%2B%20texture.frame.y%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20parseInt(letters%5Bi%5D.getAttribute('width')%2C%2010)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20parseInt(letters%5Bi%5D.getAttribute('height')%2C%2010)%0A%20%20%20%20%20%20%20%20)%3B%0A%0A%20%20%20%20%20%20%20%20data.chars%5BcharCode%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20xOffset%3A%20parseInt(letters%5Bi%5D.getAttribute('xoffset')%2C%2010)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20yOffset%3A%20parseInt(letters%5Bi%5D.getAttribute('yoffset')%2C%2010)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20xAdvance%3A%20parseInt(letters%5Bi%5D.getAttribute('xadvance')%2C%2010)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20kerning%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20texture%3A%20new%20core.Texture(texture.baseTexture%2C%20textureRect)%0A%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2Fparse%20kernings%0A%20%20%20%20var%20kernings%20%3D%20resource.data.getElementsByTagName('kerning')%3B%0A%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20kernings.length%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20first%20%3D%20parseInt(kernings%5Bi%5D.getAttribute('first')%2C%2010)%3B%0A%20%20%20%20%20%20%20%20var%20second%20%3D%20parseInt(kernings%5Bi%5D.getAttribute('second')%2C%2010)%3B%0A%20%20%20%20%20%20%20%20var%20amount%20%3D%20parseInt(kernings%5Bi%5D.getAttribute('amount')%2C%2010)%3B%0A%0A%20%20%20%20%20%20%20%20data.chars%5Bsecond%5D.kerning%5Bfirst%5D%20%3D%20amount%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20resource.bitmapFont%20%3D%20data%3B%0A%0A%20%20%20%20%2F%2F%20I'm%20leaving%20this%20as%20a%20temporary%20fix%20so%20we%20can%20test%20the%20bitmap%20fonts%20in%20v3%0A%20%20%20%20%2F%2F%20but%20it's%20very%20likely%20to%20change%0A%20%20%20%20extras.BitmapText.fonts%5Bdata.font%5D%20%3D%20data%3B%0A%7D%0A%0A%0Amodule.exports%20%3D%20function%20()%0A%7B%0A%20%20%20%20return%20function%20(resource%2C%20next)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20skip%20if%20no%20data%20or%20not%20xml%20data%0A%20%20%20%20%20%20%20%20if%20(!resource.data%20%7C%7C%20!resource.isXml)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20next()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20skip%20if%20not%20bitmap%20font%20data%2C%20using%20some%20silly%20duck-typing%0A%20%20%20%20%20%20%20%20if%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20resource.data.getElementsByTagName('page').length%20%3D%3D%3D%200%20%7C%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20resource.data.getElementsByTagName('info').length%20%3D%3D%3D%200%20%7C%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20resource.data.getElementsByTagName('info')%5B0%5D.getAttribute('face')%20%3D%3D%3D%20null%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20next()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20var%20xmlUrl%20%3D%20path.dirname(resource.url)%3B%0A%0A%20%20%20%20%20%20%20%20if%20(xmlUrl%20%3D%3D%3D%20'.')%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20xmlUrl%20%3D%20''%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if%20(this.baseUrl%20%26%26%20xmlUrl)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20if%20baseurl%20has%20a%20trailing%20slash%20then%20add%20one%20to%20xmlUrl%20so%20the%20replace%20works%20below%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.baseUrl.charAt(this.baseUrl.length%20-%201)%20%3D%3D%3D%20'%2F')%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xmlUrl%20%2B%3D%20'%2F'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20remove%20baseUrl%20from%20xmlUrl%0A%20%20%20%20%20%20%20%20%20%20%20%20xmlUrl%20%3D%20xmlUrl.replace(this.baseUrl%2C%20'')%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20if%20there%20is%20an%20xmlUrl%20now%2C%20it%20needs%20a%20trailing%20slash.%20Ensure%20that%20it%20does%20if%20the%20string%20isn't%20empty.%0A%20%20%20%20%20%20%20%20if%20(xmlUrl%20%26%26%20xmlUrl.charAt(xmlUrl.length%20-%201)%20!%3D%3D%20'%2F')%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20xmlUrl%20%2B%3D%20'%2F'%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20textureUrl%20%3D%20xmlUrl%20%2B%20resource.data.getElementsByTagName('page')%5B0%5D.getAttribute('file')%3B%0A%20%20%20%20%20%20%20%20if%20(core.utils.TextureCache%5BtextureUrl%5D)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2Freuse%20existing%20texture%0A%20%20%20%20%20%20%20%20%20%20%20%20parse(resource%2C%20core.utils.TextureCache%5BtextureUrl%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20next()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20loadOptions%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20crossOrigin%3A%20resource.crossOrigin%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20loadType%3A%20Resource.LOAD_TYPE.IMAGE%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20load%20the%20texture%20for%20the%20font%0A%20%20%20%20%20%20%20%20%20%20%20%20this.add(resource.name%20%2B%20'_image'%2C%20textureUrl%2C%20loadOptions%2C%20function%20(res)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20parse(resource%2C%20res.texture)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20next()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fcore%22%3A20%2C%22..%2Fextras%22%3A76%2C%22path%22%3A2%2C%22resource-loader%22%3A129%7D%5D%2C111%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F**%0A%20*%20%40file%20%20%20%20%20%20%20%20Main%20export%20of%20the%20PIXI%20loaders%20library%0A%20*%20%40author%20%20%20%20%20%20Mat%20Groves%20%3Cmat%40goodboydigital.com%3E%0A%20*%20%40copyright%20%20%202013-2015%20GoodBoyDigital%0A%20*%20%40license%20%20%20%20%20%7B%40link%20https%3A%2F%2Fgithub.com%2Fpixijs%2Fpixi.js%2Fblob%2Fmaster%2FLICENSE%7CMIT%20License%7D%0A%20*%2F%0A%0A%2F**%0A%20*%20%40namespace%20PIXI.loaders%0A%20*%2F%0Amodule.exports%20%3D%20%7B%0A%20%20%20%20Loader%3A%20%20%20%20%20%20%20%20%20%20%20%20%20require('.%2Floader')%2C%0A%0A%20%20%20%20%2F%2F%20parsers%0A%20%20%20%20bitmapFontParser%3A%20%20%20require('.%2FbitmapFontParser')%2C%0A%20%20%20%20spritesheetParser%3A%20%20require('.%2FspritesheetParser')%2C%0A%20%20%20%20textureParser%3A%20%20%20%20%20%20require('.%2FtextureParser')%2C%0A%20%20%20%20Resource%3A%20%20%20%20%20%20%20%20%20%20%20require('resource-loader').Resource%0A%7D%3B%0A%0A%7D%2C%7B%22.%2FbitmapFontParser%22%3A110%2C%22.%2Floader%22%3A112%2C%22.%2FspritesheetParser%22%3A113%2C%22.%2FtextureParser%22%3A114%2C%22resource-loader%22%3A129%7D%5D%2C112%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20ResourceLoader%20%3D%20require('resource-loader')%2C%0A%20%20%20%20textureParser%20%3D%20require('.%2FtextureParser')%2C%0A%20%20%20%20spritesheetParser%20%3D%20require('.%2FspritesheetParser')%2C%0A%20%20%20%20bitmapFontParser%20%3D%20require('.%2FbitmapFontParser')%3B%0A%0A%2F**%0A%20*%0A%20*%20The%20new%20loader%2C%20extends%20Resource%20Loader%20by%20Chad%20Engler%20%3A%20https%3A%2F%2Fgithub.com%2Fenglercj%2Fresource-loader%0A%20*%0A%20*%20%60%60%60js%0A%20*%20var%20loader%20%3D%20PIXI.loader%3B%20%2F%2F%20pixi%20exposes%20a%20premade%20instance%20for%20you%20to%20use.%0A%20*%20%2F%2For%0A%20*%20var%20loader%20%3D%20new%20PIXI.loaders.Loader()%3B%20%2F%2F%20you%20can%20also%20create%20your%20own%20if%20you%20want%0A%20*%0A%20*%20loader.add('bunny'%2C%22data%2Fbunny.png%22)%3B%0A%20*%0A%20*%20loader.once('complete'%2ConAssetsLoaded)%3B%0A%20*%0A%20*%20loader.load()%3B%0A%20*%20%60%60%60%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.ResourceLoader%0A%20*%20%40memberof%20PIXI.loaders%0A%20*%20%40param%20%5BbaseUrl%3D''%5D%20%7Bstring%7D%20The%20base%20url%20for%20all%20resources%20loaded%20by%20this%20loader.%0A%20*%20%40param%20%5Bconcurrency%3D10%5D%20%7Bnumber%7D%20The%20number%20of%20resources%20to%20load%20concurrently.%0A%20*%2F%0Afunction%20Loader(baseUrl%2C%20concurrency)%0A%7B%0A%20%20%20%20ResourceLoader.call(this%2C%20baseUrl%2C%20concurrency)%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20Loader._pixiMiddleware.length%3B%20%2B%2Bi)%20%7B%0A%20%20%20%20%20%20%20%20this.use(Loader._pixiMiddleware%5Bi%5D())%3B%0A%20%20%20%20%7D%0A%7D%0A%0ALoader.prototype%20%3D%20Object.create(ResourceLoader.prototype)%3B%0ALoader.prototype.constructor%20%3D%20Loader%3B%0A%0Amodule.exports%20%3D%20Loader%3B%0A%0ALoader._pixiMiddleware%20%3D%20%5B%0A%20%20%20%20%2F%2F%20parse%20any%20blob%20into%20more%20usable%20objects%20(e.g.%20Image)%0A%20%20%20%20ResourceLoader.middleware.parsing.blob%2C%0A%20%20%20%20%2F%2F%20parse%20any%20Image%20objects%20into%20textures%0A%20%20%20%20textureParser%2C%0A%20%20%20%20%2F%2F%20parse%20any%20spritesheet%20data%20into%20multiple%20textures%0A%20%20%20%20spritesheetParser%2C%0A%20%20%20%20%2F%2F%20parse%20any%20spritesheet%20data%20into%20multiple%20textures%0A%20%20%20%20bitmapFontParser%0A%5D%3B%0A%0ALoader.addPixiMiddleware%20%3D%20function%20(fn)%20%7B%0A%20%20%20%20Loader._pixiMiddleware.push(fn)%3B%0A%7D%3B%0A%0A%2F%2F%20Add%20custom%20extentions%0Avar%20Resource%20%3D%20ResourceLoader.Resource%3B%0A%0AResource.setExtensionXhrType('fnt'%2C%20Resource.XHR_RESPONSE_TYPE.DOCUMENT)%3B%0A%0A%7D%2C%7B%22.%2FbitmapFontParser%22%3A110%2C%22.%2FspritesheetParser%22%3A113%2C%22.%2FtextureParser%22%3A114%2C%22resource-loader%22%3A129%7D%5D%2C113%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20Resource%20%3D%20require('resource-loader').Resource%2C%0A%20%20%20%20path%20%3D%20require('path')%2C%0A%20%20%20%20core%20%3D%20require('..%2Fcore')%3B%0A%0Amodule.exports%20%3D%20function%20()%0A%7B%0A%20%20%20%20return%20function%20(resource%2C%20next)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20skip%20if%20no%20data%2C%20its%20not%20json%2C%20or%20it%20isn't%20spritesheet%20data%0A%20%20%20%20%20%20%20%20if%20(!resource.data%20%7C%7C%20!resource.isJson%20%7C%7C%20!resource.data.frames)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20next()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20var%20loadOptions%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20crossOrigin%3A%20resource.crossOrigin%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20loadType%3A%20Resource.LOAD_TYPE.IMAGE%0A%20%20%20%20%20%20%20%20%7D%3B%0A%0A%20%20%20%20%20%20%20%20var%20route%20%3D%20path.dirname(resource.url.replace(this.baseUrl%2C%20''))%3B%0A%0A%20%20%20%20%20%20%20%20var%20resolution%20%3D%20core.utils.getResolutionOfUrl(%20resource.url%20)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20load%20the%20image%20for%20this%20sheet%0A%20%20%20%20%20%20%20%20this.add(resource.name%20%2B%20'_image'%2C%20route%20%2B%20'%2F'%20%2B%20resource.data.meta.image%2C%20loadOptions%2C%20function%20(res)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20resource.textures%20%3D%20%7B%7D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20frames%20%3D%20resource.data.frames%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(var%20i%20in%20frames)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20rect%20%3D%20frames%5Bi%5D.frame%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(rect)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20size%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20trim%20%3D%20null%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(frames%5Bi%5D.rotated)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20size%20%3D%20new%20core.Rectangle(rect.x%2C%20rect.y%2C%20rect.h%2C%20rect.w)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20size%20%3D%20new%20core.Rectangle(rect.x%2C%20rect.y%2C%20rect.w%2C%20rect.h)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%20Check%20to%20see%20if%20the%20sprite%20is%20trimmed%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(frames%5Bi%5D.trimmed)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20trim%20%3D%20new%20core.Rectangle(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20frames%5Bi%5D.spriteSourceSize.x%20%2F%20resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20frames%5Bi%5D.spriteSourceSize.y%20%2F%20resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20frames%5Bi%5D.sourceSize.w%20%2F%20resolution%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20frames%5Bi%5D.sourceSize.h%20%2F%20resolution%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20flip%20the%20width%20and%20height!%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(frames%5Bi%5D.rotated)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20temp%20%3D%20size.width%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20size.width%20%3D%20size.height%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20size.height%20%3D%20temp%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20size.x%20%2F%3D%20resolution%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20size.y%20%2F%3D%20resolution%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20size.width%20%2F%3D%20resolution%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20size.height%20%2F%3D%20resolution%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20resource.textures%5Bi%5D%20%3D%20new%20core.Texture(res.texture.baseTexture%2C%20size%2C%20size.clone()%2C%20trim%2C%20frames%5Bi%5D.rotated)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20lets%20also%20add%20the%20frame%20to%20pixi's%20global%20cache%20for%20fromFrame%20and%20fromImage%20functions%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20core.utils.TextureCache%5Bi%5D%20%3D%20resource.textures%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20next()%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fcore%22%3A20%2C%22path%22%3A2%2C%22resource-loader%22%3A129%7D%5D%2C114%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2Fcore')%3B%0A%0Amodule.exports%20%3D%20function%20()%0A%7B%0A%20%20%20%20return%20function%20(resource%2C%20next)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20create%20a%20new%20texture%20if%20the%20data%20is%20an%20Image%20object%0A%20%20%20%20%20%20%20%20if%20(resource.data%20%26%26%20resource.isImage)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20baseTexture%20%3D%20new%20core.BaseTexture(resource.data%2C%20null%2C%20core.utils.getResolutionOfUrl(resource.url))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20baseTexture.imageUrl%20%3D%20resource.url%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20resource.texture%20%3D%20new%20core.Texture(baseTexture)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20lets%20also%20add%20the%20frame%20to%20pixi's%20global%20cache%20for%20fromFrame%20and%20fromImage%20fucntions%0A%20%20%20%20%20%20%20%20%20%20%20%20core.utils.BaseTextureCache%5Bresource.url%5D%20%3D%20baseTexture%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20core.utils.TextureCache%5Bresource.url%5D%20%3D%20resource.texture%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20next()%3B%0A%20%20%20%20%7D%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fcore%22%3A20%7D%5D%2C115%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2Fcore')%2C%0A%20%20%20%20tempPoint%20%3D%20new%20core.Point()%2C%0A%20%20%20%20tempPolygon%20%3D%20new%20core.Polygon()%3B%0A%0A%2F**%0A%20*%20Base%20mesh%20class%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.Container%0A%20*%20%40memberof%20PIXI.mesh%0A%20*%20%40param%20texture%20%7BPIXI.Texture%7D%20The%20texture%20to%20use%0A%20*%20%40param%20%5Bvertices%5D%20%7BFloat32Arrif%20you%20want%20to%20specify%20the%20vertices%0A%20*%20%40param%20%5Buvs%5D%20%7BFloat32Array%7D%20if%20you%20want%20to%20specify%20the%20uvs%0A%20*%20%40param%20%5Bindices%5D%20%7BUint16Array%7D%20if%20you%20want%20to%20specify%20the%20indices%0A%20*%20%40param%20%5BdrawMode%5D%20%7Bnumber%7D%20the%20drawMode%2C%20can%20be%20any%20of%20the%20Mesh.DRAW_MODES%20consts%0A%20*%2F%0Afunction%20Mesh(texture%2C%20vertices%2C%20uvs%2C%20indices%2C%20drawMode)%0A%7B%0A%20%20%20%20core.Container.call(this)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20texture%20of%20the%20Mesh%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Texture%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._texture%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20Uvs%20of%20the%20Mesh%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BFloat32Array%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.uvs%20%3D%20uvs%20%7C%7C%20new%20Float32Array(%5B0%2C%201%2C%0A%20%20%20%20%20%20%20%201%2C%201%2C%0A%20%20%20%20%20%20%20%201%2C%200%2C%0A%20%20%20%20%20%20%20%200%2C%201%5D)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20An%20array%20of%20vertices%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BFloat32Array%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.vertices%20%3D%20vertices%20%7C%7C%20new%20Float32Array(%5B0%2C%200%2C%0A%20%20%20%20%20%20%20%20100%2C%200%2C%0A%20%20%20%20%20%20%20%20100%2C%20100%2C%0A%20%20%20%20%20%20%20%200%2C%20100%5D)%3B%0A%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20%40member%20%7BUint16Array%7D%20An%20array%20containing%20the%20indices%20of%20the%20vertices%0A%20%20%20%20%20*%2F%0A%20%20%20%20%2F%2F%20%20TODO%20auto%20generate%20this%20based%20on%20draw%20mode!%0A%20%20%20%20this.indices%20%3D%20indices%20%7C%7C%20new%20Uint16Array(%5B0%2C%201%2C%202%2C%203%5D)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Whether%20the%20Mesh%20is%20dirty%20or%20not%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.dirty%20%3D%20true%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20blend%20mode%20to%20be%20applied%20to%20the%20sprite.%20Set%20to%20%60PIXI.BLEND_MODES.NORMAL%60%20to%20remove%20any%20blend%20mode.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40default%20PIXI.BLEND_MODES.NORMAL%0A%20%20%20%20%20*%20%40see%20PIXI.BLEND_MODES%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.blendMode%20%3D%20core.BLEND_MODES.NORMAL%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Triangles%20in%20canvas%20mode%20are%20automatically%20antialiased%2C%20use%20this%20value%20to%20force%20triangles%20to%20overlap%20a%20bit%20with%20each%20other.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.canvasPadding%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20way%20the%20Mesh%20should%20be%20drawn%2C%20can%20be%20any%20of%20the%20%7B%40link%20PIXI.mesh.Mesh.DRAW_MODES%7D%20consts%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%20%40see%20PIXI.mesh.Mesh.DRAW_MODES%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.drawMode%20%3D%20drawMode%20%7C%7C%20Mesh.DRAW_MODES.TRIANGLE_MESH%3B%0A%0A%20%20%20%20%2F%2F%20run%20texture%20setter%3B%0A%20%20%20%20this.texture%20%3D%20texture%3B%0A%7D%0A%0A%2F%2F%20constructor%0AMesh.prototype%20%3D%20Object.create(core.Container.prototype)%3B%0AMesh.prototype.constructor%20%3D%20Mesh%3B%0Amodule.exports%20%3D%20Mesh%3B%0A%0AObject.defineProperties(Mesh.prototype%2C%20%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20texture%20that%20the%20sprite%20is%20using%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Texture%7D%0A%20%20%20%20%20*%20%40memberof%20PIXI.mesh.Mesh%23%0A%20%20%20%20%20*%2F%0A%20%20%20%20texture%3A%20%7B%0A%20%20%20%20%20%20%20%20get%3A%20function%20()%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%20this._texture%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20set%3A%20function%20(value)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(this._texture%20%3D%3D%3D%20value)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20this._texture%20%3D%20value%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(value)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20wait%20for%20the%20texture%20to%20load%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(value.baseTexture.hasLoaded)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._onTextureUpdate()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20value.once('update'%2C%20this._onTextureUpdate%2C%20this)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A%0A%2F**%0A%20*%20Renders%20the%20object%20using%20the%20WebGL%20renderer%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20a%20reference%20to%20the%20WebGL%20renderer%0A%20*%20%40private%0A%20*%2F%0AMesh.prototype._renderWebGL%20%3D%20function%20(renderer)%0A%7B%0A%20%20%20%20renderer.setObjectRenderer(renderer.plugins.mesh)%3B%0A%20%20%20%20renderer.plugins.mesh.render(this)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Renders%20the%20object%20using%20the%20Canvas%20renderer%0A%20*%0A%20*%20%40param%20renderer%20%7BPIXI.CanvasRenderer%7D%0A%20*%20%40private%0A%20*%2F%0AMesh.prototype._renderCanvas%20%3D%20function%20(renderer)%0A%7B%0A%20%20%20%20var%20context%20%3D%20renderer.context%3B%0A%0A%20%20%20%20var%20transform%20%3D%20this.worldTransform%3B%0A%0A%20%20%20%20if%20(renderer.roundPixels)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20context.setTransform(transform.a%2C%20transform.b%2C%20transform.c%2C%20transform.d%2C%20transform.tx%20%7C%200%2C%20transform.ty%20%7C%200)%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20context.setTransform(transform.a%2C%20transform.b%2C%20transform.c%2C%20transform.d%2C%20transform.tx%2C%20transform.ty)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(this.drawMode%20%3D%3D%3D%20Mesh.DRAW_MODES.TRIANGLE_MESH)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this._renderCanvasTriangleMesh(context)%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this._renderCanvasTriangles(context)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Draws%20the%20object%20in%20Triangle%20Mesh%20mode%20using%20canvas%0A%20*%0A%20*%20%40param%20context%20%7BCanvasRenderingContext2D%7D%20the%20current%20drawing%20context%0A%20*%20%40private%0A%20*%2F%0AMesh.prototype._renderCanvasTriangleMesh%20%3D%20function%20(context)%0A%7B%0A%20%20%20%20%2F%2F%20draw%20triangles!!%0A%20%20%20%20var%20vertices%20%3D%20this.vertices%3B%0A%20%20%20%20var%20uvs%20%3D%20this.uvs%3B%0A%0A%20%20%20%20var%20length%20%3D%20vertices.length%20%2F%202%3B%0A%20%20%20%20%2F%2F%20this.count%2B%2B%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20length%20-%202%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20draw%20some%20triangles!%0A%20%20%20%20%20%20%20%20var%20index%20%3D%20i%20*%202%3B%0A%20%20%20%20%20%20%20%20this._renderCanvasDrawTriangle(context%2C%20vertices%2C%20uvs%2C%20index%2C%20(index%20%2B%202)%2C%20(index%20%2B%204))%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Draws%20the%20object%20in%20triangle%20mode%20using%20canvas%0A%20*%0A%20*%20%40param%20context%20%7BCanvasRenderingContext2D%7D%20the%20current%20drawing%20context%0A%20*%20%40private%0A%20*%2F%0AMesh.prototype._renderCanvasTriangles%20%3D%20function%20(context)%0A%7B%0A%20%20%20%20%2F%2F%20draw%20triangles!!%0A%20%20%20%20var%20vertices%20%3D%20this.vertices%3B%0A%20%20%20%20var%20uvs%20%3D%20this.uvs%3B%0A%20%20%20%20var%20indices%20%3D%20this.indices%3B%0A%0A%20%20%20%20var%20length%20%3D%20indices.length%3B%0A%20%20%20%20%2F%2F%20this.count%2B%2B%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20length%3B%20i%20%2B%3D%203)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20draw%20some%20triangles!%0A%20%20%20%20%20%20%20%20var%20index0%20%3D%20indices%5Bi%5D%20*%202%2C%20index1%20%3D%20indices%5Bi%20%2B%201%5D%20*%202%2C%20index2%20%3D%20indices%5Bi%20%2B%202%5D%20*%202%3B%0A%20%20%20%20%20%20%20%20this._renderCanvasDrawTriangle(context%2C%20vertices%2C%20uvs%2C%20index0%2C%20index1%2C%20index2)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Draws%20one%20of%20the%20triangles%20that%20form%20this%20Mesh%0A%20*%0A%20*%20%40param%20context%20%7BCanvasRenderingContext2D%7D%20the%20current%20drawing%20context%0A%20*%20%40param%20vertices%20%7BFloat32Array%7D%20a%20reference%20to%20the%20vertices%20of%20the%20Mesh%0A%20*%20%40param%20uvs%20%7BFloat32Array%7D%20a%20reference%20to%20the%20uvs%20of%20the%20Mesh%0A%20*%20%40param%20index0%20%7Bnumber%7D%20the%20index%20of%20the%20first%20vertex%0A%20*%20%40param%20index1%20%7Bnumber%7D%20the%20index%20of%20the%20second%20vertex%0A%20*%20%40param%20index2%20%7Bnumber%7D%20the%20index%20of%20the%20third%20vertex%0A%20*%20%40private%0A%20*%2F%0AMesh.prototype._renderCanvasDrawTriangle%20%3D%20function%20(context%2C%20vertices%2C%20uvs%2C%20index0%2C%20index1%2C%20index2)%0A%7B%0A%20%20%20%20var%20textureSource%20%3D%20this._texture.baseTexture.source%3B%0A%20%20%20%20var%20textureWidth%20%3D%20this._texture.baseTexture.width%3B%0A%20%20%20%20var%20textureHeight%20%3D%20this._texture.baseTexture.height%3B%0A%0A%20%20%20%20var%20x0%20%3D%20vertices%5Bindex0%5D%2C%20x1%20%3D%20vertices%5Bindex1%5D%2C%20x2%20%3D%20vertices%5Bindex2%5D%3B%0A%20%20%20%20var%20y0%20%3D%20vertices%5Bindex0%20%2B%201%5D%2C%20y1%20%3D%20vertices%5Bindex1%20%2B%201%5D%2C%20y2%20%3D%20vertices%5Bindex2%20%2B%201%5D%3B%0A%0A%20%20%20%20var%20u0%20%3D%20uvs%5Bindex0%5D%20*%20textureWidth%2C%20u1%20%3D%20uvs%5Bindex1%5D%20*%20textureWidth%2C%20u2%20%3D%20uvs%5Bindex2%5D%20*%20textureWidth%3B%0A%20%20%20%20var%20v0%20%3D%20uvs%5Bindex0%20%2B%201%5D%20*%20textureHeight%2C%20v1%20%3D%20uvs%5Bindex1%20%2B%201%5D%20*%20textureHeight%2C%20v2%20%3D%20uvs%5Bindex2%20%2B%201%5D%20*%20textureHeight%3B%0A%0A%20%20%20%20if%20(this.canvasPadding%20%3E%200)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20var%20paddingX%20%3D%20this.canvasPadding%20%2F%20this.worldTransform.a%3B%0A%20%20%20%20%20%20%20%20var%20paddingY%20%3D%20this.canvasPadding%20%2F%20this.worldTransform.d%3B%0A%20%20%20%20%20%20%20%20var%20centerX%20%3D%20(x0%20%2B%20x1%20%2B%20x2)%20%2F%203%3B%0A%20%20%20%20%20%20%20%20var%20centerY%20%3D%20(y0%20%2B%20y1%20%2B%20y2)%20%2F%203%3B%0A%0A%20%20%20%20%20%20%20%20var%20normX%20%3D%20x0%20-%20centerX%3B%0A%20%20%20%20%20%20%20%20var%20normY%20%3D%20y0%20-%20centerY%3B%0A%0A%20%20%20%20%20%20%20%20var%20dist%20%3D%20Math.sqrt(normX%20*%20normX%20%2B%20normY%20*%20normY)%3B%0A%20%20%20%20%20%20%20%20x0%20%3D%20centerX%20%2B%20(normX%20%2F%20dist)%20*%20(dist%20%2B%20paddingX)%3B%0A%20%20%20%20%20%20%20%20y0%20%3D%20centerY%20%2B%20(normY%20%2F%20dist)%20*%20(dist%20%2B%20paddingY)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%0A%0A%20%20%20%20%20%20%20%20normX%20%3D%20x1%20-%20centerX%3B%0A%20%20%20%20%20%20%20%20normY%20%3D%20y1%20-%20centerY%3B%0A%0A%20%20%20%20%20%20%20%20dist%20%3D%20Math.sqrt(normX%20*%20normX%20%2B%20normY%20*%20normY)%3B%0A%20%20%20%20%20%20%20%20x1%20%3D%20centerX%20%2B%20(normX%20%2F%20dist)%20*%20(dist%20%2B%20paddingX)%3B%0A%20%20%20%20%20%20%20%20y1%20%3D%20centerY%20%2B%20(normY%20%2F%20dist)%20*%20(dist%20%2B%20paddingY)%3B%0A%0A%20%20%20%20%20%20%20%20normX%20%3D%20x2%20-%20centerX%3B%0A%20%20%20%20%20%20%20%20normY%20%3D%20y2%20-%20centerY%3B%0A%0A%20%20%20%20%20%20%20%20dist%20%3D%20Math.sqrt(normX%20*%20normX%20%2B%20normY%20*%20normY)%3B%0A%20%20%20%20%20%20%20%20x2%20%3D%20centerX%20%2B%20(normX%20%2F%20dist)%20*%20(dist%20%2B%20paddingX)%3B%0A%20%20%20%20%20%20%20%20y2%20%3D%20centerY%20%2B%20(normY%20%2F%20dist)%20*%20(dist%20%2B%20paddingY)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20context.save()%3B%0A%20%20%20%20context.beginPath()%3B%0A%0A%0A%20%20%20%20context.moveTo(x0%2C%20y0)%3B%0A%20%20%20%20context.lineTo(x1%2C%20y1)%3B%0A%20%20%20%20context.lineTo(x2%2C%20y2)%3B%0A%0A%20%20%20%20context.closePath()%3B%0A%0A%20%20%20%20context.clip()%3B%0A%0A%20%20%20%20%2F%2F%20Compute%20matrix%20transform%0A%20%20%20%20var%20delta%20%3D%20%20(u0%20*%20v1)%20%20%20%20%20%20%2B%20(v0%20*%20u2)%20%20%20%20%20%20%2B%20(u1%20*%20v2)%20%20%20%20%20%20-%20(v1%20*%20u2)%20%20%20%20%20%20-%20(v0%20*%20u1)%20%20%20%20%20%20-%20(u0%20*%20v2)%3B%0A%20%20%20%20var%20deltaA%20%3D%20(x0%20*%20v1)%20%20%20%20%20%20%2B%20(v0%20*%20x2)%20%20%20%20%20%20%2B%20(x1%20*%20v2)%20%20%20%20%20%20-%20(v1%20*%20x2)%20%20%20%20%20%20-%20(v0%20*%20x1)%20%20%20%20%20%20-%20(x0%20*%20v2)%3B%0A%20%20%20%20var%20deltaB%20%3D%20(u0%20*%20x1)%20%20%20%20%20%20%2B%20(x0%20*%20u2)%20%20%20%20%20%20%2B%20(u1%20*%20x2)%20%20%20%20%20%20-%20(x1%20*%20u2)%20%20%20%20%20%20-%20(x0%20*%20u1)%20%20%20%20%20%20-%20(u0%20*%20x2)%3B%0A%20%20%20%20var%20deltaC%20%3D%20(u0%20*%20v1%20*%20x2)%20%2B%20(v0%20*%20x1%20*%20u2)%20%2B%20(x0%20*%20u1%20*%20v2)%20-%20(x0%20*%20v1%20*%20u2)%20-%20(v0%20*%20u1%20*%20x2)%20-%20(u0%20*%20x1%20*%20v2)%3B%0A%20%20%20%20var%20deltaD%20%3D%20(y0%20*%20v1)%20%20%20%20%20%20%2B%20(v0%20*%20y2)%20%20%20%20%20%20%2B%20(y1%20*%20v2)%20%20%20%20%20%20-%20(v1%20*%20y2)%20%20%20%20%20%20-%20(v0%20*%20y1)%20%20%20%20%20%20-%20(y0%20*%20v2)%3B%0A%20%20%20%20var%20deltaE%20%3D%20(u0%20*%20y1)%20%20%20%20%20%20%2B%20(y0%20*%20u2)%20%20%20%20%20%20%2B%20(u1%20*%20y2)%20%20%20%20%20%20-%20(y1%20*%20u2)%20%20%20%20%20%20-%20(y0%20*%20u1)%20%20%20%20%20%20-%20(u0%20*%20y2)%3B%0A%20%20%20%20var%20deltaF%20%3D%20(u0%20*%20v1%20*%20y2)%20%2B%20(v0%20*%20y1%20*%20u2)%20%2B%20(y0%20*%20u1%20*%20v2)%20-%20(y0%20*%20v1%20*%20u2)%20-%20(v0%20*%20u1%20*%20y2)%20-%20(u0%20*%20y1%20*%20v2)%3B%0A%0A%20%20%20%20context.transform(deltaA%20%2F%20delta%2C%20deltaD%20%2F%20delta%2C%0A%20%20%20%20%20%20%20%20deltaB%20%2F%20delta%2C%20deltaE%20%2F%20delta%2C%0A%20%20%20%20%20%20%20%20deltaC%20%2F%20delta%2C%20deltaF%20%2F%20delta)%3B%0A%0A%20%20%20%20context.drawImage(textureSource%2C%200%2C%200)%3B%0A%20%20%20%20context.restore()%3B%0A%7D%3B%0A%0A%0A%0A%2F**%0A%20*%20Renders%20a%20flat%20Mesh%0A%20*%0A%20*%20%40param%20Mesh%20%7BPIXI.mesh.Mesh%7D%20The%20Mesh%20to%20render%0A%20*%20%40private%0A%20*%2F%0AMesh.prototype.renderMeshFlat%20%3D%20function%20(Mesh)%0A%7B%0A%20%20%20%20var%20context%20%3D%20this.context%3B%0A%20%20%20%20var%20vertices%20%3D%20Mesh.vertices%3B%0A%0A%20%20%20%20var%20length%20%3D%20vertices.length%2F2%3B%0A%20%20%20%20%2F%2F%20this.count%2B%2B%3B%0A%0A%20%20%20%20context.beginPath()%3B%0A%20%20%20%20for%20(var%20i%3D1%3B%20i%20%3C%20length-2%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20draw%20some%20triangles!%0A%20%20%20%20%20%20%20%20var%20index%20%3D%20i*2%3B%0A%0A%20%20%20%20%20%20%20%20var%20x0%20%3D%20vertices%5Bindex%5D%2C%20%20%20x1%20%3D%20vertices%5Bindex%2B2%5D%2C%20x2%20%3D%20vertices%5Bindex%2B4%5D%3B%0A%20%20%20%20%20%20%20%20var%20y0%20%3D%20vertices%5Bindex%2B1%5D%2C%20y1%20%3D%20vertices%5Bindex%2B3%5D%2C%20y2%20%3D%20vertices%5Bindex%2B5%5D%3B%0A%0A%20%20%20%20%20%20%20%20context.moveTo(x0%2C%20y0)%3B%0A%20%20%20%20%20%20%20%20context.lineTo(x1%2C%20y1)%3B%0A%20%20%20%20%20%20%20%20context.lineTo(x2%2C%20y2)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20context.fillStyle%20%3D%20'%23FF0000'%3B%0A%20%20%20%20context.fill()%3B%0A%20%20%20%20context.closePath()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20When%20the%20texture%20is%20updated%2C%20this%20event%20will%20fire%20to%20update%20the%20scale%20and%20frame%0A%20*%0A%20*%20%40param%20event%0A%20*%20%40private%0A%20*%2F%0AMesh.prototype._onTextureUpdate%20%3D%20function%20()%0A%7B%0A%20%20%20%20this.updateFrame%20%3D%20true%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Returns%20the%20bounds%20of%20the%20mesh%20as%20a%20rectangle.%20The%20bounds%20calculation%20takes%20the%20worldTransform%20into%20account.%0A%20*%0A%20*%20%40param%20matrix%20%7BPIXI.Matrix%7D%20the%20transformation%20matrix%20of%20the%20sprite%0A%20*%20%40return%20%7BPIXI.Rectangle%7D%20the%20framing%20rectangle%0A%20*%2F%0AMesh.prototype.getBounds%20%3D%20function%20(matrix)%0A%7B%0A%20%20%20%20if%20(!this._currentBounds)%20%7B%0A%20%20%20%20%20%20%20%20var%20worldTransform%20%3D%20matrix%20%7C%7C%20this.worldTransform%3B%0A%0A%20%20%20%20%20%20%20%20var%20a%20%3D%20worldTransform.a%3B%0A%20%20%20%20%20%20%20%20var%20b%20%3D%20worldTransform.b%3B%0A%20%20%20%20%20%20%20%20var%20c%20%3D%20worldTransform.c%3B%0A%20%20%20%20%20%20%20%20var%20d%20%3D%20worldTransform.d%3B%0A%20%20%20%20%20%20%20%20var%20tx%20%3D%20worldTransform.tx%3B%0A%20%20%20%20%20%20%20%20var%20ty%20%3D%20worldTransform.ty%3B%0A%0A%20%20%20%20%20%20%20%20var%20maxX%20%3D%20-Infinity%3B%0A%20%20%20%20%20%20%20%20var%20maxY%20%3D%20-Infinity%3B%0A%0A%20%20%20%20%20%20%20%20var%20minX%20%3D%20Infinity%3B%0A%20%20%20%20%20%20%20%20var%20minY%20%3D%20Infinity%3B%0A%0A%20%20%20%20%20%20%20%20var%20vertices%20%3D%20this.vertices%3B%0A%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%200%2C%20n%20%3D%20vertices.length%3B%20i%20%3C%20n%3B%20i%20%2B%3D%202)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20rawX%20%3D%20vertices%5Bi%5D%2C%20rawY%20%3D%20vertices%5Bi%20%2B%201%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20x%20%3D%20(a%20*%20rawX)%20%2B%20(c%20*%20rawY)%20%2B%20tx%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20y%20%3D%20(d%20*%20rawY)%20%2B%20(b%20*%20rawX)%20%2B%20ty%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20minX%20%3D%20x%20%3C%20minX%20%3F%20x%20%3A%20minX%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20minY%20%3D%20y%20%3C%20minY%20%3F%20y%20%3A%20minY%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20maxX%20%3D%20x%20%3E%20maxX%20%3F%20x%20%3A%20maxX%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20maxY%20%3D%20y%20%3E%20maxY%20%3F%20y%20%3A%20maxY%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if%20(minX%20%3D%3D%3D%20-Infinity%20%7C%7C%20maxY%20%3D%3D%3D%20Infinity)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20core.Rectangle.EMPTY%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20var%20bounds%20%3D%20this._bounds%3B%0A%0A%20%20%20%20%20%20%20%20bounds.x%20%3D%20minX%3B%0A%20%20%20%20%20%20%20%20bounds.width%20%3D%20maxX%20-%20minX%3B%0A%0A%20%20%20%20%20%20%20%20bounds.y%20%3D%20minY%3B%0A%20%20%20%20%20%20%20%20bounds.height%20%3D%20maxY%20-%20minY%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20store%20a%20reference%20so%20that%20if%20this%20function%20gets%20called%20again%20in%20the%20render%20cycle%20we%20do%20not%20have%20to%20recalculate%0A%20%20%20%20%20%20%20%20this._currentBounds%20%3D%20bounds%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20this._currentBounds%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Tests%20if%20a%20point%20is%20inside%20this%20mesh.%20Works%20only%20for%20TRIANGLE_MESH%0A%20*%0A%20*%20%40param%20point%20%7BPIXI.Point%7D%20the%20point%20to%20test%0A%20*%20%40return%20%7Bboolean%7D%20the%20result%20of%20the%20test%0A%20*%2F%0AMesh.prototype.containsPoint%20%3D%20function(%20point%20)%20%7B%0A%20%20%20%20if%20(!this.getBounds().contains(point.x%2C%20point.y))%20%7B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.worldTransform.applyInverse(point%2C%20%20tempPoint)%3B%0A%0A%20%20%20%20var%20vertices%20%3D%20this.vertices%3B%0A%20%20%20%20var%20points%20%3D%20tempPolygon.points%3B%0A%20%20%20%20var%20i%2C%20len%3B%0A%0A%20%20%20%20if%20(this.drawMode%20%3D%3D%3D%20Mesh.DRAW_MODES.TRIANGLES)%20%7B%0A%20%20%20%20%20%20%20%20var%20indices%20%3D%20this.indices%3B%0A%20%20%20%20%20%20%20%20len%20%3D%20this.indices.length%3B%0A%20%20%20%20%20%20%20%20%2F%2FTODO%3A%20inline%20this.%0A%20%20%20%20%20%20%20%20for%20(i%3D0%3Bi%3Clen%3Bi%2B%3D3)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20ind0%20%3D%20indices%5Bi%5D*2%2C%20ind1%20%3D%20indices%5Bi%2B1%5D*2%2C%20ind2%20%3D%20indices%5Bi%2B2%5D*2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%5B0%5D%20%3D%20vertices%5Bind0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%5B1%5D%20%3D%20vertices%5Bind0%2B1%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%5B2%5D%20%3D%20vertices%5Bind1%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%5B3%5D%20%3D%20vertices%5Bind1%2B1%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%5B4%5D%20%3D%20vertices%5Bind2%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%5B5%5D%20%3D%20vertices%5Bind2%2B1%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(tempPolygon.contains(tempPoint.x%2C%20tempPoint.y))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20len%20%3D%20vertices.length%3B%0A%20%20%20%20%20%20%20%20for%20(i%3D0%3Bi%3Clen%3Bi%2B%3D6)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%5B0%5D%20%3D%20vertices%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%5B1%5D%20%3D%20vertices%5Bi%2B1%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%5B2%5D%20%3D%20vertices%5Bi%2B2%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%5B3%5D%20%3D%20vertices%5Bi%2B3%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%5B4%5D%20%3D%20vertices%5Bi%2B4%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20points%5B5%5D%20%3D%20vertices%5Bi%2B5%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(tempPolygon.contains(tempPoint.x%2C%20tempPoint.y))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20false%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Different%20drawing%20buffer%20modes%20supported%0A%20*%0A%20*%20%40static%0A%20*%20%40constant%0A%20*%20%40property%20%7Bobject%7D%20DRAW_MODES%0A%20*%20%40property%20%7Bnumber%7D%20DRAW_MODES.TRIANGLE_MESH%0A%20*%20%40property%20%7Bnumber%7D%20DRAW_MODES.TRIANGLES%0A%20*%2F%0AMesh.DRAW_MODES%20%3D%20%7B%0A%20%20%20%20TRIANGLE_MESH%3A%200%2C%0A%20%20%20%20TRIANGLES%3A%201%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fcore%22%3A20%7D%5D%2C116%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20Mesh%20%3D%20require('.%2FMesh')%3B%0Avar%20core%20%3D%20require('..%2Fcore')%3B%0A%0A%2F**%0A%20*%20The%20rope%20allows%20you%20to%20draw%20a%20texture%20across%20several%20points%20and%20them%20manipulate%20these%20points%0A%20*%0A%20*%60%60%60js%0A%20*%20for%20(var%20i%20%3D%200%3B%20i%20%3C%2020%3B%20i%2B%2B)%20%7B%0A%20*%20%20%20%20%20points.push(new%20PIXI.Point(i%20*%2050%2C%200))%3B%0A%20*%20%7D%3B%0A%20*%20var%20rope%20%3D%20new%20PIXI.Rope(PIXI.Texture.fromImage(%22snake.png%22)%2C%20points)%3B%0A%20*%20%20%60%60%60%0A%20*%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.mesh.Mesh%0A%20*%20%40memberof%20PIXI.mesh%0A%20*%20%40param%20%7BPIXI.Texture%7D%20texture%20-%20The%20texture%20to%20use%20on%20the%20rope.%0A%20*%20%40param%20%7BPIXI.Point%5B%5D%7D%20points%20-%20An%20array%20of%20%7B%40link%20PIXI.Point%7D%20objects%20to%20construct%20this%20rope.%0A%20*%0A%20*%2F%0Afunction%20Rope(texture%2C%20points)%0A%7B%0A%20%20%20%20Mesh.call(this%2C%20texture)%3B%0A%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20%40member%20%7BPIXI.Point%5B%5D%7D%20An%20array%20of%20points%20that%20determine%20the%20rope%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.points%20%3D%20points%3B%0A%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20%40member%20%7BFloat32Array%7D%20An%20array%20of%20vertices%20used%20to%20construct%20this%20rope.%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.vertices%20%3D%20new%20Float32Array(points.length%20*%204)%3B%0A%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20%40member%20%7BFloat32Array%7D%20The%20WebGL%20Uvs%20of%20the%20rope.%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.uvs%20%3D%20new%20Float32Array(points.length%20*%204)%3B%0A%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20%40member%20%7BFloat32Array%7D%20An%20array%20containing%20the%20color%20components%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.colors%20%3D%20new%20Float32Array(points.length%20*%202)%3B%0A%0A%20%20%20%20%2F*%0A%20%20%20%20%20*%20%40member%20%7BUint16Array%7D%20An%20array%20containing%20the%20indices%20of%20the%20vertices%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.indices%20%3D%20new%20Uint16Array(points.length%20*%202)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Tracker%20for%20if%20the%20rope%20is%20ready%20to%20be%20drawn.%20Needed%20because%20Mesh%20ctor%20can%0A%20%20%20%20%20*%20call%20_onTextureUpdated%20which%20could%20call%20refresh%20too%20early.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20%20this._ready%20%3D%20true%3B%0A%0A%20%20%20%20%20this.refresh()%3B%0A%7D%0A%0A%0A%2F%2F%20constructor%0ARope.prototype%20%3D%20Object.create(Mesh.prototype)%3B%0ARope.prototype.constructor%20%3D%20Rope%3B%0Amodule.exports%20%3D%20Rope%3B%0A%0A%2F**%0A%20*%20Refreshes%0A%20*%0A%20*%2F%0ARope.prototype.refresh%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20points%20%3D%20this.points%3B%0A%0A%20%20%20%20%2F%2F%20if%20too%20little%20points%2C%20or%20texture%20hasn't%20got%20UVs%20set%20yet%20just%20move%20on.%0A%20%20%20%20if%20(points.length%20%3C%201%20%7C%7C%20!this._texture._uvs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20uvs%20%3D%20this.uvs%3B%0A%0A%20%20%20%20var%20indices%20%3D%20this.indices%3B%0A%20%20%20%20var%20colors%20%3D%20this.colors%3B%0A%0A%20%20%20%20var%20textureUvs%20%3D%20this._texture._uvs%3B%0A%20%20%20%20var%20offset%20%3D%20new%20core.Point(textureUvs.x0%2C%20textureUvs.y0)%3B%0A%20%20%20%20var%20factor%20%3D%20new%20core.Point(textureUvs.x2%20-%20textureUvs.x0%2C%20textureUvs.y2%20-%20textureUvs.y0)%3B%0A%0A%20%20%20%20uvs%5B0%5D%20%3D%200%20%2B%20offset.x%3B%0A%20%20%20%20uvs%5B1%5D%20%3D%200%20%2B%20offset.y%3B%0A%20%20%20%20uvs%5B2%5D%20%3D%200%20%2B%20offset.x%3B%0A%20%20%20%20uvs%5B3%5D%20%3D%201%20*%20factor.y%20%2B%20offset.y%3B%0A%0A%20%20%20%20colors%5B0%5D%20%3D%201%3B%0A%20%20%20%20colors%5B1%5D%20%3D%201%3B%0A%0A%20%20%20%20indices%5B0%5D%20%3D%200%3B%0A%20%20%20%20indices%5B1%5D%20%3D%201%3B%0A%0A%20%20%20%20var%20total%20%3D%20points.length%2C%0A%20%20%20%20%20%20%20%20point%2C%20index%2C%20amount%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%201%3B%20i%20%3C%20total%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20point%20%3D%20points%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20index%20%3D%20i%20*%204%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20time%20to%20do%20some%20smart%20drawing!%0A%20%20%20%20%20%20%20%20amount%20%3D%20i%20%2F%20(total-1)%3B%0A%0A%20%20%20%20%20%20%20%20uvs%5Bindex%5D%20%3D%20amount%20*%20factor.x%20%2B%20offset.x%3B%0A%20%20%20%20%20%20%20%20uvs%5Bindex%2B1%5D%20%3D%200%20%2B%20offset.y%3B%0A%0A%20%20%20%20%20%20%20%20uvs%5Bindex%2B2%5D%20%3D%20amount%20*%20factor.x%20%2B%20offset.x%3B%0A%20%20%20%20%20%20%20%20uvs%5Bindex%2B3%5D%20%3D%201%20*%20factor.y%20%2B%20offset.y%3B%0A%0A%20%20%20%20%20%20%20%20index%20%3D%20i%20*%202%3B%0A%20%20%20%20%20%20%20%20colors%5Bindex%5D%20%3D%201%3B%0A%20%20%20%20%20%20%20%20colors%5Bindex%2B1%5D%20%3D%201%3B%0A%0A%20%20%20%20%20%20%20%20index%20%3D%20i%20*%202%3B%0A%20%20%20%20%20%20%20%20indices%5Bindex%5D%20%3D%20index%3B%0A%20%20%20%20%20%20%20%20indices%5Bindex%20%2B%201%5D%20%3D%20index%20%2B%201%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.dirty%20%3D%20true%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Clear%20texture%20UVs%20when%20new%20texture%20is%20set%0A%20*%0A%20*%20%40private%0A%20*%2F%0ARope.prototype._onTextureUpdate%20%3D%20function%20()%0A%7B%0A%20%20%20%20Mesh.prototype._onTextureUpdate.call(this)%3B%0A%0A%20%20%20%20%2F%2F%20wait%20for%20the%20Rope%20ctor%20to%20finish%20before%20calling%20refresh%0A%20%20%20%20if%20(this._ready)%20%7B%0A%20%20%20%20%20%20%20%20this.refresh()%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Updates%20the%20object%20transform%20for%20rendering%0A%20*%0A%20*%20%40private%0A%20*%2F%0ARope.prototype.updateTransform%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20points%20%3D%20this.points%3B%0A%0A%20%20%20%20if%20(points.length%20%3C%201)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20lastPoint%20%3D%20points%5B0%5D%3B%0A%20%20%20%20var%20nextPoint%3B%0A%20%20%20%20var%20perpX%20%3D%200%3B%0A%20%20%20%20var%20perpY%20%3D%200%3B%0A%0A%20%20%20%20%2F%2F%20this.count%20-%3D%200.2%3B%0A%0A%20%20%20%20var%20vertices%20%3D%20this.vertices%3B%0A%20%20%20%20var%20total%20%3D%20points.length%2C%0A%20%20%20%20%20%20%20%20point%2C%20index%2C%20ratio%2C%20perpLength%2C%20num%3B%0A%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20total%3B%20i%2B%2B)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20point%20%3D%20points%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20index%20%3D%20i%20*%204%3B%0A%0A%20%20%20%20%20%20%20%20if%20(i%20%3C%20points.length-1)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20nextPoint%20%3D%20points%5Bi%2B1%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20nextPoint%20%3D%20point%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20perpY%20%3D%20-(nextPoint.x%20-%20lastPoint.x)%3B%0A%20%20%20%20%20%20%20%20perpX%20%3D%20nextPoint.y%20-%20lastPoint.y%3B%0A%0A%20%20%20%20%20%20%20%20ratio%20%3D%20(1%20-%20(i%20%2F%20(total-1)))%20*%2010%3B%0A%0A%20%20%20%20%20%20%20%20if%20(ratio%20%3E%201)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20ratio%20%3D%201%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20perpLength%20%3D%20Math.sqrt(perpX%20*%20perpX%20%2B%20perpY%20*%20perpY)%3B%0A%20%20%20%20%20%20%20%20num%20%3D%20this._texture.height%20%2F%202%3B%20%2F%2F(20%20%2B%20Math.abs(Math.sin((i%20%2B%20this.count)%20*%200.3)%20*%2050)%20)*%20ratio%3B%0A%20%20%20%20%20%20%20%20perpX%20%2F%3D%20perpLength%3B%0A%20%20%20%20%20%20%20%20perpY%20%2F%3D%20perpLength%3B%0A%0A%20%20%20%20%20%20%20%20perpX%20*%3D%20num%3B%0A%20%20%20%20%20%20%20%20perpY%20*%3D%20num%3B%0A%0A%20%20%20%20%20%20%20%20vertices%5Bindex%5D%20%3D%20point.x%20%2B%20perpX%3B%0A%20%20%20%20%20%20%20%20vertices%5Bindex%2B1%5D%20%3D%20point.y%20%2B%20perpY%3B%0A%20%20%20%20%20%20%20%20vertices%5Bindex%2B2%5D%20%3D%20point.x%20-%20perpX%3B%0A%20%20%20%20%20%20%20%20vertices%5Bindex%2B3%5D%20%3D%20point.y%20-%20perpY%3B%0A%0A%20%20%20%20%20%20%20%20lastPoint%20%3D%20point%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.containerUpdateTransform()%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2Fcore%22%3A20%2C%22.%2FMesh%22%3A115%7D%5D%2C117%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F**%0A%20*%20%40file%20%20%20%20%20%20%20%20Main%20export%20of%20the%20PIXI%20extras%20library%0A%20*%20%40author%20%20%20%20%20%20Mat%20Groves%20%3Cmat%40goodboydigital.com%3E%0A%20*%20%40copyright%20%20%202013-2015%20GoodBoyDigital%0A%20*%20%40license%20%20%20%20%20%7B%40link%20https%3A%2F%2Fgithub.com%2Fpixijs%2Fpixi.js%2Fblob%2Fmaster%2FLICENSE%7CMIT%20License%7D%0A%20*%2F%0A%0A%2F**%0A%20*%20%40namespace%20PIXI.mesh%0A%20*%2F%0Amodule.exports%20%3D%20%7B%0A%20%20%20%20Mesh%3A%20%20%20%20%20%20%20%20%20%20%20require('.%2FMesh')%2C%0A%20%20%20%20Rope%3A%20%20%20%20%20%20%20%20%20%20%20require('.%2FRope')%2C%0A%20%20%20%20MeshRenderer%3A%20%20%20require('.%2Fwebgl%2FMeshRenderer')%2C%0A%20%20%20%20MeshShader%3A%20%20%20%20%20require('.%2Fwebgl%2FMeshShader')%0A%7D%3B%0A%0A%7D%2C%7B%22.%2FMesh%22%3A115%2C%22.%2FRope%22%3A116%2C%22.%2Fwebgl%2FMeshRenderer%22%3A118%2C%22.%2Fwebgl%2FMeshShader%22%3A119%7D%5D%2C118%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%2C%0A%20%20%20%20Mesh%20%3D%20require('..%2FMesh')%3B%0A%0A%2F**%0A%20*%20%40author%20Mat%20Groves%0A%20*%0A%20*%20Big%20thanks%20to%20the%20very%20clever%20Matt%20DesLauriers%20%3Cmattdesl%3E%20https%3A%2F%2Fgithub.com%2Fmattdesl%2F%0A%20*%20for%20creating%20the%20original%20pixi%20version!%0A%20*%20Also%20a%20thanks%20to%20https%3A%2F%2Fgithub.com%2Fbchevalier%20for%20tweaking%20the%20tint%20and%20alpha%20so%20that%20they%20now%20share%204%20bytes%20on%20the%20vertex%20buffer%0A%20*%0A%20*%20Heavily%20inspired%20by%20LibGDX's%20MeshRenderer%3A%0A%20*%20https%3A%2F%2Fgithub.com%2Flibgdx%2Flibgdx%2Fblob%2Fmaster%2Fgdx%2Fsrc%2Fcom%2Fbadlogic%2Fgdx%2Fgraphics%2Fg2d%2FMeshRenderer.java%0A%20*%2F%0A%0A%2F**%0A%20*%0A%20*%20%40class%0A%20*%20%40private%0A%20*%20%40memberof%20PIXI.mesh%0A%20*%20%40extends%20PIXI.ObjectRenderer%0A%20*%20%40param%20renderer%20%7BPIXI.WebGLRenderer%7D%20The%20renderer%20this%20sprite%20batch%20works%20for.%0A%20*%2F%0Afunction%20MeshRenderer(renderer)%0A%7B%0A%20%20%20%20core.ObjectRenderer.call(this%2C%20renderer)%3B%0A%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Holds%20the%20indices%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BUint16Array%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.indices%20%3D%20new%20Uint16Array(15000)%3B%0A%0A%20%20%20%20%2F%2FTODO%20this%20could%20be%20a%20single%20buffer%20shared%20amongst%20all%20renderers%20as%20we%20reuse%20this%20set%20up%20in%20most%20renderers%0A%20%20%20%20for%20(var%20i%3D0%2C%20j%3D0%3B%20i%20%3C%2015000%3B%20i%20%2B%3D%206%2C%20j%20%2B%3D%204)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this.indices%5Bi%20%2B%200%5D%20%3D%20j%20%2B%200%3B%0A%20%20%20%20%20%20%20%20this.indices%5Bi%20%2B%201%5D%20%3D%20j%20%2B%201%3B%0A%20%20%20%20%20%20%20%20this.indices%5Bi%20%2B%202%5D%20%3D%20j%20%2B%202%3B%0A%20%20%20%20%20%20%20%20this.indices%5Bi%20%2B%203%5D%20%3D%20j%20%2B%200%3B%0A%20%20%20%20%20%20%20%20this.indices%5Bi%20%2B%204%5D%20%3D%20j%20%2B%202%3B%0A%20%20%20%20%20%20%20%20this.indices%5Bi%20%2B%205%5D%20%3D%20j%20%2B%203%3B%0A%20%20%20%20%7D%0A%7D%0A%0AMeshRenderer.prototype%20%3D%20Object.create(core.ObjectRenderer.prototype)%3B%0AMeshRenderer.prototype.constructor%20%3D%20MeshRenderer%3B%0Amodule.exports%20%3D%20MeshRenderer%3B%0A%0Acore.WebGLRenderer.registerPlugin('mesh'%2C%20MeshRenderer)%3B%0A%0A%2F**%0A%20*%20Sets%20up%20the%20renderer%20context%20and%20necessary%20buffers.%0A%20*%0A%20*%20%40private%0A%20*%20%40param%20gl%20%7BWebGLRenderingContext%7D%20the%20current%20WebGL%20drawing%20context%0A%20*%2F%0AMeshRenderer.prototype.onContextChange%20%3D%20function%20()%0A%7B%0A%0A%7D%3B%0A%0A%2F**%0A%20*%20Renders%20the%20sprite%20object.%0A%20*%0A%20*%20%40param%20mesh%20%7BPIXI.mesh.Mesh%7D%20the%20mesh%20to%20render%0A%20*%2F%0AMeshRenderer.prototype.render%20%3D%20function%20(mesh)%0A%7B%0A%20%20%20%20if(!mesh._vertexBuffer)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20this._initWebGL(mesh)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20renderer%20%3D%20this.renderer%2C%0A%20%20%20%20%20%20%20%20gl%20%3D%20renderer.gl%2C%0A%20%20%20%20%20%20%20%20texture%20%3D%20mesh._texture.baseTexture%2C%0A%20%20%20%20%20%20%20%20shader%20%3D%20renderer.shaderManager.plugins.meshShader%3B%0A%0A%20%20%20%20var%20drawMode%20%3D%20mesh.drawMode%20%3D%3D%3D%20Mesh.DRAW_MODES.TRIANGLE_MESH%20%3F%20gl.TRIANGLE_STRIP%20%3A%20gl.TRIANGLES%3B%0A%0A%20%20%20%20renderer.blendModeManager.setBlendMode(mesh.blendMode)%3B%0A%0A%0A%20%20%20%20%2F%2F%20set%20uniforms%0A%20%20%20%20gl.uniformMatrix3fv(shader.uniforms.translationMatrix._location%2C%20false%2C%20mesh.worldTransform.toArray(true))%3B%0A%0A%20%20%20%20gl.uniformMatrix3fv(shader.uniforms.projectionMatrix._location%2C%20false%2C%20renderer.currentRenderTarget.projectionMatrix.toArray(true))%3B%0A%20%20%20%20gl.uniform1f(shader.uniforms.alpha._location%2C%20mesh.worldAlpha)%3B%0A%0A%20%20%20%20if%20(!mesh.dirty)%0A%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20mesh._vertexBuffer)%3B%0A%20%20%20%20%20%20%20%20gl.bufferSubData(gl.ARRAY_BUFFER%2C%200%2C%20mesh.vertices)%3B%0A%20%20%20%20%20%20%20%20gl.vertexAttribPointer(shader.attributes.aVertexPosition%2C%202%2C%20gl.FLOAT%2C%20false%2C%200%2C%200)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20update%20the%20uvs%0A%20%20%20%20%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20mesh._uvBuffer)%3B%0A%20%20%20%20%20%20%20%20gl.vertexAttribPointer(shader.attributes.aTextureCoord%2C%202%2C%20gl.FLOAT%2C%20false%2C%200%2C%200)%3B%0A%0A%0A%20%20%20%20%20%20%20%20gl.activeTexture(gl.TEXTURE0)%3B%0A%0A%20%20%20%20%20%20%20if%20(!texture._glTextures%5Bgl.id%5D)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.renderer.updateTexture(texture)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20bind%20the%20current%20texture%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.bindTexture(gl.TEXTURE_2D%2C%20texture._glTextures%5Bgl.id%5D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER%2C%20mesh._indexBuffer)%3B%0A%20%20%20%20%20%20%20%20gl.bufferSubData(gl.ELEMENT_ARRAY_BUFFER%2C%200%2C%20mesh.indices)%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%0A%20%20%20%20%7B%0A%0A%20%20%20%20%20%20%20%20mesh.dirty%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20mesh._vertexBuffer)%3B%0A%20%20%20%20%20%20%20%20gl.bufferData(gl.ARRAY_BUFFER%2C%20mesh.vertices%2C%20gl.STATIC_DRAW)%3B%0A%20%20%20%20%20%20%20%20gl.vertexAttribPointer(shader.attributes.aVertexPosition%2C%202%2C%20gl.FLOAT%2C%20false%2C%200%2C%200)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20update%20the%20uvs%0A%20%20%20%20%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20mesh._uvBuffer)%3B%0A%20%20%20%20%20%20%20%20gl.bufferData(gl.ARRAY_BUFFER%2C%20mesh.uvs%2C%20gl.STATIC_DRAW)%3B%0A%20%20%20%20%20%20%20%20gl.vertexAttribPointer(shader.attributes.aTextureCoord%2C%202%2C%20gl.FLOAT%2C%20false%2C%200%2C%200)%3B%0A%0A%20%20%20%20%20%20%20%20%20gl.activeTexture(gl.TEXTURE0)%3B%0A%0A%20%20%20%20%20%20%20%20if%20(!texture._glTextures%5Bgl.id%5D)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.renderer.updateTexture(texture)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20bind%20the%20current%20texture%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.bindTexture(gl.TEXTURE_2D%2C%20texture._glTextures%5Bgl.id%5D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20dont%20need%20to%20upload!%0A%20%20%20%20%20%20%20%20gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER%2C%20mesh._indexBuffer)%3B%0A%20%20%20%20%20%20%20%20gl.bufferData(gl.ELEMENT_ARRAY_BUFFER%2C%20mesh.indices%2C%20gl.STATIC_DRAW)%3B%0A%0A%20%20%20%20%7D%0A%0A%20%20%20%20gl.drawElements(drawMode%2C%20mesh.indices.length%2C%20gl.UNSIGNED_SHORT%2C%200)%3B%0A%0A%7D%3B%0A%0A%2F**%0A%20*%20Prepares%20all%20the%20buffers%20to%20render%20this%20mesh%0A%20*%20%40param%20mesh%20%7BPIXI.mesh.Mesh%7D%20the%20mesh%20to%20render%0A%20*%2F%0AMeshRenderer.prototype._initWebGL%20%3D%20function%20(mesh)%0A%7B%0A%20%20%20%20%2F%2F%20build%20the%20strip!%0A%20%20%20%20var%20gl%20%3D%20this.renderer.gl%3B%0A%0A%20%20%20%20mesh._vertexBuffer%20%3D%20gl.createBuffer()%3B%0A%20%20%20%20mesh._indexBuffer%20%3D%20gl.createBuffer()%3B%0A%20%20%20%20mesh._uvBuffer%20%3D%20gl.createBuffer()%3B%0A%0A%0A%0A%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20mesh._vertexBuffer)%3B%0A%20%20%20%20gl.bufferData(gl.ARRAY_BUFFER%2C%20mesh.vertices%2C%20gl.DYNAMIC_DRAW)%3B%0A%0A%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20mesh._uvBuffer)%3B%0A%20%20%20%20gl.bufferData(gl.ARRAY_BUFFER%2C%20%20mesh.uvs%2C%20gl.STATIC_DRAW)%3B%0A%0A%20%20%20%20if(mesh.colors)%7B%0A%20%20%20%20%20%20%20%20mesh._colorBuffer%20%3D%20gl.createBuffer()%3B%0A%20%20%20%20%20%20%20%20gl.bindBuffer(gl.ARRAY_BUFFER%2C%20mesh._colorBuffer)%3B%0A%20%20%20%20%20%20%20%20gl.bufferData(gl.ARRAY_BUFFER%2C%20mesh.colors%2C%20gl.STATIC_DRAW)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER%2C%20mesh._indexBuffer)%3B%0A%20%20%20%20gl.bufferData(gl.ELEMENT_ARRAY_BUFFER%2C%20mesh.indices%2C%20gl.STATIC_DRAW)%3B%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Empties%20the%20current%20batch.%0A%20*%0A%20*%2F%0AMeshRenderer.prototype.flush%20%3D%20function%20()%0A%7B%0A%0A%7D%3B%0A%0A%2F**%0A%20*%20Starts%20a%20new%20mesh%20renderer.%0A%20*%0A%20*%2F%0AMeshRenderer.prototype.start%20%3D%20function%20()%0A%7B%0A%20%20%20%20var%20shader%20%3D%20this.renderer.shaderManager.plugins.meshShader%3B%0A%0A%20%20%20%20this.renderer.shaderManager.setShader(shader)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Destroys%20the%20Mesh%20renderer%0A%20*%0A%20*%2F%0AMeshRenderer.prototype.destroy%20%3D%20function%20()%0A%7B%0A%20%20%20%20core.ObjectRenderer.prototype.destroy.call(this)%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%2C%22..%2FMesh%22%3A115%7D%5D%2C119%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20core%20%3D%20require('..%2F..%2Fcore')%3B%0A%0A%2F**%0A%20*%20%40class%0A%20*%20%40extends%20PIXI.Shader%0A%20*%20%40memberof%20PIXI.mesh%0A%20*%20%40param%20shaderManager%20%7BPIXI.ShaderManager%7D%20The%20WebGL%20shader%20manager%20this%20shader%20works%20for.%0A%20*%2F%0Afunction%20MeshShader(shaderManager)%0A%7B%0A%20%20%20%20core.Shader.call(this%2C%0A%20%20%20%20%20%20%20%20shaderManager%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20vertex%20shader%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20'precision%20lowp%20float%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'attribute%20vec2%20aVertexPosition%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'attribute%20vec2%20aTextureCoord%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'uniform%20mat3%20translationMatrix%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'uniform%20mat3%20projectionMatrix%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'varying%20vec2%20vTextureCoord%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'void%20main(void)%7B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%20%20gl_Position%20%3D%20vec4((projectionMatrix%20*%20translationMatrix%20*%20vec3(aVertexPosition%2C%201.0)).xy%2C%200.0%2C%201.0)%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%20%20vTextureCoord%20%3D%20aTextureCoord%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%7D'%0A%20%20%20%20%20%20%20%20%5D.join('%5Cn')%2C%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20'precision%20lowp%20float%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'varying%20vec2%20vTextureCoord%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'uniform%20float%20alpha%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'uniform%20sampler2D%20uSampler%3B'%2C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20'void%20main(void)%7B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%20%20%20gl_FragColor%20%3D%20texture2D(uSampler%2C%20vTextureCoord)%20*%20alpha%20%3B'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'%7D'%0A%20%20%20%20%20%20%20%20%5D.join('%5Cn')%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20uniforms%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20alpha%3A%20%20%7B%20type%3A%20'1f'%2C%20value%3A%200%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20translationMatrix%3A%20%7B%20type%3A%20'mat3'%2C%20value%3A%20new%20Float32Array(9)%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20projectionMatrix%3A%20%7B%20type%3A%20'mat3'%2C%20value%3A%20new%20Float32Array(9)%20%7D%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20custom%20attributes%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20aVertexPosition%3A0%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20aTextureCoord%3A0%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%3B%0A%7D%0A%0AMeshShader.prototype%20%3D%20Object.create(core.Shader.prototype)%3B%0AMeshShader.prototype.constructor%20%3D%20MeshShader%3B%0Amodule.exports%20%3D%20MeshShader%3B%0A%0Acore.ShaderManager.registerPlugin('meshShader'%2C%20MeshShader)%3B%0A%0A%7D%2C%7B%22..%2F..%2Fcore%22%3A20%7D%5D%2C120%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F%2F%20References%3A%0A%2F%2F%20https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FJavaScript%2FReference%2FGlobal_Objects%2FMath%2Fsign%0A%0Aif%20(!Math.sign)%0A%7B%0A%20%20%20%20Math.sign%20%3D%20function%20(x)%20%7B%0A%20%20%20%20%20%20%20%20x%20%3D%20%2Bx%3B%0A%20%20%20%20%20%20%20%20if%20(x%20%3D%3D%3D%200%20%7C%7C%20isNaN(x))%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20x%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20x%20%3E%200%20%3F%201%20%3A%20-1%3B%0A%20%20%20%20%7D%3B%0A%7D%0A%0A%7D%2C%7B%7D%5D%2C121%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F%2F%20References%3A%0A%2F%2F%20https%3A%2F%2Fgithub.com%2Fsindresorhus%2Fobject-assign%0A%2F%2F%20https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FJavaScript%2FReference%2FGlobal_Objects%2FObject%2Fassign%0A%0Aif%20(!Object.assign)%0A%7B%0A%20%20%20%20Object.assign%20%3D%20require('object-assign')%3B%0A%7D%0A%0A%7D%2C%7B%22object-assign%22%3A11%7D%5D%2C122%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Arequire('.%2FObject.assign')%3B%0Arequire('.%2FrequestAnimationFrame')%3B%0Arequire('.%2FMath.sign')%3B%0A%0A%7D%2C%7B%22.%2FMath.sign%22%3A120%2C%22.%2FObject.assign%22%3A121%2C%22.%2FrequestAnimationFrame%22%3A123%7D%5D%2C123%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A(function%20(global)%7B%0A%2F%2F%20References%3A%0A%2F%2F%20http%3A%2F%2Fpaulirish.com%2F2011%2Frequestanimationframe-for-smart-animating%2F%0A%2F%2F%20https%3A%2F%2Fgist.github.com%2F1579671%0A%2F%2F%20http%3A%2F%2Fupdates.html5rocks.com%2F2012%2F05%2FrequestAnimationFrame-API-now-with-sub-millisecond-precision%0A%2F%2F%20https%3A%2F%2Fgist.github.com%2Ftimhall%2F4078614%0A%2F%2F%20https%3A%2F%2Fgithub.com%2FFinancial-Times%2Fpolyfill-service%2Ftree%2Fmaster%2Fpolyfills%2FrequestAnimationFrame%0A%0A%2F%2F%20Expected%20to%20be%20used%20with%20Browserfiy%0A%2F%2F%20Browserify%20automatically%20detects%20the%20use%20of%20%60global%60%20and%20passes%20the%0A%2F%2F%20correct%20reference%20of%20%60global%60%2C%20%60self%60%2C%20and%20finally%20%60window%60%0A%0A%2F%2F%20Date.now%0Aif%20(!(Date.now%20%26%26%20Date.prototype.getTime))%20%7B%0A%20%20%20%20Date.now%20%3D%20function%20now()%20%7B%0A%20%20%20%20%20%20%20%20return%20new%20Date().getTime()%3B%0A%20%20%20%20%7D%3B%0A%7D%0A%0A%2F%2F%20performance.now%0Aif%20(!(global.performance%20%26%26%20global.performance.now))%20%7B%0A%20%20%20%20var%20startTime%20%3D%20Date.now()%3B%0A%20%20%20%20if%20(!global.performance)%20%7B%0A%20%20%20%20%20%20%20%20global.performance%20%3D%20%7B%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20global.performance.now%20%3D%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20return%20Date.now()%20-%20startTime%3B%0A%20%20%20%20%7D%3B%0A%7D%0A%0A%2F%2F%20requestAnimationFrame%0Avar%20lastTime%20%3D%20Date.now()%3B%0Avar%20vendors%20%3D%20%5B'ms'%2C%20'moz'%2C%20'webkit'%2C%20'o'%5D%3B%0A%0Afor(var%20x%20%3D%200%3B%20x%20%3C%20vendors.length%20%26%26%20!global.requestAnimationFrame%3B%20%2B%2Bx)%20%7B%0A%20%20%20%20global.requestAnimationFrame%20%3D%20global%5Bvendors%5Bx%5D%20%2B%20'RequestAnimationFrame'%5D%3B%0A%20%20%20%20global.cancelAnimationFrame%20%3D%20global%5Bvendors%5Bx%5D%20%2B%20'CancelAnimationFrame'%5D%20%7C%7C%0A%20%20%20%20%20%20%20%20global%5Bvendors%5Bx%5D%20%2B%20'CancelRequestAnimationFrame'%5D%3B%0A%7D%0A%0Aif%20(!global.requestAnimationFrame)%20%7B%0A%20%20%20%20global.requestAnimationFrame%20%3D%20function%20(callback)%20%7B%0A%20%20%20%20%20%20%20%20if%20(typeof%20callback%20!%3D%3D%20'function')%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20TypeError(callback%20%2B%20'is%20not%20a%20function')%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20var%20currentTime%20%3D%20Date.now()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20delay%20%3D%2016%20%2B%20lastTime%20-%20currentTime%3B%0A%0A%20%20%20%20%20%20%20%20if%20(delay%20%3C%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20delay%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20lastTime%20%3D%20currentTime%3B%0A%0A%20%20%20%20%20%20%20%20return%20setTimeout(function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20lastTime%20%3D%20Date.now()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20callback(performance.now())%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20delay)%3B%0A%20%20%20%20%7D%3B%0A%7D%0A%0Aif%20(!global.cancelAnimationFrame)%20%7B%0A%20%20%20%20global.cancelAnimationFrame%20%3D%20function(id)%20%7B%0A%20%20%20%20%20%20%20%20clearTimeout(id)%3B%0A%20%20%20%20%7D%3B%0A%7D%0A%0A%7D).call(this%2Ctypeof%20global%20!%3D%3D%20%22undefined%22%20%3F%20global%20%3A%20typeof%20self%20!%3D%3D%20%22undefined%22%20%3F%20self%20%3A%20typeof%20window%20!%3D%3D%20%22undefined%22%20%3F%20window%20%3A%20%7B%7D)%0A%0A%7D%2C%7B%7D%5D%2C124%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A(function%20(process)%7B%0A%2F*!%0A%20*%20async%0A%20*%20https%3A%2F%2Fgithub.com%2Fcaolan%2Fasync%0A%20*%0A%20*%20Copyright%202010-2014%20Caolan%20McMahon%0A%20*%20Released%20under%20the%20MIT%20license%0A%20*%2F%0A%2F*jshint%20onevar%3A%20false%2C%20indent%3A4%20*%2F%0A%2F*global%20setImmediate%3A%20false%2C%20setTimeout%3A%20false%2C%20console%3A%20false%20*%2F%0A(function%20()%20%7B%0A%0A%20%20%20%20var%20async%20%3D%20%7B%7D%3B%0A%0A%20%20%20%20%2F%2F%20global%20on%20the%20server%2C%20window%20in%20the%20browser%0A%20%20%20%20var%20root%2C%20previous_async%3B%0A%0A%20%20%20%20root%20%3D%20this%3B%0A%20%20%20%20if%20(root%20!%3D%20null)%20%7B%0A%20%20%20%20%20%20previous_async%20%3D%20root.async%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20async.noConflict%20%3D%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20root.async%20%3D%20previous_async%3B%0A%20%20%20%20%20%20%20%20return%20async%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20function%20only_once(fn)%20%7B%0A%20%20%20%20%20%20%20%20var%20called%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20return%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(called)%20throw%20new%20Error(%22Callback%20was%20already%20called.%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20called%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20fn.apply(root%2C%20arguments)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%20cross-browser%20compatiblity%20functions%20%2F%2F%2F%2F%0A%0A%20%20%20%20var%20_toString%20%3D%20Object.prototype.toString%3B%0A%0A%20%20%20%20var%20_isArray%20%3D%20Array.isArray%20%7C%7C%20function%20(obj)%20%7B%0A%20%20%20%20%20%20%20%20return%20_toString.call(obj)%20%3D%3D%3D%20'%5Bobject%20Array%5D'%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20var%20_each%20%3D%20function%20(arr%2C%20iterator)%20%7B%0A%20%20%20%20%20%20%20%20if%20(arr.forEach)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20arr.forEach(iterator)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20arr.length%3B%20i%20%2B%3D%201)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(arr%5Bi%5D%2C%20i%2C%20arr)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20var%20_map%20%3D%20function%20(arr%2C%20iterator)%20%7B%0A%20%20%20%20%20%20%20%20if%20(arr.map)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20arr.map(iterator)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20results%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20_each(arr%2C%20function%20(x%2C%20i%2C%20a)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20results.push(iterator(x%2C%20i%2C%20a))%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20return%20results%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20var%20_reduce%20%3D%20function%20(arr%2C%20iterator%2C%20memo)%20%7B%0A%20%20%20%20%20%20%20%20if%20(arr.reduce)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20arr.reduce(iterator%2C%20memo)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20_each(arr%2C%20function%20(x%2C%20i%2C%20a)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20memo%20%3D%20iterator(memo%2C%20x%2C%20i%2C%20a)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20return%20memo%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20var%20_keys%20%3D%20function%20(obj)%20%7B%0A%20%20%20%20%20%20%20%20if%20(Object.keys)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20Object.keys(obj)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20keys%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20for%20(var%20k%20in%20obj)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(obj.hasOwnProperty(k))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20keys.push(k)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20keys%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20%2F%2F%2F%2F%20exported%20async%20module%20functions%20%2F%2F%2F%2F%0A%0A%20%20%20%20%2F%2F%2F%2F%20nextTick%20implementation%20with%20browser-compatible%20fallback%20%2F%2F%2F%2F%0A%20%20%20%20if%20(typeof%20process%20%3D%3D%3D%20'undefined'%20%7C%7C%20!(process.nextTick))%20%7B%0A%20%20%20%20%20%20%20%20if%20(typeof%20setImmediate%20%3D%3D%3D%20'function')%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20async.nextTick%20%3D%20function%20(fn)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20not%20a%20direct%20alias%20for%20IE10%20compatibility%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20setImmediate(fn)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20async.setImmediate%20%3D%20async.nextTick%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20async.nextTick%20%3D%20function%20(fn)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20setTimeout(fn%2C%200)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20async.setImmediate%20%3D%20async.nextTick%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20async.nextTick%20%3D%20process.nextTick%3B%0A%20%20%20%20%20%20%20%20if%20(typeof%20setImmediate%20!%3D%3D%20'undefined')%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20async.setImmediate%20%3D%20function%20(fn)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20not%20a%20direct%20alias%20for%20IE10%20compatibility%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20setImmediate(fn)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20async.setImmediate%20%3D%20async.nextTick%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20async.each%20%3D%20function%20(arr%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20callback%20%3D%20callback%20%7C%7C%20function%20()%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20if%20(!arr.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20callback()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20completed%20%3D%200%3B%0A%20%20%20%20%20%20%20%20_each(arr%2C%20function%20(x)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(x%2C%20only_once(done)%20)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20function%20done(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback%20%3D%20function%20()%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20completed%20%2B%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(completed%20%3E%3D%20arr.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20async.forEach%20%3D%20async.each%3B%0A%0A%20%20%20%20async.eachSeries%20%3D%20function%20(arr%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20callback%20%3D%20callback%20%7C%7C%20function%20()%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20if%20(!arr.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20callback()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20completed%20%3D%200%3B%0A%20%20%20%20%20%20%20%20var%20iterate%20%3D%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(arr%5Bcompleted%5D%2C%20function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback%20%3D%20function%20()%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20completed%20%2B%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(completed%20%3E%3D%20arr.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20iterate()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20iterate()%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20async.forEachSeries%20%3D%20async.eachSeries%3B%0A%0A%20%20%20%20async.eachLimit%20%3D%20function%20(arr%2C%20limit%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20var%20fn%20%3D%20_eachLimit(limit)%3B%0A%20%20%20%20%20%20%20%20fn.apply(null%2C%20%5Barr%2C%20iterator%2C%20callback%5D)%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20async.forEachLimit%20%3D%20async.eachLimit%3B%0A%0A%20%20%20%20var%20_eachLimit%20%3D%20function%20(limit)%20%7B%0A%0A%20%20%20%20%20%20%20%20return%20function%20(arr%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20callback%20%3D%20callback%20%7C%7C%20function%20()%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!arr.length%20%7C%7C%20limit%20%3C%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20callback()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20completed%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20started%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20running%20%3D%200%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20(function%20replenish%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(completed%20%3E%3D%20arr.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20callback()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20while%20(running%20%3C%20limit%20%26%26%20started%20%3C%20arr.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20started%20%2B%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20running%20%2B%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20iterator(arr%5Bstarted%20-%201%5D%2C%20function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback%20%3D%20function%20()%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20completed%20%2B%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20running%20-%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(completed%20%3E%3D%20arr.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20replenish()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)()%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%3B%0A%0A%0A%20%20%20%20var%20doParallel%20%3D%20function%20(fn)%20%7B%0A%20%20%20%20%20%20%20%20return%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20Array.prototype.slice.call(arguments)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20fn.apply(null%2C%20%5Basync.each%5D.concat(args))%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20var%20doParallelLimit%20%3D%20function(limit%2C%20fn)%20%7B%0A%20%20%20%20%20%20%20%20return%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20Array.prototype.slice.call(arguments)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20fn.apply(null%2C%20%5B_eachLimit(limit)%5D.concat(args))%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20var%20doSeries%20%3D%20function%20(fn)%20%7B%0A%20%20%20%20%20%20%20%20return%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20Array.prototype.slice.call(arguments)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20fn.apply(null%2C%20%5Basync.eachSeries%5D.concat(args))%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%3B%0A%0A%0A%20%20%20%20var%20_asyncMap%20%3D%20function%20(eachfn%2C%20arr%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20arr%20%3D%20_map(arr%2C%20function%20(x%2C%20i)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%7Bindex%3A%20i%2C%20value%3A%20x%7D%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20if%20(!callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20eachfn(arr%2C%20function%20(x%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20iterator(x.value%2C%20function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20results%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20eachfn(arr%2C%20function%20(x%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20iterator(x.value%2C%20function%20(err%2C%20v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20results%5Bx.index%5D%20%3D%20v%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%20function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err%2C%20results)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20async.map%20%3D%20doParallel(_asyncMap)%3B%0A%20%20%20%20async.mapSeries%20%3D%20doSeries(_asyncMap)%3B%0A%20%20%20%20async.mapLimit%20%3D%20function%20(arr%2C%20limit%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20return%20_mapLimit(limit)(arr%2C%20iterator%2C%20callback)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20var%20_mapLimit%20%3D%20function(limit)%20%7B%0A%20%20%20%20%20%20%20%20return%20doParallelLimit(limit%2C%20_asyncMap)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20%2F%2F%20reduce%20only%20has%20a%20series%20version%2C%20as%20doing%20reduce%20in%20parallel%20won't%0A%20%20%20%20%2F%2F%20work%20in%20many%20situations.%0A%20%20%20%20async.reduce%20%3D%20function%20(arr%2C%20memo%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20async.eachSeries(arr%2C%20function%20(x%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(memo%2C%20x%2C%20function%20(err%2C%20v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20memo%20%3D%20v%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20callback(err%2C%20memo)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20%2F%2F%20inject%20alias%0A%20%20%20%20async.inject%20%3D%20async.reduce%3B%0A%20%20%20%20%2F%2F%20foldl%20alias%0A%20%20%20%20async.foldl%20%3D%20async.reduce%3B%0A%0A%20%20%20%20async.reduceRight%20%3D%20function%20(arr%2C%20memo%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20var%20reversed%20%3D%20_map(arr%2C%20function%20(x)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20x%3B%0A%20%20%20%20%20%20%20%20%7D).reverse()%3B%0A%20%20%20%20%20%20%20%20async.reduce(reversed%2C%20memo%2C%20iterator%2C%20callback)%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20%2F%2F%20foldr%20alias%0A%20%20%20%20async.foldr%20%3D%20async.reduceRight%3B%0A%0A%20%20%20%20var%20_filter%20%3D%20function%20(eachfn%2C%20arr%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20var%20results%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20arr%20%3D%20_map(arr%2C%20function%20(x%2C%20i)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%7Bindex%3A%20i%2C%20value%3A%20x%7D%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20eachfn(arr%2C%20function%20(x%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(x.value%2C%20function%20(v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20results.push(x)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20callback(_map(results.sort(function%20(a%2C%20b)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20a.index%20-%20b.index%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%2C%20function%20(x)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20x.value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D))%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20async.filter%20%3D%20doParallel(_filter)%3B%0A%20%20%20%20async.filterSeries%20%3D%20doSeries(_filter)%3B%0A%20%20%20%20%2F%2F%20select%20alias%0A%20%20%20%20async.select%20%3D%20async.filter%3B%0A%20%20%20%20async.selectSeries%20%3D%20async.filterSeries%3B%0A%0A%20%20%20%20var%20_reject%20%3D%20function%20(eachfn%2C%20arr%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20var%20results%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20arr%20%3D%20_map(arr%2C%20function%20(x%2C%20i)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%7Bindex%3A%20i%2C%20value%3A%20x%7D%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20eachfn(arr%2C%20function%20(x%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(x.value%2C%20function%20(v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20results.push(x)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20callback(_map(results.sort(function%20(a%2C%20b)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20a.index%20-%20b.index%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%2C%20function%20(x)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20x.value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D))%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20async.reject%20%3D%20doParallel(_reject)%3B%0A%20%20%20%20async.rejectSeries%20%3D%20doSeries(_reject)%3B%0A%0A%20%20%20%20var%20_detect%20%3D%20function%20(eachfn%2C%20arr%2C%20iterator%2C%20main_callback)%20%7B%0A%20%20%20%20%20%20%20%20eachfn(arr%2C%20function%20(x%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(x%2C%20function%20(result)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(result)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20main_callback(x)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20main_callback%20%3D%20function%20()%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20main_callback()%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20async.detect%20%3D%20doParallel(_detect)%3B%0A%20%20%20%20async.detectSeries%20%3D%20doSeries(_detect)%3B%0A%0A%20%20%20%20async.some%20%3D%20function%20(arr%2C%20iterator%2C%20main_callback)%20%7B%0A%20%20%20%20%20%20%20%20async.each(arr%2C%20function%20(x%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(x%2C%20function%20(v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20main_callback(true)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20main_callback%20%3D%20function%20()%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20main_callback(false)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20%2F%2F%20any%20alias%0A%20%20%20%20async.any%20%3D%20async.some%3B%0A%0A%20%20%20%20async.every%20%3D%20function%20(arr%2C%20iterator%2C%20main_callback)%20%7B%0A%20%20%20%20%20%20%20%20async.each(arr%2C%20function%20(x%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(x%2C%20function%20(v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20main_callback(false)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20main_callback%20%3D%20function%20()%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20main_callback(true)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20%2F%2F%20all%20alias%0A%20%20%20%20async.all%20%3D%20async.every%3B%0A%0A%20%20%20%20async.sortBy%20%3D%20function%20(arr%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20async.map(arr%2C%20function%20(x%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(x%2C%20function%20(err%2C%20criteria)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(null%2C%20%7Bvalue%3A%20x%2C%20criteria%3A%20criteria%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20function%20(err%2C%20results)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20fn%20%3D%20function%20(left%2C%20right)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20a%20%3D%20left.criteria%2C%20b%20%3D%20right.criteria%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20a%20%3C%20b%20%3F%20-1%20%3A%20a%20%3E%20b%20%3F%201%20%3A%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(null%2C%20_map(results.sort(fn)%2C%20function%20(x)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20x.value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.auto%20%3D%20function%20(tasks%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20callback%20%3D%20callback%20%7C%7C%20function%20()%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20var%20keys%20%3D%20_keys(tasks)%3B%0A%20%20%20%20%20%20%20%20var%20remainingTasks%20%3D%20keys.length%0A%20%20%20%20%20%20%20%20if%20(!remainingTasks)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20callback()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20var%20results%20%3D%20%7B%7D%3B%0A%0A%20%20%20%20%20%20%20%20var%20listeners%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20var%20addListener%20%3D%20function%20(fn)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20listeners.unshift(fn)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20var%20removeListener%20%3D%20function%20(fn)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20listeners.length%3B%20i%20%2B%3D%201)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(listeners%5Bi%5D%20%3D%3D%3D%20fn)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20listeners.splice(i%2C%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20var%20taskComplete%20%3D%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20remainingTasks--%0A%20%20%20%20%20%20%20%20%20%20%20%20_each(listeners.slice(0)%2C%20function%20(fn)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fn()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%0A%20%20%20%20%20%20%20%20addListener(function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!remainingTasks)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20theCallback%20%3D%20callback%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20prevent%20final%20callback%20from%20calling%20itself%20if%20it%20errors%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback%20%3D%20function%20()%20%7B%7D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20theCallback(null%2C%20results)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20%20%20_each(keys%2C%20function%20(k)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20task%20%3D%20_isArray(tasks%5Bk%5D)%20%3F%20tasks%5Bk%5D%3A%20%5Btasks%5Bk%5D%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20taskCallback%20%3D%20function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20Array.prototype.slice.call(arguments%2C%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(args.length%20%3C%3D%201)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20args%20%3D%20args%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20safeResults%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_each(_keys(results)%2C%20function(rkey)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20safeResults%5Brkey%5D%20%3D%20results%5Brkey%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20safeResults%5Bk%5D%20%3D%20args%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err%2C%20safeResults)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20stop%20subsequent%20errors%20hitting%20callback%20multiple%20times%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback%20%3D%20function%20()%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20results%5Bk%5D%20%3D%20args%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20async.setImmediate(taskComplete)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20requires%20%3D%20task.slice(0%2C%20Math.abs(task.length%20-%201))%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20ready%20%3D%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20_reduce(requires%2C%20function%20(a%2C%20x)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20(a%20%26%26%20results.hasOwnProperty(x))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%20true)%20%26%26%20!results.hasOwnProperty(k)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(ready())%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20task%5Btask.length%20-%201%5D(taskCallback%2C%20results)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20listener%20%3D%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(ready())%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20removeListener(listener)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20task%5Btask.length%20-%201%5D(taskCallback%2C%20results)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20addListener(listener)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.retry%20%3D%20function(times%2C%20task%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20var%20DEFAULT_TIMES%20%3D%205%3B%0A%20%20%20%20%20%20%20%20var%20attempts%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20Use%20defaults%20if%20times%20not%20passed%0A%20%20%20%20%20%20%20%20if%20(typeof%20times%20%3D%3D%3D%20'function')%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20callback%20%3D%20task%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20task%20%3D%20times%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20times%20%3D%20DEFAULT_TIMES%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%2F%2F%20Make%20sure%20times%20is%20a%20number%0A%20%20%20%20%20%20%20%20times%20%3D%20parseInt(times%2C%2010)%20%7C%7C%20DEFAULT_TIMES%3B%0A%20%20%20%20%20%20%20%20var%20wrappedTask%20%3D%20function(wrappedCallback%2C%20wrappedResults)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20retryAttempt%20%3D%20function(task%2C%20finalAttempt)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20function(seriesCallback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20task(function(err%2C%20result)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20seriesCallback(!err%20%7C%7C%20finalAttempt%2C%20%7Berr%3A%20err%2C%20result%3A%20result%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%20wrappedResults)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20while%20(times)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20attempts.push(retryAttempt(task%2C%20!(times-%3D1)))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20async.series(attempts%2C%20function(done%2C%20data)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%20%3D%20data%5Bdata.length%20-%201%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(wrappedCallback%20%7C%7C%20callback)(data.err%2C%20data.result)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%2F%2F%20If%20a%20callback%20is%20passed%2C%20run%20this%20as%20a%20controll%20flow%0A%20%20%20%20%20%20%20%20return%20callback%20%3F%20wrappedTask()%20%3A%20wrappedTask%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.waterfall%20%3D%20function%20(tasks%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20callback%20%3D%20callback%20%7C%7C%20function%20()%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20if%20(!_isArray(tasks))%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20err%20%3D%20new%20Error('First%20argument%20to%20waterfall%20must%20be%20an%20array%20of%20functions')%3B%0A%20%20%20%20%20%20%20%20%20%20return%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20(!tasks.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20callback()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20wrapIterator%20%3D%20function%20(iterator)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback.apply(null%2C%20arguments)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback%20%3D%20function%20()%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20Array.prototype.slice.call(arguments%2C%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20next%20%3D%20iterator.next()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(next)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20args.push(wrapIterator(next))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20args.push(callback)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20async.setImmediate(function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20iterator.apply(null%2C%20args)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20wrapIterator(async.iterator(tasks))()%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20var%20_parallel%20%3D%20function(eachfn%2C%20tasks%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20callback%20%3D%20callback%20%7C%7C%20function%20()%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20if%20(_isArray(tasks))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20eachfn.map(tasks%2C%20function%20(fn%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(fn)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fn(function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20Array.prototype.slice.call(arguments%2C%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(args.length%20%3C%3D%201)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20args%20%3D%20args%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback.call(null%2C%20err%2C%20args)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%20callback)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20results%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20eachfn.each(_keys(tasks)%2C%20function%20(k%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20tasks%5Bk%5D(function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20Array.prototype.slice.call(arguments%2C%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(args.length%20%3C%3D%201)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20args%20%3D%20args%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20results%5Bk%5D%20%3D%20args%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%20function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err%2C%20results)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.parallel%20%3D%20function%20(tasks%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20_parallel(%7B%20map%3A%20async.map%2C%20each%3A%20async.each%20%7D%2C%20tasks%2C%20callback)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.parallelLimit%20%3D%20function(tasks%2C%20limit%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20_parallel(%7B%20map%3A%20_mapLimit(limit)%2C%20each%3A%20_eachLimit(limit)%20%7D%2C%20tasks%2C%20callback)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.series%20%3D%20function%20(tasks%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20callback%20%3D%20callback%20%7C%7C%20function%20()%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20if%20(_isArray(tasks))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20async.mapSeries(tasks%2C%20function%20(fn%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(fn)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fn(function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20Array.prototype.slice.call(arguments%2C%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(args.length%20%3C%3D%201)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20args%20%3D%20args%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback.call(null%2C%20err%2C%20args)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%20callback)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20results%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20async.eachSeries(_keys(tasks)%2C%20function%20(k%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20tasks%5Bk%5D(function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20Array.prototype.slice.call(arguments%2C%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(args.length%20%3C%3D%201)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20args%20%3D%20args%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20results%5Bk%5D%20%3D%20args%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%20function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback(err%2C%20results)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.iterator%20%3D%20function%20(tasks)%20%7B%0A%20%20%20%20%20%20%20%20var%20makeCallback%20%3D%20function%20(index)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20fn%20%3D%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(tasks.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20tasks%5Bindex%5D.apply(null%2C%20arguments)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20fn.next()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20fn.next%20%3D%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20(index%20%3C%20tasks.length%20-%201)%20%3F%20makeCallback(index%20%2B%201)%3A%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20fn%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20return%20makeCallback(0)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.apply%20%3D%20function%20(fn)%20%7B%0A%20%20%20%20%20%20%20%20var%20args%20%3D%20Array.prototype.slice.call(arguments%2C%201)%3B%0A%20%20%20%20%20%20%20%20return%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20fn.apply(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20null%2C%20args.concat(Array.prototype.slice.call(arguments))%0A%20%20%20%20%20%20%20%20%20%20%20%20)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20var%20_concat%20%3D%20function%20(eachfn%2C%20arr%2C%20fn%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20var%20r%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20eachfn(arr%2C%20function%20(x%2C%20cb)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20fn(x%2C%20function%20(err%2C%20y)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20r%20%3D%20r.concat(y%20%7C%7C%20%5B%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cb(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20callback(err%2C%20r)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20async.concat%20%3D%20doParallel(_concat)%3B%0A%20%20%20%20async.concatSeries%20%3D%20doSeries(_concat)%3B%0A%0A%20%20%20%20async.whilst%20%3D%20function%20(test%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20if%20(test())%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20async.whilst(test%2C%20iterator%2C%20callback)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20callback()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.doWhilst%20%3D%20function%20(iterator%2C%20test%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20iterator(function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20Array.prototype.slice.call(arguments%2C%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(test.apply(null%2C%20args))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20async.doWhilst(iterator%2C%20test%2C%20callback)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.until%20%3D%20function%20(test%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20if%20(!test())%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterator(function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20async.until(test%2C%20iterator%2C%20callback)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20callback()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.doUntil%20%3D%20function%20(iterator%2C%20test%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20iterator(function%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20Array.prototype.slice.call(arguments%2C%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!test.apply(null%2C%20args))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20async.doUntil(iterator%2C%20test%2C%20callback)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.queue%20%3D%20function%20(worker%2C%20concurrency)%20%7B%0A%20%20%20%20%20%20%20%20if%20(concurrency%20%3D%3D%3D%20undefined)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20concurrency%20%3D%201%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20function%20_insert(q%2C%20data%2C%20pos%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20(!q.started)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20q.started%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20(!_isArray(data))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%20%3D%20%5Bdata%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if(data.length%20%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20call%20drain%20immediately%20if%20there%20are%20no%20tasks%0A%20%20%20%20%20%20%20%20%20%20%20%20%20return%20async.setImmediate(function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(q.drain)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.drain()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20_each(data%2C%20function(task)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20item%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%3A%20task%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback%3A%20typeof%20callback%20%3D%3D%3D%20'function'%20%3F%20callback%20%3A%20null%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(pos)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.tasks.unshift(item)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.tasks.push(item)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(q.saturated%20%26%26%20q.tasks.length%20%3D%3D%3D%20q.concurrency)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.saturated()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20async.setImmediate(q.process)%3B%0A%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20var%20workers%20%3D%200%3B%0A%20%20%20%20%20%20%20%20var%20q%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20tasks%3A%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20concurrency%3A%20concurrency%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20saturated%3A%20null%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20empty%3A%20null%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20drain%3A%20null%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20started%3A%20false%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20paused%3A%20false%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20push%3A%20function%20(data%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20_insert(q%2C%20data%2C%20false%2C%20callback)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20kill%3A%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.drain%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.tasks%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20unshift%3A%20function%20(data%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20_insert(q%2C%20data%2C%20true%2C%20callback)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20process%3A%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!q.paused%20%26%26%20workers%20%3C%20q.concurrency%20%26%26%20q.tasks.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20task%20%3D%20q.tasks.shift()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(q.empty%20%26%26%20q.tasks.length%20%3D%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.empty()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20workers%20%2B%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20next%20%3D%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20workers%20-%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(task.callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20task.callback.apply(task%2C%20arguments)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(q.drain%20%26%26%20q.tasks.length%20%2B%20workers%20%3D%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.drain()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.process()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20cb%20%3D%20only_once(next)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20worker(task.data%2C%20cb)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20length%3A%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20q.tasks.length%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20running%3A%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20workers%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20idle%3A%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20q.tasks.length%20%2B%20workers%20%3D%3D%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20pause%3A%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(q.paused%20%3D%3D%3D%20true)%20%7B%20return%3B%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.paused%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.process()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20resume%3A%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(q.paused%20%3D%3D%3D%20false)%20%7B%20return%3B%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.paused%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.process()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20return%20q%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20%0A%20%20%20%20async.priorityQueue%20%3D%20function%20(worker%2C%20concurrency)%20%7B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20function%20_compareTasks(a%2C%20b)%7B%0A%20%20%20%20%20%20%20%20%20%20return%20a.priority%20-%20b.priority%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20function%20_binarySearch(sequence%2C%20item%2C%20compare)%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20beg%20%3D%20-1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20end%20%3D%20sequence.length%20-%201%3B%0A%20%20%20%20%20%20%20%20%20%20while%20(beg%20%3C%20end)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20mid%20%3D%20beg%20%2B%20((end%20-%20beg%20%2B%201)%20%3E%3E%3E%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(compare(item%2C%20sequence%5Bmid%5D)%20%3E%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20beg%20%3D%20mid%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20end%20%3D%20mid%20-%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20return%20beg%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20function%20_insert(q%2C%20data%2C%20priority%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20(!q.started)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20q.started%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20(!_isArray(data))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%20%3D%20%5Bdata%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if(data.length%20%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20call%20drain%20immediately%20if%20there%20are%20no%20tasks%0A%20%20%20%20%20%20%20%20%20%20%20%20%20return%20async.setImmediate(function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(q.drain)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.drain()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20_each(data%2C%20function(task)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20item%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%3A%20task%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20priority%3A%20priority%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback%3A%20typeof%20callback%20%3D%3D%3D%20'function'%20%3F%20callback%20%3A%20null%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.tasks.splice(_binarySearch(q.tasks%2C%20item%2C%20_compareTasks)%20%2B%201%2C%200%2C%20item)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(q.saturated%20%26%26%20q.tasks.length%20%3D%3D%3D%20q.concurrency)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q.saturated()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20async.setImmediate(q.process)%3B%0A%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20Start%20with%20a%20normal%20queue%0A%20%20%20%20%20%20%20%20var%20q%20%3D%20async.queue(worker%2C%20concurrency)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20Override%20push%20to%20accept%20second%20parameter%20representing%20priority%0A%20%20%20%20%20%20%20%20q.push%20%3D%20function%20(data%2C%20priority%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20_insert(q%2C%20data%2C%20priority%2C%20callback)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20Remove%20unshift%20function%0A%20%20%20%20%20%20%20%20delete%20q.unshift%3B%0A%0A%20%20%20%20%20%20%20%20return%20q%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.cargo%20%3D%20function%20(worker%2C%20payload)%20%7B%0A%20%20%20%20%20%20%20%20var%20working%20%20%20%20%20%3D%20false%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tasks%20%20%20%20%20%20%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20%20%20%20%20var%20cargo%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20tasks%3A%20tasks%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20payload%3A%20payload%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20saturated%3A%20null%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20empty%3A%20null%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20drain%3A%20null%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20drained%3A%20true%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20push%3A%20function%20(data%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!_isArray(data))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%20%3D%20%5Bdata%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_each(data%2C%20function(task)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20tasks.push(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%3A%20task%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback%3A%20typeof%20callback%20%3D%3D%3D%20'function'%20%3F%20callback%20%3A%20null%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cargo.drained%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(cargo.saturated%20%26%26%20tasks.length%20%3D%3D%3D%20payload)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cargo.saturated()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20async.setImmediate(cargo.process)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20process%3A%20function%20process()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(working)%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(tasks.length%20%3D%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(cargo.drain%20%26%26%20!cargo.drained)%20cargo.drain()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cargo.drained%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20ts%20%3D%20typeof%20payload%20%3D%3D%3D%20'number'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3F%20tasks.splice(0%2C%20payload)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%20tasks.splice(0%2C%20tasks.length)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20ds%20%3D%20_map(ts%2C%20function%20(task)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20task.data%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(cargo.empty)%20cargo.empty()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20working%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20worker(ds%2C%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20working%20%3D%20false%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20arguments%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_each(ts%2C%20function%20(data)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data.callback.apply(null%2C%20args)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20process()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20length%3A%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20tasks.length%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20running%3A%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20working%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20return%20cargo%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20var%20_console_fn%20%3D%20function%20(name)%20%7B%0A%20%20%20%20%20%20%20%20return%20function%20(fn)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20Array.prototype.slice.call(arguments%2C%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20fn.apply(null%2C%20args.concat(%5Bfunction%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20Array.prototype.slice.call(arguments%2C%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(typeof%20console%20!%3D%3D%20'undefined')%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(console.error)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20if%20(console%5Bname%5D)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_each(args%2C%20function%20(x)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console%5Bname%5D(x)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%5D))%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20async.log%20%3D%20_console_fn('log')%3B%0A%20%20%20%20async.dir%20%3D%20_console_fn('dir')%3B%0A%20%20%20%20%2F*async.info%20%3D%20_console_fn('info')%3B%0A%20%20%20%20async.warn%20%3D%20_console_fn('warn')%3B%0A%20%20%20%20async.error%20%3D%20_console_fn('error')%3B*%2F%0A%0A%20%20%20%20async.memoize%20%3D%20function%20(fn%2C%20hasher)%20%7B%0A%20%20%20%20%20%20%20%20var%20memo%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20var%20queues%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20hasher%20%3D%20hasher%20%7C%7C%20function%20(x)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20x%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20var%20memoized%20%3D%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20Array.prototype.slice.call(arguments)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20callback%20%3D%20args.pop()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20key%20%3D%20hasher.apply(null%2C%20args)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(key%20in%20memo)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20async.nextTick(function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback.apply(null%2C%20memo%5Bkey%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20if%20(key%20in%20queues)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20queues%5Bkey%5D.push(callback)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20queues%5Bkey%5D%20%3D%20%5Bcallback%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fn.apply(null%2C%20args.concat(%5Bfunction%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20memo%5Bkey%5D%20%3D%20arguments%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20q%20%3D%20queues%5Bkey%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20delete%20queues%5Bkey%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%200%2C%20l%20%3D%20q.length%3B%20i%20%3C%20l%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20q%5Bi%5D.apply(null%2C%20arguments)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5D))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20memoized.memo%20%3D%20memo%3B%0A%20%20%20%20%20%20%20%20memoized.unmemoized%20%3D%20fn%3B%0A%20%20%20%20%20%20%20%20return%20memoized%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.unmemoize%20%3D%20function%20(fn)%20%7B%0A%20%20%20%20%20%20return%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20return%20(fn.unmemoized%20%7C%7C%20fn).apply(null%2C%20arguments)%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.times%20%3D%20function%20(count%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20var%20counter%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20count%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20counter.push(i)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20async.map(counter%2C%20iterator%2C%20callback)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.timesSeries%20%3D%20function%20(count%2C%20iterator%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20var%20counter%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20count%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20counter.push(i)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20async.mapSeries(counter%2C%20iterator%2C%20callback)%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.seq%20%3D%20function%20(%2F*%20functions...%20*%2F)%20%7B%0A%20%20%20%20%20%20%20%20var%20fns%20%3D%20arguments%3B%0A%20%20%20%20%20%20%20%20return%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20that%20%3D%20this%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20Array.prototype.slice.call(arguments)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20callback%20%3D%20args.pop()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20async.reduce(fns%2C%20args%2C%20function%20(newargs%2C%20fn%2C%20cb)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fn.apply(that%2C%20newargs.concat(%5Bfunction%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20err%20%3D%20arguments%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20nextargs%20%3D%20Array.prototype.slice.call(arguments%2C%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cb(err%2C%20nextargs)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5D))%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20function%20(err%2C%20results)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callback.apply(that%2C%20%5Berr%5D.concat(results))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20async.compose%20%3D%20function%20(%2F*%20functions...%20*%2F)%20%7B%0A%20%20%20%20%20%20return%20async.seq.apply(null%2C%20Array.prototype.reverse.call(arguments))%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20var%20_applyEach%20%3D%20function%20(eachfn%2C%20fns%20%2F*args...*%2F)%20%7B%0A%20%20%20%20%20%20%20%20var%20go%20%3D%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20that%20%3D%20this%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20Array.prototype.slice.call(arguments)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20callback%20%3D%20args.pop()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20eachfn(fns%2C%20function%20(fn%2C%20cb)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fn.apply(that%2C%20args.concat(%5Bcb%5D))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20callback)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20if%20(arguments.length%20%3E%202)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20Array.prototype.slice.call(arguments%2C%202)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20go.apply(this%2C%20args)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20go%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20async.applyEach%20%3D%20doParallel(_applyEach)%3B%0A%20%20%20%20async.applyEachSeries%20%3D%20doSeries(_applyEach)%3B%0A%0A%20%20%20%20async.forever%20%3D%20function%20(fn%2C%20callback)%20%7B%0A%20%20%20%20%20%20%20%20function%20next(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(err)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(callback)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20callback(err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20err%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20fn(next)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20next()%3B%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20%2F%2F%20Node.js%0A%20%20%20%20if%20(typeof%20module%20!%3D%3D%20'undefined'%20%26%26%20module.exports)%20%7B%0A%20%20%20%20%20%20%20%20module.exports%20%3D%20async%3B%0A%20%20%20%20%7D%0A%20%20%20%20%2F%2F%20AMD%20%2F%20RequireJS%0A%20%20%20%20else%20if%20(typeof%20define%20!%3D%3D%20'undefined'%20%26%26%20define.amd)%20%7B%0A%20%20%20%20%20%20%20%20define(%5B%5D%2C%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20async%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%20%20%20%20%2F%2F%20included%20directly%20via%20%3Cscript%3E%20tag%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20root.async%20%3D%20async%3B%0A%20%20%20%20%7D%0A%0A%7D())%3B%0A%0A%7D).call(this%2Crequire('_process'))%0A%0A%7D%2C%7B%22_process%22%3A3%7D%5D%2C125%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A'use%20strict'%3B%0A%0A%2F%2F%0A%2F%2F%20We%20store%20our%20EE%20objects%20in%20a%20plain%20object%20whose%20properties%20are%20event%20names.%0A%2F%2F%20If%20%60Object.create(null)%60%20is%20not%20supported%20we%20prefix%20the%20event%20names%20with%20a%0A%2F%2F%20%60~%60%20to%20make%20sure%20that%20the%20built-in%20object%20properties%20are%20not%20overridden%20or%0A%2F%2F%20used%20as%20an%20attack%20vector.%0A%2F%2F%20We%20also%20assume%20that%20%60Object.create(null)%60%20is%20available%20when%20the%20event%20name%0A%2F%2F%20is%20an%20ES6%20Symbol.%0A%2F%2F%0Avar%20prefix%20%3D%20typeof%20Object.create%20!%3D%3D%20'function'%20%3F%20'~'%20%3A%20false%3B%0A%0A%2F**%0A%20*%20Representation%20of%20a%20single%20EventEmitter%20function.%0A%20*%0A%20*%20%40param%20%7BFunction%7D%20fn%20Event%20handler%20to%20be%20called.%0A%20*%20%40param%20%7BMixed%7D%20context%20Context%20for%20function%20execution.%0A%20*%20%40param%20%7BBoolean%7D%20once%20Only%20emit%20once%0A%20*%20%40api%20private%0A%20*%2F%0Afunction%20EE(fn%2C%20context%2C%20once)%20%7B%0A%20%20this.fn%20%3D%20fn%3B%0A%20%20this.context%20%3D%20context%3B%0A%20%20this.once%20%3D%20once%20%7C%7C%20false%3B%0A%7D%0A%0A%2F**%0A%20*%20Minimal%20EventEmitter%20interface%20that%20is%20molded%20against%20the%20Node.js%0A%20*%20EventEmitter%20interface.%0A%20*%0A%20*%20%40constructor%0A%20*%20%40api%20public%0A%20*%2F%0Afunction%20EventEmitter()%20%7B%20%2F*%20Nothing%20to%20set%20*%2F%20%7D%0A%0A%2F**%0A%20*%20Holds%20the%20assigned%20EventEmitters%20by%20name.%0A%20*%0A%20*%20%40type%20%7BObject%7D%0A%20*%20%40private%0A%20*%2F%0AEventEmitter.prototype._events%20%3D%20undefined%3B%0A%0A%2F**%0A%20*%20Return%20a%20list%20of%20assigned%20event%20listeners.%0A%20*%0A%20*%20%40param%20%7BString%7D%20event%20The%20events%20that%20should%20be%20listed.%0A%20*%20%40param%20%7BBoolean%7D%20exists%20We%20only%20need%20to%20know%20if%20there%20are%20listeners.%0A%20*%20%40returns%20%7BArray%7CBoolean%7D%0A%20*%20%40api%20public%0A%20*%2F%0AEventEmitter.prototype.listeners%20%3D%20function%20listeners(event%2C%20exists)%20%7B%0A%20%20var%20evt%20%3D%20prefix%20%3F%20prefix%20%2B%20event%20%3A%20event%0A%20%20%20%20%2C%20available%20%3D%20this._events%20%26%26%20this._events%5Bevt%5D%3B%0A%0A%20%20if%20(exists)%20return%20!!available%3B%0A%20%20if%20(!available)%20return%20%5B%5D%3B%0A%20%20if%20(this._events%5Bevt%5D.fn)%20return%20%5Bthis._events%5Bevt%5D.fn%5D%3B%0A%0A%20%20for%20(var%20i%20%3D%200%2C%20l%20%3D%20this._events%5Bevt%5D.length%2C%20ee%20%3D%20new%20Array(l)%3B%20i%20%3C%20l%3B%20i%2B%2B)%20%7B%0A%20%20%20%20ee%5Bi%5D%20%3D%20this._events%5Bevt%5D%5Bi%5D.fn%3B%0A%20%20%7D%0A%0A%20%20return%20ee%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Emit%20an%20event%20to%20all%20registered%20event%20listeners.%0A%20*%0A%20*%20%40param%20%7BString%7D%20event%20The%20name%20of%20the%20event.%0A%20*%20%40returns%20%7BBoolean%7D%20Indication%20if%20we've%20emitted%20an%20event.%0A%20*%20%40api%20public%0A%20*%2F%0AEventEmitter.prototype.emit%20%3D%20function%20emit(event%2C%20a1%2C%20a2%2C%20a3%2C%20a4%2C%20a5)%20%7B%0A%20%20var%20evt%20%3D%20prefix%20%3F%20prefix%20%2B%20event%20%3A%20event%3B%0A%0A%20%20if%20(!this._events%20%7C%7C%20!this._events%5Bevt%5D)%20return%20false%3B%0A%0A%20%20var%20listeners%20%3D%20this._events%5Bevt%5D%0A%20%20%20%20%2C%20len%20%3D%20arguments.length%0A%20%20%20%20%2C%20args%0A%20%20%20%20%2C%20i%3B%0A%0A%20%20if%20('function'%20%3D%3D%3D%20typeof%20listeners.fn)%20%7B%0A%20%20%20%20if%20(listeners.once)%20this.removeListener(event%2C%20listeners.fn%2C%20undefined%2C%20true)%3B%0A%0A%20%20%20%20switch%20(len)%20%7B%0A%20%20%20%20%20%20case%201%3A%20return%20listeners.fn.call(listeners.context)%2C%20true%3B%0A%20%20%20%20%20%20case%202%3A%20return%20listeners.fn.call(listeners.context%2C%20a1)%2C%20true%3B%0A%20%20%20%20%20%20case%203%3A%20return%20listeners.fn.call(listeners.context%2C%20a1%2C%20a2)%2C%20true%3B%0A%20%20%20%20%20%20case%204%3A%20return%20listeners.fn.call(listeners.context%2C%20a1%2C%20a2%2C%20a3)%2C%20true%3B%0A%20%20%20%20%20%20case%205%3A%20return%20listeners.fn.call(listeners.context%2C%20a1%2C%20a2%2C%20a3%2C%20a4)%2C%20true%3B%0A%20%20%20%20%20%20case%206%3A%20return%20listeners.fn.call(listeners.context%2C%20a1%2C%20a2%2C%20a3%2C%20a4%2C%20a5)%2C%20true%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20for%20(i%20%3D%201%2C%20args%20%3D%20new%20Array(len%20-1)%3B%20i%20%3C%20len%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20args%5Bi%20-%201%5D%20%3D%20arguments%5Bi%5D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20listeners.fn.apply(listeners.context%2C%20args)%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20var%20length%20%3D%20listeners.length%0A%20%20%20%20%20%20%2C%20j%3B%0A%0A%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20length%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20if%20(listeners%5Bi%5D.once)%20this.removeListener(event%2C%20listeners%5Bi%5D.fn%2C%20undefined%2C%20true)%3B%0A%0A%20%20%20%20%20%20switch%20(len)%20%7B%0A%20%20%20%20%20%20%20%20case%201%3A%20listeners%5Bi%5D.fn.call(listeners%5Bi%5D.context)%3B%20break%3B%0A%20%20%20%20%20%20%20%20case%202%3A%20listeners%5Bi%5D.fn.call(listeners%5Bi%5D.context%2C%20a1)%3B%20break%3B%0A%20%20%20%20%20%20%20%20case%203%3A%20listeners%5Bi%5D.fn.call(listeners%5Bi%5D.context%2C%20a1%2C%20a2)%3B%20break%3B%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20if%20(!args)%20for%20(j%20%3D%201%2C%20args%20%3D%20new%20Array(len%20-1)%3B%20j%20%3C%20len%3B%20j%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20args%5Bj%20-%201%5D%20%3D%20arguments%5Bj%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20listeners%5Bi%5D.fn.apply(listeners%5Bi%5D.context%2C%20args)%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20return%20true%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Register%20a%20new%20EventListener%20for%20the%20given%20event.%0A%20*%0A%20*%20%40param%20%7BString%7D%20event%20Name%20of%20the%20event.%0A%20*%20%40param%20%7BFuncton%7D%20fn%20Callback%20function.%0A%20*%20%40param%20%7BMixed%7D%20context%20The%20context%20of%20the%20function.%0A%20*%20%40api%20public%0A%20*%2F%0AEventEmitter.prototype.on%20%3D%20function%20on(event%2C%20fn%2C%20context)%20%7B%0A%20%20var%20listener%20%3D%20new%20EE(fn%2C%20context%20%7C%7C%20this)%0A%20%20%20%20%2C%20evt%20%3D%20prefix%20%3F%20prefix%20%2B%20event%20%3A%20event%3B%0A%0A%20%20if%20(!this._events)%20this._events%20%3D%20prefix%20%3F%20%7B%7D%20%3A%20Object.create(null)%3B%0A%20%20if%20(!this._events%5Bevt%5D)%20this._events%5Bevt%5D%20%3D%20listener%3B%0A%20%20else%20%7B%0A%20%20%20%20if%20(!this._events%5Bevt%5D.fn)%20this._events%5Bevt%5D.push(listener)%3B%0A%20%20%20%20else%20this._events%5Bevt%5D%20%3D%20%5B%0A%20%20%20%20%20%20this._events%5Bevt%5D%2C%20listener%0A%20%20%20%20%5D%3B%0A%20%20%7D%0A%0A%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Add%20an%20EventListener%20that's%20only%20called%20once.%0A%20*%0A%20*%20%40param%20%7BString%7D%20event%20Name%20of%20the%20event.%0A%20*%20%40param%20%7BFunction%7D%20fn%20Callback%20function.%0A%20*%20%40param%20%7BMixed%7D%20context%20The%20context%20of%20the%20function.%0A%20*%20%40api%20public%0A%20*%2F%0AEventEmitter.prototype.once%20%3D%20function%20once(event%2C%20fn%2C%20context)%20%7B%0A%20%20var%20listener%20%3D%20new%20EE(fn%2C%20context%20%7C%7C%20this%2C%20true)%0A%20%20%20%20%2C%20evt%20%3D%20prefix%20%3F%20prefix%20%2B%20event%20%3A%20event%3B%0A%0A%20%20if%20(!this._events)%20this._events%20%3D%20prefix%20%3F%20%7B%7D%20%3A%20Object.create(null)%3B%0A%20%20if%20(!this._events%5Bevt%5D)%20this._events%5Bevt%5D%20%3D%20listener%3B%0A%20%20else%20%7B%0A%20%20%20%20if%20(!this._events%5Bevt%5D.fn)%20this._events%5Bevt%5D.push(listener)%3B%0A%20%20%20%20else%20this._events%5Bevt%5D%20%3D%20%5B%0A%20%20%20%20%20%20this._events%5Bevt%5D%2C%20listener%0A%20%20%20%20%5D%3B%0A%20%20%7D%0A%0A%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Remove%20event%20listeners.%0A%20*%0A%20*%20%40param%20%7BString%7D%20event%20The%20event%20we%20want%20to%20remove.%0A%20*%20%40param%20%7BFunction%7D%20fn%20The%20listener%20that%20we%20need%20to%20find.%0A%20*%20%40param%20%7BMixed%7D%20context%20Only%20remove%20listeners%20matching%20this%20context.%0A%20*%20%40param%20%7BBoolean%7D%20once%20Only%20remove%20once%20listeners.%0A%20*%20%40api%20public%0A%20*%2F%0AEventEmitter.prototype.removeListener%20%3D%20function%20removeListener(event%2C%20fn%2C%20context%2C%20once)%20%7B%0A%20%20var%20evt%20%3D%20prefix%20%3F%20prefix%20%2B%20event%20%3A%20event%3B%0A%0A%20%20if%20(!this._events%20%7C%7C%20!this._events%5Bevt%5D)%20return%20this%3B%0A%0A%20%20var%20listeners%20%3D%20this._events%5Bevt%5D%0A%20%20%20%20%2C%20events%20%3D%20%5B%5D%3B%0A%0A%20%20if%20(fn)%20%7B%0A%20%20%20%20if%20(listeners.fn)%20%7B%0A%20%20%20%20%20%20if%20(%0A%20%20%20%20%20%20%20%20%20%20%20listeners.fn%20!%3D%3D%20fn%0A%20%20%20%20%20%20%20%20%7C%7C%20(once%20%26%26%20!listeners.once)%0A%20%20%20%20%20%20%20%20%7C%7C%20(context%20%26%26%20listeners.context%20!%3D%3D%20context)%0A%20%20%20%20%20%20)%20%7B%0A%20%20%20%20%20%20%20%20events.push(listeners)%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20for%20(var%20i%20%3D%200%2C%20length%20%3D%20listeners.length%3B%20i%20%3C%20length%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20if%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20listeners%5Bi%5D.fn%20!%3D%3D%20fn%0A%20%20%20%20%20%20%20%20%20%20%7C%7C%20(once%20%26%26%20!listeners%5Bi%5D.once)%0A%20%20%20%20%20%20%20%20%20%20%7C%7C%20(context%20%26%26%20listeners%5Bi%5D.context%20!%3D%3D%20context)%0A%20%20%20%20%20%20%20%20)%20%7B%0A%20%20%20%20%20%20%20%20%20%20events.push(listeners%5Bi%5D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%2F%2F%0A%20%20%2F%2F%20Reset%20the%20array%2C%20or%20remove%20it%20completely%20if%20we%20have%20no%20more%20listeners.%0A%20%20%2F%2F%0A%20%20if%20(events.length)%20%7B%0A%20%20%20%20this._events%5Bevt%5D%20%3D%20events.length%20%3D%3D%3D%201%20%3F%20events%5B0%5D%20%3A%20events%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20delete%20this._events%5Bevt%5D%3B%0A%20%20%7D%0A%0A%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Remove%20all%20listeners%20or%20only%20the%20listeners%20for%20the%20specified%20event.%0A%20*%0A%20*%20%40param%20%7BString%7D%20event%20The%20event%20want%20to%20remove%20all%20listeners%20for.%0A%20*%20%40api%20public%0A%20*%2F%0AEventEmitter.prototype.removeAllListeners%20%3D%20function%20removeAllListeners(event)%20%7B%0A%20%20if%20(!this._events)%20return%20this%3B%0A%0A%20%20if%20(event)%20delete%20this._events%5Bprefix%20%3F%20prefix%20%2B%20event%20%3A%20event%5D%3B%0A%20%20else%20this._events%20%3D%20prefix%20%3F%20%7B%7D%20%3A%20Object.create(null)%3B%0A%0A%20%20return%20this%3B%0A%7D%3B%0A%0A%2F%2F%0A%2F%2F%20Alias%20methods%20names%20because%20people%20roll%20like%20that.%0A%2F%2F%0AEventEmitter.prototype.off%20%3D%20EventEmitter.prototype.removeListener%3B%0AEventEmitter.prototype.addListener%20%3D%20EventEmitter.prototype.on%3B%0A%0A%2F%2F%0A%2F%2F%20This%20function%20doesn't%20apply%20anymore.%0A%2F%2F%0AEventEmitter.prototype.setMaxListeners%20%3D%20function%20setMaxListeners()%20%7B%0A%20%20return%20this%3B%0A%7D%3B%0A%0A%2F%2F%0A%2F%2F%20Expose%20the%20prefix.%0A%2F%2F%0AEventEmitter.prefixed%20%3D%20prefix%3B%0A%0A%2F%2F%0A%2F%2F%20Expose%20the%20module.%0A%2F%2F%0Amodule.exports%20%3D%20EventEmitter%3B%0A%0A%7D%2C%7B%7D%5D%2C126%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20async%20%20%20%20%20%20%20%3D%20require('async')%2C%0A%20%20%20%20urlParser%20%20%20%3D%20require('url')%2C%0A%20%20%20%20Resource%20%20%20%20%3D%20require('.%2FResource')%2C%0A%20%20%20%20EventEmitter%20%3D%20require('eventemitter3')%3B%0A%0A%2F**%0A%20*%20Manages%20the%20state%20and%20loading%20of%20multiple%20resources%20to%20load.%0A%20*%0A%20*%20%40class%0A%20*%20%40param%20%5BbaseUrl%3D''%5D%20%7Bstring%7D%20The%20base%20url%20for%20all%20resources%20loaded%20by%20this%20loader.%0A%20*%20%40param%20%5Bconcurrency%3D10%5D%20%7Bnumber%7D%20The%20number%20of%20resources%20to%20load%20concurrently.%0A%20*%2F%0Afunction%20Loader(baseUrl%2C%20concurrency)%20%7B%0A%20%20%20%20EventEmitter.call(this)%3B%0A%0A%20%20%20%20concurrency%20%3D%20concurrency%20%7C%7C%2010%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20base%20url%20for%20all%20resources%20loaded%20by%20this%20loader.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bstring%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.baseUrl%20%3D%20baseUrl%20%7C%7C%20''%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20progress%20percent%20of%20the%20loader%20going%20through%20the%20queue.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.progress%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Loading%20state%20of%20the%20loader%2C%20true%20if%20it%20is%20currently%20loading%20resources.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.loading%20%3D%20false%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20percentage%20of%20total%20progress%20that%20a%20single%20resource%20represents.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._progressChunk%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20middleware%20to%20run%20before%20loading%20each%20resource.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bfunction%5B%5D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._beforeMiddleware%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20middleware%20to%20run%20after%20loading%20each%20resource.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bfunction%5B%5D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._afterMiddleware%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20%60_loadResource%60%20function%20bound%20with%20this%20object%20context.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40member%20%7Bfunction%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._boundLoadResource%20%3D%20this._loadResource.bind(this)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20%60_onLoad%60%20function%20bound%20with%20this%20object%20context.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40member%20%7Bfunction%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._boundOnLoad%20%3D%20this._onLoad.bind(this)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20resource%20buffer%20that%20fills%20until%20%60load%60%20is%20called%20to%20start%20loading%20resources.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40member%20%7BResource%5B%5D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._buffer%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Used%20to%20track%20load%20completion.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40member%20%7Bnumber%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._numToLoad%20%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20resources%20waiting%20to%20be%20loaded.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%20%40member%20%7BResource%5B%5D%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._queue%20%3D%20async.queue(this._boundLoadResource%2C%20concurrency)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20All%20the%20resources%20for%20this%20loader%20keyed%20by%20name.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bobject%3Cstring%2C%20Resource%3E%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.resources%20%3D%20%7B%7D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Emitted%20once%20per%20loaded%20or%20errored%20resource.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40event%20progress%0A%20%20%20%20%20*%20%40memberof%20Loader%23%0A%20%20%20%20%20*%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Emitted%20once%20per%20errored%20resource.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40event%20error%0A%20%20%20%20%20*%20%40memberof%20Loader%23%0A%20%20%20%20%20*%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Emitted%20once%20per%20loaded%20resource.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40event%20load%0A%20%20%20%20%20*%20%40memberof%20Loader%23%0A%20%20%20%20%20*%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Emitted%20when%20the%20loader%20begins%20to%20process%20the%20queue.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40event%20start%0A%20%20%20%20%20*%20%40memberof%20Loader%23%0A%20%20%20%20%20*%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Emitted%20when%20the%20queued%20resources%20all%20load.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40event%20complete%0A%20%20%20%20%20*%20%40memberof%20Loader%23%0A%20%20%20%20%20*%2F%0A%7D%0A%0ALoader.prototype%20%3D%20Object.create(EventEmitter.prototype)%3B%0ALoader.prototype.constructor%20%3D%20Loader%3B%0Amodule.exports%20%3D%20Loader%3B%0A%0A%2F**%0A%20*%20Adds%20a%20resource%20(or%20multiple%20resources)%20to%20the%20loader%20queue.%0A%20*%0A%20*%20This%20function%20can%20take%20a%20wide%20variety%20of%20different%20parameters.%20The%20only%20thing%20that%20is%20always%0A%20*%20required%20the%20url%20to%20load.%20All%20the%20following%20will%20work%3A%0A%20*%0A%20*%20%60%60%60js%0A%20*%20loader%0A%20*%20%20%20%20%20%2F%2F%20normal%20param%20syntax%0A%20*%20%20%20%20%20.add('key'%2C%20'http%3A%2F%2F...'%2C%20function%20()%20%7B%7D)%0A%20*%20%20%20%20%20.add('http%3A%2F%2F...'%2C%20function%20()%20%7B%7D)%0A%20*%20%20%20%20%20.add('http%3A%2F%2F...')%0A%20*%0A%20*%20%20%20%20%20%2F%2F%20object%20syntax%0A%20*%20%20%20%20%20.add(%7B%0A%20*%20%20%20%20%20%20%20%20%20name%3A%20'key2'%2C%0A%20*%20%20%20%20%20%20%20%20%20url%3A%20'http%3A%2F%2F...'%0A%20*%20%20%20%20%20%7D%2C%20function%20()%20%7B%7D)%0A%20*%20%20%20%20%20.add(%7B%0A%20*%20%20%20%20%20%20%20%20%20url%3A%20'http%3A%2F%2F...'%0A%20*%20%20%20%20%20%7D%2C%20function%20()%20%7B%7D)%0A%20*%20%20%20%20%20.add(%7B%0A%20*%20%20%20%20%20%20%20%20%20name%3A%20'key3'%2C%0A%20*%20%20%20%20%20%20%20%20%20url%3A%20'http%3A%2F%2F...'%0A%20*%20%20%20%20%20%20%20%20%20onComplete%3A%20function%20()%20%7B%7D%0A%20*%20%20%20%20%20%7D)%0A%20*%20%20%20%20%20.add(%7B%0A%20*%20%20%20%20%20%20%20%20%20url%3A%20'https%3A%2F%2F...'%2C%0A%20*%20%20%20%20%20%20%20%20%20onComplete%3A%20function%20()%20%7B%7D%2C%0A%20*%20%20%20%20%20%20%20%20%20crossOrigin%3A%20true%0A%20*%20%20%20%20%20%7D)%0A%20*%0A%20*%20%20%20%20%20%2F%2F%20you%20can%20also%20pass%20an%20array%20of%20objects%20or%20urls%20or%20both%0A%20*%20%20%20%20%20.add(%5B%0A%20*%20%20%20%20%20%20%20%20%20%7B%20name%3A%20'key4'%2C%20url%3A%20'http%3A%2F%2F...'%2C%20onComplete%3A%20function%20()%20%7B%7D%20%7D%2C%0A%20*%20%20%20%20%20%20%20%20%20%7B%20url%3A%20'http%3A%2F%2F...'%2C%20onComplete%3A%20function%20()%20%7B%7D%20%7D%2C%0A%20*%20%20%20%20%20%20%20%20%20'http%3A%2F%2F...'%0A%20*%20%20%20%20%20%5D)%3B%0A%20*%20%60%60%60%0A%20*%0A%20*%20%40alias%20enqueue%0A%20*%20%40param%20%5Bname%5D%20%7Bstring%7D%20The%20name%20of%20the%20resource%20to%20load%2C%20if%20not%20passed%20the%20url%20is%20used.%0A%20*%20%40param%20url%20%7Bstring%7D%20The%20url%20for%20this%20resource%2C%20relative%20to%20the%20baseUrl%20of%20this%20loader.%0A%20*%20%40param%20%5Boptions%5D%20%7Bobject%7D%20The%20options%20for%20the%20load.%0A%20*%20%40param%20%5Boptions.crossOrigin%5D%20%7Bboolean%7D%20Is%20this%20request%20cross-origin%3F%20Default%20is%20to%20determine%20automatically.%0A%20*%20%40param%20%5Boptions.loadType%3DResource.LOAD_TYPE.XHR%5D%20%7BResource.XHR_LOAD_TYPE%7D%20How%20should%20this%20resource%20be%20loaded%3F%0A%20*%20%40param%20%5Boptions.xhrType%3DResource.XHR_RESPONSE_TYPE.DEFAULT%5D%20%7BResource.XHR_RESPONSE_TYPE%7D%20How%20should%20the%20data%20being%0A%20*%20%20%20%20%20%20loaded%20be%20interpreted%20when%20using%20XHR%3F%0A%20*%20%40param%20%5Bcallback%5D%20%7Bfunction%7D%20Function%20to%20call%20when%20this%20specific%20resource%20completes%20loading.%0A%20*%20%40return%20%7BLoader%7D%0A%20*%2F%0ALoader.prototype.add%20%3D%20Loader.prototype.enqueue%20%3D%20function%20(name%2C%20url%2C%20options%2C%20cb)%20%7B%0A%20%20%20%20%2F%2F%20special%20case%20of%20an%20array%20of%20objects%20or%20urls%0A%20%20%20%20if%20(Array.isArray(name))%20%7B%0A%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20name.length%3B%20%2B%2Bi)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.add(name%5Bi%5D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20if%20an%20object%20is%20passed%20instead%20of%20params%0A%20%20%20%20if%20(typeof%20name%20%3D%3D%3D%20'object')%20%7B%0A%20%20%20%20%20%20%20%20cb%20%3D%20url%20%7C%7C%20name.callback%20%7C%7C%20name.onComplete%3B%0A%20%20%20%20%20%20%20%20options%20%3D%20name%3B%0A%20%20%20%20%20%20%20%20url%20%3D%20name.url%3B%0A%20%20%20%20%20%20%20%20name%20%3D%20name.name%20%7C%7C%20name.key%20%7C%7C%20name.url%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20case%20where%20no%20name%20is%20passed%20shift%20all%20args%20over%20by%20one.%0A%20%20%20%20if%20(typeof%20url%20!%3D%3D%20'string')%20%7B%0A%20%20%20%20%20%20%20%20cb%20%3D%20options%3B%0A%20%20%20%20%20%20%20%20options%20%3D%20url%3B%0A%20%20%20%20%20%20%20%20url%20%3D%20name%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20now%20that%20we%20shifted%20make%20sure%20we%20have%20a%20proper%20url.%0A%20%20%20%20if%20(typeof%20url%20!%3D%3D%20'string')%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error('No%20url%20passed%20to%20add%20resource%20to%20loader.')%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20options%20are%20optional%20so%20people%20might%20pass%20a%20function%20and%20no%20options%0A%20%20%20%20if%20(typeof%20options%20%3D%3D%3D%20'function')%20%7B%0A%20%20%20%20%20%20%20%20cb%20%3D%20options%3B%0A%20%20%20%20%20%20%20%20options%20%3D%20null%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20check%20if%20resource%20already%20exists.%0A%20%20%20%20if%20(this.resources%5Bname%5D)%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error('Resource%20with%20name%20%22'%20%2B%20name%20%2B%20'%22%20already%20exists.')%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20add%20base%20url%20if%20this%20isn't%20an%20absolute%20url%0A%20%20%20%20url%20%3D%20this._handleBaseUrl(url)%3B%0A%0A%20%20%20%20%2F%2F%20create%20the%20store%20the%20resource%0A%20%20%20%20this.resources%5Bname%5D%20%3D%20new%20Resource(name%2C%20url%2C%20options)%3B%0A%0A%20%20%20%20if%20(typeof%20cb%20%3D%3D%3D%20'function')%20%7B%0A%20%20%20%20%20%20%20%20this.resources%5Bname%5D.once('afterMiddleware'%2C%20cb)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this._numToLoad%2B%2B%3B%0A%0A%20%20%20%20%2F%2F%20if%20already%20loading%20add%20it%20to%20the%20worker%20queue%0A%20%20%20%20if%20(this._queue.started)%20%7B%0A%20%20%20%20%20%20%20%20this._queue.push(this.resources%5Bname%5D)%3B%0A%20%20%20%20%20%20%20%20this._progressChunk%20%3D%20(100%20-%20this.progress)%20%2F%20(this._queue.length()%20%2B%20this._queue.running())%3B%0A%20%20%20%20%7D%0A%20%20%20%20%2F%2F%20otherwise%20buffer%20it%20to%20be%20added%20to%20the%20queue%20later%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20this._buffer.push(this.resources%5Bname%5D)%3B%0A%20%20%20%20%20%20%20%20this._progressChunk%20%3D%20100%20%2F%20this._buffer.length%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0ALoader.prototype._handleBaseUrl%20%3D%20function%20(url)%20%7B%0A%20%20%20%20var%20parsedUrl%20%3D%20urlParser.parse(url)%3B%0A%0A%20%20%20%20%2F%2F%20absolute%20url%2C%20just%20use%20it%20as%20is.%0A%20%20%20%20if%20(parsedUrl.protocol%20%7C%7C%20parsedUrl.pathname.indexOf('%2F%2F')%20%3D%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20return%20url%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20if%20baseUrl%20doesn't%20end%20in%20slash%20and%20url%20doesn't%20start%20with%20slash%2C%20then%20add%20a%20slash%20inbetween%0A%20%20%20%20if%20(%0A%20%20%20%20%20%20%20%20this.baseUrl.length%20%26%26%0A%20%20%20%20%20%20%20%20this.baseUrl.lastIndexOf('%2F')%20!%3D%3D%20this.baseUrl.length%20-%201%20%26%26%0A%20%20%20%20%20%20%20%20url.lastIndexOf('%2F')%20!%3D%3D%20url.length%20-%201%0A%20%20%20%20)%20%7B%0A%20%20%20%20%20%20%20%20return%20this.baseUrl%20%2B%20'%2F'%20%2B%20url%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20this.baseUrl%20%2B%20url%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%0A%2F**%0A%20*%20Sets%20up%20a%20middleware%20function%20that%20will%20run%20*before*%20the%0A%20*%20resource%20is%20loaded.%0A%20*%0A%20*%20%40alias%20pre%0A%20*%20%40param%20middleware%20%7Bfunction%7D%20The%20middleware%20function%20to%20register.%0A%20*%20%40return%20%7BLoader%7D%0A%20*%2F%0ALoader.prototype.before%20%3D%20Loader.prototype.pre%20%3D%20function%20(fn)%20%7B%0A%20%20%20%20this._beforeMiddleware.push(fn)%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Sets%20up%20a%20middleware%20function%20that%20will%20run%20*after*%20the%0A%20*%20resource%20is%20loaded.%0A%20*%0A%20*%20%40alias%20use%0A%20*%20%40param%20middleware%20%7Bfunction%7D%20The%20middleware%20function%20to%20register.%0A%20*%20%40return%20%7BLoader%7D%0A%20*%2F%0ALoader.prototype.after%20%3D%20Loader.prototype.use%20%3D%20function%20(fn)%20%7B%0A%20%20%20%20this._afterMiddleware.push(fn)%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Resets%20the%20queue%20of%20the%20loader%20to%20prepare%20for%20a%20new%20load.%0A%20*%0A%20*%20%40return%20%7BLoader%7D%0A%20*%2F%0ALoader.prototype.reset%20%3D%20function%20()%20%7B%0A%20%20%20%20%2F%2F%20this.baseUrl%20%3D%20baseUrl%20%7C%7C%20''%3B%0A%0A%20%20%20%20this.progress%20%3D%200%3B%0A%0A%20%20%20%20this.loading%20%3D%20false%3B%0A%0A%20%20%20%20this._progressChunk%20%3D%200%3B%0A%0A%20%20%20%20%2F%2F%20this._beforeMiddleware.length%20%3D%200%3B%0A%20%20%20%20%2F%2F%20this._afterMiddleware.length%20%3D%200%3B%0A%0A%20%20%20%20this._buffer.length%20%3D%200%3B%0A%0A%20%20%20%20this._numToLoad%20%3D%200%3B%0A%0A%20%20%20%20this._queue.kill()%3B%0A%20%20%20%20this._queue.started%20%3D%20false%3B%0A%0A%20%20%20%20this.resources%20%3D%20%7B%7D%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Starts%20loading%20the%20queued%20resources.%0A%20*%0A%20*%20%40fires%20start%0A%20*%20%40param%20%5Bcallback%5D%20%7Bfunction%7D%20Optional%20callback%20that%20will%20be%20bound%20to%20the%20%60complete%60%20event.%0A%20*%20%40return%20%7BLoader%7D%0A%20*%2F%0ALoader.prototype.load%20%3D%20function%20(cb)%20%7B%0A%20%20%20%20%2F%2F%20register%20complete%20callback%20if%20they%20pass%20one%0A%20%20%20%20if%20(typeof%20cb%20%3D%3D%3D%20'function')%20%7B%0A%20%20%20%20%20%20%20%20this.once('complete'%2C%20cb)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20if%20the%20queue%20has%20already%20started%20we%20are%20done%20here%0A%20%20%20%20if%20(this._queue.started)%20%7B%0A%20%20%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20notify%20of%20start%0A%20%20%20%20this.emit('start'%2C%20this)%3B%0A%0A%20%20%20%20%2F%2F%20start%20the%20internal%20queue%0A%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20this._buffer.length%3B%20%2B%2Bi)%20%7B%0A%20%20%20%20%20%20%20%20this._queue.push(this._buffer%5Bi%5D)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20empty%20the%20buffer%0A%20%20%20%20this._buffer.length%20%3D%200%3B%0A%0A%20%20%20%20return%20this%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Loads%20a%20single%20resource.%0A%20*%0A%20*%20%40fires%20progress%0A%20*%20%40private%0A%20*%2F%0ALoader.prototype._loadResource%20%3D%20function%20(resource%2C%20dequeue)%20%7B%0A%20%20%20%20var%20self%20%3D%20this%3B%0A%0A%20%20%20%20resource._dequeue%20%3D%20dequeue%3B%0A%0A%20%20%20%20this._runMiddleware(resource%2C%20this._beforeMiddleware%2C%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20resource.on('progress'%2C%20self.emit.bind(self%2C%20'progress'))%3B%0A%0A%20%20%20%20%20%20%20%20resource.load(self._boundOnLoad)%3B%0A%20%20%20%20%7D)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Called%20once%20each%20resource%20has%20loaded.%0A%20*%0A%20*%20%40fires%20complete%0A%20*%20%40private%0A%20*%2F%0ALoader.prototype._onComplete%20%3D%20function%20()%20%7B%0A%20%20%20%20this.emit('complete'%2C%20this%2C%20this.resources)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Called%20each%20time%20a%20resources%20is%20loaded.%0A%20*%0A%20*%20%40fires%20progress%0A%20*%20%40fires%20error%0A%20*%20%40fires%20load%0A%20*%20%40private%0A%20*%2F%0ALoader.prototype._onLoad%20%3D%20function%20(resource)%20%7B%0A%20%20%20%20this.progress%20%2B%3D%20this._progressChunk%3B%0A%0A%20%20%20%20this.emit('progress'%2C%20this%2C%20resource)%3B%0A%0A%20%20%20%20%2F%2F%20run%20middleware%2C%20this%20*must*%20happen%20before%20dequeue%20so%20sub-assets%20get%20added%20properly%0A%20%20%20%20this._runMiddleware(resource%2C%20this._afterMiddleware%2C%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20resource.emit('afterMiddleware'%2C%20resource)%3B%0A%0A%20%20%20%20%20%20%20%20this._numToLoad--%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20do%20completion%20check%0A%20%20%20%20%20%20%20%20if%20(this._numToLoad%20%3D%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.progress%20%3D%20100%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._onComplete()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20if%20(resource.error)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.emit('error'%2C%20resource.error%2C%20this%2C%20resource)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.emit('load'%2C%20this%2C%20resource)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D)%3B%0A%20%20%20%20%0A%0A%0A%20%20%20%20%2F%2F%20remove%20this%20resource%20from%20the%20async%20queue%0A%20%20%20%20resource._dequeue()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Run%20middleware%20functions%20on%20a%20resource.%0A%20*%0A%20*%20%40private%0A%20*%2F%0ALoader.prototype._runMiddleware%20%3D%20function%20(resource%2C%20fns%2C%20cb)%20%7B%0A%20%20%20%20var%20self%20%3D%20this%3B%0A%0A%20%20%20%20async.eachSeries(fns%2C%20function%20(fn%2C%20next)%20%7B%0A%20%20%20%20%20%20%20%20fn.call(self%2C%20resource%2C%20next)%3B%0A%20%20%20%20%7D%2C%20cb.bind(this%2C%20resource))%3B%0A%7D%3B%0A%0ALoader.LOAD_TYPE%20%3D%20Resource.LOAD_TYPE%3B%0ALoader.XHR_READY_STATE%20%3D%20Resource.XHR_READY_STATE%3B%0ALoader.XHR_RESPONSE_TYPE%20%3D%20Resource.XHR_RESPONSE_TYPE%3B%0A%0A%7D%2C%7B%22.%2FResource%22%3A127%2C%22async%22%3A124%2C%22eventemitter3%22%3A125%2C%22url%22%3A8%7D%5D%2C127%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20EventEmitter%20%3D%20require('eventemitter3')%2C%0A%20%20%20%20_url%20%3D%20require('url')%2C%0A%20%20%20%20%2F%2F%20tests%20is%20CORS%20is%20supported%20in%20XHR%2C%20if%20not%20we%20need%20to%20use%20XDR%0A%20%20%20%20useXdr%20%3D%20!!(window.XDomainRequest%20%26%26%20!('withCredentials'%20in%20(new%20XMLHttpRequest())))%2C%0A%20%20%20%20tempAnchor%20%3D%20null%3B%0A%0A%2F**%0A%20*%20Manages%20the%20state%20and%20loading%20of%20a%20single%20resource%20represented%20by%0A%20*%20a%20single%20URL.%0A%20*%0A%20*%20%40class%0A%20*%20%40param%20name%20%7Bstring%7D%20The%20name%20of%20the%20resource%20to%20load.%0A%20*%20%40param%20url%20%7Bstring%7Cstring%5B%5D%7D%20The%20url%20for%20this%20resource%2C%20for%20audio%2Fvideo%20loads%20you%20can%20pass%20an%20array%20of%20sources.%0A%20*%20%40param%20%5Boptions%5D%20%7Bobject%7D%20The%20options%20for%20the%20load.%0A%20*%20%40param%20%5Boptions.crossOrigin%5D%20%7Bboolean%7D%20Is%20this%20request%20cross-origin%3F%20Default%20is%20to%20determine%20automatically.%0A%20*%20%40param%20%5Boptions.loadType%3DResource.LOAD_TYPE.XHR%5D%20%7BResource.LOAD_TYPE%7D%20How%20should%20this%20resource%20be%20loaded%3F%0A%20*%20%40param%20%5Boptions.xhrType%3DResource.XHR_RESPONSE_TYPE.DEFAULT%5D%20%7BResource.XHR_RESPONSE_TYPE%7D%20How%20should%20the%20data%20being%0A%20*%20%20%20%20%20%20loaded%20be%20interpreted%20when%20using%20XHR%3F%0A%20*%2F%0Afunction%20Resource(name%2C%20url%2C%20options)%20%7B%0A%20%20%20%20EventEmitter.call(this)%3B%0A%0A%20%20%20%20options%20%3D%20options%20%7C%7C%20%7B%7D%3B%0A%0A%20%20%20%20if%20(typeof%20name%20!%3D%3D%20'string'%20%7C%7C%20typeof%20url%20!%3D%3D%20'string')%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error('Both%20name%20and%20url%20are%20required%20for%20constructing%20a%20resource.')%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20name%20of%20this%20resource.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bstring%7D%0A%20%20%20%20%20*%20%40readonly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.name%20%3D%20name%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20url%20used%20to%20load%20this%20resource.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bstring%7D%0A%20%20%20%20%20*%20%40readonly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.url%20%3D%20url%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Stores%20whether%20or%20not%20this%20url%20is%20a%20data%20url.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%20%40readonly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.isDataUrl%20%3D%20this.url.indexOf('data%3A')%20%3D%3D%3D%200%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20data%20that%20was%20loaded%20by%20the%20resource.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bany%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.data%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Is%20this%20request%20cross-origin%3F%20If%20unset%2C%20determined%20automatically.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bstring%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.crossOrigin%20%3D%20options.crossOrigin%20%3D%3D%3D%20true%20%3F%20'anonymous'%20%3A%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20method%20of%20loading%20to%20use%20for%20this%20resource.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BResource.LOAD_TYPE%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.loadType%20%3D%20options.loadType%20%7C%7C%20this._determineLoadType()%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20type%20used%20to%20load%20the%20resource%20via%20XHR.%20If%20unset%2C%20determined%20automatically.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bstring%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.xhrType%20%3D%20options.xhrType%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20error%20that%20occurred%20while%20loading%20(if%20any).%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BError%7D%0A%20%20%20%20%20*%20%40readonly%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.error%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20XHR%20object%20that%20was%20used%20to%20load%20this%20resource.%20This%20is%20only%20set%0A%20%20%20%20%20*%20when%20%60loadType%60%20is%20%60Resource.LOAD_TYPE.XHR%60.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7BXMLHttpRequest%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.xhr%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Describes%20if%20this%20resource%20was%20loaded%20as%20json.%20Only%20valid%20after%20the%20resource%0A%20%20%20%20%20*%20has%20completely%20loaded.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.isJson%20%3D%20false%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Describes%20if%20this%20resource%20was%20loaded%20as%20xml.%20Only%20valid%20after%20the%20resource%0A%20%20%20%20%20*%20has%20completely%20loaded.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.isXml%20%3D%20false%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Describes%20if%20this%20resource%20was%20loaded%20as%20an%20image%20tag.%20Only%20valid%20after%20the%20resource%0A%20%20%20%20%20*%20has%20completely%20loaded.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.isImage%20%3D%20false%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Describes%20if%20this%20resource%20was%20loaded%20as%20an%20audio%20tag.%20Only%20valid%20after%20the%20resource%0A%20%20%20%20%20*%20has%20completely%20loaded.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.isAudio%20%3D%20false%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Describes%20if%20this%20resource%20was%20loaded%20as%20a%20video%20tag.%20Only%20valid%20after%20the%20resource%0A%20%20%20%20%20*%20has%20completely%20loaded.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bboolean%7D%0A%20%20%20%20%20*%2F%0A%20%20%20%20this.isVideo%20%3D%20false%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20%60dequeue%60%20method%20that%20will%20be%20used%20a%20storage%20place%20for%20the%20async%20queue%20dequeue%20method%0A%20%20%20%20%20*%20used%20privately%20by%20the%20loader.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bfunction%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._dequeue%20%3D%20null%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20%60complete%60%20function%20bound%20to%20this%20resource's%20context.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bfunction%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._boundComplete%20%3D%20this.complete.bind(this)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20%60_onError%60%20function%20bound%20to%20this%20resource's%20context.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bfunction%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._boundOnError%20%3D%20this._onError.bind(this)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20The%20%60_onProgress%60%20function%20bound%20to%20this%20resource's%20context.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40member%20%7Bfunction%7D%0A%20%20%20%20%20*%20%40private%0A%20%20%20%20%20*%2F%0A%20%20%20%20this._boundOnProgress%20%3D%20this._onProgress.bind(this)%3B%0A%0A%20%20%20%20%2F%2F%20xhr%20callbacks%0A%20%20%20%20this._boundXhrOnError%20%3D%20this._xhrOnError.bind(this)%3B%0A%20%20%20%20this._boundXhrOnAbort%20%3D%20this._xhrOnAbort.bind(this)%3B%0A%20%20%20%20this._boundXhrOnLoad%20%3D%20this._xhrOnLoad.bind(this)%3B%0A%20%20%20%20this._boundXdrOnTimeout%20%3D%20this._xdrOnTimeout.bind(this)%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Emitted%20when%20the%20resource%20beings%20to%20load.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40event%20start%0A%20%20%20%20%20*%20%40memberof%20Resource%23%0A%20%20%20%20%20*%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Emitted%20each%20time%20progress%20of%20this%20resource%20load%20updates.%0A%20%20%20%20%20*%20Not%20all%20resources%20types%20and%20loader%20systems%20can%20support%20this%20event%0A%20%20%20%20%20*%20so%20sometimes%20it%20may%20not%20be%20available.%20If%20the%20resource%0A%20%20%20%20%20*%20is%20being%20loaded%20on%20a%20modern%20browser%2C%20using%20XHR%2C%20and%20the%20remote%20server%0A%20%20%20%20%20*%20properly%20sets%20Content-Length%20headers%2C%20then%20this%20will%20be%20available.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40event%20progress%0A%20%20%20%20%20*%20%40memberof%20Resource%23%0A%20%20%20%20%20*%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Emitted%20once%20this%20resource%20has%20loaded%2C%20if%20there%20was%20an%20error%20it%20will%0A%20%20%20%20%20*%20be%20in%20the%20%60error%60%20property.%0A%20%20%20%20%20*%0A%20%20%20%20%20*%20%40event%20complete%0A%20%20%20%20%20*%20%40memberof%20Resource%23%0A%20%20%20%20%20*%2F%0A%7D%0A%0AResource.prototype%20%3D%20Object.create(EventEmitter.prototype)%3B%0AResource.prototype.constructor%20%3D%20Resource%3B%0Amodule.exports%20%3D%20Resource%3B%0A%0A%2F**%0A%20*%20Marks%20the%20resource%20as%20complete.%0A%20*%0A%20*%20%40fires%20complete%0A%20*%2F%0AResource.prototype.complete%20%3D%20function%20()%20%7B%0A%20%20%20%20%2F%2F%20TODO%3A%20Clean%20this%20up%20in%20a%20wrapper%20or%20something...gross....%0A%20%20%20%20if%20(this.data%20%26%26%20this.data.removeEventListener)%20%7B%0A%20%20%20%20%20%20%20%20this.data.removeEventListener('error'%2C%20this._boundOnError)%3B%0A%20%20%20%20%20%20%20%20this.data.removeEventListener('load'%2C%20this._boundComplete)%3B%0A%20%20%20%20%20%20%20%20this.data.removeEventListener('progress'%2C%20this._boundOnProgress)%3B%0A%20%20%20%20%20%20%20%20this.data.removeEventListener('canplaythrough'%2C%20this._boundComplete)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(this.xhr)%20%7B%0A%20%20%20%20%20%20%20%20if%20(this.xhr.removeEventListener)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.xhr.removeEventListener('error'%2C%20this._boundXhrOnError)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.xhr.removeEventListener('abort'%2C%20this._boundXhrOnAbort)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.xhr.removeEventListener('progress'%2C%20this._boundOnProgress)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.xhr.removeEventListener('load'%2C%20this._boundXhrOnLoad)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.xhr.onerror%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.xhr.ontimeout%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.xhr.onprogress%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.xhr.onload%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.emit('complete'%2C%20this)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Kicks%20off%20loading%20of%20this%20resource.%0A%20*%0A%20*%20%40fires%20start%0A%20*%20%40param%20%5Bcallback%5D%20%7Bfunction%7D%20Optional%20callback%20to%20call%20once%20the%20resource%20is%20loaded.%0A%20*%2F%0AResource.prototype.load%20%3D%20function%20(cb)%20%7B%0A%20%20%20%20this.emit('start'%2C%20this)%3B%0A%0A%20%20%20%20%2F%2F%20if%20a%20callback%20is%20set%2C%20listen%20for%20complete%20event%0A%20%20%20%20if%20(cb)%20%7B%0A%20%20%20%20%20%20%20%20this.once('complete'%2C%20cb)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20if%20unset%2C%20determine%20the%20value%0A%20%20%20%20if%20(typeof%20this.crossOrigin%20!%3D%3D%20'string')%20%7B%0A%20%20%20%20%20%20%20%20this.crossOrigin%20%3D%20this._determineCrossOrigin(this.url)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20switch(this.loadType)%20%7B%0A%20%20%20%20%20%20%20%20case%20Resource.LOAD_TYPE.IMAGE%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20this._loadImage()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20case%20Resource.LOAD_TYPE.AUDIO%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20this._loadElement('audio')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20case%20Resource.LOAD_TYPE.VIDEO%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20this._loadElement('video')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20case%20Resource.LOAD_TYPE.XHR%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F*%20falls%20through%20*%2F%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(useXdr%20%26%26%20this.crossOrigin)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._loadXdr()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._loadXhr()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Loads%20this%20resources%20using%20an%20Image%20object.%0A%20*%0A%20*%20%40private%0A%20*%2F%0AResource.prototype._loadImage%20%3D%20function%20()%20%7B%0A%20%20%20%20this.data%20%3D%20new%20Image()%3B%0A%0A%20%20%20%20if%20(this.crossOrigin)%20%7B%0A%20%20%20%20%20%20%20%20this.data.crossOrigin%20%3D%20this.crossOrigin%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.data.src%20%3D%20this.url%3B%0A%0A%20%20%20%20this.isImage%20%3D%20true%3B%0A%0A%20%20%20%20this.data.addEventListener('error'%2C%20this._boundOnError%2C%20false)%3B%0A%20%20%20%20this.data.addEventListener('load'%2C%20this._boundComplete%2C%20false)%3B%0A%20%20%20%20this.data.addEventListener('progress'%2C%20this._boundOnProgress%2C%20false)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Loads%20this%20resources%20using%20an%20HTMLAudioElement%20or%20HTMLVideoElement.%0A%20*%0A%20*%20%40private%0A%20*%2F%0AResource.prototype._loadElement%20%3D%20function%20(type)%20%7B%0A%20%20%20%20if%20(type%20%3D%3D%3D%20'audio'%20%26%26%20typeof%20Audio%20!%3D%3D%20'undefined')%20%7B%0A%20%20%20%20%20%20%20%20this.data%20%3D%20new%20Audio()%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20this.data%20%3D%20document.createElement(type)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(this.data%20%3D%3D%3D%20null)%20%7B%0A%20%20%20%20%20%20%20%20this.error%20%3D%20new%20Error('Unsupported%20element%20'%20%2B%20type)%3B%0A%20%20%20%20%20%20%20%20this.complete()%3B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20support%20for%20CocoonJS%20Canvas%2B%20runtime%2C%20lacks%20document.createElement('source')%0A%20%20%20%20if%20(navigator.isCocoonJS)%20%7B%0A%20%20%20%20%20%20%20%20this.data.src%20%3D%20Array.isArray(this.url)%20%3F%20this.url%5B0%5D%20%3A%20this.url%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20(Array.isArray(this.url))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(var%20i%20%3D%200%3B%20i%20%3C%20this.url.length%3B%20%2B%2Bi)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.data.appendChild(this._createSource(type%2C%20this.url%5Bi%5D))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.data.appendChild(this._createSource(type%2C%20this.url))%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20this%5B'is'%20%2B%20type%5B0%5D.toUpperCase()%20%2B%20type.substring(1)%5D%20%3D%20true%3B%0A%0A%20%20%20%20this.data.addEventListener('error'%2C%20this._boundOnError%2C%20false)%3B%0A%20%20%20%20this.data.addEventListener('load'%2C%20this._boundComplete%2C%20false)%3B%0A%20%20%20%20this.data.addEventListener('progress'%2C%20this._boundOnProgress%2C%20false)%3B%0A%20%20%20%20this.data.addEventListener('canplaythrough'%2C%20this._boundComplete%2C%20false)%3B%0A%0A%20%20%20%20this.data.load()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Loads%20this%20resources%20using%20an%20XMLHttpRequest.%0A%20*%0A%20*%20%40private%0A%20*%2F%0AResource.prototype._loadXhr%20%3D%20function%20()%20%7B%0A%20%20%20%20%2F%2F%20if%20unset%2C%20determine%20the%20value%0A%20%20%20%20if%20(typeof%20this.xhrType%20!%3D%3D%20'string')%20%7B%0A%20%20%20%20%20%20%20%20this.xhrType%20%3D%20this._determineXhrType()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20xhr%20%3D%20this.xhr%20%3D%20new%20XMLHttpRequest()%3B%0A%0A%20%20%20%20%2F%2F%20set%20the%20request%20type%20and%20url%0A%20%20%20%20xhr.open('GET'%2C%20this.url%2C%20true)%3B%0A%0A%20%20%20%20%2F%2F%20load%20json%20as%20text%20and%20parse%20it%20ourselves.%20We%20do%20this%20because%20some%20browsers%0A%20%20%20%20%2F%2F%20*cough*%20safari%20*cough*%20can't%20deal%20with%20it.%0A%20%20%20%20if%20(this.xhrType%20%3D%3D%3D%20Resource.XHR_RESPONSE_TYPE.JSON%20%7C%7C%20this.xhrType%20%3D%3D%3D%20Resource.XHR_RESPONSE_TYPE.DOCUMENT)%20%7B%0A%20%20%20%20%20%20%20%20xhr.responseType%20%3D%20Resource.XHR_RESPONSE_TYPE.TEXT%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20xhr.responseType%20%3D%20this.xhrType%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20xhr.addEventListener('error'%2C%20this._boundXhrOnError%2C%20false)%3B%0A%20%20%20%20xhr.addEventListener('abort'%2C%20this._boundXhrOnAbort%2C%20false)%3B%0A%20%20%20%20xhr.addEventListener('progress'%2C%20this._boundOnProgress%2C%20false)%3B%0A%20%20%20%20xhr.addEventListener('load'%2C%20this._boundXhrOnLoad%2C%20false)%3B%0A%0A%20%20%20%20xhr.send()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Loads%20this%20resources%20using%20an%20XDomainRequest.%20This%20is%20here%20because%20we%20need%20to%20support%20IE9%20(gross).%0A%20*%0A%20*%20%40private%0A%20*%2F%0AResource.prototype._loadXdr%20%3D%20function%20()%20%7B%0A%20%20%20%20%2F%2F%20if%20unset%2C%20determine%20the%20value%0A%20%20%20%20if%20(typeof%20this.xhrType%20!%3D%3D%20'string')%20%7B%0A%20%20%20%20%20%20%20%20this.xhrType%20%3D%20this._determineXhrType()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20xdr%20%3D%20this.xhr%20%3D%20new%20XDomainRequest()%3B%0A%0A%20%20%20%20%2F%2F%20XDomainRequest%20has%20a%20few%20quirks.%20Occasionally%20it%20will%20abort%20requests%0A%20%20%20%20%2F%2F%20A%20way%20to%20avoid%20this%20is%20to%20make%20sure%20ALL%20callbacks%20are%20set%20even%20if%20not%20used%0A%20%20%20%20%2F%2F%20More%20info%20here%3A%20http%3A%2F%2Fstackoverflow.com%2Fquestions%2F15786966%2Fxdomainrequest-aborts-post-on-ie-9%0A%20%20%20%20xdr.timeout%20%3D%205000%3B%0A%0A%20%20%20%20xdr.onerror%20%3D%20this._boundXhrOnError%3B%0A%20%20%20%20xdr.ontimeout%20%3D%20this._boundXdrOnTimeout%3B%0A%20%20%20%20xdr.onprogress%20%3D%20this._boundOnProgress%3B%0A%20%20%20%20xdr.onload%20%3D%20this._boundXhrOnLoad%3B%0A%0A%20%20%20%20xdr.open('GET'%2C%20this.url%2C%20true)%3B%0A%0A%20%20%20%20%2F%2F%20%20Note%3A%20The%20xdr.send()%20call%20is%20wrapped%20in%20a%20timeout%20to%20prevent%20an%20issue%20with%20the%20interface%20where%20some%20requests%20are%20lost%0A%20%20%20%20%2F%2F%20%20if%20multiple%20XDomainRequests%20are%20being%20sent%20at%20the%20same%20time.%0A%20%20%20%20%2F%2F%20Some%20info%20here%3A%20https%3A%2F%2Fgithub.com%2Fphotonstorm%2Fphaser%2Fissues%2F1248%0A%20%20%20%20setTimeout(function%20()%20%7B%0A%20%20%20%20%20%20%20%20xdr.send()%3B%0A%20%20%20%20%7D%2C%200)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Creates%20a%20source%20used%20in%20loading%20via%20an%20element.%0A%20*%0A%20*%20%40param%20type%20%7Bstring%7D%20The%20element%20type%20(video%20or%20audio).%0A%20*%20%40param%20url%20%7Bstring%7D%20The%20source%20URL%20to%20load%20from.%0A%20*%20%40param%20%5Bmime%5D%20%7Bstring%7D%20The%20mime%20type%20of%20the%20video%0A%20*%20%40private%0A%20*%2F%0AResource.prototype._createSource%20%3D%20function%20(type%2C%20url%2C%20mime)%20%7B%0A%20%20%20%20if%20(!mime)%20%7B%0A%20%20%20%20%20%20%20%20mime%20%3D%20type%20%2B%20'%2F'%20%2B%20url.substr(url.lastIndexOf('.')%20%2B%201)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20source%20%3D%20document.createElement('source')%3B%0A%0A%20%20%20%20source.src%20%3D%20url%3B%0A%20%20%20%20source.type%20%3D%20mime%3B%0A%0A%20%20%20%20return%20source%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Called%20if%20a%20load%20errors%20out.%0A%20*%0A%20*%20%40param%20event%20%7BEvent%7D%20The%20error%20event%20from%20the%20element%20that%20emits%20it.%0A%20*%20%40private%0A%20*%2F%0AResource.prototype._onError%20%3D%20function%20(event)%20%7B%0A%20%20%20%20this.error%20%3D%20new%20Error('Failed%20to%20load%20element%20using%20'%20%2B%20event.target.nodeName)%3B%0A%20%20%20%20this.complete()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Called%20if%20a%20load%20progress%20event%20fires%20for%20xhr%2Fxdr.%0A%20*%0A%20*%20%40fires%20progress%0A%20*%20%40param%20event%20%7BXMLHttpRequestProgressEvent%7CEvent%7D%0A%20*%20%40private%0A%20*%2F%0AResource.prototype._onProgress%20%3D%20%20function%20(event)%20%7B%0A%20%20%20%20if%20(event%20%26%26%20event.lengthComputable)%20%7B%0A%20%20%20%20%20%20%20%20this.emit('progress'%2C%20this%2C%20event.loaded%20%2F%20event.total)%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20Called%20if%20an%20error%20event%20fires%20for%20xhr%2Fxdr.%0A%20*%0A%20*%20%40param%20event%20%7BXMLHttpRequestErrorEvent%7CEvent%7D%0A%20*%20%40private%0A%20*%2F%0AResource.prototype._xhrOnError%20%3D%20function%20()%20%7B%0A%20%20%20%20this.error%20%3D%20new%20Error(%0A%20%20%20%20%20%20%20%20reqType(this.xhr)%20%2B%20'%20Request%20failed.%20'%20%2B%0A%20%20%20%20%20%20%20%20'Status%3A%20'%20%2B%20this.xhr.status%20%2B%20'%2C%20text%3A%20%22'%20%2B%20this.xhr.statusText%20%2B%20'%22'%0A%20%20%20%20)%3B%0A%0A%20%20%20%20this.complete()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Called%20if%20an%20abort%20event%20fires%20for%20xhr.%0A%20*%0A%20*%20%40param%20event%20%7BXMLHttpRequestAbortEvent%7D%0A%20*%20%40private%0A%20*%2F%0AResource.prototype._xhrOnAbort%20%3D%20function%20()%20%7B%0A%20%20%20%20this.error%20%3D%20new%20Error(reqType(this.xhr)%20%2B%20'%20Request%20was%20aborted%20by%20the%20user.')%3B%0A%20%20%20%20this.complete()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Called%20if%20a%20timeout%20event%20fires%20for%20xdr.%0A%20*%0A%20*%20%40param%20event%20%7BEvent%7D%0A%20*%20%40private%0A%20*%2F%0AResource.prototype._xdrOnTimeout%20%3D%20function%20()%20%7B%0A%20%20%20%20this.error%20%3D%20new%20Error(reqType(this.xhr)%20%2B%20'%20Request%20timed%20out.')%3B%0A%20%20%20%20this.complete()%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Called%20when%20data%20successfully%20loads%20from%20an%20xhr%2Fxdr%20request.%0A%20*%0A%20*%20%40param%20event%20%7BXMLHttpRequestLoadEvent%7CEvent%7D%0A%20*%20%40private%0A%20*%2F%0AResource.prototype._xhrOnLoad%20%3D%20function%20()%20%7B%0A%20%20%20%20var%20xhr%20%3D%20this.xhr%2C%0A%20%20%20%20%20%20%20%20status%20%3D%20xhr.status%20!%3D%3D%20undefined%20%3F%20xhr.status%20%3A%20200%3B%20%2F%2FXDR%20has%20no%20%60.status%60%2C%20assume%20200.%0A%0A%20%20%20%20%2F%2F%20status%20can%20be%200%20when%20using%20the%20file%3A%2F%2F%20protocol%2C%20also%20check%20if%20a%20response%20was%20found%0A%20%20%20%20if%20(status%20%3D%3D%3D%20200%20%7C%7C%20status%20%3D%3D%3D%20204%20%7C%7C%20(status%20%3D%3D%3D%200%20%26%26%20xhr.responseText.length%20%3E%200))%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20if%20text%2C%20just%20return%20it%0A%20%20%20%20%20%20%20%20if%20(this.xhrType%20%3D%3D%3D%20Resource.XHR_RESPONSE_TYPE.TEXT)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.data%20%3D%20xhr.responseText%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%2F%2F%20if%20json%2C%20parse%20into%20json%20object%0A%20%20%20%20%20%20%20%20else%20if%20(this.xhrType%20%3D%3D%3D%20Resource.XHR_RESPONSE_TYPE.JSON)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.data%20%3D%20JSON.parse(xhr.responseText)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.isJson%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20catch(e)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.error%20%3D%20new%20Error('Error%20trying%20to%20parse%20loaded%20json%3A'%2C%20e)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%2F%2F%20if%20xml%2C%20parse%20into%20an%20xml%20document%20or%20div%20element%0A%20%20%20%20%20%20%20%20else%20if%20(this.xhrType%20%3D%3D%3D%20Resource.XHR_RESPONSE_TYPE.DOCUMENT)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(window.DOMParser)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20domparser%20%3D%20new%20DOMParser()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.data%20%3D%20domparser.parseFromString(xhr.responseText%2C%20'text%2Fxml')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20div%20%3D%20document.createElement('div')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20div.innerHTML%20%3D%20xhr.responseText%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.data%20%3D%20div%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.isXml%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20catch%20(e)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.error%20%3D%20new%20Error('Error%20trying%20to%20parse%20loaded%20xml%3A'%2C%20e)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%2F%2F%20other%20types%20just%20return%20the%20response%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.data%20%3D%20xhr.response%20%7C%7C%20xhr.responseText%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20this.error%20%3D%20new%20Error('%5B'%20%2B%20xhr.status%20%2B%20'%5D'%20%2B%20xhr.statusText%20%2B%20'%3A'%20%2B%20xhr.responseURL)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.complete()%3B%0A%7D%3B%0A%0Afunction%20reqType(xhr)%20%7B%0A%20%20%20%20return%20xhr.toString().replace('object%20'%2C%20'')%3B%0A%7D%0A%0A%2F**%0A%20*%20Sets%20the%20%60crossOrigin%60%20property%20for%20this%20resource%20based%20on%20if%20the%20url%0A%20*%20for%20this%20resource%20is%20cross-origin.%20If%20crossOrigin%20was%20manually%20set%2C%20this%0A%20*%20function%20does%20nothing.%0A%20*%0A%20*%20%40private%0A%20*%20%40param%20url%20%7Bstring%7D%20The%20url%20to%20test.%0A%20*%20%40param%20%5Blocation%3Dwindow.location%5D%20%7Bobject%7D%20The%20location%20object%20to%20test%20against.%0A%20*%20%40return%20%7Bstring%7D%20The%20crossOrigin%20value%20to%20use%20(or%20empty%20string%20for%20none).%0A%20*%2F%0AResource.prototype._determineCrossOrigin%20%3D%20function%20(url%2C%20loc)%20%7B%0A%20%20%20%20%2F%2F%20data%3A%20and%20javascript%3A%20urls%20are%20considered%20same-origin%0A%20%20%20%20if%20(url.indexOf('data%3A')%20%3D%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20return%20''%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20default%20is%20window.location%0A%20%20%20%20loc%20%3D%20loc%20%7C%7C%20window.location%3B%0A%20%20%20%20url%20%3D%20window.urlParse(url)%3B%0A%0A%20%20%20%20var%20samePort%20%3D%20(!url.port%20%26%26%20loc.port%20%3D%3D%3D%20'')%20%7C%7C%20(url.port%20%3D%3D%3D%20loc.port)%3B%0A%0A%20%20%20%20%2F%2F%20if%20cross%20origin%0A%20%20%20%20if%20(url.hostname%20!%3D%3D%20loc.hostname%20%7C%7C%20!samePort%20%7C%7C%20url.protocol%20!%3D%3D%20loc.protocol)%20%7B%0A%20%20%20%20%20%20%20%20return%20'anonymous'%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20''%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Determines%20the%20responseType%20of%20an%20XHR%20request%20based%20on%20the%20extension%20of%20the%0A%20*%20resource%20being%20loaded.%0A%20*%0A%20*%20%40private%0A%20*%20%40return%20%7BResource.XHR_RESPONSE_TYPE%7D%20The%20responseType%20to%20use.%0A%20*%2F%0AResource.prototype._determineXhrType%20%3D%20function%20()%20%7B%0A%20%20%20%20return%20Resource._xhrTypeMap%5Bthis._getExtension()%5D%20%7C%7C%20Resource.XHR_RESPONSE_TYPE.TEXT%3B%0A%7D%3B%0A%0AResource.prototype._determineLoadType%20%3D%20function%20()%20%7B%0A%20%20%20%20return%20Resource._loadTypeMap%5Bthis._getExtension()%5D%20%7C%7C%20Resource.LOAD_TYPE.XHR%3B%0A%7D%3B%0A%0AResource.prototype._getExtension%20%3D%20function%20()%20%7B%0A%20%20%20%20var%20url%20%3D%20this.url%2C%0A%20%20%20%20%20%20%20%20ext%3B%0A%0A%20%20%20%20if%20(this.isDataUrl)%20%7B%0A%20%20%20%20%20%20%20%20var%20slashIndex%20%3D%20url.indexOf('%2F')%3B%0A%20%20%20%20%20%20%20%20ext%20%3D%20url.substring(slashIndex%20%2B%201%2C%20url.indexOf('%3B'%2C%20slashIndex))%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20var%20queryStart%20%3D%20url.indexOf('%3F')%3B%0A%20%20%20%20%20%20%20%20if%20(queryStart%20!%3D%3D%20-1)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20url%20%3D%20url.substring(0%2C%20queryStart)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20ext%20%3D%20url.substring(url.lastIndexOf('.')%20%2B%201)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20ext%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Determines%20the%20mime%20type%20of%20an%20XHR%20request%20based%20on%20the%20responseType%20of%0A%20*%20resource%20being%20loaded.%0A%20*%0A%20*%20%40private%0A%20*%20%40return%20%7Bstring%7D%20The%20mime%20type%20to%20use.%0A%20*%2F%0AResource.prototype._getMimeFromXhrType%20%3D%20function%20(type)%20%7B%0A%20%20%20%20switch(type)%20%7B%0A%20%20%20%20%20%20%20%20case%20Resource.XHR_RESPONSE_TYPE.BUFFER%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20'application%2Foctet-binary'%3B%0A%0A%20%20%20%20%20%20%20%20case%20Resource.XHR_RESPONSE_TYPE.BLOB%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20'application%2Fblob'%3B%0A%0A%20%20%20%20%20%20%20%20case%20Resource.XHR_RESPONSE_TYPE.DOCUMENT%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20'application%2Fxml'%3B%0A%0A%20%20%20%20%20%20%20%20case%20Resource.XHR_RESPONSE_TYPE.JSON%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20'application%2Fjson'%3B%0A%0A%20%20%20%20%20%20%20%20case%20Resource.XHR_RESPONSE_TYPE.DEFAULT%3A%0A%20%20%20%20%20%20%20%20case%20Resource.XHR_RESPONSE_TYPE.TEXT%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F*%20falls%20through%20*%2F%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20'text%2Fplain'%3B%0A%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F**%0A%20*%20The%20types%20of%20loading%20a%20resource%20can%20use.%0A%20*%0A%20*%20%40static%0A%20*%20%40constant%0A%20*%20%40property%20%7Bobject%7D%20LOAD_TYPE%0A%20*%20%40property%20%7Bnumber%7D%20LOAD_TYPE.XHR%20-%20Uses%20XMLHttpRequest%20to%20load%20the%20resource.%0A%20*%20%40property%20%7Bnumber%7D%20LOAD_TYPE.IMAGE%20-%20Uses%20an%20%60Image%60%20object%20to%20load%20the%20resource.%0A%20*%20%40property%20%7Bnumber%7D%20LOAD_TYPE.AUDIO%20-%20Uses%20an%20%60Audio%60%20object%20to%20load%20the%20resource.%0A%20*%20%40property%20%7Bnumber%7D%20LOAD_TYPE.VIDEO%20-%20Uses%20a%20%60Video%60%20object%20to%20load%20the%20resource.%0A%20*%2F%0AResource.LOAD_TYPE%20%3D%20%7B%0A%20%20%20%20XHR%3A%20%20%20%201%2C%0A%20%20%20%20IMAGE%3A%20%202%2C%0A%20%20%20%20AUDIO%3A%20%203%2C%0A%20%20%20%20VIDEO%3A%20%204%0A%7D%3B%0A%0A%2F**%0A%20*%20The%20XHR%20ready%20states%2C%20used%20internally.%0A%20*%0A%20*%20%40static%0A%20*%20%40constant%0A%20*%20%40property%20%7Bobject%7D%20XHR_READY_STATE%0A%20*%20%40property%20%7Bnumber%7D%20XHR_READY_STATE.UNSENT%20-%20open()has%20not%20been%20called%20yet.%0A%20*%20%40property%20%7Bnumber%7D%20XHR_READY_STATE.OPENED%20-%20send()has%20not%20been%20called%20yet.%0A%20*%20%40property%20%7Bnumber%7D%20XHR_READY_STATE.HEADERS_RECEIVED%20-%20send()%20has%20been%20called%2C%20and%20headers%20and%20status%20are%20available.%0A%20*%20%40property%20%7Bnumber%7D%20XHR_READY_STATE.LOADING%20-%20Downloading%3B%20responseText%20holds%20partial%20data.%0A%20*%20%40property%20%7Bnumber%7D%20XHR_READY_STATE.DONE%20-%20The%20operation%20is%20complete.%0A%20*%2F%0AResource.XHR_READY_STATE%20%3D%20%7B%0A%20%20%20%20UNSENT%3A%200%2C%0A%20%20%20%20OPENED%3A%201%2C%0A%20%20%20%20HEADERS_RECEIVED%3A%202%2C%0A%20%20%20%20LOADING%3A%203%2C%0A%20%20%20%20DONE%3A%204%0A%7D%3B%0A%0A%2F**%0A%20*%20The%20XHR%20ready%20states%2C%20used%20internally.%0A%20*%0A%20*%20%40static%0A%20*%20%40constant%0A%20*%20%40property%20%7Bobject%7D%20XHR_RESPONSE_TYPE%0A%20*%20%40property%20%7Bstring%7D%20XHR_RESPONSE_TYPE.DEFAULT%20-%20defaults%20to%20text%0A%20*%20%40property%20%7Bstring%7D%20XHR_RESPONSE_TYPE.BUFFER%20-%20ArrayBuffer%0A%20*%20%40property%20%7Bstring%7D%20XHR_RESPONSE_TYPE.BLOB%20-%20Blob%0A%20*%20%40property%20%7Bstring%7D%20XHR_RESPONSE_TYPE.DOCUMENT%20-%20Document%0A%20*%20%40property%20%7Bstring%7D%20XHR_RESPONSE_TYPE.JSON%20-%20Object%0A%20*%20%40property%20%7Bstring%7D%20XHR_RESPONSE_TYPE.TEXT%20-%20String%0A%20*%2F%0AResource.XHR_RESPONSE_TYPE%20%3D%20%7B%0A%20%20%20%20DEFAULT%3A%20%20%20%20'text'%2C%0A%20%20%20%20BUFFER%3A%20%20%20%20%20'arraybuffer'%2C%0A%20%20%20%20BLOB%3A%20%20%20%20%20%20%20'blob'%2C%0A%20%20%20%20DOCUMENT%3A%20%20%20'document'%2C%0A%20%20%20%20JSON%3A%20%20%20%20%20%20%20'json'%2C%0A%20%20%20%20TEXT%3A%20%20%20%20%20%20%20'text'%0A%7D%3B%0A%0AResource._loadTypeMap%20%3D%20%7B%0A%20%20%20%20'gif'%3A%20%20%20%20%20%20Resource.LOAD_TYPE.IMAGE%2C%0A%20%20%20%20'png'%3A%20%20%20%20%20%20Resource.LOAD_TYPE.IMAGE%2C%0A%20%20%20%20'bmp'%3A%20%20%20%20%20%20Resource.LOAD_TYPE.IMAGE%2C%0A%20%20%20%20'jpg'%3A%20%20%20%20%20%20Resource.LOAD_TYPE.IMAGE%2C%0A%20%20%20%20'jpeg'%3A%20%20%20%20%20Resource.LOAD_TYPE.IMAGE%2C%0A%20%20%20%20'tif'%3A%20%20%20%20%20%20Resource.LOAD_TYPE.IMAGE%2C%0A%20%20%20%20'tiff'%3A%20%20%20%20%20Resource.LOAD_TYPE.IMAGE%2C%0A%20%20%20%20'webp'%3A%20%20%20%20%20Resource.LOAD_TYPE.IMAGE%2C%0A%20%20%20%20'tga'%3A%20%20%20%20%20%20Resource.LOAD_TYPE.IMAGE%0A%7D%3B%0A%0AResource._xhrTypeMap%20%3D%20%7B%0A%20%20%20%20%2F%2F%20xml%0A%20%20%20%20'xhtml'%3A%20%20%20%20Resource.XHR_RESPONSE_TYPE.DOCUMENT%2C%0A%20%20%20%20'html'%3A%20%20%20%20%20Resource.XHR_RESPONSE_TYPE.DOCUMENT%2C%0A%20%20%20%20'htm'%3A%20%20%20%20%20%20Resource.XHR_RESPONSE_TYPE.DOCUMENT%2C%0A%20%20%20%20'xml'%3A%20%20%20%20%20%20Resource.XHR_RESPONSE_TYPE.DOCUMENT%2C%0A%20%20%20%20'tmx'%3A%20%20%20%20%20%20Resource.XHR_RESPONSE_TYPE.DOCUMENT%2C%0A%20%20%20%20'tsx'%3A%20%20%20%20%20%20Resource.XHR_RESPONSE_TYPE.DOCUMENT%2C%0A%20%20%20%20'svg'%3A%20%20%20%20%20%20Resource.XHR_RESPONSE_TYPE.DOCUMENT%2C%0A%0A%20%20%20%20%2F%2F%20images%0A%20%20%20%20'gif'%3A%20%20%20%20%20%20Resource.XHR_RESPONSE_TYPE.BLOB%2C%0A%20%20%20%20'png'%3A%20%20%20%20%20%20Resource.XHR_RESPONSE_TYPE.BLOB%2C%0A%20%20%20%20'bmp'%3A%20%20%20%20%20%20Resource.XHR_RESPONSE_TYPE.BLOB%2C%0A%20%20%20%20'jpg'%3A%20%20%20%20%20%20Resource.XHR_RESPONSE_TYPE.BLOB%2C%0A%20%20%20%20'jpeg'%3A%20%20%20%20%20Resource.XHR_RESPONSE_TYPE.BLOB%2C%0A%20%20%20%20'tif'%3A%20%20%20%20%20%20Resource.XHR_RESPONSE_TYPE.BLOB%2C%0A%20%20%20%20'tiff'%3A%20%20%20%20%20Resource.XHR_RESPONSE_TYPE.BLOB%2C%0A%20%20%20%20'webp'%3A%20%20%20%20%20Resource.XHR_RESPONSE_TYPE.BLOB%2C%0A%20%20%20%20'tga'%3A%20%20%20%20%20%20Resource.XHR_RESPONSE_TYPE.BLOB%2C%0A%0A%20%20%20%20%2F%2F%20json%0A%20%20%20%20'json'%3A%20%20%20%20%20Resource.XHR_RESPONSE_TYPE.JSON%2C%0A%0A%20%20%20%20%2F%2F%20text%0A%20%20%20%20'text'%3A%20%20%20%20%20Resource.XHR_RESPONSE_TYPE.TEXT%2C%0A%20%20%20%20'txt'%3A%20%20%20%20%20%20Resource.XHR_RESPONSE_TYPE.TEXT%0A%7D%3B%0A%0A%2F**%0A%20*%20Sets%20the%20load%20type%20to%20be%20used%20for%20a%20specific%20extension.%0A%20*%0A%20*%20%40static%0A%20*%20%40param%20extname%20%7Bstring%7D%20The%20extension%20to%20set%20the%20type%20for%2C%20e.g.%20%22png%22%20or%20%22fnt%22%0A%20*%20%40param%20loadType%20%7BResource.LOAD_TYPE%7D%20The%20load%20type%20to%20set%20it%20to.%0A%20*%2F%0AResource.setExtensionLoadType%20%3D%20function%20(extname%2C%20loadType)%20%7B%0A%20%20%20%20setExtMap(Resource._loadTypeMap%2C%20extname%2C%20loadType)%3B%0A%7D%3B%0A%0A%2F**%0A%20*%20Sets%20the%20load%20type%20to%20be%20used%20for%20a%20specific%20extension.%0A%20*%0A%20*%20%40static%0A%20*%20%40param%20extname%20%7Bstring%7D%20The%20extension%20to%20set%20the%20type%20for%2C%20e.g.%20%22png%22%20or%20%22fnt%22%0A%20*%20%40param%20xhrType%20%7BResource.XHR_RESPONSE_TYPE%7D%20The%20xhr%20type%20to%20set%20it%20to.%0A%20*%2F%0AResource.setExtensionXhrType%20%3D%20function%20(extname%2C%20xhrType)%20%7B%0A%20%20%20%20setExtMap(Resource._xhrTypeMap%2C%20extname%2C%20xhrType)%3B%0A%7D%3B%0A%0Afunction%20setExtMap(map%2C%20extname%2C%20val)%20%7B%0A%20%20%20%20if%20(extname%20%26%26%20extname.indexOf('.')%20%3D%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20extname%20%3D%20extname.substring(1)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(!extname)%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20map%5Bextname%5D%20%3D%20val%3B%0A%7D%0A%0A%7D%2C%7B%22eventemitter3%22%3A125%2C%22url%22%3A8%7D%5D%2C128%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Amodule.exports%20%3D%20%7B%0A%0A%20%20%20%20%2F%2F%20private%20property%0A%20%20%20%20_keyStr%3A%20%22ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%2B%2F%3D%22%2C%0A%0A%20%20%20%20encodeBinary%3A%20function%20(input)%20%7B%0A%20%20%20%20%20%20%20%20var%20output%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%20%20var%20bytebuffer%3B%0A%20%20%20%20%20%20%20%20var%20encodedCharIndexes%20%3D%20new%20Array(4)%3B%0A%20%20%20%20%20%20%20%20var%20inx%20%3D%200%3B%0A%20%20%20%20%20%20%20%20var%20jnx%20%3D%200%3B%0A%20%20%20%20%20%20%20%20var%20paddingBytes%20%3D%200%3B%0A%0A%20%20%20%20%20%20%20%20while%20(inx%20%3C%20input.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Fill%20byte%20buffer%20array%0A%20%20%20%20%20%20%20%20%20%20%20%20bytebuffer%20%3D%20new%20Array(3)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(jnx%20%3D%200%3B%20jnx%20%3C%20bytebuffer.length%3B%20jnx%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(inx%20%3C%20input.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20throw%20away%20high-order%20byte%2C%20as%20documented%20at%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20https%3A%2F%2Fdeveloper.mozilla.org%2FEn%2FUsing_XMLHttpRequest%23Handling_binary_data%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bytebuffer%5Bjnx%5D%20%3D%20input.charCodeAt(inx%2B%2B)%20%26%200xff%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bytebuffer%5Bjnx%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Get%20each%20encoded%20character%2C%206%20bits%20at%20a%20time%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20index%201%3A%20first%206%20bits%0A%20%20%20%20%20%20%20%20%20%20%20%20encodedCharIndexes%5B0%5D%20%3D%20bytebuffer%5B0%5D%20%3E%3E%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20index%202%3A%20second%206%20bits%20(2%20least%20significant%20bits%20from%20input%20byte%201%20%2B%204%20most%20significant%20bits%20from%20byte%202)%0A%20%20%20%20%20%20%20%20%20%20%20%20encodedCharIndexes%5B1%5D%20%3D%20((bytebuffer%5B0%5D%20%26%200x3)%20%3C%3C%204)%20%7C%20(bytebuffer%5B1%5D%20%3E%3E%204)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20index%203%3A%20third%206%20bits%20(4%20least%20significant%20bits%20from%20input%20byte%202%20%2B%202%20most%20significant%20bits%20from%20byte%203)%0A%20%20%20%20%20%20%20%20%20%20%20%20encodedCharIndexes%5B2%5D%20%3D%20((bytebuffer%5B1%5D%20%26%200x0f)%20%3C%3C%202)%20%7C%20(bytebuffer%5B2%5D%20%3E%3E%206)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20index%203%3A%20forth%206%20bits%20(6%20least%20significant%20bits%20from%20input%20byte%203)%0A%20%20%20%20%20%20%20%20%20%20%20%20encodedCharIndexes%5B3%5D%20%3D%20bytebuffer%5B2%5D%20%26%200x3f%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Determine%20whether%20padding%20happened%2C%20and%20adjust%20accordingly%0A%20%20%20%20%20%20%20%20%20%20%20%20paddingBytes%20%3D%20inx%20-%20(input.length%20-%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20switch%20(paddingBytes)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Set%20last%202%20characters%20to%20padding%20char%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20encodedCharIndexes%5B3%5D%20%3D%2064%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20encodedCharIndexes%5B2%5D%20%3D%2064%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Set%20last%20character%20to%20padding%20char%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20encodedCharIndexes%5B3%5D%20%3D%2064%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%20%2F%2F%20No%20padding%20-%20proceed%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Now%20we%20will%20grab%20each%20appropriate%20character%20out%20of%20our%20keystring%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20based%20on%20our%20index%20array%20and%20append%20it%20to%20the%20output%20string%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(jnx%20%3D%200%3B%20jnx%20%3C%20encodedCharIndexes.length%3B%20jnx%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output%20%2B%3D%20this._keyStr.charAt(encodedCharIndexes%5Bjnx%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20output%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%7D%2C%7B%7D%5D%2C129%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Amodule.exports%20%3D%20require('.%2FLoader')%3B%0A%0Amodule.exports.Resource%20%3D%20require('.%2FResource')%3B%0A%0Amodule.exports.middleware%20%3D%20%7B%0A%20%20%20%20caching%3A%20%7B%0A%20%20%20%20%20%20%20%20memory%3A%20require('.%2Fmiddlewares%2Fcaching%2Fmemory')%0A%20%20%20%20%7D%2C%0A%20%20%20%20parsing%3A%20%7B%0A%20%20%20%20%20%20%20%20blob%3A%20require('.%2Fmiddlewares%2Fparsing%2Fblob')%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%7D%2C%7B%22.%2FLoader%22%3A126%2C%22.%2FResource%22%3A127%2C%22.%2Fmiddlewares%2Fcaching%2Fmemory%22%3A130%2C%22.%2Fmiddlewares%2Fparsing%2Fblob%22%3A131%7D%5D%2C130%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0A%2F%2F%20a%20simple%20in-memory%20cache%20for%20resources%0Avar%20cache%20%3D%20%7B%7D%3B%0A%0Amodule.exports%20%3D%20function%20()%20%7B%0A%20%20%20%20return%20function%20(resource%2C%20next)%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20if%20cached%2C%20then%20set%20data%20and%20complete%20the%20resource%0A%20%20%20%20%20%20%20%20if%20(cache%5Bresource.url%5D)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20resource.data%20%3D%20cache%5Bresource.url%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20resource.complete()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%2F%2F%20if%20not%20cached%2C%20wait%20for%20complete%20and%20store%20it%20in%20the%20cache.%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20resource.once('complete'%2C%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache%5Bthis.url%5D%20%3D%20this.data%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20next()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%7D%3B%0A%0A%7D%2C%7B%7D%5D%2C131%3A%5Bfunction(require%2Cmodule%2Cexports)%7B%0Avar%20Resource%20%3D%20require('..%2F..%2FResource')%2C%0A%20%20%20%20b64%20%3D%20require('..%2F..%2Fb64')%3B%0A%0Awindow.URL%20%3D%20window.URL%20%7C%7C%20window.webkitURL%3B%0A%0A%2F%2F%20a%20middleware%20for%20transforming%20XHR%20loaded%20Blobs%20into%20more%20useful%20objects%0A%0Amodule.exports%20%3D%20function%20()%20%7B%0A%20%20%20%20return%20function%20(resource%2C%20next)%20%7B%0A%20%20%20%20%20%20%20%20if%20(!resource.data)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20next()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20if%20this%20was%20an%20XHR%20load%20of%20a%20blob%0A%20%20%20%20%20%20%20%20if%20(resource.xhr%20%26%26%20resource.xhrType%20%3D%3D%3D%20Resource.XHR_RESPONSE_TYPE.BLOB)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20if%20there%20is%20no%20blob%20support%20we%20probably%20got%20a%20binary%20string%20back%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!window.Blob%20%7C%7C%20typeof%20resource.data%20%3D%3D%3D%20'string')%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20type%20%3D%20resource.xhr.getResponseHeader('content-type')%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20this%20is%20an%20image%2C%20convert%20the%20binary%20string%20into%20a%20data%20url%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(type%20%26%26%20type.indexOf('image')%20%3D%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20resource.data%20%3D%20new%20Image()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20resource.data.src%20%3D%20'data%3A'%20%2B%20type%20%2B%20'%3Bbase64%2C'%20%2B%20b64.encodeBinary(resource.xhr.responseText)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20resource.isImage%20%3D%20true%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20wait%20until%20the%20image%20loads%20and%20then%20callback%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20resource.data.onload%20%3D%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20resource.data.onload%20%3D%20null%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20next()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20if%20content%20type%20says%20this%20is%20an%20image%2C%20then%20we%20should%20transform%20the%20blob%20into%20an%20Image%20object%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20if%20(resource.data.type.indexOf('image')%20%3D%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20src%20%3D%20URL.createObjectURL(resource.data)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20resource.blob%20%3D%20resource.data%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20resource.data%20%3D%20new%20Image()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20resource.data.src%20%3D%20src%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20resource.isImage%20%3D%20true%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20cleanup%20the%20no%20longer%20used%20blob%20after%20the%20image%20loads%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20resource.data.onload%20%3D%20function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20URL.revokeObjectURL(src)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20resource.data.onload%20%3D%20null%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20next()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20next()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%7D%3B%0A%0A%7D%2C%7B%22..%2F..%2FResource%22%3A127%2C%22..%2F..%2Fb64%22%3A128%7D%5D%7D%2C%7B%7D%2C%5B105%5D)(105)%0A%7D)%3B%0A%0A%0A%2F%2F%23%20sourceMappingURL%3Dpixi.js.map%0A"));
},function(e,t,r){"use strict";var A=r(6)["default"],a=r(10)["default"],i=r(3)["default"];Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),o=r(15),s=i(o),l=r(16),B=i(l),D=function(){function e(t){a(this,e),this.renderer=t,this.stage=new n.Container,this.players=new B["default"],this.playerBar=new s["default"](this),this.stage.addChild(this.playerBar.container)}return A(e,[{key:"render",value:function(){this.playerBar.render(),this.renderer.render(this.stage)}}]),e}();t["default"]=D,e.exports=t["default"]},function(e,t,r){"use strict";var A=r(7)["default"];t["default"]=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),A(e,a.key,a)}}return function(t,r,A){return r&&e(t.prototype,r),A&&e(t,A),t}}(),t.__esModule=!0},function(e,t,r){e.exports={"default":r(8),__esModule:!0}},function(e,t,r){var A=r(9);e.exports=function(e,t,r){return A.setDesc(e,t,r)}},function(e,t){var r=Object;e.exports={create:r.create,getProto:r.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:r.getOwnPropertyDescriptor,setDesc:r.defineProperty,setDescs:r.defineProperties,getKeys:r.keys,getNames:r.getOwnPropertyNames,getSymbols:r.getOwnPropertySymbols,each:[].forEach}},function(e,t){"use strict";t["default"]=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t.__esModule=!0},function(e,t,r){"use strict";function A(e,t,r){if(!(this instanceof A))return new A(e,t,r);var l,B,D,h,u=o.test(e),c=typeof t,d=this,p=0;for("object"!==c&&"string"!==c&&(r=t,t=null),r&&"function"!=typeof r&&(r=n.parse),t=i(t);p<s.length;p++)B=s[p],l=B[0],h=B[1],l!==l?d[h]=e:"string"==typeof l?~(D=e.indexOf(l))&&("number"==typeof B[2]?(d[h]=e.slice(0,D),e=e.slice(D+B[2])):(d[h]=e.slice(D),e=e.slice(0,D))):(D=l.exec(e))&&(d[h]=D[1],e=e.slice(0,e.length-D[0].length)),d[h]=d[h]||(B[3]||"port"===h&&u?t[h]||"":""),B[4]&&(d[h]=d[h].toLowerCase());r&&(d.query=r(d.query)),a(d.port,d.protocol)||(d.host=d.hostname,d.port=""),d.username=d.password="",d.auth&&(B=d.auth.split(":"),d.username=B[0]||"",d.password=B[1]||""),d.href=d.toString()}var a=r(12),i=r(13),n=r(14),o=/^\/(?!\/)/,s=[["#","hash"],["?","query"],["//","protocol",2,1,1],["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/\:(\d+)$/,"port"],[NaN,"hostname",void 0,1,1]];A.prototype.set=function(e,t,r){var A=this;return"query"===e?("string"==typeof t&&t.length&&(t=(r||n.parse)(t)),A[e]=t):"port"===e?(A[e]=t,a(t,A.protocol)?t&&(A.host=A.hostname+":"+t):(A.host=A.hostname,A[e]="")):"hostname"===e?(A[e]=t,A.port&&(t+=":"+A.port),A.host=t):"host"===e?(A[e]=t,/\:\d+/.test(t)&&(t=t.split(":"),A.hostname=t[0],A.port=t[1])):A[e]=t,A.href=A.toString(),A},A.prototype.toString=function(e){e&&"function"==typeof e||(e=n.stringify);var t,r=this,A=r.protocol+"//";return r.username&&(A+=r.username,r.password&&(A+=":"+r.password),A+="@"),A+=r.hostname,r.port&&(A+=":"+r.port),A+=r.pathname,t="object"==typeof r.query?e(r.query):r.query,t&&(A+="?"!==t.charAt(0)?"?"+t:t),r.hash&&(A+=r.hash),A},A.qs=n,A.location=i,e.exports=A},function(e,t){"use strict";e.exports=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 22!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},function(e,t,r){(function(t){"use strict";var A,a={hash:1,query:1};e.exports=function(e){e=e||t.location||{},A=A||r(11);var i,n={},o=typeof e;if("blob:"===e.protocol)n=new A(unescape(e.pathname),{});else if("string"===o){n=new A(e,{});for(i in a)delete n[i]}else if("object"===o)for(i in e)i in a||(n[i]=e[i]);return n}}).call(t,function(){return this}())},function(e,t){"use strict";function r(e){for(var t,r=/([^=?&]+)=([^&]*)/g,A={};t=r.exec(e);A[decodeURIComponent(t[1])]=decodeURIComponent(t[2]));return A}function A(e,t){t=t||"";var r=[];"string"!=typeof t&&(t="?");for(var A in e)a.call(e,A)&&r.push(encodeURIComponent(A)+"="+encodeURIComponent(e[A]));return r.length?t+r.join("&"):""}var a=Object.prototype.hasOwnProperty;t.stringify=A,t.parse=r},function(e,t,r){"use strict";var A=r(6)["default"],a=r(10)["default"];Object.defineProperty(t,"__esModule",{value:!0});var i=r(4),n=52/1366,o=57/768,s=300/1366,l=(1-2*n-4*s)/3,B=function(){function e(t){a(this,e),this.manager=t,this.container=new i.Container,this.players=[],this.playerLabels=[],this.playerAvatars=[],this.playerWins=[];for(var r=this.manager.renderer,A=r.width,B=r.height,D=0;4>D;D++){var h=new i.Container;h.position.y=o*B,h.position.x=(n+(l+s)*D)*A,this.players.push(h),this.container.addChild(h),console.log(h);var u=new i.Text("PLAYER "+(D+1),{font:"36px VCR",fill:"#ffffff"});u.x=0,u.y=0,h.addChild(u),this.playerLabels.push(u)}}return A(e,[{key:"render",value:function(){}}]),e}();t["default"]=B,e.exports=t["default"]},function(e,t,r){"use strict";var A=r(6)["default"],a=r(10)["default"];Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){a(this,e),this.inGame=!1,this.players=[];for(var t=0;4>t;t++)this.players.push({user:null,connected:!1,wins:0})}return A(e,[{key:"clear",value:function(){for(var e=0;4>e;e++)this.players[e].user&&this.left(this.players[e].user)}},{key:"_playerForUser",value:function(e){for(var t=0;4>t;t++)if(this.players[t].user===e)return t;return null}},{key:"joined",value:function(e){var t=this._playerForUser(e);if(null===t&&!this.inGame)for(var r=0;4>r;r++)if(!this.players[r].user){t=r;break}if(null!==t){var A=this.players[t];A.user=e,A.connected=!0,this.room.send({a:"pl",h:e,p:t})}}},{key:"left",value:function(e){var t=this._playerForUser(e);if(null!==t){var r=this.players[t];this.inGame&&(r.user=null),r.connected=!1}}},{key:"onData",value:function(e){console.log("data",e)}}]),e}();t["default"]=i,e.exports=t["default"]}]);